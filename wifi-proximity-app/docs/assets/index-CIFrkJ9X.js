function BV(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const u in i)if(u!=="default"&&!(u in t)){const f=Object.getOwnPropertyDescriptor(i,u);f&&Object.defineProperty(t,u,f.get?f:{enumerable:!0,get:()=>i[u]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))i(u);new MutationObserver(u=>{for(const f of u)if(f.type==="childList")for(const g of f.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&i(g)}).observe(document,{childList:!0,subtree:!0});function n(u){const f={};return u.integrity&&(f.integrity=u.integrity),u.referrerPolicy&&(f.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?f.credentials="include":u.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function i(u){if(u.ep)return;u.ep=!0;const f=n(u);fetch(u.href,f)}})();function RT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var sS={exports:{}},k0={};var QM;function NV(){if(QM)return k0;QM=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,u,f){var g=null;if(f!==void 0&&(g=""+f),u.key!==void 0&&(g=""+u.key),"key"in u){f={};for(var b in u)b!=="key"&&(f[b]=u[b])}else f=u;return u=f.ref,{$$typeof:t,type:i,key:g,ref:u!==void 0?u:null,props:f}}return k0.Fragment=e,k0.jsx=n,k0.jsxs=n,k0}var JM;function VV(){return JM||(JM=1,sS.exports=NV()),sS.exports}var U=VV(),oS={exports:{}},Ar={};var eP;function FV(){if(eP)return Ar;eP=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),f=Symbol.for("react.consumer"),g=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),o=Symbol.for("react.suspense"),S=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),N=Symbol.iterator;function j(De){return De===null||typeof De!="object"?null:(De=N&&De[N]||De["@@iterator"],typeof De=="function"?De:null)}var Z={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},K=Object.assign,Q={};function ce(De,tt,Et){this.props=De,this.context=tt,this.refs=Q,this.updater=Et||Z}ce.prototype.isReactComponent={},ce.prototype.setState=function(De,tt){if(typeof De!="object"&&typeof De!="function"&&De!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,De,tt,"setState")},ce.prototype.forceUpdate=function(De){this.updater.enqueueForceUpdate(this,De,"forceUpdate")};function ge(){}ge.prototype=ce.prototype;function ue(De,tt,Et){this.props=De,this.context=tt,this.refs=Q,this.updater=Et||Z}var pe=ue.prototype=new ge;pe.constructor=ue,K(pe,ce.prototype),pe.isPureReactComponent=!0;var me=Array.isArray;function Te(){}var ae={H:null,A:null,T:null,S:null},re=Object.prototype.hasOwnProperty;function he(De,tt,Et){var wt=Et.ref;return{$$typeof:t,type:De,key:tt,ref:wt!==void 0?wt:null,props:Et}}function se(De,tt){return he(De.type,tt,De.props)}function ve(De){return typeof De=="object"&&De!==null&&De.$$typeof===t}function Y(De){var tt={"=":"=0",":":"=2"};return"$"+De.replace(/[=:]/g,function(Et){return tt[Et]})}var le=/\/+/g;function Ne(De,tt){return typeof De=="object"&&De!==null&&De.key!=null?Y(""+De.key):tt.toString(36)}function Ze(De){switch(De.status){case"fulfilled":return De.value;case"rejected":throw De.reason;default:switch(typeof De.status=="string"?De.then(Te,Te):(De.status="pending",De.then(function(tt){De.status==="pending"&&(De.status="fulfilled",De.value=tt)},function(tt){De.status==="pending"&&(De.status="rejected",De.reason=tt)})),De.status){case"fulfilled":return De.value;case"rejected":throw De.reason}}throw De}function Ie(De,tt,Et,wt,Lt){var Ut=typeof De;(Ut==="undefined"||Ut==="boolean")&&(De=null);var an=!1;if(De===null)an=!0;else switch(Ut){case"bigint":case"string":case"number":an=!0;break;case"object":switch(De.$$typeof){case t:case e:an=!0;break;case M:return an=De._init,Ie(an(De._payload),tt,Et,wt,Lt)}}if(an)return Lt=Lt(De),an=wt===""?"."+Ne(De,0):wt,me(Lt)?(Et="",an!=null&&(Et=an.replace(le,"$&/")+"/"),Ie(Lt,tt,Et,"",function(Wt){return Wt})):Lt!=null&&(ve(Lt)&&(Lt=se(Lt,Et+(Lt.key==null||De&&De.key===Lt.key?"":(""+Lt.key).replace(le,"$&/")+"/")+an)),tt.push(Lt)),1;an=0;var At=wt===""?".":wt+":";if(me(De))for(var Qt=0;Qt<De.length;Qt++)wt=De[Qt],Ut=At+Ne(wt,Qt),an+=Ie(wt,tt,Et,Ut,Lt);else if(Qt=j(De),typeof Qt=="function")for(De=Qt.call(De),Qt=0;!(wt=De.next()).done;)wt=wt.value,Ut=At+Ne(wt,Qt++),an+=Ie(wt,tt,Et,Ut,Lt);else if(Ut==="object"){if(typeof De.then=="function")return Ie(Ze(De),tt,Et,wt,Lt);throw tt=String(De),Error("Objects are not valid as a React child (found: "+(tt==="[object Object]"?"object with keys {"+Object.keys(De).join(", ")+"}":tt)+"). If you meant to render a collection of children, use an array instead.")}return an}function Je(De,tt,Et){if(De==null)return De;var wt=[],Lt=0;return Ie(De,wt,"","",function(Ut){return tt.call(Et,Ut,Lt++)}),wt}function dt(De){if(De._status===-1){var tt=De._result;tt=tt(),tt.then(function(Et){(De._status===0||De._status===-1)&&(De._status=1,De._result=Et)},function(Et){(De._status===0||De._status===-1)&&(De._status=2,De._result=Et)}),De._status===-1&&(De._status=0,De._result=tt)}if(De._status===1)return De._result.default;throw De._result}var et=typeof reportError=="function"?reportError:function(De){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var tt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof De=="object"&&De!==null&&typeof De.message=="string"?String(De.message):String(De),error:De});if(!window.dispatchEvent(tt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",De);return}console.error(De)},Kt={map:Je,forEach:function(De,tt,Et){Je(De,function(){tt.apply(this,arguments)},Et)},count:function(De){var tt=0;return Je(De,function(){tt++}),tt},toArray:function(De){return Je(De,function(tt){return tt})||[]},only:function(De){if(!ve(De))throw Error("React.Children.only expected to receive a single React element child.");return De}};return Ar.Activity=O,Ar.Children=Kt,Ar.Component=ce,Ar.Fragment=n,Ar.Profiler=u,Ar.PureComponent=ue,Ar.StrictMode=i,Ar.Suspense=o,Ar.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ae,Ar.__COMPILER_RUNTIME={__proto__:null,c:function(De){return ae.H.useMemoCache(De)}},Ar.cache=function(De){return function(){return De.apply(null,arguments)}},Ar.cacheSignal=function(){return null},Ar.cloneElement=function(De,tt,Et){if(De==null)throw Error("The argument must be a React element, but you passed "+De+".");var wt=K({},De.props),Lt=De.key;if(tt!=null)for(Ut in tt.key!==void 0&&(Lt=""+tt.key),tt)!re.call(tt,Ut)||Ut==="key"||Ut==="__self"||Ut==="__source"||Ut==="ref"&&tt.ref===void 0||(wt[Ut]=tt[Ut]);var Ut=arguments.length-2;if(Ut===1)wt.children=Et;else if(1<Ut){for(var an=Array(Ut),At=0;At<Ut;At++)an[At]=arguments[At+2];wt.children=an}return he(De.type,Lt,wt)},Ar.createContext=function(De){return De={$$typeof:g,_currentValue:De,_currentValue2:De,_threadCount:0,Provider:null,Consumer:null},De.Provider=De,De.Consumer={$$typeof:f,_context:De},De},Ar.createElement=function(De,tt,Et){var wt,Lt={},Ut=null;if(tt!=null)for(wt in tt.key!==void 0&&(Ut=""+tt.key),tt)re.call(tt,wt)&&wt!=="key"&&wt!=="__self"&&wt!=="__source"&&(Lt[wt]=tt[wt]);var an=arguments.length-2;if(an===1)Lt.children=Et;else if(1<an){for(var At=Array(an),Qt=0;Qt<an;Qt++)At[Qt]=arguments[Qt+2];Lt.children=At}if(De&&De.defaultProps)for(wt in an=De.defaultProps,an)Lt[wt]===void 0&&(Lt[wt]=an[wt]);return he(De,Ut,Lt)},Ar.createRef=function(){return{current:null}},Ar.forwardRef=function(De){return{$$typeof:b,render:De}},Ar.isValidElement=ve,Ar.lazy=function(De){return{$$typeof:M,_payload:{_status:-1,_result:De},_init:dt}},Ar.memo=function(De,tt){return{$$typeof:S,type:De,compare:tt===void 0?null:tt}},Ar.startTransition=function(De){var tt=ae.T,Et={};ae.T=Et;try{var wt=De(),Lt=ae.S;Lt!==null&&Lt(Et,wt),typeof wt=="object"&&wt!==null&&typeof wt.then=="function"&&wt.then(Te,et)}catch(Ut){et(Ut)}finally{tt!==null&&Et.types!==null&&(tt.types=Et.types),ae.T=tt}},Ar.unstable_useCacheRefresh=function(){return ae.H.useCacheRefresh()},Ar.use=function(De){return ae.H.use(De)},Ar.useActionState=function(De,tt,Et){return ae.H.useActionState(De,tt,Et)},Ar.useCallback=function(De,tt){return ae.H.useCallback(De,tt)},Ar.useContext=function(De){return ae.H.useContext(De)},Ar.useDebugValue=function(){},Ar.useDeferredValue=function(De,tt){return ae.H.useDeferredValue(De,tt)},Ar.useEffect=function(De,tt){return ae.H.useEffect(De,tt)},Ar.useEffectEvent=function(De){return ae.H.useEffectEvent(De)},Ar.useId=function(){return ae.H.useId()},Ar.useImperativeHandle=function(De,tt,Et){return ae.H.useImperativeHandle(De,tt,Et)},Ar.useInsertionEffect=function(De,tt){return ae.H.useInsertionEffect(De,tt)},Ar.useLayoutEffect=function(De,tt){return ae.H.useLayoutEffect(De,tt)},Ar.useMemo=function(De,tt){return ae.H.useMemo(De,tt)},Ar.useOptimistic=function(De,tt){return ae.H.useOptimistic(De,tt)},Ar.useReducer=function(De,tt,Et){return ae.H.useReducer(De,tt,Et)},Ar.useRef=function(De){return ae.H.useRef(De)},Ar.useState=function(De){return ae.H.useState(De)},Ar.useSyncExternalStore=function(De,tt,Et){return ae.H.useSyncExternalStore(De,tt,Et)},Ar.useTransition=function(){return ae.H.useTransition()},Ar.version="19.2.0",Ar}var tP;function NA(){return tP||(tP=1,oS.exports=FV()),oS.exports}var W=NA();const hu=RT(W),uC=BV({__proto__:null,default:hu},[W]);var aS={exports:{}},D0={},lS={exports:{}},cS={};var nP;function UV(){return nP||(nP=1,(function(t){function e(Ie,Je){var dt=Ie.length;Ie.push(Je);e:for(;0<dt;){var et=dt-1>>>1,Kt=Ie[et];if(0<u(Kt,Je))Ie[et]=Je,Ie[dt]=Kt,dt=et;else break e}}function n(Ie){return Ie.length===0?null:Ie[0]}function i(Ie){if(Ie.length===0)return null;var Je=Ie[0],dt=Ie.pop();if(dt!==Je){Ie[0]=dt;e:for(var et=0,Kt=Ie.length,De=Kt>>>1;et<De;){var tt=2*(et+1)-1,Et=Ie[tt],wt=tt+1,Lt=Ie[wt];if(0>u(Et,dt))wt<Kt&&0>u(Lt,Et)?(Ie[et]=Lt,Ie[wt]=dt,et=wt):(Ie[et]=Et,Ie[tt]=dt,et=tt);else if(wt<Kt&&0>u(Lt,dt))Ie[et]=Lt,Ie[wt]=dt,et=wt;else break e}}return Je}function u(Ie,Je){var dt=Ie.sortIndex-Je.sortIndex;return dt!==0?dt:Ie.id-Je.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var f=performance;t.unstable_now=function(){return f.now()}}else{var g=Date,b=g.now();t.unstable_now=function(){return g.now()-b}}var o=[],S=[],M=1,O=null,N=3,j=!1,Z=!1,K=!1,Q=!1,ce=typeof setTimeout=="function"?setTimeout:null,ge=typeof clearTimeout=="function"?clearTimeout:null,ue=typeof setImmediate<"u"?setImmediate:null;function pe(Ie){for(var Je=n(S);Je!==null;){if(Je.callback===null)i(S);else if(Je.startTime<=Ie)i(S),Je.sortIndex=Je.expirationTime,e(o,Je);else break;Je=n(S)}}function me(Ie){if(K=!1,pe(Ie),!Z)if(n(o)!==null)Z=!0,Te||(Te=!0,Y());else{var Je=n(S);Je!==null&&Ze(me,Je.startTime-Ie)}}var Te=!1,ae=-1,re=5,he=-1;function se(){return Q?!0:!(t.unstable_now()-he<re)}function ve(){if(Q=!1,Te){var Ie=t.unstable_now();he=Ie;var Je=!0;try{e:{Z=!1,K&&(K=!1,ge(ae),ae=-1),j=!0;var dt=N;try{t:{for(pe(Ie),O=n(o);O!==null&&!(O.expirationTime>Ie&&se());){var et=O.callback;if(typeof et=="function"){O.callback=null,N=O.priorityLevel;var Kt=et(O.expirationTime<=Ie);if(Ie=t.unstable_now(),typeof Kt=="function"){O.callback=Kt,pe(Ie),Je=!0;break t}O===n(o)&&i(o),pe(Ie)}else i(o);O=n(o)}if(O!==null)Je=!0;else{var De=n(S);De!==null&&Ze(me,De.startTime-Ie),Je=!1}}break e}finally{O=null,N=dt,j=!1}Je=void 0}}finally{Je?Y():Te=!1}}}var Y;if(typeof ue=="function")Y=function(){ue(ve)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,Ne=le.port2;le.port1.onmessage=ve,Y=function(){Ne.postMessage(null)}}else Y=function(){ce(ve,0)};function Ze(Ie,Je){ae=ce(function(){Ie(t.unstable_now())},Je)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ie){Ie.callback=null},t.unstable_forceFrameRate=function(Ie){0>Ie||125<Ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):re=0<Ie?Math.floor(1e3/Ie):5},t.unstable_getCurrentPriorityLevel=function(){return N},t.unstable_next=function(Ie){switch(N){case 1:case 2:case 3:var Je=3;break;default:Je=N}var dt=N;N=Je;try{return Ie()}finally{N=dt}},t.unstable_requestPaint=function(){Q=!0},t.unstable_runWithPriority=function(Ie,Je){switch(Ie){case 1:case 2:case 3:case 4:case 5:break;default:Ie=3}var dt=N;N=Ie;try{return Je()}finally{N=dt}},t.unstable_scheduleCallback=function(Ie,Je,dt){var et=t.unstable_now();switch(typeof dt=="object"&&dt!==null?(dt=dt.delay,dt=typeof dt=="number"&&0<dt?et+dt:et):dt=et,Ie){case 1:var Kt=-1;break;case 2:Kt=250;break;case 5:Kt=1073741823;break;case 4:Kt=1e4;break;default:Kt=5e3}return Kt=dt+Kt,Ie={id:M++,callback:Je,priorityLevel:Ie,startTime:dt,expirationTime:Kt,sortIndex:-1},dt>et?(Ie.sortIndex=dt,e(S,Ie),n(o)===null&&Ie===n(S)&&(K?(ge(ae),ae=-1):K=!0,Ze(me,dt-et))):(Ie.sortIndex=Kt,e(o,Ie),Z||j||(Z=!0,Te||(Te=!0,Y()))),Ie},t.unstable_shouldYield=se,t.unstable_wrapCallback=function(Ie){var Je=N;return function(){var dt=N;N=Je;try{return Ie.apply(this,arguments)}finally{N=dt}}}})(cS)),cS}var rP;function jV(){return rP||(rP=1,lS.exports=UV()),lS.exports}var uS={exports:{}},Wa={};var iP;function $V(){if(iP)return Wa;iP=1;var t=NA();function e(o){var S="https://react.dev/errors/"+o;if(1<arguments.length){S+="?args[]="+encodeURIComponent(arguments[1]);for(var M=2;M<arguments.length;M++)S+="&args[]="+encodeURIComponent(arguments[M])}return"Minified React error #"+o+"; visit "+S+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},u=Symbol.for("react.portal");function f(o,S,M){var O=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:O==null?null:""+O,children:o,containerInfo:S,implementation:M}}var g=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function b(o,S){if(o==="font")return"";if(typeof S=="string")return S==="use-credentials"?S:""}return Wa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Wa.createPortal=function(o,S){var M=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!S||S.nodeType!==1&&S.nodeType!==9&&S.nodeType!==11)throw Error(e(299));return f(o,S,null,M)},Wa.flushSync=function(o){var S=g.T,M=i.p;try{if(g.T=null,i.p=2,o)return o()}finally{g.T=S,i.p=M,i.d.f()}},Wa.preconnect=function(o,S){typeof o=="string"&&(S?(S=S.crossOrigin,S=typeof S=="string"?S==="use-credentials"?S:"":void 0):S=null,i.d.C(o,S))},Wa.prefetchDNS=function(o){typeof o=="string"&&i.d.D(o)},Wa.preinit=function(o,S){if(typeof o=="string"&&S&&typeof S.as=="string"){var M=S.as,O=b(M,S.crossOrigin),N=typeof S.integrity=="string"?S.integrity:void 0,j=typeof S.fetchPriority=="string"?S.fetchPriority:void 0;M==="style"?i.d.S(o,typeof S.precedence=="string"?S.precedence:void 0,{crossOrigin:O,integrity:N,fetchPriority:j}):M==="script"&&i.d.X(o,{crossOrigin:O,integrity:N,fetchPriority:j,nonce:typeof S.nonce=="string"?S.nonce:void 0})}},Wa.preinitModule=function(o,S){if(typeof o=="string")if(typeof S=="object"&&S!==null){if(S.as==null||S.as==="script"){var M=b(S.as,S.crossOrigin);i.d.M(o,{crossOrigin:M,integrity:typeof S.integrity=="string"?S.integrity:void 0,nonce:typeof S.nonce=="string"?S.nonce:void 0})}}else S==null&&i.d.M(o)},Wa.preload=function(o,S){if(typeof o=="string"&&typeof S=="object"&&S!==null&&typeof S.as=="string"){var M=S.as,O=b(M,S.crossOrigin);i.d.L(o,M,{crossOrigin:O,integrity:typeof S.integrity=="string"?S.integrity:void 0,nonce:typeof S.nonce=="string"?S.nonce:void 0,type:typeof S.type=="string"?S.type:void 0,fetchPriority:typeof S.fetchPriority=="string"?S.fetchPriority:void 0,referrerPolicy:typeof S.referrerPolicy=="string"?S.referrerPolicy:void 0,imageSrcSet:typeof S.imageSrcSet=="string"?S.imageSrcSet:void 0,imageSizes:typeof S.imageSizes=="string"?S.imageSizes:void 0,media:typeof S.media=="string"?S.media:void 0})}},Wa.preloadModule=function(o,S){if(typeof o=="string")if(S){var M=b(S.as,S.crossOrigin);i.d.m(o,{as:typeof S.as=="string"&&S.as!=="script"?S.as:void 0,crossOrigin:M,integrity:typeof S.integrity=="string"?S.integrity:void 0})}else i.d.m(o)},Wa.requestFormReset=function(o){i.d.r(o)},Wa.unstable_batchedUpdates=function(o,S){return o(S)},Wa.useFormState=function(o,S,M){return g.H.useFormState(o,S,M)},Wa.useFormStatus=function(){return g.H.useHostTransitionStatus()},Wa.version="19.2.0",Wa}var sP;function WO(){if(sP)return uS.exports;sP=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),uS.exports=$V(),uS.exports}var oP;function qV(){if(oP)return D0;oP=1;var t=jV(),e=NA(),n=WO();function i(c){var h="https://react.dev/errors/"+c;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)h+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+c+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function u(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function f(c){var h=c,y=c;if(c.alternate)for(;h.return;)h=h.return;else{c=h;do h=c,(h.flags&4098)!==0&&(y=h.return),c=h.return;while(c)}return h.tag===3?y:null}function g(c){if(c.tag===13){var h=c.memoizedState;if(h===null&&(c=c.alternate,c!==null&&(h=c.memoizedState)),h!==null)return h.dehydrated}return null}function b(c){if(c.tag===31){var h=c.memoizedState;if(h===null&&(c=c.alternate,c!==null&&(h=c.memoizedState)),h!==null)return h.dehydrated}return null}function o(c){if(f(c)!==c)throw Error(i(188))}function S(c){var h=c.alternate;if(!h){if(h=f(c),h===null)throw Error(i(188));return h!==c?null:c}for(var y=c,T=h;;){var k=y.return;if(k===null)break;var z=k.alternate;if(z===null){if(T=k.return,T!==null){y=T;continue}break}if(k.child===z.child){for(z=k.child;z;){if(z===y)return o(k),c;if(z===T)return o(k),h;z=z.sibling}throw Error(i(188))}if(y.return!==T.return)y=k,T=z;else{for(var ee=!1,xe=k.child;xe;){if(xe===y){ee=!0,y=k,T=z;break}if(xe===T){ee=!0,T=k,y=z;break}xe=xe.sibling}if(!ee){for(xe=z.child;xe;){if(xe===y){ee=!0,y=z,T=k;break}if(xe===T){ee=!0,T=z,y=k;break}xe=xe.sibling}if(!ee)throw Error(i(189))}}if(y.alternate!==T)throw Error(i(190))}if(y.tag!==3)throw Error(i(188));return y.stateNode.current===y?c:h}function M(c){var h=c.tag;if(h===5||h===26||h===27||h===6)return c;for(c=c.child;c!==null;){if(h=M(c),h!==null)return h;c=c.sibling}return null}var O=Object.assign,N=Symbol.for("react.element"),j=Symbol.for("react.transitional.element"),Z=Symbol.for("react.portal"),K=Symbol.for("react.fragment"),Q=Symbol.for("react.strict_mode"),ce=Symbol.for("react.profiler"),ge=Symbol.for("react.consumer"),ue=Symbol.for("react.context"),pe=Symbol.for("react.forward_ref"),me=Symbol.for("react.suspense"),Te=Symbol.for("react.suspense_list"),ae=Symbol.for("react.memo"),re=Symbol.for("react.lazy"),he=Symbol.for("react.activity"),se=Symbol.for("react.memo_cache_sentinel"),ve=Symbol.iterator;function Y(c){return c===null||typeof c!="object"?null:(c=ve&&c[ve]||c["@@iterator"],typeof c=="function"?c:null)}var le=Symbol.for("react.client.reference");function Ne(c){if(c==null)return null;if(typeof c=="function")return c.$$typeof===le?null:c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case K:return"Fragment";case ce:return"Profiler";case Q:return"StrictMode";case me:return"Suspense";case Te:return"SuspenseList";case he:return"Activity"}if(typeof c=="object")switch(c.$$typeof){case Z:return"Portal";case ue:return c.displayName||"Context";case ge:return(c._context.displayName||"Context")+".Consumer";case pe:var h=c.render;return c=c.displayName,c||(c=h.displayName||h.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case ae:return h=c.displayName||null,h!==null?h:Ne(c.type)||"Memo";case re:h=c._payload,c=c._init;try{return Ne(c(h))}catch{}}return null}var Ze=Array.isArray,Ie=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Je=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,dt={pending:!1,data:null,method:null,action:null},et=[],Kt=-1;function De(c){return{current:c}}function tt(c){0>Kt||(c.current=et[Kt],et[Kt]=null,Kt--)}function Et(c,h){Kt++,et[Kt]=c.current,c.current=h}var wt=De(null),Lt=De(null),Ut=De(null),an=De(null);function At(c,h){switch(Et(Ut,h),Et(Lt,c),Et(wt,null),h.nodeType){case 9:case 11:c=(c=h.documentElement)&&(c=c.namespaceURI)?xf(c):0;break;default:if(c=h.tagName,h=h.namespaceURI)h=xf(h),c=_1(h,c);else switch(c){case"svg":c=1;break;case"math":c=2;break;default:c=0}}tt(wt),Et(wt,c)}function Qt(){tt(wt),tt(Lt),tt(Ut)}function Wt(c){c.memoizedState!==null&&Et(an,c);var h=wt.current,y=_1(h,c.type);h!==y&&(Et(Lt,c),Et(wt,y))}function vn(c){Lt.current===c&&(tt(wt),tt(Lt)),an.current===c&&(tt(an),zp._currentValue=dt)}var Gt,Cn;function ln(c){if(Gt===void 0)try{throw Error()}catch(y){var h=y.stack.trim().match(/\n( *(at )?)/);Gt=h&&h[1]||"",Cn=-1<y.stack.indexOf(`
    at`)?" (<anonymous>)":-1<y.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Gt+c+Cn}var qn=!1;function Rn(c,h){if(!c||qn)return"";qn=!0;var y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var T={DetermineComponentFrameRoot:function(){try{if(h){var Ft=function(){throw Error()};if(Object.defineProperty(Ft.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ft,[])}catch(Tt){var gt=Tt}Reflect.construct(c,[],Ft)}else{try{Ft.call()}catch(Tt){gt=Tt}c.call(Ft.prototype)}}else{try{throw Error()}catch(Tt){gt=Tt}(Ft=c())&&typeof Ft.catch=="function"&&Ft.catch(function(){})}}catch(Tt){if(Tt&&gt&&typeof Tt.stack=="string")return[Tt.stack,gt.stack]}return[null,null]}};T.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var k=Object.getOwnPropertyDescriptor(T.DetermineComponentFrameRoot,"name");k&&k.configurable&&Object.defineProperty(T.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var z=T.DetermineComponentFrameRoot(),ee=z[0],xe=z[1];if(ee&&xe){var We=ee.split(`
`),mt=xe.split(`
`);for(k=T=0;T<We.length&&!We[T].includes("DetermineComponentFrameRoot");)T++;for(;k<mt.length&&!mt[k].includes("DetermineComponentFrameRoot");)k++;if(T===We.length||k===mt.length)for(T=We.length-1,k=mt.length-1;1<=T&&0<=k&&We[T]!==mt[k];)k--;for(;1<=T&&0<=k;T--,k--)if(We[T]!==mt[k]){if(T!==1||k!==1)do if(T--,k--,0>k||We[T]!==mt[k]){var Pt=`
`+We[T].replace(" at new "," at ");return c.displayName&&Pt.includes("<anonymous>")&&(Pt=Pt.replace("<anonymous>",c.displayName)),Pt}while(1<=T&&0<=k);break}}}finally{qn=!1,Error.prepareStackTrace=y}return(y=c?c.displayName||c.name:"")?ln(y):""}function An(c,h){switch(c.tag){case 26:case 27:case 5:return ln(c.type);case 16:return ln("Lazy");case 13:return c.child!==h&&h!==null?ln("Suspense Fallback"):ln("Suspense");case 19:return ln("SuspenseList");case 0:case 15:return Rn(c.type,!1);case 11:return Rn(c.type.render,!1);case 1:return Rn(c.type,!0);case 31:return ln("Activity");default:return""}}function rr(c){try{var h="",y=null;do h+=An(c,y),y=c,c=c.return;while(c);return h}catch(T){return`
Error generating stack: `+T.message+`
`+T.stack}}var En=Object.prototype.hasOwnProperty,bn=t.unstable_scheduleCallback,zn=t.unstable_cancelCallback,mn=t.unstable_shouldYield,ti=t.unstable_requestPaint,Xn=t.unstable_now,on=t.unstable_getCurrentPriorityLevel,Jt=t.unstable_ImmediatePriority,yn=t.unstable_UserBlockingPriority,_n=t.unstable_NormalPriority,In=t.unstable_LowPriority,Bn=t.unstable_IdlePriority,Nn=t.log,Br=t.unstable_setDisableYieldValue,tr=null,_r=null;function xn(c){if(typeof Nn=="function"&&Br(c),_r&&typeof _r.setStrictMode=="function")try{_r.setStrictMode(tr,c)}catch{}}var $n=Math.clz32?Math.clz32:eo,jr=Math.log,Gi=Math.LN2;function eo(c){return c>>>=0,c===0?32:31-(jr(c)/Gi|0)|0}var Oe=256,fe=262144,de=4194304;function Me(c){var h=c&42;if(h!==0)return h;switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return c&261888;case 262144:case 524288:case 1048576:case 2097152:return c&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return c&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return c}}function Ve(c,h,y){var T=c.pendingLanes;if(T===0)return 0;var k=0,z=c.suspendedLanes,ee=c.pingedLanes;c=c.warmLanes;var xe=T&134217727;return xe!==0?(T=xe&~z,T!==0?k=Me(T):(ee&=xe,ee!==0?k=Me(ee):y||(y=xe&~c,y!==0&&(k=Me(y))))):(xe=T&~z,xe!==0?k=Me(xe):ee!==0?k=Me(ee):y||(y=T&~c,y!==0&&(k=Me(y)))),k===0?0:h!==0&&h!==k&&(h&z)===0&&(z=k&-k,y=h&-h,z>=y||z===32&&(y&4194048)!==0)?h:k}function Ge(c,h){return(c.pendingLanes&~(c.suspendedLanes&~c.pingedLanes)&h)===0}function nt(c,h){switch(c){case 1:case 2:case 4:case 8:case 64:return h+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xe(){var c=de;return de<<=1,(de&62914560)===0&&(de=4194304),c}function $e(c){for(var h=[],y=0;31>y;y++)h.push(c);return h}function ct(c,h){c.pendingLanes|=h,h!==268435456&&(c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0)}function Xt(c,h,y,T,k,z){var ee=c.pendingLanes;c.pendingLanes=y,c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0,c.expiredLanes&=y,c.entangledLanes&=y,c.errorRecoveryDisabledLanes&=y,c.shellSuspendCounter=0;var xe=c.entanglements,We=c.expirationTimes,mt=c.hiddenUpdates;for(y=ee&~y;0<y;){var Pt=31-$n(y),Ft=1<<Pt;xe[Pt]=0,We[Pt]=-1;var gt=mt[Pt];if(gt!==null)for(mt[Pt]=null,Pt=0;Pt<gt.length;Pt++){var Tt=gt[Pt];Tt!==null&&(Tt.lane&=-536870913)}y&=~Ft}T!==0&&en(c,T,0),z!==0&&k===0&&c.tag!==0&&(c.suspendedLanes|=z&~(ee&~h))}function en(c,h,y){c.pendingLanes|=h,c.suspendedLanes&=~h;var T=31-$n(h);c.entangledLanes|=h,c.entanglements[T]=c.entanglements[T]|1073741824|y&261930}function jt(c,h){var y=c.entangledLanes|=h;for(c=c.entanglements;y;){var T=31-$n(y),k=1<<T;k&h|c[T]&h&&(c[T]|=h),y&=~k}}function Kn(c,h){var y=h&-h;return y=(y&42)!==0?1:Jn(y),(y&(c.suspendedLanes|h))!==0?0:y}function Jn(c){switch(c){case 2:c=1;break;case 8:c=4;break;case 32:c=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:c=128;break;case 268435456:c=134217728;break;default:c=0}return c}function Hn(c){return c&=-c,2<c?8<c?(c&134217727)!==0?32:268435456:8:2}function ir(){var c=Je.p;return c!==0?c:(c=window.event,c===void 0?32:If(c.type))}function er(c,h){var y=Je.p;try{return Je.p=c,h()}finally{Je.p=y}}var Nr=Math.random().toString(36).slice(2),Cr="__reactFiber$"+Nr,Xr="__reactProps$"+Nr,mi="__reactContainer$"+Nr,Eo="__reactEvents$"+Nr,gs="__reactListeners$"+Nr,ks="__reactHandles$"+Nr,Hl="__reactResources$"+Nr,wl="__reactMarker$"+Nr;function wu(c){delete c[Cr],delete c[Xr],delete c[Eo],delete c[gs],delete c[ks]}function vr(c){var h=c[Cr];if(h)return h;for(var y=c.parentNode;y;){if(h=y[mi]||y[Cr]){if(y=h.alternate,h.child!==null||y!==null&&y.child!==null)for(c=S1(c);c!==null;){if(y=c[Cr])return y;c=S1(c)}return h}c=y,y=c.parentNode}return null}function Uo(c){if(c=c[Cr]||c[mi]){var h=c.tag;if(h===5||h===6||h===13||h===31||h===26||h===27||h===3)return c}return null}function $s(c){var h=c.tag;if(h===5||h===26||h===27||h===6)return c.stateNode;throw Error(i(33))}function wa(c){var h=c[Hl];return h||(h=c[Hl]={hoistableStyles:new Map,hoistableScripts:new Map}),h}function ts(c){c[wl]=!0}var jo=new Set,ea={};function Ta(c,h){Ea(c,h),Ea(c+"Capture",h)}function Ea(c,h){for(ea[c]=h,c=0;c<h.length;c++)jo.add(h[c])}var tl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ta={},Wl={};function vt(c){return En.call(Wl,c)?!0:En.call(ta,c)?!1:tl.test(c)?Wl[c]=!0:(ta[c]=!0,!1)}function $o(c,h,y){if(vt(h))if(y===null)c.removeAttribute(h);else{switch(typeof y){case"undefined":case"function":case"symbol":c.removeAttribute(h);return;case"boolean":var T=h.toLowerCase().slice(0,5);if(T!=="data-"&&T!=="aria-"){c.removeAttribute(h);return}}c.setAttribute(h,""+y)}}function Zr(c,h,y){if(y===null)c.removeAttribute(h);else{switch(typeof y){case"undefined":case"function":case"symbol":case"boolean":c.removeAttribute(h);return}c.setAttribute(h,""+y)}}function Dr(c,h,y,T){if(T===null)c.removeAttribute(y);else{switch(typeof T){case"undefined":case"function":case"symbol":case"boolean":c.removeAttribute(y);return}c.setAttributeNS(h,y,""+T)}}function Es(c){switch(typeof c){case"bigint":case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function qs(c){var h=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function Tu(c,h,y){var T=Object.getOwnPropertyDescriptor(c.constructor.prototype,h);if(!c.hasOwnProperty(h)&&typeof T<"u"&&typeof T.get=="function"&&typeof T.set=="function"){var k=T.get,z=T.set;return Object.defineProperty(c,h,{configurable:!0,get:function(){return k.call(this)},set:function(ee){y=""+ee,z.call(this,ee)}}),Object.defineProperty(c,h,{enumerable:T.enumerable}),{getValue:function(){return y},setValue:function(ee){y=""+ee},stopTracking:function(){c._valueTracker=null,delete c[h]}}}}function ui(c){if(!c._valueTracker){var h=qs(c)?"checked":"value";c._valueTracker=Tu(c,h,""+c[h])}}function Sa(c){if(!c)return!1;var h=c._valueTracker;if(!h)return!0;var y=h.getValue(),T="";return c&&(T=qs(c)?c.checked?"true":"false":c.value),c=T,c!==y?(h.setValue(c),!0):!1}function nn(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}var sr=/[\n"\\]/g;function Wn(c){return c.replace(sr,function(h){return"\\"+h.charCodeAt(0).toString(16)+" "})}function Ds(c,h,y,T,k,z,ee,xe){c.name="",ee!=null&&typeof ee!="function"&&typeof ee!="symbol"&&typeof ee!="boolean"?c.type=ee:c.removeAttribute("type"),h!=null?ee==="number"?(h===0&&c.value===""||c.value!=h)&&(c.value=""+Es(h)):c.value!==""+Es(h)&&(c.value=""+Es(h)):ee!=="submit"&&ee!=="reset"||c.removeAttribute("value"),h!=null?or(c,ee,Es(h)):y!=null?or(c,ee,Es(y)):T!=null&&c.removeAttribute("value"),k==null&&z!=null&&(c.defaultChecked=!!z),k!=null&&(c.checked=k&&typeof k!="function"&&typeof k!="symbol"),xe!=null&&typeof xe!="function"&&typeof xe!="symbol"&&typeof xe!="boolean"?c.name=""+Es(xe):c.removeAttribute("name")}function qo(c,h,y,T,k,z,ee,xe){if(z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(c.type=z),h!=null||y!=null){if(!(z!=="submit"&&z!=="reset"||h!=null)){ui(c);return}y=y!=null?""+Es(y):"",h=h!=null?""+Es(h):y,xe||h===c.value||(c.value=h),c.defaultValue=h}T=T??k,T=typeof T!="function"&&typeof T!="symbol"&&!!T,c.checked=xe?c.checked:!!T,c.defaultChecked=!!T,ee!=null&&typeof ee!="function"&&typeof ee!="symbol"&&typeof ee!="boolean"&&(c.name=ee),ui(c)}function or(c,h,y){h==="number"&&nn(c.ownerDocument)===c||c.defaultValue===""+y||(c.defaultValue=""+y)}function ys(c,h,y,T){if(c=c.options,h){h={};for(var k=0;k<y.length;k++)h["$"+y[k]]=!0;for(y=0;y<c.length;y++)k=h.hasOwnProperty("$"+c[y].value),c[y].selected!==k&&(c[y].selected=k),k&&T&&(c[y].defaultSelected=!0)}else{for(y=""+Es(y),h=null,k=0;k<c.length;k++){if(c[k].value===y){c[k].selected=!0,T&&(c[k].defaultSelected=!0);return}h!==null||c[k].disabled||(h=c[k])}h!==null&&(h.selected=!0)}}function Ac(c,h,y){if(h!=null&&(h=""+Es(h),h!==c.value&&(c.value=h),y==null)){c.defaultValue!==h&&(c.defaultValue=h);return}c.defaultValue=y!=null?""+Es(y):""}function Go(c,h,y,T){if(h==null){if(T!=null){if(y!=null)throw Error(i(92));if(Ze(T)){if(1<T.length)throw Error(i(93));T=T[0]}y=T}y==null&&(y=""),h=y}y=Es(h),c.defaultValue=y,T=c.textContent,T===y&&T!==""&&T!==null&&(c.value=T),ui(c)}function Hi(c,h){if(h){var y=c.firstChild;if(y&&y===c.lastChild&&y.nodeType===3){y.nodeValue=h;return}}c.textContent=h}var gi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function vh(c,h,y){var T=h.indexOf("--")===0;y==null||typeof y=="boolean"||y===""?T?c.setProperty(h,""):h==="float"?c.cssFloat="":c[h]="":T?c.setProperty(h,y):typeof y!="number"||y===0||gi.has(h)?h==="float"?c.cssFloat=y:c[h]=(""+y).trim():c[h]=y+"px"}function na(c,h,y){if(h!=null&&typeof h!="object")throw Error(i(62));if(c=c.style,y!=null){for(var T in y)!y.hasOwnProperty(T)||h!=null&&h.hasOwnProperty(T)||(T.indexOf("--")===0?c.setProperty(T,""):T==="float"?c.cssFloat="":c[T]="");for(var k in h)T=h[k],h.hasOwnProperty(k)&&y[k]!==T&&vh(c,k,T)}else for(var z in h)h.hasOwnProperty(z)&&vh(c,z,h[z])}function Tl(c){if(c.indexOf("-")===-1)return!1;switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ic=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),El=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Eu(c){return El.test(""+c)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":c}function So(){}var Xl=null;function Co(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var ra=null,ns=null;function Ti(c){var h=Uo(c);if(h&&(c=h.stateNode)){var y=c[Xr]||null;e:switch(c=h.stateNode,h.type){case"input":if(Ds(c,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name),h=y.name,y.type==="radio"&&h!=null){for(y=c;y.parentNode;)y=y.parentNode;for(y=y.querySelectorAll('input[name="'+Wn(""+h)+'"][type="radio"]'),h=0;h<y.length;h++){var T=y[h];if(T!==c&&T.form===c.form){var k=T[Xr]||null;if(!k)throw Error(i(90));Ds(T,k.value,k.defaultValue,k.defaultValue,k.checked,k.defaultChecked,k.type,k.name)}}for(h=0;h<y.length;h++)T=y[h],T.form===c.form&&Sa(T)}break e;case"textarea":Ac(c,y.value,y.defaultValue);break e;case"select":h=y.value,h!=null&&ys(c,!!y.multiple,h,!1)}}}var Rc=!1;function Sl(c,h,y){if(Rc)return c(h,y);Rc=!0;try{var T=c(h);return T}finally{if(Rc=!1,(ra!==null||ns!==null)&&(Ap(),ra&&(h=ra,c=ns,ns=ra=null,Ti(h),c)))for(h=0;h<c.length;h++)Ti(c[h])}}function Yi(c,h){var y=c.stateNode;if(y===null)return null;var T=y[Xr]||null;if(T===null)return null;y=T[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(T=!T.disabled)||(c=c.type,T=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!T;break e;default:c=!1}if(c)return null;if(y&&typeof y!="function")throw Error(i(231,h,typeof y));return y}var rs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Mc=!1;if(rs)try{var ni={};Object.defineProperty(ni,"passive",{get:function(){Mc=!0}}),window.addEventListener("test",ni,ni),window.removeEventListener("test",ni,ni)}catch{Mc=!1}var ri=null,Zl=null,Kl=null;function nl(){if(Kl)return Kl;var c,h=Zl,y=h.length,T,k="value"in ri?ri.value:ri.textContent,z=k.length;for(c=0;c<y&&h[c]===k[c];c++);var ee=y-c;for(T=1;T<=ee&&h[y-T]===k[z-T];T++);return Kl=k.slice(c,1<T?1-T:void 0)}function is(c){var h=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&h===13&&(c=13)):c=h,c===10&&(c=13),32<=c||c===13?c:0}function rl(){return!0}function ia(){return!1}function Wi(c){function h(y,T,k,z,ee){this._reactName=y,this._targetInst=k,this.type=T,this.nativeEvent=z,this.target=ee,this.currentTarget=null;for(var xe in c)c.hasOwnProperty(xe)&&(y=c[xe],this[xe]=y?y(z):z[xe]);return this.isDefaultPrevented=(z.defaultPrevented!=null?z.defaultPrevented:z.returnValue===!1)?rl:ia,this.isPropagationStopped=ia,this}return O(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var y=this.nativeEvent;y&&(y.preventDefault?y.preventDefault():typeof y.returnValue!="unknown"&&(y.returnValue=!1),this.isDefaultPrevented=rl)},stopPropagation:function(){var y=this.nativeEvent;y&&(y.stopPropagation?y.stopPropagation():typeof y.cancelBubble!="unknown"&&(y.cancelBubble=!0),this.isPropagationStopped=rl)},persist:function(){},isPersistent:rl}),h}var to={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sa=Wi(to),Pc=O({},to,{view:0,detail:0}),Su=Wi(Pc),oa,Ao,Ca,Aa=O({},Pc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cl,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==Ca&&(Ca&&c.type==="mousemove"?(oa=c.screenX-Ca.screenX,Ao=c.screenY-Ca.screenY):Ao=oa=0,Ca=c),oa)},movementY:function(c){return"movementY"in c?c.movementY:Ao}}),aa=Wi(Aa),il=O({},Aa,{dataTransfer:0}),Ia=Wi(il),Cu=O({},Pc,{relatedTarget:0}),Ra=Wi(Cu),Yl=O({},to,{animationName:0,elapsedTime:0,pseudoElement:0}),Vd=Wi(Yl),Ql=O({},to,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),xh=Wi(Ql),bh=O({},to,{data:0}),Io=Wi(bh),Lr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Zf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Fd(c){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(c):(c=wh[c])?!!h[c]:!1}function Cl(){return Fd}var no=O({},Pc,{key:function(c){if(c.key){var h=Lr[c.key]||c.key;if(h!=="Unidentified")return h}return c.type==="keypress"?(c=is(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?Zf[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cl,charCode:function(c){return c.type==="keypress"?is(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?is(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),Th=Wi(no),Jl=O({},Aa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ma=Wi(Jl),R=O({},Pc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cl}),H=Wi(R),ie=O({},to,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ae=Wi(ie),ht=O({},Aa,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),yt=Wi(ht),pn=O({},to,{newState:0,oldState:0}),gr=Wi(pn),Qi=[9,13,27,32],$r=rs&&"CompositionEvent"in window,Vi=null;rs&&"documentMode"in document&&(Vi=document.documentMode);var nr=rs&&"TextEvent"in window&&!Vi,Ho=rs&&(!$r||Vi&&8<Vi&&11>=Vi),Pa=" ",la=!1;function kc(c,h){switch(c){case"keyup":return Qi.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ka(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Dc=!1;function uv(c,h){switch(c){case"compositionend":return ka(h);case"keypress":return h.which!==32?null:(la=!0,Pa);case"textInput":return c=h.data,c===Pa&&la?null:c;default:return null}}function hv(c,h){if(Dc)return c==="compositionend"||!$r&&kc(c,h)?(c=nl(),Kl=Zl=ri=null,Dc=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return Ho&&h.locale!=="ko"?null:h.data;default:return null}}var dv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kf(c){var h=c&&c.nodeName&&c.nodeName.toLowerCase();return h==="input"?!!dv[c.type]:h==="textarea"}function Yf(c,h,y,T){ra?ns?ns.push(T):ns=[T]:ra=T,h=_f(h,"onChange"),0<h.length&&(y=new sa("onChange","change",null,y,T),c.push({event:y,listeners:h}))}var Au=null,Lc=null;function Kg(c){n0(c,0)}function Ud(c){var h=$s(c);if(Sa(h))return c}function Yg(c,h){if(c==="change")return h}var Eh=!1;if(rs){var Oc;if(rs){var jd="oninput"in document;if(!jd){var Sh=document.createElement("div");Sh.setAttribute("oninput","return;"),jd=typeof Sh.oninput=="function"}Oc=jd}else Oc=!1;Eh=Oc&&(!document.documentMode||9<document.documentMode)}function Qf(){Au&&(Au.detachEvent("onpropertychange",sl),Lc=Au=null)}function sl(c){if(c.propertyName==="value"&&Ud(Lc)){var h=[];Yf(h,Lc,c,Co(c)),Sl(Kg,h)}}function Jf(c,h,y){c==="focusin"?(Qf(),Au=h,Lc=y,Au.attachEvent("onpropertychange",sl)):c==="focusout"&&Qf()}function Am(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return Ud(Lc)}function ep(c,h){if(c==="click")return Ud(h)}function Qg(c,h){if(c==="input"||c==="change")return Ud(h)}function Im(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var ca=typeof Object.is=="function"?Object.is:Im;function Iu(c,h){if(ca(c,h))return!0;if(typeof c!="object"||c===null||typeof h!="object"||h===null)return!1;var y=Object.keys(c),T=Object.keys(h);if(y.length!==T.length)return!1;for(T=0;T<y.length;T++){var k=y[T];if(!En.call(h,k)||!ca(c[k],h[k]))return!1}return!0}function $d(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function Ch(c,h){var y=$d(c);c=0;for(var T;y;){if(y.nodeType===3){if(T=c+y.textContent.length,c<=h&&T>=h)return{node:y,offset:h-c};c=T}e:{for(;y;){if(y.nextSibling){y=y.nextSibling;break e}y=y.parentNode}y=void 0}y=$d(y)}}function Rm(c,h){return c&&h?c===h?!0:c&&c.nodeType===3?!1:h&&h.nodeType===3?Rm(c,h.parentNode):"contains"in c?c.contains(h):c.compareDocumentPosition?!!(c.compareDocumentPosition(h)&16):!1:!1}function tp(c){c=c!=null&&c.ownerDocument!=null&&c.ownerDocument.defaultView!=null?c.ownerDocument.defaultView:window;for(var h=nn(c.document);h instanceof c.HTMLIFrameElement;){try{var y=typeof h.contentWindow.location.href=="string"}catch{y=!1}if(y)c=h.contentWindow;else break;h=nn(c.document)}return h}function Mm(c){var h=c&&c.nodeName&&c.nodeName.toLowerCase();return h&&(h==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||h==="textarea"||c.contentEditable==="true")}var Pm=rs&&"documentMode"in document&&11>=document.documentMode,Ru=null,Mu=null,Ah=null,Ih=!1;function km(c,h,y){var T=y.window===y?y.document:y.nodeType===9?y:y.ownerDocument;Ih||Ru==null||Ru!==nn(T)||(T=Ru,"selectionStart"in T&&Mm(T)?T={start:T.selectionStart,end:T.selectionEnd}:(T=(T.ownerDocument&&T.ownerDocument.defaultView||window).getSelection(),T={anchorNode:T.anchorNode,anchorOffset:T.anchorOffset,focusNode:T.focusNode,focusOffset:T.focusOffset}),Ah&&Iu(Ah,T)||(Ah=T,T=_f(Mu,"onSelect"),0<T.length&&(h=new sa("onSelect","select",null,h,y),c.push({event:h,listeners:T}),h.target=Ru)))}function Da(c,h){var y={};return y[c.toLowerCase()]=h.toLowerCase(),y["Webkit"+c]="webkit"+h,y["Moz"+c]="moz"+h,y}var Rh={animationend:Da("Animation","AnimationEnd"),animationiteration:Da("Animation","AnimationIteration"),animationstart:Da("Animation","AnimationStart"),transitionrun:Da("Transition","TransitionRun"),transitionstart:Da("Transition","TransitionStart"),transitioncancel:Da("Transition","TransitionCancel"),transitionend:Da("Transition","TransitionEnd")},Dm={},Jg={};rs&&(Jg=document.createElement("div").style,"AnimationEvent"in window||(delete Rh.animationend.animation,delete Rh.animationiteration.animation,delete Rh.animationstart.animation),"TransitionEvent"in window||delete Rh.transitionend.transition);function Pu(c){if(Dm[c])return Dm[c];if(!Rh[c])return c;var h=Rh[c],y;for(y in h)if(h.hasOwnProperty(y)&&y in Jg)return Dm[c]=h[y];return c}var ey=Pu("animationend"),Lm=Pu("animationiteration"),qd=Pu("animationstart"),Mh=Pu("transitionrun"),ty=Pu("transitionstart"),ny=Pu("transitioncancel"),Al=Pu("transitionend"),Gd=new Map,Wo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Wo.push("scrollEnd");function Ro(c,h){Gd.set(c,h),Ta(h,[c])}var Hd=typeof reportError=="function"?reportError:function(c){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof c=="object"&&c!==null&&typeof c.message=="string"?String(c.message):String(c),error:c});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",c);return}console.error(c)},Ls=[],ol=0,Ph=0;function ku(){for(var c=ol,h=Ph=ol=0;h<c;){var y=Ls[h];Ls[h++]=null;var T=Ls[h];Ls[h++]=null;var k=Ls[h];Ls[h++]=null;var z=Ls[h];if(Ls[h++]=null,T!==null&&k!==null){var ee=T.pending;ee===null?k.next=k:(k.next=ee.next,ee.next=k),T.pending=k}z!==0&&Wd(y,k,z)}}function Mr(c,h,y,T){Ls[ol++]=c,Ls[ol++]=h,Ls[ol++]=y,Ls[ol++]=T,Ph|=T,c.lanes|=T,c=c.alternate,c!==null&&(c.lanes|=T)}function Du(c,h,y,T){return Mr(c,h,y,T),ec(c)}function zc(c,h){return Mr(c,null,null,h),ec(c)}function Wd(c,h,y){c.lanes|=y;var T=c.alternate;T!==null&&(T.lanes|=y);for(var k=!1,z=c.return;z!==null;)z.childLanes|=y,T=z.alternate,T!==null&&(T.childLanes|=y),z.tag===22&&(c=z.stateNode,c===null||c._visibility&1||(k=!0)),c=z,z=z.return;return c.tag===3?(z=c.stateNode,k&&h!==null&&(k=31-$n(y),c=z.hiddenUpdates,T=c[k],T===null?c[k]=[h]:T.push(h),h.lane=y|536870912),z):null}function ec(c){if(50<Xi)throw Xi=0,Sp=null,Error(i(185));for(var h=c.return;h!==null;)c=h,h=c.return;return c.tag===3?c.stateNode:null}var Lu={};function np(c,h,y,T){this.tag=c,this.key=y,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=T,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ds(c,h,y,T){return new np(c,h,y,T)}function rp(c){return c=c.prototype,!(!c||!c.isReactComponent)}function La(c,h){var y=c.alternate;return y===null?(y=ds(c.tag,h,c.key,c.mode),y.elementType=c.elementType,y.type=c.type,y.stateNode=c.stateNode,y.alternate=c,c.alternate=y):(y.pendingProps=h,y.type=c.type,y.flags=0,y.subtreeFlags=0,y.deletions=null),y.flags=c.flags&65011712,y.childLanes=c.childLanes,y.lanes=c.lanes,y.child=c.child,y.memoizedProps=c.memoizedProps,y.memoizedState=c.memoizedState,y.updateQueue=c.updateQueue,h=c.dependencies,y.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},y.sibling=c.sibling,y.index=c.index,y.ref=c.ref,y.refCleanup=c.refCleanup,y}function Ou(c,h){c.flags&=65011714;var y=c.alternate;return y===null?(c.childLanes=0,c.lanes=h,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=y.childLanes,c.lanes=y.lanes,c.child=y.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=y.memoizedProps,c.memoizedState=y.memoizedState,c.updateQueue=y.updateQueue,c.type=y.type,h=y.dependencies,c.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),c}function tc(c,h,y,T,k,z){var ee=0;if(T=c,typeof c=="function")rp(c)&&(ee=1);else if(typeof c=="string")ee=P1(c,y,wt.current)?26:c==="html"||c==="head"||c==="body"?27:5;else e:switch(c){case he:return c=ds(31,y,h,k),c.elementType=he,c.lanes=z,c;case K:return nc(y.children,k,z,h);case Q:ee=8,k|=24;break;case ce:return c=ds(12,y,h,k|2),c.elementType=ce,c.lanes=z,c;case me:return c=ds(13,y,h,k),c.elementType=me,c.lanes=z,c;case Te:return c=ds(19,y,h,k),c.elementType=Te,c.lanes=z,c;default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case ue:ee=10;break e;case ge:ee=9;break e;case pe:ee=11;break e;case ae:ee=14;break e;case re:ee=16,T=null;break e}ee=29,y=Error(i(130,c===null?"null":typeof c,"")),T=null}return h=ds(ee,y,h,k),h.elementType=c,h.type=T,h.lanes=z,h}function nc(c,h,y,T){return c=ds(7,c,T,h),c.lanes=y,c}function zu(c,h,y){return c=ds(6,c,null,h),c.lanes=y,c}function kh(c){var h=ds(18,null,null,0);return h.stateNode=c,h}function Dh(c,h,y){return h=ds(4,c.children!==null?c.children:[],c.key,h),h.lanes=y,h.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},h}var Xd=new WeakMap;function rn(c,h){if(typeof c=="object"&&c!==null){var y=Xd.get(c);return y!==void 0?y:(h={value:c,source:h,stack:rr(h)},Xd.set(c,h),h)}return{value:c,source:h,stack:rr(h)}}var ro=[],Bu=0,Bc=null,rc=0,yi=[],io=0,al=null,Oa=1,ua="";function Il(c,h){ro[Bu++]=rc,ro[Bu++]=Bc,Bc=c,rc=h}function Zd(c,h,y){yi[io++]=Oa,yi[io++]=ua,yi[io++]=al,al=c;var T=Oa;c=ua;var k=32-$n(T)-1;T&=~(1<<k),y+=1;var z=32-$n(h)+k;if(30<z){var ee=k-k%5;z=(T&(1<<ee)-1).toString(32),T>>=ee,k-=ee,Oa=1<<32-$n(h)+k|y<<k|T,ua=z+c}else Oa=1<<z|y<<k|T,ua=c}function Nc(c){c.return!==null&&(Il(c,1),Zd(c,1,0))}function Kd(c){for(;c===Bc;)Bc=ro[--Bu],ro[Bu]=null,rc=ro[--Bu],ro[Bu]=null;for(;c===al;)al=yi[--io],yi[io]=null,ua=yi[--io],yi[io]=null,Oa=yi[--io],yi[io]=null}function ry(c,h){yi[io++]=Oa,yi[io++]=ua,yi[io++]=al,Oa=h.id,ua=h.overflow,al=c}var Os=null,hi=null,Or=!1,Rl=null,Xo=!1,Lh=Error(i(519));function za(c){var h=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ba(rn(h,c)),Lh}function Oh(c){var h=c.stateNode,y=c.type,T=c.memoizedProps;switch(h[Cr]=c,h[Xr]=T,y){case"dialog":zr("cancel",h),zr("close",h);break;case"iframe":case"object":case"embed":zr("load",h);break;case"video":case"audio":for(y=0;y<Yc.length;y++)zr(Yc[y],h);break;case"source":zr("error",h);break;case"img":case"image":case"link":zr("error",h),zr("load",h);break;case"details":zr("toggle",h);break;case"input":zr("invalid",h),qo(h,T.value,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name,!0);break;case"select":zr("invalid",h);break;case"textarea":zr("invalid",h),Go(h,T.value,T.defaultValue,T.children)}y=T.children,typeof y!="string"&&typeof y!="number"&&typeof y!="bigint"||h.textContent===""+y||T.suppressHydrationWarning===!0||m1(h.textContent,y)?(T.popover!=null&&(zr("beforetoggle",h),zr("toggle",h)),T.onScroll!=null&&zr("scroll",h),T.onScrollEnd!=null&&zr("scrollend",h),T.onClick!=null&&(h.onclick=So),h=!0):h=!1,h||za(c,!0)}function ip(c){for(Os=c.return;Os;)switch(Os.tag){case 5:case 31:case 13:Xo=!1;return;case 27:case 3:Xo=!0;return;default:Os=Os.return}}function Nu(c){if(c!==Os)return!1;if(!Or)return ip(c),Or=!0,!1;var h=c.tag,y;if((y=h!==3&&h!==27)&&((y=h===5)&&(y=c.type,y=!(y!=="form"&&y!=="button")||l0(c.type,c.memoizedProps)),y=!y),y&&hi&&za(c),ip(c),h===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(i(317));hi=E1(c)}else if(h===31){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(i(317));hi=E1(c)}else h===27?(h=hi,Qc(c.type)?(c=p0,p0=null,hi=c):hi=h):hi=Os?zl(c.stateNode.nextSibling):null;return!0}function ic(){hi=Os=null,Or=!1}function sp(){var c=Rl;return c!==null&&(pa===null?pa=c:pa.push.apply(pa,c),Rl=null),c}function Ba(c){Rl===null?Rl=[c]:Rl.push(c)}var op=De(null),Vc=null,sc=null;function oc(c,h,y){Et(op,h._currentValue),h._currentValue=y}function ll(c){c._currentValue=op.current,tt(op)}function ap(c,h,y){for(;c!==null;){var T=c.alternate;if((c.childLanes&h)!==h?(c.childLanes|=h,T!==null&&(T.childLanes|=h)):T!==null&&(T.childLanes&h)!==h&&(T.childLanes|=h),c===y)break;c=c.return}}function lp(c,h,y,T){var k=c.child;for(k!==null&&(k.return=c);k!==null;){var z=k.dependencies;if(z!==null){var ee=k.child;z=z.firstContext;e:for(;z!==null;){var xe=z;z=k;for(var We=0;We<h.length;We++)if(xe.context===h[We]){z.lanes|=y,xe=z.alternate,xe!==null&&(xe.lanes|=y),ap(z.return,y,c),T||(ee=null);break e}z=xe.next}}else if(k.tag===18){if(ee=k.return,ee===null)throw Error(i(341));ee.lanes|=y,z=ee.alternate,z!==null&&(z.lanes|=y),ap(ee,y,c),ee=null}else ee=k.child;if(ee!==null)ee.return=k;else for(ee=k;ee!==null;){if(ee===c){ee=null;break}if(k=ee.sibling,k!==null){k.return=ee.return,ee=k;break}ee=ee.return}k=ee}}function fs(c,h,y,T){c=null;for(var k=h,z=!1;k!==null;){if(!z){if((k.flags&524288)!==0)z=!0;else if((k.flags&262144)!==0)break}if(k.tag===10){var ee=k.alternate;if(ee===null)throw Error(i(387));if(ee=ee.memoizedProps,ee!==null){var xe=k.type;ca(k.pendingProps.value,ee.value)||(c!==null?c.push(xe):c=[xe])}}else if(k===an.current){if(ee=k.alternate,ee===null)throw Error(i(387));ee.memoizedState.memoizedState!==k.memoizedState.memoizedState&&(c!==null?c.push(zp):c=[zp])}k=k.return}c!==null&&lp(h,c,y,T),h.flags|=262144}function cp(c){for(c=c.firstContext;c!==null;){if(!ca(c.context._currentValue,c.memoizedValue))return!0;c=c.next}return!1}function Fc(c){Vc=c,sc=null,c=c.dependencies,c!==null&&(c.firstContext=null)}function Gs(c){return ha(Vc,c)}function up(c,h){return Vc===null&&Fc(c),ha(c,h)}function ha(c,h){var y=h._currentValue;if(h={context:h,memoizedValue:y,next:null},sc===null){if(c===null)throw Error(i(308));sc=h,c.dependencies={lanes:0,firstContext:h},c.flags|=524288}else sc=sc.next=h;return y}var iy=typeof AbortController<"u"?AbortController:function(){var c=[],h=this.signal={aborted:!1,addEventListener:function(y,T){c.push(T)}};this.abort=function(){h.aborted=!0,c.forEach(function(y){return y()})}},fv=t.unstable_scheduleCallback,cl=t.unstable_NormalPriority,_i={$$typeof:ue,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ac(){return{controller:new iy,data:new Map,refCount:0}}function Uc(c){c.refCount--,c.refCount===0&&fv(cl,function(){c.controller.abort()})}var gn=null,Yd=0,jc=0,ul=null;function Vu(c,h){if(gn===null){var y=gn=[];Yd=0,jc=Oy(),ul={status:"pending",value:void 0,then:function(T){y.push(T)}}}return Yd++,h.then(un,un),h}function un(){if(--Yd===0&&gn!==null){ul!==null&&(ul.status="fulfilled");var c=gn;gn=null,jc=0,ul=null;for(var h=0;h<c.length;h++)(0,c[h])()}}function Om(c,h){var y=[],T={status:"pending",value:null,reason:null,then:function(k){y.push(k)}};return c.then(function(){T.status="fulfilled",T.value=h;for(var k=0;k<y.length;k++)(0,y[k])(h)},function(k){for(T.status="rejected",T.reason=k,k=0;k<y.length;k++)(0,y[k])(void 0)}),T}var sy=Ie.S;Ie.S=function(c,h){Xb=Xn(),typeof h=="object"&&h!==null&&typeof h.then=="function"&&Vu(c,h),sy!==null&&sy(c,h)};var $c=De(null);function Qd(){var c=$c.current;return c!==null?c:Fi.pooledCache}function Jd(c,h){h===null?Et($c,$c.current):Et($c,h.pool)}function zm(){var c=Qd();return c===null?null:{parent:_i._currentValue,pool:c}}var zh=Error(i(460)),Bm=Error(i(474)),Bh=Error(i(542)),Nh={then:function(){}};function hp(c){return c=c.status,c==="fulfilled"||c==="rejected"}function Fu(c,h,y){switch(y=c[y],y===void 0?c.push(h):y!==h&&(h.then(So,So),h=y),h.status){case"fulfilled":return h.value;case"rejected":throw c=h.reason,x(c),c;default:if(typeof h.status=="string")h.then(So,So);else{if(c=Fi,c!==null&&100<c.shellSuspendCounter)throw Error(i(482));c=h,c.status="pending",c.then(function(T){if(h.status==="pending"){var k=h;k.status="fulfilled",k.value=T}},function(T){if(h.status==="pending"){var k=h;k.status="rejected",k.reason=T}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw c=h.reason,x(c),c}throw l=h,zh}}function _(c){try{var h=c._init;return h(c._payload)}catch(y){throw y!==null&&typeof y=="object"&&typeof y.then=="function"?(l=y,zh):y}}var l=null;function p(){if(l===null)throw Error(i(459));var c=l;return l=null,c}function x(c){if(c===zh||c===Bh)throw Error(i(483))}var E=null,A=0;function D(c){var h=A;return A+=1,E===null&&(E=[]),Fu(E,c,h)}function L(c,h){h=h.props.ref,c.ref=h!==void 0?h:null}function V(c,h){throw h.$$typeof===N?Error(i(525)):(c=Object.prototype.toString.call(h),Error(i(31,c==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":c)))}function G(c){function h(it,Ke){if(c){var ft=it.deletions;ft===null?(it.deletions=[Ke],it.flags|=16):ft.push(Ke)}}function y(it,Ke){if(!c)return null;for(;Ke!==null;)h(it,Ke),Ke=Ke.sibling;return null}function T(it){for(var Ke=new Map;it!==null;)it.key!==null?Ke.set(it.key,it):Ke.set(it.index,it),it=it.sibling;return Ke}function k(it,Ke){return it=La(it,Ke),it.index=0,it.sibling=null,it}function z(it,Ke,ft){return it.index=ft,c?(ft=it.alternate,ft!==null?(ft=ft.index,ft<Ke?(it.flags|=67108866,Ke):ft):(it.flags|=67108866,Ke)):(it.flags|=1048576,Ke)}function ee(it){return c&&it.alternate===null&&(it.flags|=67108866),it}function xe(it,Ke,ft,kt){return Ke===null||Ke.tag!==6?(Ke=zu(ft,it.mode,kt),Ke.return=it,Ke):(Ke=k(Ke,ft),Ke.return=it,Ke)}function We(it,Ke,ft,kt){var Zn=ft.type;return Zn===K?Pt(it,Ke,ft.props.children,kt,ft.key):Ke!==null&&(Ke.elementType===Zn||typeof Zn=="object"&&Zn!==null&&Zn.$$typeof===re&&_(Zn)===Ke.type)?(Ke=k(Ke,ft.props),L(Ke,ft),Ke.return=it,Ke):(Ke=tc(ft.type,ft.key,ft.props,null,it.mode,kt),L(Ke,ft),Ke.return=it,Ke)}function mt(it,Ke,ft,kt){return Ke===null||Ke.tag!==4||Ke.stateNode.containerInfo!==ft.containerInfo||Ke.stateNode.implementation!==ft.implementation?(Ke=Dh(ft,it.mode,kt),Ke.return=it,Ke):(Ke=k(Ke,ft.children||[]),Ke.return=it,Ke)}function Pt(it,Ke,ft,kt,Zn){return Ke===null||Ke.tag!==7?(Ke=nc(ft,it.mode,kt,Zn),Ke.return=it,Ke):(Ke=k(Ke,ft),Ke.return=it,Ke)}function Ft(it,Ke,ft){if(typeof Ke=="string"&&Ke!==""||typeof Ke=="number"||typeof Ke=="bigint")return Ke=zu(""+Ke,it.mode,ft),Ke.return=it,Ke;if(typeof Ke=="object"&&Ke!==null){switch(Ke.$$typeof){case j:return ft=tc(Ke.type,Ke.key,Ke.props,null,it.mode,ft),L(ft,Ke),ft.return=it,ft;case Z:return Ke=Dh(Ke,it.mode,ft),Ke.return=it,Ke;case re:return Ke=_(Ke),Ft(it,Ke,ft)}if(Ze(Ke)||Y(Ke))return Ke=nc(Ke,it.mode,ft,null),Ke.return=it,Ke;if(typeof Ke.then=="function")return Ft(it,D(Ke),ft);if(Ke.$$typeof===ue)return Ft(it,up(it,Ke),ft);V(it,Ke)}return null}function gt(it,Ke,ft,kt){var Zn=Ke!==null?Ke.key:null;if(typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint")return Zn!==null?null:xe(it,Ke,""+ft,kt);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case j:return ft.key===Zn?We(it,Ke,ft,kt):null;case Z:return ft.key===Zn?mt(it,Ke,ft,kt):null;case re:return ft=_(ft),gt(it,Ke,ft,kt)}if(Ze(ft)||Y(ft))return Zn!==null?null:Pt(it,Ke,ft,kt,null);if(typeof ft.then=="function")return gt(it,Ke,D(ft),kt);if(ft.$$typeof===ue)return gt(it,Ke,up(it,ft),kt);V(it,ft)}return null}function Tt(it,Ke,ft,kt,Zn){if(typeof kt=="string"&&kt!==""||typeof kt=="number"||typeof kt=="bigint")return it=it.get(ft)||null,xe(Ke,it,""+kt,Zn);if(typeof kt=="object"&&kt!==null){switch(kt.$$typeof){case j:return it=it.get(kt.key===null?ft:kt.key)||null,We(Ke,it,kt,Zn);case Z:return it=it.get(kt.key===null?ft:kt.key)||null,mt(Ke,it,kt,Zn);case re:return kt=_(kt),Tt(it,Ke,ft,kt,Zn)}if(Ze(kt)||Y(kt))return it=it.get(ft)||null,Pt(Ke,it,kt,Zn,null);if(typeof kt.then=="function")return Tt(it,Ke,ft,D(kt),Zn);if(kt.$$typeof===ue)return Tt(it,Ke,ft,up(Ke,kt),Zn);V(Ke,kt)}return null}function Mn(it,Ke,ft,kt){for(var Zn=null,ii=null,jn=Ke,xr=Ke=0,Hr=null;jn!==null&&xr<ft.length;xr++){jn.index>xr?(Hr=jn,jn=null):Hr=jn.sibling;var di=gt(it,jn,ft[xr],kt);if(di===null){jn===null&&(jn=Hr);break}c&&jn&&di.alternate===null&&h(it,jn),Ke=z(di,Ke,xr),ii===null?Zn=di:ii.sibling=di,ii=di,jn=Hr}if(xr===ft.length)return y(it,jn),Or&&Il(it,xr),Zn;if(jn===null){for(;xr<ft.length;xr++)jn=Ft(it,ft[xr],kt),jn!==null&&(Ke=z(jn,Ke,xr),ii===null?Zn=jn:ii.sibling=jn,ii=jn);return Or&&Il(it,xr),Zn}for(jn=T(jn);xr<ft.length;xr++)Hr=Tt(jn,it,xr,ft[xr],kt),Hr!==null&&(c&&Hr.alternate!==null&&jn.delete(Hr.key===null?xr:Hr.key),Ke=z(Hr,Ke,xr),ii===null?Zn=Hr:ii.sibling=Hr,ii=Hr);return c&&jn.forEach(function(od){return h(it,od)}),Or&&Il(it,xr),Zn}function Yn(it,Ke,ft,kt){if(ft==null)throw Error(i(151));for(var Zn=null,ii=null,jn=Ke,xr=Ke=0,Hr=null,di=ft.next();jn!==null&&!di.done;xr++,di=ft.next()){jn.index>xr?(Hr=jn,jn=null):Hr=jn.sibling;var od=gt(it,jn,di.value,kt);if(od===null){jn===null&&(jn=Hr);break}c&&jn&&od.alternate===null&&h(it,jn),Ke=z(od,Ke,xr),ii===null?Zn=od:ii.sibling=od,ii=od,jn=Hr}if(di.done)return y(it,jn),Or&&Il(it,xr),Zn;if(jn===null){for(;!di.done;xr++,di=ft.next())di=Ft(it,di.value,kt),di!==null&&(Ke=z(di,Ke,xr),ii===null?Zn=di:ii.sibling=di,ii=di);return Or&&Il(it,xr),Zn}for(jn=T(jn);!di.done;xr++,di=ft.next())di=Tt(jn,it,xr,di.value,kt),di!==null&&(c&&di.alternate!==null&&jn.delete(di.key===null?xr:di.key),Ke=z(di,Ke,xr),ii===null?Zn=di:ii.sibling=di,ii=di);return c&&jn.forEach(function(jE){return h(it,jE)}),Or&&Il(it,xr),Zn}function wi(it,Ke,ft,kt){if(typeof ft=="object"&&ft!==null&&ft.type===K&&ft.key===null&&(ft=ft.props.children),typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case j:e:{for(var Zn=ft.key;Ke!==null;){if(Ke.key===Zn){if(Zn=ft.type,Zn===K){if(Ke.tag===7){y(it,Ke.sibling),kt=k(Ke,ft.props.children),kt.return=it,it=kt;break e}}else if(Ke.elementType===Zn||typeof Zn=="object"&&Zn!==null&&Zn.$$typeof===re&&_(Zn)===Ke.type){y(it,Ke.sibling),kt=k(Ke,ft.props),L(kt,ft),kt.return=it,it=kt;break e}y(it,Ke);break}else h(it,Ke);Ke=Ke.sibling}ft.type===K?(kt=nc(ft.props.children,it.mode,kt,ft.key),kt.return=it,it=kt):(kt=tc(ft.type,ft.key,ft.props,null,it.mode,kt),L(kt,ft),kt.return=it,it=kt)}return ee(it);case Z:e:{for(Zn=ft.key;Ke!==null;){if(Ke.key===Zn)if(Ke.tag===4&&Ke.stateNode.containerInfo===ft.containerInfo&&Ke.stateNode.implementation===ft.implementation){y(it,Ke.sibling),kt=k(Ke,ft.children||[]),kt.return=it,it=kt;break e}else{y(it,Ke);break}else h(it,Ke);Ke=Ke.sibling}kt=Dh(ft,it.mode,kt),kt.return=it,it=kt}return ee(it);case re:return ft=_(ft),wi(it,Ke,ft,kt)}if(Ze(ft))return Mn(it,Ke,ft,kt);if(Y(ft)){if(Zn=Y(ft),typeof Zn!="function")throw Error(i(150));return ft=Zn.call(ft),Yn(it,Ke,ft,kt)}if(typeof ft.then=="function")return wi(it,Ke,D(ft),kt);if(ft.$$typeof===ue)return wi(it,Ke,up(it,ft),kt);V(it,ft)}return typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint"?(ft=""+ft,Ke!==null&&Ke.tag===6?(y(it,Ke.sibling),kt=k(Ke,ft),kt.return=it,it=kt):(y(it,Ke),kt=zu(ft,it.mode,kt),kt.return=it,it=kt),ee(it)):y(it,Ke)}return function(it,Ke,ft,kt){try{A=0;var Zn=wi(it,Ke,ft,kt);return E=null,Zn}catch(jn){if(jn===zh||jn===Bh)throw jn;var ii=ds(29,jn,null,it.mode);return ii.lanes=kt,ii.return=it,ii}finally{}}}var q=G(!0),te=G(!1),ye=!1;function we(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Se(c,h){c=c.updateQueue,h.updateQueue===c&&(h.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,callbacks:null})}function Ee(c){return{lane:c,tag:0,payload:null,callback:null,next:null}}function Ce(c,h,y){var T=c.updateQueue;if(T===null)return null;if(T=T.shared,(xi&2)!==0){var k=T.pending;return k===null?h.next=h:(h.next=k.next,k.next=h),T.pending=h,h=ec(c),Wd(c,null,y),h}return Mr(c,T,h,y),ec(c)}function ne(c,h,y){if(h=h.updateQueue,h!==null&&(h=h.shared,(y&4194048)!==0)){var T=h.lanes;T&=c.pendingLanes,y|=T,h.lanes=y,jt(c,y)}}function be(c,h){var y=c.updateQueue,T=c.alternate;if(T!==null&&(T=T.updateQueue,y===T)){var k=null,z=null;if(y=y.firstBaseUpdate,y!==null){do{var ee={lane:y.lane,tag:y.tag,payload:y.payload,callback:null,next:null};z===null?k=z=ee:z=z.next=ee,y=y.next}while(y!==null);z===null?k=z=h:z=z.next=h}else k=z=h;y={baseState:T.baseState,firstBaseUpdate:k,lastBaseUpdate:z,shared:T.shared,callbacks:T.callbacks},c.updateQueue=y;return}c=y.lastBaseUpdate,c===null?y.firstBaseUpdate=h:c.next=h,y.lastBaseUpdate=h}var ke=!1;function Le(){if(ke){var c=ul;if(c!==null)throw c}}function je(c,h,y,T){ke=!1;var k=c.updateQueue;ye=!1;var z=k.firstBaseUpdate,ee=k.lastBaseUpdate,xe=k.shared.pending;if(xe!==null){k.shared.pending=null;var We=xe,mt=We.next;We.next=null,ee===null?z=mt:ee.next=mt,ee=We;var Pt=c.alternate;Pt!==null&&(Pt=Pt.updateQueue,xe=Pt.lastBaseUpdate,xe!==ee&&(xe===null?Pt.firstBaseUpdate=mt:xe.next=mt,Pt.lastBaseUpdate=We))}if(z!==null){var Ft=k.baseState;ee=0,Pt=mt=We=null,xe=z;do{var gt=xe.lane&-536870913,Tt=gt!==xe.lane;if(Tt?(Gr&gt)===gt:(T&gt)===gt){gt!==0&&gt===jc&&(ke=!0),Pt!==null&&(Pt=Pt.next={lane:0,tag:xe.tag,payload:xe.payload,callback:null,next:null});e:{var Mn=c,Yn=xe;gt=h;var wi=y;switch(Yn.tag){case 1:if(Mn=Yn.payload,typeof Mn=="function"){Ft=Mn.call(wi,Ft,gt);break e}Ft=Mn;break e;case 3:Mn.flags=Mn.flags&-65537|128;case 0:if(Mn=Yn.payload,gt=typeof Mn=="function"?Mn.call(wi,Ft,gt):Mn,gt==null)break e;Ft=O({},Ft,gt);break e;case 2:ye=!0}}gt=xe.callback,gt!==null&&(c.flags|=64,Tt&&(c.flags|=8192),Tt=k.callbacks,Tt===null?k.callbacks=[gt]:Tt.push(gt))}else Tt={lane:gt,tag:xe.tag,payload:xe.payload,callback:xe.callback,next:null},Pt===null?(mt=Pt=Tt,We=Ft):Pt=Pt.next=Tt,ee|=gt;if(xe=xe.next,xe===null){if(xe=k.shared.pending,xe===null)break;Tt=xe,xe=Tt.next,Tt.next=null,k.lastBaseUpdate=Tt,k.shared.pending=null}}while(!0);Pt===null&&(We=Ft),k.baseState=We,k.firstBaseUpdate=mt,k.lastBaseUpdate=Pt,z===null&&(k.shared.lanes=0),Kc|=ee,c.lanes=ee,c.memoizedState=Ft}}function He(c,h){if(typeof c!="function")throw Error(i(191,c));c.call(h)}function qe(c,h){var y=c.callbacks;if(y!==null)for(c.callbacks=null,c=0;c<y.length;c++)He(y[c],h)}var Qe=De(null),Ye=De(0);function lt(c,h){c=vs,Et(Ye,c),Et(Qe,h),vs=c|h.baseLanes}function Vt(){Et(Ye,vs),Et(Qe,Qe.current)}function rt(){vs=Ye.current,tt(Qe),tt(Ye)}var _t=De(null),at=null;function Ot(c){var h=c.alternate;Et(It,It.current&1),Et(_t,c),at===null&&(h===null||Qe.current!==null||h.memoizedState!==null)&&(at=c)}function st(c){Et(It,It.current),Et(_t,c),at===null&&(at=c)}function St(c){c.tag===22?(Et(It,It.current),Et(_t,c),at===null&&(at=c)):zt()}function zt(){Et(It,It.current),Et(_t,_t.current)}function Ct(c){tt(_t),at===c&&(at=null),tt(It)}var It=De(0);function Sn(c){for(var h=c;h!==null;){if(h.tag===13){var y=h.memoizedState;if(y!==null&&(y=y.dehydrated,y===null||d0(y)||f0(y)))return h}else if(h.tag===19&&(h.memoizedProps.revealOrder==="forwards"||h.memoizedProps.revealOrder==="backwards"||h.memoizedProps.revealOrder==="unstable_legacy-backwards"||h.memoizedProps.revealOrder==="together")){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var Un=0,Bt=null,hn=null,Fn=null,ar=!1,Tn=!1,Pr=!1,Kr=0,qr=0,Vr=null,so=0;function kr(){throw Error(i(321))}function Zo(c,h){if(h===null)return!1;for(var y=0;y<h.length&&y<c.length;y++)if(!ca(c[y],h[y]))return!1;return!0}function Na(c,h,y,T,k,z){return Un=z,Bt=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,Ie.H=c===null||c.memoizedState===null?dy:fy,Pr=!1,z=y(T,k),Pr=!1,Tn&&(z=li(h,y,T,k)),Mi(c),z}function Mi(c){Ie.H=fl;var h=hn!==null&&hn.next!==null;if(Un=0,Fn=hn=Bt=null,ar=!1,qr=0,Vr=null,h)throw Error(i(300));c===null||Ss||(c=c.dependencies,c!==null&&cp(c)&&(Ss=!0))}function li(c,h,y,T){Bt=c;var k=0;do{if(Tn&&(Vr=null),qr=0,Tn=!1,25<=k)throw Error(i(301));if(k+=1,Fn=hn=null,c.updateQueue!=null){var z=c.updateQueue;z.lastEffect=null,z.events=null,z.stores=null,z.memoCache!=null&&(z.memoCache.index=0)}Ie.H=mp,z=h(y,T)}while(Tn);return z}function Fr(){var c=Ie.H,h=c.useState()[0];return h=typeof h.then=="function"?lc(h):h,c=c.useState()[0],(hn!==null?hn.memoizedState:null)!==c&&(Bt.flags|=1024),h}function ss(){var c=Kr!==0;return Kr=0,c}function Hs(c,h,y){h.updateQueue=c.updateQueue,h.flags&=-2053,c.lanes&=~y}function vi(c){if(ar){for(c=c.memoizedState;c!==null;){var h=c.queue;h!==null&&(h.pending=null),c=c.next}ar=!1}Un=0,Fn=hn=Bt=null,Tn=!1,qr=Kr=0,Vr=null}function Ei(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fn===null?Bt.memoizedState=Fn=c:Fn=Fn.next=c,Fn}function Ji(){if(hn===null){var c=Bt.alternate;c=c!==null?c.memoizedState:null}else c=hn.next;var h=Fn===null?Bt.memoizedState:Fn.next;if(h!==null)Fn=h,hn=c;else{if(c===null)throw Bt.alternate===null?Error(i(467)):Error(i(310));hn=c,c={memoizedState:hn.memoizedState,baseState:hn.baseState,baseQueue:hn.baseQueue,queue:hn.queue,next:null},Fn===null?Bt.memoizedState=Fn=c:Fn=Fn.next=c}return Fn}function Ml(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function lc(c){var h=qr;return qr+=1,Vr===null&&(Vr=[]),c=Fu(Vr,c,h),h=Bt,(Fn===null?h.memoizedState:Fn.next)===null&&(h=h.alternate,Ie.H=h===null||h.memoizedState===null?dy:fy),c}function Va(c){if(c!==null&&typeof c=="object"){if(typeof c.then=="function")return lc(c);if(c.$$typeof===ue)return Gs(c)}throw Error(i(438,String(c)))}function Pl(c){var h=null,y=Bt.updateQueue;if(y!==null&&(h=y.memoCache),h==null){var T=Bt.alternate;T!==null&&(T=T.updateQueue,T!==null&&(T=T.memoCache,T!=null&&(h={data:T.data.map(function(k){return k.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),y===null&&(y=Ml(),Bt.updateQueue=y),y.memoCache=h,y=h.data[h.index],y===void 0)for(y=h.data[h.index]=Array(c),T=0;T<c;T++)y[T]=se;return h.index++,y}function Mo(c,h){return typeof h=="function"?h(c):h}function Uu(c){var h=Ji();return ju(h,hn,c)}function ju(c,h,y){var T=c.queue;if(T===null)throw Error(i(311));T.lastRenderedReducer=y;var k=c.baseQueue,z=T.pending;if(z!==null){if(k!==null){var ee=k.next;k.next=z.next,z.next=ee}h.baseQueue=k=z,T.pending=null}if(z=c.baseState,k===null)c.memoizedState=z;else{h=k.next;var xe=ee=null,We=null,mt=h,Pt=!1;do{var Ft=mt.lane&-536870913;if(Ft!==mt.lane?(Gr&Ft)===Ft:(Un&Ft)===Ft){var gt=mt.revertLane;if(gt===0)We!==null&&(We=We.next={lane:0,revertLane:0,gesture:null,action:mt.action,hasEagerState:mt.hasEagerState,eagerState:mt.eagerState,next:null}),Ft===jc&&(Pt=!0);else if((Un&gt)===gt){mt=mt.next,gt===jc&&(Pt=!0);continue}else Ft={lane:0,revertLane:mt.revertLane,gesture:null,action:mt.action,hasEagerState:mt.hasEagerState,eagerState:mt.eagerState,next:null},We===null?(xe=We=Ft,ee=z):We=We.next=Ft,Bt.lanes|=gt,Kc|=gt;Ft=mt.action,Pr&&y(z,Ft),z=mt.hasEagerState?mt.eagerState:y(z,Ft)}else gt={lane:Ft,revertLane:mt.revertLane,gesture:mt.gesture,action:mt.action,hasEagerState:mt.hasEagerState,eagerState:mt.eagerState,next:null},We===null?(xe=We=gt,ee=z):We=We.next=gt,Bt.lanes|=Ft,Kc|=Ft;mt=mt.next}while(mt!==null&&mt!==h);if(We===null?ee=z:We.next=xe,!ca(z,c.memoizedState)&&(Ss=!0,Pt&&(y=ul,y!==null)))throw y;c.memoizedState=z,c.baseState=ee,c.baseQueue=We,T.lastRenderedState=z}return k===null&&(T.lanes=0),[c.memoizedState,T.dispatch]}function ef(c){var h=Ji(),y=h.queue;if(y===null)throw Error(i(311));y.lastRenderedReducer=c;var T=y.dispatch,k=y.pending,z=h.memoizedState;if(k!==null){y.pending=null;var ee=k=k.next;do z=c(z,ee.action),ee=ee.next;while(ee!==k);ca(z,h.memoizedState)||(Ss=!0),h.memoizedState=z,h.baseQueue===null&&(h.baseState=z),y.lastRenderedState=z}return[z,T]}function pv(c,h,y){var T=Bt,k=Ji(),z=Or;if(z){if(y===void 0)throw Error(i(407));y=y()}else y=h();var ee=!ca((hn||k).memoizedState,y);if(ee&&(k.memoizedState=y,Ss=!0),k=k.queue,xv(oy.bind(null,T,k,c),[c]),k.getSnapshot!==h||ee||Fn!==null&&Fn.memoizedState.tag&1){if(T.flags|=2048,hl(9,{destroy:void 0},Ab.bind(null,T,k,y,h),null),Fi===null)throw Error(i(349));z||(Un&127)!==0||mv(T,h,y)}return y}function mv(c,h,y){c.flags|=16384,c={getSnapshot:h,value:y},h=Bt.updateQueue,h===null?(h=Ml(),Bt.updateQueue=h,h.stores=[c]):(y=h.stores,y===null?h.stores=[c]:y.push(c))}function Ab(c,h,y,T){h.value=y,h.getSnapshot=T,Nm(h)&&gv(c)}function oy(c,h,y){return y(function(){Nm(h)&&gv(c)})}function Nm(c){var h=c.getSnapshot;c=c.value;try{var y=h();return!ca(c,y)}catch{return!0}}function gv(c){var h=zc(c,2);h!==null&&Lo(h,c,2)}function Vm(c){var h=Ei();if(typeof c=="function"){var y=c;if(c=y(),Pr){xn(!0);try{y()}finally{xn(!1)}}}return h.memoizedState=h.baseState=c,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mo,lastRenderedState:c},h}function Fm(c,h,y,T){return c.baseState=y,ju(c,hn,typeof T=="function"?T:Mo)}function $u(c,h,y,T,k){if(qm(c))throw Error(i(485));if(c=h.action,c!==null){var z={payload:k,action:c,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ee){z.listeners.push(ee)}};Ie.T!==null?y(!0):z.isTransition=!1,T(z),y=h.pending,y===null?(z.next=h.pending=z,Um(h,z)):(z.next=y.next,h.pending=y.next=z)}}function Um(c,h){var y=h.action,T=h.payload,k=c.state;if(h.isTransition){var z=Ie.T,ee={};Ie.T=ee;try{var xe=y(k,T),We=Ie.S;We!==null&&We(ee,xe),yv(c,h,xe)}catch(mt){vv(c,h,mt)}finally{z!==null&&ee.types!==null&&(z.types=ee.types),Ie.T=z}}else try{z=y(k,T),yv(c,h,z)}catch(mt){vv(c,h,mt)}}function yv(c,h,y){y!==null&&typeof y=="object"&&typeof y.then=="function"?y.then(function(T){_v(c,h,T)},function(T){return vv(c,h,T)}):_v(c,h,y)}function _v(c,h,y){h.status="fulfilled",h.value=y,Ib(h),c.state=y,h=c.pending,h!==null&&(y=h.next,y===h?c.pending=null:(y=y.next,h.next=y,Um(c,y)))}function vv(c,h,y){var T=c.pending;if(c.pending=null,T!==null){T=T.next;do h.status="rejected",h.reason=y,Ib(h),h=h.next;while(h!==T)}c.action=null}function Ib(c){c=c.listeners;for(var h=0;h<c.length;h++)(0,c[h])()}function Rb(c,h){return h}function ay(c,h){if(Or){var y=Fi.formState;if(y!==null){e:{var T=Bt;if(Or){if(hi){t:{for(var k=hi,z=Xo;k.nodeType!==8;){if(!z){k=null;break t}if(k=zl(k.nextSibling),k===null){k=null;break t}}z=k.data,k=z==="F!"||z==="F"?k:null}if(k){hi=zl(k.nextSibling),T=k.data==="F!";break e}}za(T)}T=!1}T&&(h=y[0])}}return y=Ei(),y.memoizedState=y.baseState=h,T={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rb,lastRenderedState:h},y.queue=T,y=Ev.bind(null,Bt,T),T.dispatch=y,T=Vm(!1),z=$m.bind(null,Bt,!1,T.queue),T=Ei(),k={state:h,dispatch:null,action:c,pending:null},T.queue=k,y=$u.bind(null,Bt,k,z,y),k.dispatch=y,T.memoizedState=c,[h,y,!1]}function dp(c){var h=Ji();return tf(h,hn,c)}function tf(c,h,y){if(h=ju(c,h,Rb)[0],c=Uu(Mo)[0],typeof h=="object"&&h!==null&&typeof h.then=="function")try{var T=lc(h)}catch(ee){throw ee===zh?Bh:ee}else T=h;h=Ji();var k=h.queue,z=k.dispatch;return y!==h.memoizedState&&(Bt.flags|=2048,hl(9,{destroy:void 0},qu.bind(null,k,y),null)),[T,z,c]}function qu(c,h){c.action=h}function kl(c){var h=Ji(),y=hn;if(y!==null)return tf(h,y,c);Ji(),h=h.memoizedState,y=Ji();var T=y.queue.dispatch;return y.memoizedState=c,[h,T,!1]}function hl(c,h,y,T){return c={tag:c,create:y,deps:T,inst:h,next:null},h=Bt.updateQueue,h===null&&(h=Ml(),Bt.updateQueue=h),y=h.lastEffect,y===null?h.lastEffect=c.next=c:(T=y.next,y.next=c,c.next=T,h.lastEffect=c),c}function Gu(){return Ji().memoizedState}function qc(c,h,y,T){var k=Ei();Bt.flags|=c,k.memoizedState=hl(1|h,{destroy:void 0},y,T===void 0?null:T)}function ly(c,h,y,T){var k=Ji();T=T===void 0?null:T;var z=k.memoizedState.inst;hn!==null&&T!==null&&Zo(T,hn.memoizedState.deps)?k.memoizedState=hl(h,z,y,T):(Bt.flags|=c,k.memoizedState=hl(1|h,z,y,T))}function Mb(c,h){qc(8390656,8,c,h)}function xv(c,h){ly(2048,8,c,h)}function ME(c){Bt.flags|=4;var h=Bt.updateQueue;if(h===null)h=Ml(),Bt.updateQueue=h,h.events=[c];else{var y=h.events;y===null?h.events=[c]:y.push(c)}}function bv(c){var h=Ji().memoizedState;return ME({ref:h,nextImpl:c}),function(){if((xi&2)!==0)throw Error(i(440));return h.impl.apply(void 0,arguments)}}function wv(c,h){return ly(4,2,c,h)}function Dl(c,h){return ly(4,4,c,h)}function Pb(c,h){if(typeof h=="function"){c=c();var y=h(c);return function(){typeof y=="function"?y():h(null)}}if(h!=null)return c=c(),h.current=c,function(){h.current=null}}function kb(c,h,y){y=y!=null?y.concat([c]):null,ly(4,4,Pb.bind(null,h,c),y)}function os(){}function Dn(c,h){var y=Ji();h=h===void 0?null:h;var T=y.memoizedState;return h!==null&&Zo(h,T[1])?T[0]:(y.memoizedState=[c,h],c)}function Hu(c,h){var y=Ji();h=h===void 0?null:h;var T=y.memoizedState;if(h!==null&&Zo(h,T[1]))return T[0];if(T=c(),Pr){xn(!0);try{c()}finally{xn(!1)}}return y.memoizedState=[T,h],T}function fp(c,h,y){return y===void 0||(Un&1073741824)!==0&&(Gr&261930)===0?c.memoizedState=h:(c.memoizedState=y,c=Xm(),Bt.lanes|=c,Kc|=c,y)}function da(c,h,y,T){return ca(y,h)?y:Qe.current!==null?(c=fp(c,y,T),ca(c,h)||(Ss=!0),c):(Un&42)===0||(Un&1073741824)!==0&&(Gr&261930)===0?(Ss=!0,c.memoizedState=y):(c=Xm(),Bt.lanes|=c,Kc|=c,h)}function Tv(c,h,y,T,k){var z=Je.p;Je.p=z!==0&&8>z?z:8;var ee=Ie.T,xe={};Ie.T=xe,$m(c,!1,h,y);try{var We=k(),mt=Ie.S;if(mt!==null&&mt(xe,We),We!==null&&typeof We=="object"&&typeof We.then=="function"){var Pt=Om(We,T);jm(c,h,Pt,$a(c))}else jm(c,h,T,$a(c))}catch(Ft){jm(c,h,{then:function(){},status:"rejected",reason:Ft},$a())}finally{Je.p=z,ee!==null&&xe.types!==null&&(ee.types=xe.types),Ie.T=ee}}function Db(){}function dl(c,h,y,T){if(c.tag!==5)throw Error(i(476));var k=cy(c).queue;Tv(c,k,h,dt,y===null?Db:function(){return Vh(c),y(T)})}function cy(c){var h=c.memoizedState;if(h!==null)return h;h={memoizedState:dt,baseState:dt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mo,lastRenderedState:dt},next:null};var y={};return h.next={memoizedState:y,baseState:y,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mo,lastRenderedState:y},next:null},c.memoizedState=h,c=c.alternate,c!==null&&(c.memoizedState=h),h}function Vh(c){var h=cy(c);h.next===null&&(h=c.alternate.memoizedState),jm(c,h.next.queue,{},$a())}function nf(){return Gs(zp)}function Fh(){return Ji().memoizedState}function uy(){return Ji().memoizedState}function hy(c){for(var h=c.return;h!==null;){switch(h.tag){case 24:case 3:var y=$a();c=Ee(y);var T=Ce(h,c,y);T!==null&&(Lo(T,h,y),ne(T,h,y)),h={cache:ac()},c.payload=h;return}h=h.return}}function Lb(c,h,y){var T=$a();y={lane:T,revertLane:0,gesture:null,action:y,hasEagerState:!1,eagerState:null,next:null},qm(c)?pp(h,y):(y=Du(c,h,y,T),y!==null&&(Lo(y,c,T),rf(y,h,T)))}function Ev(c,h,y){var T=$a();jm(c,h,y,T)}function jm(c,h,y,T){var k={lane:T,revertLane:0,gesture:null,action:y,hasEagerState:!1,eagerState:null,next:null};if(qm(c))pp(h,k);else{var z=c.alternate;if(c.lanes===0&&(z===null||z.lanes===0)&&(z=h.lastRenderedReducer,z!==null))try{var ee=h.lastRenderedState,xe=z(ee,y);if(k.hasEagerState=!0,k.eagerState=xe,ca(xe,ee))return Mr(c,h,k,0),Fi===null&&ku(),!1}catch{}finally{}if(y=Du(c,h,k,T),y!==null)return Lo(y,c,T),rf(y,h,T),!0}return!1}function $m(c,h,y,T){if(T={lane:2,revertLane:Oy(),gesture:null,action:T,hasEagerState:!1,eagerState:null,next:null},qm(c)){if(h)throw Error(i(479))}else h=Du(c,y,T,2),h!==null&&Lo(h,c,2)}function qm(c){var h=c.alternate;return c===Bt||h!==null&&h===Bt}function pp(c,h){Tn=ar=!0;var y=c.pending;y===null?h.next=h:(h.next=y.next,y.next=h),c.pending=h}function rf(c,h,y){if((y&4194048)!==0){var T=h.lanes;T&=c.pendingLanes,y|=T,h.lanes=y,jt(c,y)}}var fl={readContext:Gs,use:Va,useCallback:kr,useContext:kr,useEffect:kr,useImperativeHandle:kr,useLayoutEffect:kr,useInsertionEffect:kr,useMemo:kr,useReducer:kr,useRef:kr,useState:kr,useDebugValue:kr,useDeferredValue:kr,useTransition:kr,useSyncExternalStore:kr,useId:kr,useHostTransitionStatus:kr,useFormState:kr,useActionState:kr,useOptimistic:kr,useMemoCache:kr,useCacheRefresh:kr};fl.useEffectEvent=kr;var dy={readContext:Gs,use:Va,useCallback:function(c,h){return Ei().memoizedState=[c,h===void 0?null:h],c},useContext:Gs,useEffect:Mb,useImperativeHandle:function(c,h,y){y=y!=null?y.concat([c]):null,qc(4194308,4,Pb.bind(null,h,c),y)},useLayoutEffect:function(c,h){return qc(4194308,4,c,h)},useInsertionEffect:function(c,h){qc(4,2,c,h)},useMemo:function(c,h){var y=Ei();h=h===void 0?null:h;var T=c();if(Pr){xn(!0);try{c()}finally{xn(!1)}}return y.memoizedState=[T,h],T},useReducer:function(c,h,y){var T=Ei();if(y!==void 0){var k=y(h);if(Pr){xn(!0);try{y(h)}finally{xn(!1)}}}else k=h;return T.memoizedState=T.baseState=k,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:k},T.queue=c,c=c.dispatch=Lb.bind(null,Bt,c),[T.memoizedState,c]},useRef:function(c){var h=Ei();return c={current:c},h.memoizedState=c},useState:function(c){c=Vm(c);var h=c.queue,y=Ev.bind(null,Bt,h);return h.dispatch=y,[c.memoizedState,y]},useDebugValue:os,useDeferredValue:function(c,h){var y=Ei();return fp(y,c,h)},useTransition:function(){var c=Vm(!1);return c=Tv.bind(null,Bt,c.queue,!0,!1),Ei().memoizedState=c,[!1,c]},useSyncExternalStore:function(c,h,y){var T=Bt,k=Ei();if(Or){if(y===void 0)throw Error(i(407));y=y()}else{if(y=h(),Fi===null)throw Error(i(349));(Gr&127)!==0||mv(T,h,y)}k.memoizedState=y;var z={value:y,getSnapshot:h};return k.queue=z,Mb(oy.bind(null,T,z,c),[c]),T.flags|=2048,hl(9,{destroy:void 0},Ab.bind(null,T,z,y,h),null),y},useId:function(){var c=Ei(),h=Fi.identifierPrefix;if(Or){var y=ua,T=Oa;y=(T&~(1<<32-$n(T)-1)).toString(32)+y,h="_"+h+"R_"+y,y=Kr++,0<y&&(h+="H"+y.toString(32)),h+="_"}else y=so++,h="_"+h+"r_"+y.toString(32)+"_";return c.memoizedState=h},useHostTransitionStatus:nf,useFormState:ay,useActionState:ay,useOptimistic:function(c){var h=Ei();h.memoizedState=h.baseState=c;var y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=y,h=$m.bind(null,Bt,!0,y),y.dispatch=h,[c,h]},useMemoCache:Pl,useCacheRefresh:function(){return Ei().memoizedState=hy.bind(null,Bt)},useEffectEvent:function(c){var h=Ei(),y={impl:c};return h.memoizedState=y,function(){if((xi&2)!==0)throw Error(i(440));return y.impl.apply(void 0,arguments)}}},fy={readContext:Gs,use:Va,useCallback:Dn,useContext:Gs,useEffect:xv,useImperativeHandle:kb,useInsertionEffect:wv,useLayoutEffect:Dl,useMemo:Hu,useReducer:Uu,useRef:Gu,useState:function(){return Uu(Mo)},useDebugValue:os,useDeferredValue:function(c,h){var y=Ji();return da(y,hn.memoizedState,c,h)},useTransition:function(){var c=Uu(Mo)[0],h=Ji().memoizedState;return[typeof c=="boolean"?c:lc(c),h]},useSyncExternalStore:pv,useId:Fh,useHostTransitionStatus:nf,useFormState:dp,useActionState:dp,useOptimistic:function(c,h){var y=Ji();return Fm(y,hn,c,h)},useMemoCache:Pl,useCacheRefresh:uy};fy.useEffectEvent=bv;var mp={readContext:Gs,use:Va,useCallback:Dn,useContext:Gs,useEffect:xv,useImperativeHandle:kb,useInsertionEffect:wv,useLayoutEffect:Dl,useMemo:Hu,useReducer:ef,useRef:Gu,useState:function(){return ef(Mo)},useDebugValue:os,useDeferredValue:function(c,h){var y=Ji();return hn===null?fp(y,c,h):da(y,hn.memoizedState,c,h)},useTransition:function(){var c=ef(Mo)[0],h=Ji().memoizedState;return[typeof c=="boolean"?c:lc(c),h]},useSyncExternalStore:pv,useId:Fh,useHostTransitionStatus:nf,useFormState:kl,useActionState:kl,useOptimistic:function(c,h){var y=Ji();return hn!==null?Fm(y,hn,c,h):(y.baseState=c,[c,y.queue.dispatch])},useMemoCache:Pl,useCacheRefresh:uy};mp.useEffectEvent=bv;function sf(c,h,y,T){h=c.memoizedState,y=y(T,h),y=y==null?h:O({},h,y),c.memoizedState=y,c.lanes===0&&(c.updateQueue.baseState=y)}var fa={enqueueSetState:function(c,h,y){c=c._reactInternals;var T=$a(),k=Ee(T);k.payload=h,y!=null&&(k.callback=y),h=Ce(c,k,T),h!==null&&(Lo(h,c,T),ne(h,c,T))},enqueueReplaceState:function(c,h,y){c=c._reactInternals;var T=$a(),k=Ee(T);k.tag=1,k.payload=h,y!=null&&(k.callback=y),h=Ce(c,k,T),h!==null&&(Lo(h,c,T),ne(h,c,T))},enqueueForceUpdate:function(c,h){c=c._reactInternals;var y=$a(),T=Ee(y);T.tag=2,h!=null&&(T.callback=h),h=Ce(c,T,y),h!==null&&(Lo(h,c,y),ne(h,c,y))}};function gp(c,h,y,T,k,z,ee){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(T,z,ee):h.prototype&&h.prototype.isPureReactComponent?!Iu(y,T)||!Iu(k,z):!0}function Po(c,h,y,T){c=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(y,T),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(y,T),h.state!==c&&fa.enqueueReplaceState(h,h.state,null)}function oo(c,h){var y=h;if("ref"in h){y={};for(var T in h)T!=="ref"&&(y[T]=h[T])}if(c=c.defaultProps){y===h&&(y=O({},y));for(var k in c)y[k]===void 0&&(y[k]=c[k])}return y}function py(c){Hd(c)}function as(c){console.error(c)}function Sv(c){Hd(c)}function Uh(c,h){try{var y=c.onUncaughtError;y(h.value,{componentStack:h.stack})}catch(T){setTimeout(function(){throw T})}}function Ll(c,h,y){try{var T=c.onCaughtError;T(y.value,{componentStack:y.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(k){setTimeout(function(){throw k})}}function Cv(c,h,y){return y=Ee(y),y.tag=3,y.payload={element:null},y.callback=function(){Uh(c,h)},y}function Ob(c){return c=Ee(c),c.tag=3,c}function Av(c,h,y,T){var k=y.type.getDerivedStateFromError;if(typeof k=="function"){var z=T.value;c.payload=function(){return k(z)},c.callback=function(){Ll(h,y,T)}}var ee=y.stateNode;ee!==null&&typeof ee.componentDidCatch=="function"&&(c.callback=function(){Ll(h,y,T),typeof k!="function"&&(Xh===null?Xh=new Set([this]):Xh.add(this));var xe=T.stack;this.componentDidCatch(T.value,{componentStack:xe!==null?xe:""})})}function zb(c,h,y,T,k){if(y.flags|=32768,T!==null&&typeof T=="object"&&typeof T.then=="function"){if(h=y.alternate,h!==null&&fs(h,y,k,!0),y=_t.current,y!==null){switch(y.tag){case 31:case 13:return at===null?Rp():y.alternate===null&&xs===0&&(xs=3),y.flags&=-257,y.flags|=65536,y.lanes=k,T===Nh?y.flags|=16384:(h=y.updateQueue,h===null?y.updateQueue=new Set([T]):h.add(T),Dy(c,T,k)),!1;case 22:return y.flags|=65536,T===Nh?y.flags|=16384:(h=y.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([T])},y.updateQueue=h):(y=h.retryQueue,y===null?h.retryQueue=new Set([T]):y.add(T)),Dy(c,T,k)),!1}throw Error(i(435,y.tag))}return Dy(c,T,k),Rp(),!1}if(Or)return h=_t.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=k,T!==Lh&&(c=Error(i(422),{cause:T}),Ba(rn(c,y)))):(T!==Lh&&(h=Error(i(423),{cause:T}),Ba(rn(h,y))),c=c.current.alternate,c.flags|=65536,k&=-k,c.lanes|=k,T=rn(T,y),k=Cv(c.stateNode,T,k),be(c,k),xs!==4&&(xs=2)),!1;var z=Error(i(520),{cause:T});if(z=rn(z,y),Hh===null?Hh=[z]:Hh.push(z),xs!==4&&(xs=2),h===null)return!0;T=rn(T,y),y=h;do{switch(y.tag){case 3:return y.flags|=65536,c=k&-k,y.lanes|=c,c=Cv(y.stateNode,T,c),be(y,c),!1;case 1:if(h=y.type,z=y.stateNode,(y.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(Xh===null||!Xh.has(z))))return y.flags|=65536,k&=-k,y.lanes|=k,k=Ob(k),Av(k,c,y,T),be(y,k),!1}y=y.return}while(y!==null);return!1}var Wu=Error(i(461)),Ss=!1;function ao(c,h,y,T){h.child=c===null?te(h,null,y,T):q(h,c.child,y,T)}function Iv(c,h,y,T,k){y=y.render;var z=h.ref;if("ref"in T){var ee={};for(var xe in T)xe!=="ref"&&(ee[xe]=T[xe])}else ee=T;return Fc(h),T=Na(c,h,y,ee,z,k),xe=ss(),c!==null&&!Ss?(Hs(c,h,k),co(c,h,k)):(Or&&xe&&Nc(h),h.flags|=1,ao(c,h,T,k),h.child)}function Rv(c,h,y,T,k){if(c===null){var z=y.type;return typeof z=="function"&&!rp(z)&&z.defaultProps===void 0&&y.compare===null?(h.tag=15,h.type=z,Bb(c,h,z,T,k)):(c=tc(y.type,null,T,h,h.mode,k),c.ref=h.ref,c.return=h,h.child=c)}if(z=c.child,!Zu(c,k)){var ee=z.memoizedProps;if(y=y.compare,y=y!==null?y:Iu,y(ee,T)&&c.ref===h.ref)return co(c,h,k)}return h.flags|=1,c=La(z,T),c.ref=h.ref,c.return=h,h.child=c}function Bb(c,h,y,T,k){if(c!==null){var z=c.memoizedProps;if(Iu(z,T)&&c.ref===h.ref)if(Ss=!1,h.pendingProps=T=z,Zu(c,k))(c.flags&131072)!==0&&(Ss=!0);else return h.lanes=c.lanes,co(c,h,k)}return lo(c,h,y,T,k)}function Nb(c,h,y,T){var k=T.children,z=c!==null?c.memoizedState:null;if(c===null&&h.stateNode===null&&(h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),T.mode==="hidden"){if((h.flags&128)!==0){if(z=z!==null?z.baseLanes|y:y,c!==null){for(T=h.child=c.child,k=0;T!==null;)k=k|T.lanes|T.childLanes,T=T.sibling;T=k&~z}else T=0,h.child=null;return Mv(c,h,z,y,T)}if((y&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},c!==null&&Jd(h,z!==null?z.cachePool:null),z!==null?lt(h,z):Vt(),St(h);else return T=h.lanes=536870912,Mv(c,h,z!==null?z.baseLanes|y:y,y,T)}else z!==null?(Jd(h,z.cachePool),lt(h,z),zt(),h.memoizedState=null):(c!==null&&Jd(h,null),Vt(),zt());return ao(c,h,k,y),h.child}function yp(c,h){return c!==null&&c.tag===22||h.stateNode!==null||(h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.sibling}function Mv(c,h,y,T,k){var z=Qd();return z=z===null?null:{parent:_i._currentValue,pool:z},h.memoizedState={baseLanes:y,cachePool:z},c!==null&&Jd(h,null),Vt(),St(h),c!==null&&fs(c,h,T,!0),h.childLanes=k,null}function jh(c,h){return h=yy({mode:h.mode,children:h.children},c.mode),h.ref=c.ref,c.child=h,h.return=c,h}function my(c,h,y){return q(h,c.child,null,y),c=jh(h,h.pendingProps),c.flags|=2,Ct(h),h.memoizedState=null,c}function Pv(c,h,y){var T=h.pendingProps,k=(h.flags&128)!==0;if(h.flags&=-129,c===null){if(Or){if(T.mode==="hidden")return c=jh(h,T),h.lanes=536870912,yp(null,c);if(st(h),(c=hi)?(c=T1(c,Xo),c=c!==null&&c.data==="&"?c:null,c!==null&&(h.memoizedState={dehydrated:c,treeContext:al!==null?{id:Oa,overflow:ua}:null,retryLane:536870912,hydrationErrors:null},y=kh(c),y.return=h,h.child=y,Os=h,hi=null)):c=null,c===null)throw za(h);return h.lanes=536870912,null}return jh(h,T)}var z=c.memoizedState;if(z!==null){var ee=z.dehydrated;if(st(h),k)if(h.flags&256)h.flags&=-257,h=my(c,h,y);else if(h.memoizedState!==null)h.child=c.child,h.flags|=128,h=null;else throw Error(i(558));else if(Ss||fs(c,h,y,!1),k=(y&c.childLanes)!==0,Ss||k){if(T=Fi,T!==null&&(ee=Kn(T,y),ee!==0&&ee!==z.retryLane))throw z.retryLane=ee,zc(c,ee),Lo(T,c,ee),Wu;Rp(),h=my(c,h,y)}else c=z.treeContext,hi=zl(ee.nextSibling),Os=h,Or=!0,Rl=null,Xo=!1,c!==null&&ry(h,c),h=jh(h,T),h.flags|=4096;return h}return c=La(c.child,{mode:T.mode,children:T.children}),c.ref=h.ref,h.child=c,c.return=h,c}function _p(c,h){var y=h.ref;if(y===null)c!==null&&c.ref!==null&&(h.flags|=4194816);else{if(typeof y!="function"&&typeof y!="object")throw Error(i(284));(c===null||c.ref!==y)&&(h.flags|=4194816)}}function lo(c,h,y,T,k){return Fc(h),y=Na(c,h,y,T,void 0,k),T=ss(),c!==null&&!Ss?(Hs(c,h,k),co(c,h,k)):(Or&&T&&Nc(h),h.flags|=1,ao(c,h,y,k),h.child)}function gy(c,h,y,T,k,z){return Fc(h),h.updateQueue=null,y=li(h,T,y,k),Mi(c),T=ss(),c!==null&&!Ss?(Hs(c,h,z),co(c,h,z)):(Or&&T&&Nc(h),h.flags|=1,ao(c,h,y,z),h.child)}function kv(c,h,y,T,k){if(Fc(h),h.stateNode===null){var z=Lu,ee=y.contextType;typeof ee=="object"&&ee!==null&&(z=Gs(ee)),z=new y(T,z),h.memoizedState=z.state!==null&&z.state!==void 0?z.state:null,z.updater=fa,h.stateNode=z,z._reactInternals=h,z=h.stateNode,z.props=T,z.state=h.memoizedState,z.refs={},we(h),ee=y.contextType,z.context=typeof ee=="object"&&ee!==null?Gs(ee):Lu,z.state=h.memoizedState,ee=y.getDerivedStateFromProps,typeof ee=="function"&&(sf(h,y,ee,T),z.state=h.memoizedState),typeof y.getDerivedStateFromProps=="function"||typeof z.getSnapshotBeforeUpdate=="function"||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(ee=z.state,typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount(),ee!==z.state&&fa.enqueueReplaceState(z,z.state,null),je(h,T,z,k),Le(),z.state=h.memoizedState),typeof z.componentDidMount=="function"&&(h.flags|=4194308),T=!0}else if(c===null){z=h.stateNode;var xe=h.memoizedProps,We=oo(y,xe);z.props=We;var mt=z.context,Pt=y.contextType;ee=Lu,typeof Pt=="object"&&Pt!==null&&(ee=Gs(Pt));var Ft=y.getDerivedStateFromProps;Pt=typeof Ft=="function"||typeof z.getSnapshotBeforeUpdate=="function",xe=h.pendingProps!==xe,Pt||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(xe||mt!==ee)&&Po(h,z,T,ee),ye=!1;var gt=h.memoizedState;z.state=gt,je(h,T,z,k),Le(),mt=h.memoizedState,xe||gt!==mt||ye?(typeof Ft=="function"&&(sf(h,y,Ft,T),mt=h.memoizedState),(We=ye||gp(h,y,We,T,gt,mt,ee))?(Pt||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(h.flags|=4194308)):(typeof z.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=T,h.memoizedState=mt),z.props=T,z.state=mt,z.context=ee,T=We):(typeof z.componentDidMount=="function"&&(h.flags|=4194308),T=!1)}else{z=h.stateNode,Se(c,h),ee=h.memoizedProps,Pt=oo(y,ee),z.props=Pt,Ft=h.pendingProps,gt=z.context,mt=y.contextType,We=Lu,typeof mt=="object"&&mt!==null&&(We=Gs(mt)),xe=y.getDerivedStateFromProps,(mt=typeof xe=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(ee!==Ft||gt!==We)&&Po(h,z,T,We),ye=!1,gt=h.memoizedState,z.state=gt,je(h,T,z,k),Le();var Tt=h.memoizedState;ee!==Ft||gt!==Tt||ye||c!==null&&c.dependencies!==null&&cp(c.dependencies)?(typeof xe=="function"&&(sf(h,y,xe,T),Tt=h.memoizedState),(Pt=ye||gp(h,y,Pt,T,gt,Tt,We)||c!==null&&c.dependencies!==null&&cp(c.dependencies))?(mt||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(T,Tt,We),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(T,Tt,We)),typeof z.componentDidUpdate=="function"&&(h.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof z.componentDidUpdate!="function"||ee===c.memoizedProps&&gt===c.memoizedState||(h.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||ee===c.memoizedProps&&gt===c.memoizedState||(h.flags|=1024),h.memoizedProps=T,h.memoizedState=Tt),z.props=T,z.state=Tt,z.context=We,T=Pt):(typeof z.componentDidUpdate!="function"||ee===c.memoizedProps&&gt===c.memoizedState||(h.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||ee===c.memoizedProps&&gt===c.memoizedState||(h.flags|=1024),T=!1)}return z=T,_p(c,h),T=(h.flags&128)!==0,z||T?(z=h.stateNode,y=T&&typeof y.getDerivedStateFromError!="function"?null:z.render(),h.flags|=1,c!==null&&T?(h.child=q(h,c.child,null,k),h.child=q(h,null,y,k)):ao(c,h,y,k),h.memoizedState=z.state,c=h.child):c=co(c,h,k),c}function cc(c,h,y,T){return ic(),h.flags|=256,ao(c,h,y,T),h.child}var Dv={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Xu(c){return{baseLanes:c,cachePool:zm()}}function of(c,h,y){return c=c!==null?c.childLanes&~y:0,h&&(c|=gl),c}function pl(c,h,y){var T=h.pendingProps,k=!1,z=(h.flags&128)!==0,ee;if((ee=z)||(ee=c!==null&&c.memoizedState===null?!1:(It.current&2)!==0),ee&&(k=!0,h.flags&=-129),ee=(h.flags&32)!==0,h.flags&=-33,c===null){if(Or){if(k?Ot(h):zt(),(c=hi)?(c=T1(c,Xo),c=c!==null&&c.data!=="&"?c:null,c!==null&&(h.memoizedState={dehydrated:c,treeContext:al!==null?{id:Oa,overflow:ua}:null,retryLane:536870912,hydrationErrors:null},y=kh(c),y.return=h,h.child=y,Os=h,hi=null)):c=null,c===null)throw za(h);return f0(c)?h.lanes=32:h.lanes=536870912,null}var xe=T.children;return T=T.fallback,k?(zt(),k=h.mode,xe=yy({mode:"hidden",children:xe},k),T=nc(T,k,y,null),xe.return=h,T.return=h,xe.sibling=T,h.child=xe,T=h.child,T.memoizedState=Xu(y),T.childLanes=of(c,ee,y),h.memoizedState=Dv,yp(null,T)):(Ot(h),Fa(h,xe))}var We=c.memoizedState;if(We!==null&&(xe=We.dehydrated,xe!==null)){if(z)h.flags&256?(Ot(h),h.flags&=-257,h=vp(c,h,y)):h.memoizedState!==null?(zt(),h.child=c.child,h.flags|=128,h=null):(zt(),xe=T.fallback,k=h.mode,T=yy({mode:"visible",children:T.children},k),xe=nc(xe,k,y,null),xe.flags|=2,T.return=h,xe.return=h,T.sibling=xe,h.child=T,q(h,c.child,null,y),T=h.child,T.memoizedState=Xu(y),T.childLanes=of(c,ee,y),h.memoizedState=Dv,h=yp(null,T));else if(Ot(h),f0(xe)){if(ee=xe.nextSibling&&xe.nextSibling.dataset,ee)var mt=ee.dgst;ee=mt,T=Error(i(419)),T.stack="",T.digest=ee,Ba({value:T,source:null,stack:null}),h=vp(c,h,y)}else if(Ss||fs(c,h,y,!1),ee=(y&c.childLanes)!==0,Ss||ee){if(ee=Fi,ee!==null&&(T=Kn(ee,y),T!==0&&T!==We.retryLane))throw We.retryLane=T,zc(c,T),Lo(ee,c,T),Wu;d0(xe)||Rp(),h=vp(c,h,y)}else d0(xe)?(h.flags|=192,h.child=c.child,h=null):(c=We.treeContext,hi=zl(xe.nextSibling),Os=h,Or=!0,Rl=null,Xo=!1,c!==null&&ry(h,c),h=Fa(h,T.children),h.flags|=4096);return h}return k?(zt(),xe=T.fallback,k=h.mode,We=c.child,mt=We.sibling,T=La(We,{mode:"hidden",children:T.children}),T.subtreeFlags=We.subtreeFlags&65011712,mt!==null?xe=La(mt,xe):(xe=nc(xe,k,y,null),xe.flags|=2),xe.return=h,T.return=h,T.sibling=xe,h.child=T,yp(null,T),T=h.child,xe=c.child.memoizedState,xe===null?xe=Xu(y):(k=xe.cachePool,k!==null?(We=_i._currentValue,k=k.parent!==We?{parent:We,pool:We}:k):k=zm(),xe={baseLanes:xe.baseLanes|y,cachePool:k}),T.memoizedState=xe,T.childLanes=of(c,ee,y),h.memoizedState=Dv,yp(c.child,T)):(Ot(h),y=c.child,c=y.sibling,y=La(y,{mode:"visible",children:T.children}),y.return=h,y.sibling=null,c!==null&&(ee=h.deletions,ee===null?(h.deletions=[c],h.flags|=16):ee.push(c)),h.child=y,h.memoizedState=null,y)}function Fa(c,h){return h=yy({mode:"visible",children:h},c.mode),h.return=c,c.child=h}function yy(c,h){return c=ds(22,c,null,h),c.lanes=0,c}function vp(c,h,y){return q(h,c.child,null,y),c=Fa(h,h.pendingProps.children),c.flags|=2,h.memoizedState=null,c}function Lv(c,h,y){c.lanes|=h;var T=c.alternate;T!==null&&(T.lanes|=h),ap(c.return,h,y)}function Ov(c,h,y,T,k,z){var ee=c.memoizedState;ee===null?c.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:T,tail:y,tailMode:k,treeForkCount:z}:(ee.isBackwards=h,ee.rendering=null,ee.renderingStartTime=0,ee.last=T,ee.tail=y,ee.tailMode=k,ee.treeForkCount=z)}function _y(c,h,y){var T=h.pendingProps,k=T.revealOrder,z=T.tail;T=T.children;var ee=It.current,xe=(ee&2)!==0;if(xe?(ee=ee&1|2,h.flags|=128):ee&=1,Et(It,ee),ao(c,h,T,y),T=Or?rc:0,!xe&&c!==null&&(c.flags&128)!==0)e:for(c=h.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&Lv(c,y,h);else if(c.tag===19)Lv(c,y,h);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===h)break e;for(;c.sibling===null;){if(c.return===null||c.return===h)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}switch(k){case"forwards":for(y=h.child,k=null;y!==null;)c=y.alternate,c!==null&&Sn(c)===null&&(k=y),y=y.sibling;y=k,y===null?(k=h.child,h.child=null):(k=y.sibling,y.sibling=null),Ov(h,!1,k,y,z,T);break;case"backwards":case"unstable_legacy-backwards":for(y=null,k=h.child,h.child=null;k!==null;){if(c=k.alternate,c!==null&&Sn(c)===null){h.child=k;break}c=k.sibling,k.sibling=y,y=k,k=c}Ov(h,!0,y,null,z,T);break;case"together":Ov(h,!1,null,null,void 0,T);break;default:h.memoizedState=null}return h.child}function co(c,h,y){if(c!==null&&(h.dependencies=c.dependencies),Kc|=h.lanes,(y&h.childLanes)===0)if(c!==null){if(fs(c,h,y,!1),(y&h.childLanes)===0)return null}else return null;if(c!==null&&h.child!==c.child)throw Error(i(153));if(h.child!==null){for(c=h.child,y=La(c,c.pendingProps),h.child=y,y.return=h;c.sibling!==null;)c=c.sibling,y=y.sibling=La(c,c.pendingProps),y.return=h;y.sibling=null}return h.child}function Zu(c,h){return(c.lanes&h)!==0?!0:(c=c.dependencies,!!(c!==null&&cp(c)))}function Vb(c,h,y){switch(h.tag){case 3:At(h,h.stateNode.containerInfo),oc(h,_i,c.memoizedState.cache),ic();break;case 27:case 5:Wt(h);break;case 4:At(h,h.stateNode.containerInfo);break;case 10:oc(h,h.type,h.memoizedProps.value);break;case 31:if(h.memoizedState!==null)return h.flags|=128,st(h),null;break;case 13:var T=h.memoizedState;if(T!==null)return T.dehydrated!==null?(Ot(h),h.flags|=128,null):(y&h.child.childLanes)!==0?pl(c,h,y):(Ot(h),c=co(c,h,y),c!==null?c.sibling:null);Ot(h);break;case 19:var k=(c.flags&128)!==0;if(T=(y&h.childLanes)!==0,T||(fs(c,h,y,!1),T=(y&h.childLanes)!==0),k){if(T)return _y(c,h,y);h.flags|=128}if(k=h.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),Et(It,It.current),T)break;return null;case 22:return h.lanes=0,Nb(c,h,y,h.pendingProps);case 24:oc(h,_i,c.memoizedState.cache)}return co(c,h,y)}function zv(c,h,y){if(c!==null)if(c.memoizedProps!==h.pendingProps)Ss=!0;else{if(!Zu(c,y)&&(h.flags&128)===0)return Ss=!1,Vb(c,h,y);Ss=(c.flags&131072)!==0}else Ss=!1,Or&&(h.flags&1048576)!==0&&Zd(h,rc,h.index);switch(h.lanes=0,h.tag){case 16:e:{var T=h.pendingProps;if(c=_(h.elementType),h.type=c,typeof c=="function")rp(c)?(T=oo(c,T),h.tag=1,h=kv(null,h,c,T,y)):(h.tag=0,h=lo(null,h,c,T,y));else{if(c!=null){var k=c.$$typeof;if(k===pe){h.tag=11,h=Iv(null,h,c,T,y);break e}else if(k===ae){h.tag=14,h=Rv(null,h,c,T,y);break e}}throw h=Ne(c)||c,Error(i(306,h,""))}}return h;case 0:return lo(c,h,h.type,h.pendingProps,y);case 1:return T=h.type,k=oo(T,h.pendingProps),kv(c,h,T,k,y);case 3:e:{if(At(h,h.stateNode.containerInfo),c===null)throw Error(i(387));T=h.pendingProps;var z=h.memoizedState;k=z.element,Se(c,h),je(h,T,null,y);var ee=h.memoizedState;if(T=ee.cache,oc(h,_i,T),T!==z.cache&&lp(h,[_i],y,!0),Le(),T=ee.element,z.isDehydrated)if(z={element:T,isDehydrated:!1,cache:ee.cache},h.updateQueue.baseState=z,h.memoizedState=z,h.flags&256){h=cc(c,h,T,y);break e}else if(T!==k){k=rn(Error(i(424)),h),Ba(k),h=cc(c,h,T,y);break e}else{switch(c=h.stateNode.containerInfo,c.nodeType){case 9:c=c.body;break;default:c=c.nodeName==="HTML"?c.ownerDocument.body:c}for(hi=zl(c.firstChild),Os=h,Or=!0,Rl=null,Xo=!0,y=te(h,null,T,y),h.child=y;y;)y.flags=y.flags&-3|4096,y=y.sibling}else{if(ic(),T===k){h=co(c,h,y);break e}ao(c,h,T,y)}h=h.child}return h;case 26:return _p(c,h),c===null?(y=Tf(h.type,null,h.pendingProps,null))?h.memoizedState=y:Or||(y=h.type,c=h.pendingProps,T=vf(Ut.current).createElement(y),T[Cr]=h,T[Xr]=c,Oo(T,y,c),ts(T),h.stateNode=T):h.memoizedState=Tf(h.type,c.memoizedProps,h.pendingProps,c.memoizedState),null;case 27:return Wt(h),c===null&&Or&&(T=h.stateNode=C1(h.type,h.pendingProps,Ut.current),Os=h,Xo=!0,k=hi,Qc(h.type)?(p0=k,hi=zl(T.firstChild)):hi=k),ao(c,h,h.pendingProps.children,y),_p(c,h),c===null&&(h.flags|=4194304),h.child;case 5:return c===null&&Or&&((k=T=hi)&&(T=Lp(T,h.type,h.pendingProps,Xo),T!==null?(h.stateNode=T,Os=h,hi=zl(T.firstChild),Xo=!1,k=!0):k=!1),k||za(h)),Wt(h),k=h.type,z=h.pendingProps,ee=c!==null?c.memoizedProps:null,T=z.children,l0(k,z)?T=null:ee!==null&&l0(k,ee)&&(h.flags|=32),h.memoizedState!==null&&(k=Na(c,h,Fr,null,null,y),zp._currentValue=k),_p(c,h),ao(c,h,T,y),h.child;case 6:return c===null&&Or&&((c=y=hi)&&(y=w1(y,h.pendingProps,Xo),y!==null?(h.stateNode=y,Os=h,hi=null,c=!0):c=!1),c||za(h)),null;case 13:return pl(c,h,y);case 4:return At(h,h.stateNode.containerInfo),T=h.pendingProps,c===null?h.child=q(h,null,T,y):ao(c,h,T,y),h.child;case 11:return Iv(c,h,h.type,h.pendingProps,y);case 7:return ao(c,h,h.pendingProps,y),h.child;case 8:return ao(c,h,h.pendingProps.children,y),h.child;case 12:return ao(c,h,h.pendingProps.children,y),h.child;case 10:return T=h.pendingProps,oc(h,h.type,T.value),ao(c,h,T.children,y),h.child;case 9:return k=h.type._context,T=h.pendingProps.children,Fc(h),k=Gs(k),T=T(k),h.flags|=1,ao(c,h,T,y),h.child;case 14:return Rv(c,h,h.type,h.pendingProps,y);case 15:return Bb(c,h,h.type,h.pendingProps,y);case 19:return _y(c,h,y);case 31:return Pv(c,h,y);case 22:return Nb(c,h,y,h.pendingProps);case 24:return Fc(h),T=Gs(_i),c===null?(k=Qd(),k===null&&(k=Fi,z=ac(),k.pooledCache=z,z.refCount++,z!==null&&(k.pooledCacheLanes|=y),k=z),h.memoizedState={parent:T,cache:k},we(h),oc(h,_i,k)):((c.lanes&y)!==0&&(Se(c,h),je(h,null,null,y),Le()),k=c.memoizedState,z=h.memoizedState,k.parent!==T?(k={parent:T,cache:T},h.memoizedState=k,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=k),oc(h,_i,T)):(T=z.cache,oc(h,_i,T),T!==k.cache&&lp(h,[_i],y,!0))),ao(c,h,h.pendingProps.children,y),h.child;case 29:throw h.pendingProps}throw Error(i(156,h.tag))}function Ku(c){c.flags|=4}function xp(c,h,y,T,k){if((h=(c.mode&32)!==0)&&(h=!1),h){if(c.flags|=16777216,(k&335544128)===k)if(c.stateNode.complete)c.flags|=8192;else if(Gv())c.flags|=8192;else throw l=Nh,Bm}else c.flags&=-16777217}function vy(c,h){if(h.type!=="stylesheet"||(h.state.loading&4)!==0)c.flags&=-16777217;else if(c.flags|=16777216,!b0(h))if(Gv())c.flags|=8192;else throw l=Nh,Bm}function Yu(c,h){h!==null&&(c.flags|=4),c.flags&16384&&(h=c.tag!==22?Xe():536870912,c.lanes|=h,Gh|=h)}function Gc(c,h){if(!Or)switch(c.tailMode){case"hidden":h=c.tail;for(var y=null;h!==null;)h.alternate!==null&&(y=h),h=h.sibling;y===null?c.tail=null:y.sibling=null;break;case"collapsed":y=c.tail;for(var T=null;y!==null;)y.alternate!==null&&(T=y),y=y.sibling;T===null?h||c.tail===null?c.tail=null:c.tail.sibling=null:T.sibling=null}}function Pi(c){var h=c.alternate!==null&&c.alternate.child===c.child,y=0,T=0;if(h)for(var k=c.child;k!==null;)y|=k.lanes|k.childLanes,T|=k.subtreeFlags&65011712,T|=k.flags&65011712,k.return=c,k=k.sibling;else for(k=c.child;k!==null;)y|=k.lanes|k.childLanes,T|=k.subtreeFlags,T|=k.flags,k.return=c,k=k.sibling;return c.subtreeFlags|=T,c.childLanes=y,h}function xy(c,h,y){var T=h.pendingProps;switch(Kd(h),h.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pi(h),null;case 1:return Pi(h),null;case 3:return y=h.stateNode,T=null,c!==null&&(T=c.memoizedState.cache),h.memoizedState.cache!==T&&(h.flags|=2048),ll(_i),Qt(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(c===null||c.child===null)&&(Nu(h)?Ku(h):c===null||c.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,sp())),Pi(h),null;case 26:var k=h.type,z=h.memoizedState;return c===null?(Ku(h),z!==null?(Pi(h),vy(h,z)):(Pi(h),xp(h,k,null,T,y))):z?z!==c.memoizedState?(Ku(h),Pi(h),vy(h,z)):(Pi(h),h.flags&=-16777217):(c=c.memoizedProps,c!==T&&Ku(h),Pi(h),xp(h,k,c,T,y)),null;case 27:if(vn(h),y=Ut.current,k=h.type,c!==null&&h.stateNode!=null)c.memoizedProps!==T&&Ku(h);else{if(!T){if(h.stateNode===null)throw Error(i(166));return Pi(h),null}c=wt.current,Nu(h)?Oh(h):(c=C1(k,T,y),h.stateNode=c,Ku(h))}return Pi(h),null;case 5:if(vn(h),k=h.type,c!==null&&h.stateNode!=null)c.memoizedProps!==T&&Ku(h);else{if(!T){if(h.stateNode===null)throw Error(i(166));return Pi(h),null}if(z=wt.current,Nu(h))Oh(h);else{var ee=vf(Ut.current);switch(z){case 1:z=ee.createElementNS("http://www.w3.org/2000/svg",k);break;case 2:z=ee.createElementNS("http://www.w3.org/1998/Math/MathML",k);break;default:switch(k){case"svg":z=ee.createElementNS("http://www.w3.org/2000/svg",k);break;case"math":z=ee.createElementNS("http://www.w3.org/1998/Math/MathML",k);break;case"script":z=ee.createElement("div"),z.innerHTML="<script><\/script>",z=z.removeChild(z.firstChild);break;case"select":z=typeof T.is=="string"?ee.createElement("select",{is:T.is}):ee.createElement("select"),T.multiple?z.multiple=!0:T.size&&(z.size=T.size);break;default:z=typeof T.is=="string"?ee.createElement(k,{is:T.is}):ee.createElement(k)}}z[Cr]=h,z[Xr]=T;e:for(ee=h.child;ee!==null;){if(ee.tag===5||ee.tag===6)z.appendChild(ee.stateNode);else if(ee.tag!==4&&ee.tag!==27&&ee.child!==null){ee.child.return=ee,ee=ee.child;continue}if(ee===h)break e;for(;ee.sibling===null;){if(ee.return===null||ee.return===h)break e;ee=ee.return}ee.sibling.return=ee.return,ee=ee.sibling}h.stateNode=z;e:switch(Oo(z,k,T),k){case"button":case"input":case"select":case"textarea":T=!!T.autoFocus;break e;case"img":T=!0;break e;default:T=!1}T&&Ku(h)}}return Pi(h),xp(h,h.type,c===null?null:c.memoizedProps,h.pendingProps,y),null;case 6:if(c&&h.stateNode!=null)c.memoizedProps!==T&&Ku(h);else{if(typeof T!="string"&&h.stateNode===null)throw Error(i(166));if(c=Ut.current,Nu(h)){if(c=h.stateNode,y=h.memoizedProps,T=null,k=Os,k!==null)switch(k.tag){case 27:case 5:T=k.memoizedProps}c[Cr]=h,c=!!(c.nodeValue===y||T!==null&&T.suppressHydrationWarning===!0||m1(c.nodeValue,y)),c||za(h,!0)}else c=vf(c).createTextNode(T),c[Cr]=h,h.stateNode=c}return Pi(h),null;case 31:if(y=h.memoizedState,c===null||c.memoizedState!==null){if(T=Nu(h),y!==null){if(c===null){if(!T)throw Error(i(318));if(c=h.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(i(557));c[Cr]=h}else ic(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Pi(h),c=!1}else y=sp(),c!==null&&c.memoizedState!==null&&(c.memoizedState.hydrationErrors=y),c=!0;if(!c)return h.flags&256?(Ct(h),h):(Ct(h),null);if((h.flags&128)!==0)throw Error(i(558))}return Pi(h),null;case 13:if(T=h.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(k=Nu(h),T!==null&&T.dehydrated!==null){if(c===null){if(!k)throw Error(i(318));if(k=h.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(i(317));k[Cr]=h}else ic(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Pi(h),k=!1}else k=sp(),c!==null&&c.memoizedState!==null&&(c.memoizedState.hydrationErrors=k),k=!0;if(!k)return h.flags&256?(Ct(h),h):(Ct(h),null)}return Ct(h),(h.flags&128)!==0?(h.lanes=y,h):(y=T!==null,c=c!==null&&c.memoizedState!==null,y&&(T=h.child,k=null,T.alternate!==null&&T.alternate.memoizedState!==null&&T.alternate.memoizedState.cachePool!==null&&(k=T.alternate.memoizedState.cachePool.pool),z=null,T.memoizedState!==null&&T.memoizedState.cachePool!==null&&(z=T.memoizedState.cachePool.pool),z!==k&&(T.flags|=2048)),y!==c&&y&&(h.child.flags|=8192),Yu(h,h.updateQueue),Pi(h),null);case 4:return Qt(),c===null&&i0(h.stateNode.containerInfo),Pi(h),null;case 10:return ll(h.type),Pi(h),null;case 19:if(tt(It),T=h.memoizedState,T===null)return Pi(h),null;if(k=(h.flags&128)!==0,z=T.rendering,z===null)if(k)Gc(T,!1);else{if(xs!==0||c!==null&&(c.flags&128)!==0)for(c=h.child;c!==null;){if(z=Sn(c),z!==null){for(h.flags|=128,Gc(T,!1),c=z.updateQueue,h.updateQueue=c,Yu(h,c),h.subtreeFlags=0,c=y,y=h.child;y!==null;)Ou(y,c),y=y.sibling;return Et(It,It.current&1|2),Or&&Il(h,T.treeForkCount),h.child}c=c.sibling}T.tail!==null&&Xn()>Iy&&(h.flags|=128,k=!0,Gc(T,!1),h.lanes=4194304)}else{if(!k)if(c=Sn(z),c!==null){if(h.flags|=128,k=!0,c=c.updateQueue,h.updateQueue=c,Yu(h,c),Gc(T,!0),T.tail===null&&T.tailMode==="hidden"&&!z.alternate&&!Or)return Pi(h),null}else 2*Xn()-T.renderingStartTime>Iy&&y!==536870912&&(h.flags|=128,k=!0,Gc(T,!1),h.lanes=4194304);T.isBackwards?(z.sibling=h.child,h.child=z):(c=T.last,c!==null?c.sibling=z:h.child=z,T.last=z)}return T.tail!==null?(c=T.tail,T.rendering=c,T.tail=c.sibling,T.renderingStartTime=Xn(),c.sibling=null,y=It.current,Et(It,k?y&1|2:y&1),Or&&Il(h,T.treeForkCount),c):(Pi(h),null);case 22:case 23:return Ct(h),rt(),T=h.memoizedState!==null,c!==null?c.memoizedState!==null!==T&&(h.flags|=8192):T&&(h.flags|=8192),T?(y&536870912)!==0&&(h.flags&128)===0&&(Pi(h),h.subtreeFlags&6&&(h.flags|=8192)):Pi(h),y=h.updateQueue,y!==null&&Yu(h,y.retryQueue),y=null,c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),T=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(T=h.memoizedState.cachePool.pool),T!==y&&(h.flags|=2048),c!==null&&tt($c),null;case 24:return y=null,c!==null&&(y=c.memoizedState.cache),h.memoizedState.cache!==y&&(h.flags|=2048),ll(_i),Pi(h),null;case 25:return null;case 30:return null}throw Error(i(156,h.tag))}function Fb(c,h){switch(Kd(h),h.tag){case 1:return c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 3:return ll(_i),Qt(),c=h.flags,(c&65536)!==0&&(c&128)===0?(h.flags=c&-65537|128,h):null;case 26:case 27:case 5:return vn(h),null;case 31:if(h.memoizedState!==null){if(Ct(h),h.alternate===null)throw Error(i(340));ic()}return c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 13:if(Ct(h),c=h.memoizedState,c!==null&&c.dehydrated!==null){if(h.alternate===null)throw Error(i(340));ic()}return c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 19:return tt(It),null;case 4:return Qt(),null;case 10:return ll(h.type),null;case 22:case 23:return Ct(h),rt(),c!==null&&tt($c),c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 24:return ll(_i),null;case 25:return null;default:return null}}function bp(c,h){switch(Kd(h),h.tag){case 3:ll(_i),Qt();break;case 26:case 27:case 5:vn(h);break;case 4:Qt();break;case 31:h.memoizedState!==null&&Ct(h);break;case 13:Ct(h);break;case 19:tt(It);break;case 10:ll(h.type);break;case 22:case 23:Ct(h),rt(),c!==null&&tt($c);break;case 24:ll(_i)}}function af(c,h){try{var y=h.updateQueue,T=y!==null?y.lastEffect:null;if(T!==null){var k=T.next;y=k;do{if((y.tag&c)===c){T=void 0;var z=y.create,ee=y.inst;T=z(),ee.destroy=T}y=y.next}while(y!==k)}}catch(xe){Ci(h,h.return,xe)}}function Qu(c,h,y){try{var T=h.updateQueue,k=T!==null?T.lastEffect:null;if(k!==null){var z=k.next;T=z;do{if((T.tag&c)===c){var ee=T.inst,xe=ee.destroy;if(xe!==void 0){ee.destroy=void 0,k=h;var We=y,mt=xe;try{mt()}catch(Pt){Ci(k,We,Pt)}}}T=T.next}while(T!==z)}}catch(Pt){Ci(h,h.return,Pt)}}function lf(c){var h=c.updateQueue;if(h!==null){var y=c.stateNode;try{qe(h,y)}catch(T){Ci(c,c.return,T)}}}function Bv(c,h,y){y.props=oo(c.type,c.memoizedProps),y.state=c.memoizedState;try{y.componentWillUnmount()}catch(T){Ci(c,h,T)}}function cf(c,h){try{var y=c.ref;if(y!==null){switch(c.tag){case 26:case 27:case 5:var T=c.stateNode;break;case 30:T=c.stateNode;break;default:T=c.stateNode}typeof y=="function"?c.refCleanup=y(T):y.current=T}}catch(k){Ci(c,h,k)}}function uc(c,h){var y=c.ref,T=c.refCleanup;if(y!==null)if(typeof T=="function")try{T()}catch(k){Ci(c,h,k)}finally{c.refCleanup=null,c=c.alternate,c!=null&&(c.refCleanup=null)}else if(typeof y=="function")try{y(null)}catch(k){Ci(c,h,k)}else y.current=null}function Ub(c){var h=c.type,y=c.memoizedProps,T=c.stateNode;try{e:switch(h){case"button":case"input":case"select":case"textarea":y.autoFocus&&T.focus();break e;case"img":y.src?T.src=y.src:y.srcSet&&(T.srcset=y.srcSet)}}catch(k){Ci(c,c.return,k)}}function Nv(c,h,y){try{var T=c.stateNode;g1(T,c.type,y,h),T[Xr]=h}catch(k){Ci(c,c.return,k)}}function wp(c){return c.tag===5||c.tag===3||c.tag===26||c.tag===27&&Qc(c.type)||c.tag===4}function by(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||wp(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.tag===27&&Qc(c.type)||c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function Hc(c,h,y){var T=c.tag;if(T===5||T===6)c=c.stateNode,h?(y.nodeType===9?y.body:y.nodeName==="HTML"?y.ownerDocument.body:y).insertBefore(c,h):(h=y.nodeType===9?y.body:y.nodeName==="HTML"?y.ownerDocument.body:y,h.appendChild(c),y=y._reactRootContainer,y!=null||h.onclick!==null||(h.onclick=So));else if(T!==4&&(T===27&&Qc(c.type)&&(y=c.stateNode,h=null),c=c.child,c!==null))for(Hc(c,h,y),c=c.sibling;c!==null;)Hc(c,h,y),c=c.sibling}function Yr(c,h,y){var T=c.tag;if(T===5||T===6)c=c.stateNode,h?y.insertBefore(c,h):y.appendChild(c);else if(T!==4&&(T===27&&Qc(c.type)&&(y=c.stateNode),c=c.child,c!==null))for(Yr(c,h,y),c=c.sibling;c!==null;)Yr(c,h,y),c=c.sibling}function wy(c){var h=c.stateNode,y=c.memoizedProps;try{for(var T=c.type,k=h.attributes;k.length;)h.removeAttributeNode(k[0]);Oo(h,T,y),h[Cr]=c,h[Xr]=y}catch(z){Ci(c,c.return,z)}}var uo=!1,ki=!1,ml=!1,Ua=typeof WeakSet=="function"?WeakSet:Set,Qr=null;function jb(c,h){if(c=c.containerInfo,yl=Af,c=tp(c),Mm(c)){if("selectionStart"in c)var y={start:c.selectionStart,end:c.selectionEnd};else e:{y=(y=c.ownerDocument)&&y.defaultView||window;var T=y.getSelection&&y.getSelection();if(T&&T.rangeCount!==0){y=T.anchorNode;var k=T.anchorOffset,z=T.focusNode;T=T.focusOffset;try{y.nodeType,z.nodeType}catch{y=null;break e}var ee=0,xe=-1,We=-1,mt=0,Pt=0,Ft=c,gt=null;t:for(;;){for(var Tt;Ft!==y||k!==0&&Ft.nodeType!==3||(xe=ee+k),Ft!==z||T!==0&&Ft.nodeType!==3||(We=ee+T),Ft.nodeType===3&&(ee+=Ft.nodeValue.length),(Tt=Ft.firstChild)!==null;)gt=Ft,Ft=Tt;for(;;){if(Ft===c)break t;if(gt===y&&++mt===k&&(xe=ee),gt===z&&++Pt===T&&(We=ee),(Tt=Ft.nextSibling)!==null)break;Ft=gt,gt=Ft.parentNode}Ft=Tt}y=xe===-1||We===-1?null:{start:xe,end:We}}else y=null}y=y||{start:0,end:0}}else y=null;for(eg={focusedElem:c,selectionRange:y},Af=!1,Qr=h;Qr!==null;)if(h=Qr,c=h.child,(h.subtreeFlags&1028)!==0&&c!==null)c.return=h,Qr=c;else for(;Qr!==null;){switch(h=Qr,z=h.alternate,c=h.flags,h.tag){case 0:if((c&4)!==0&&(c=h.updateQueue,c=c!==null?c.events:null,c!==null))for(y=0;y<c.length;y++)k=c[y],k.ref.impl=k.nextImpl;break;case 11:case 15:break;case 1:if((c&1024)!==0&&z!==null){c=void 0,y=h,k=z.memoizedProps,z=z.memoizedState,T=y.stateNode;try{var Mn=oo(y.type,k);c=T.getSnapshotBeforeUpdate(Mn,z),T.__reactInternalSnapshotBeforeUpdate=c}catch(Yn){Ci(y,y.return,Yn)}}break;case 3:if((c&1024)!==0){if(c=h.stateNode.containerInfo,y=c.nodeType,y===9)mc(c);else if(y===1)switch(c.nodeName){case"HEAD":case"HTML":case"BODY":mc(c);break;default:c.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((c&1024)!==0)throw Error(i(163))}if(c=h.sibling,c!==null){c.return=h.return,Qr=c;break}Qr=h.return}}function Ws(c,h,y){var T=y.flags;switch(y.tag){case 0:case 11:case 15:Xc(c,y),T&4&&af(5,y);break;case 1:if(Xc(c,y),T&4)if(c=y.stateNode,h===null)try{c.componentDidMount()}catch(ee){Ci(y,y.return,ee)}else{var k=oo(y.type,h.memoizedProps);h=h.memoizedState;try{c.componentDidUpdate(k,h,c.__reactInternalSnapshotBeforeUpdate)}catch(ee){Ci(y,y.return,ee)}}T&64&&lf(y),T&512&&cf(y,y.return);break;case 3:if(Xc(c,y),T&64&&(c=y.updateQueue,c!==null)){if(h=null,y.child!==null)switch(y.child.tag){case 27:case 5:h=y.child.stateNode;break;case 1:h=y.child.stateNode}try{qe(c,h)}catch(ee){Ci(y,y.return,ee)}}break;case 27:h===null&&T&4&&wy(y);case 26:case 5:Xc(c,y),h===null&&T&4&&Ub(y),T&512&&cf(y,y.return);break;case 12:Xc(c,y);break;case 31:Xc(c,y),T&4&&$b(c,y);break;case 13:Xc(c,y),T&4&&Ey(c,y),T&64&&(c=y.memoizedState,c!==null&&(c=c.dehydrated,c!==null&&(y=DE.bind(null,y),BE(c,y))));break;case 22:if(T=y.memoizedState!==null||uo,!T){h=h!==null&&h.memoizedState!==null||ki,k=uo;var z=ki;uo=T,(ki=h)&&!z?Zc(c,y,(y.subtreeFlags&8772)!==0):Xc(c,y),uo=k,ki=z}break;case 30:break;default:Xc(c,y)}}function Vv(c){var h=c.alternate;h!==null&&(c.alternate=null,Vv(h)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(h=c.stateNode,h!==null&&wu(h)),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}var Di=null,Ko=!1;function Wc(c,h,y){for(y=y.child;y!==null;)Ty(c,h,y),y=y.sibling}function Ty(c,h,y){if(_r&&typeof _r.onCommitFiberUnmount=="function")try{_r.onCommitFiberUnmount(tr,y)}catch{}switch(y.tag){case 26:ki||uc(y,h),Wc(c,h,y),y.memoizedState?y.memoizedState.count--:y.stateNode&&(y=y.stateNode,y.parentNode.removeChild(y));break;case 27:ki||uc(y,h);var T=Di,k=Ko;Qc(y.type)&&(Di=y.stateNode,Ko=!1),Wc(c,h,y),Jh(y.stateNode),Di=T,Ko=k;break;case 5:ki||uc(y,h);case 6:if(T=Di,k=Ko,Di=null,Wc(c,h,y),Di=T,Ko=k,Di!==null)if(Ko)try{(Di.nodeType===9?Di.body:Di.nodeName==="HTML"?Di.ownerDocument.body:Di).removeChild(y.stateNode)}catch(z){Ci(y,h,z)}else try{Di.removeChild(y.stateNode)}catch(z){Ci(y,h,z)}break;case 18:Di!==null&&(Ko?(c=Di,u0(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,y.stateNode),Vp(c)):u0(Di,y.stateNode));break;case 4:T=Di,k=Ko,Di=y.stateNode.containerInfo,Ko=!0,Wc(c,h,y),Di=T,Ko=k;break;case 0:case 11:case 14:case 15:Qu(2,y,h),ki||Qu(4,y,h),Wc(c,h,y);break;case 1:ki||(uc(y,h),T=y.stateNode,typeof T.componentWillUnmount=="function"&&Bv(y,h,T)),Wc(c,h,y);break;case 21:Wc(c,h,y);break;case 22:ki=(T=ki)||y.memoizedState!==null,Wc(c,h,y),ki=T;break;default:Wc(c,h,y)}}function $b(c,h){if(h.memoizedState===null&&(c=h.alternate,c!==null&&(c=c.memoizedState,c!==null))){c=c.dehydrated;try{Vp(c)}catch(y){Ci(h,h.return,y)}}}function Ey(c,h){if(h.memoizedState===null&&(c=h.alternate,c!==null&&(c=c.memoizedState,c!==null&&(c=c.dehydrated,c!==null))))try{Vp(c)}catch(y){Ci(h,h.return,y)}}function qb(c){switch(c.tag){case 31:case 13:case 19:var h=c.stateNode;return h===null&&(h=c.stateNode=new Ua),h;case 22:return c=c.stateNode,h=c._retryCache,h===null&&(h=c._retryCache=new Ua),h;default:throw Error(i(435,c.tag))}}function Sy(c,h){var y=qb(c);h.forEach(function(T){if(!y.has(T)){y.add(T);var k=Kv.bind(null,c,T);T.then(k,k)}})}function _s(c,h){var y=h.deletions;if(y!==null)for(var T=0;T<y.length;T++){var k=y[T],z=c,ee=h,xe=ee;e:for(;xe!==null;){switch(xe.tag){case 27:if(Qc(xe.type)){Di=xe.stateNode,Ko=!1;break e}break;case 5:Di=xe.stateNode,Ko=!1;break e;case 3:case 4:Di=xe.stateNode.containerInfo,Ko=!0;break e}xe=xe.return}if(Di===null)throw Error(i(160));Ty(z,ee,k),Di=null,Ko=!1,z=k.alternate,z!==null&&(z.return=null),k.return=null}if(h.subtreeFlags&13886)for(h=h.child;h!==null;)Gm(h,c),h=h.sibling}var ko=null;function Gm(c,h){var y=c.alternate,T=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:_s(h,c),Do(c),T&4&&(Qu(3,c,c.return),af(3,c),Qu(5,c,c.return));break;case 1:_s(h,c),Do(c),T&512&&(ki||y===null||uc(y,y.return)),T&64&&uo&&(c=c.updateQueue,c!==null&&(T=c.callbacks,T!==null&&(y=c.shared.hiddenCallbacks,c.shared.hiddenCallbacks=y===null?T:y.concat(T))));break;case 26:var k=ko;if(_s(h,c),Do(c),T&512&&(ki||y===null||uc(y,y.return)),T&4){var z=y!==null?y.memoizedState:null;if(T=c.memoizedState,y===null)if(T===null)if(c.stateNode===null){e:{T=c.type,y=c.memoizedProps,k=k.ownerDocument||k;t:switch(T){case"title":z=k.getElementsByTagName("title")[0],(!z||z[wl]||z[Cr]||z.namespaceURI==="http://www.w3.org/2000/svg"||z.hasAttribute("itemprop"))&&(z=k.createElement(T),k.head.insertBefore(z,k.querySelector("head > title"))),Oo(z,T,y),z[Cr]=c,ts(z),T=z;break e;case"link":var ee=x0("link","href",k).get(T+(y.href||""));if(ee){for(var xe=0;xe<ee.length;xe++)if(z=ee[xe],z.getAttribute("href")===(y.href==null||y.href===""?null:y.href)&&z.getAttribute("rel")===(y.rel==null?null:y.rel)&&z.getAttribute("title")===(y.title==null?null:y.title)&&z.getAttribute("crossorigin")===(y.crossOrigin==null?null:y.crossOrigin)){ee.splice(xe,1);break t}}z=k.createElement(T),Oo(z,T,y),k.head.appendChild(z);break;case"meta":if(ee=x0("meta","content",k).get(T+(y.content||""))){for(xe=0;xe<ee.length;xe++)if(z=ee[xe],z.getAttribute("content")===(y.content==null?null:""+y.content)&&z.getAttribute("name")===(y.name==null?null:y.name)&&z.getAttribute("property")===(y.property==null?null:y.property)&&z.getAttribute("http-equiv")===(y.httpEquiv==null?null:y.httpEquiv)&&z.getAttribute("charset")===(y.charSet==null?null:y.charSet)){ee.splice(xe,1);break t}}z=k.createElement(T),Oo(z,T,y),k.head.appendChild(z);break;default:throw Error(i(468,T))}z[Cr]=c,ts(z),T=z}c.stateNode=T}else Jc(k,c.type,c.stateNode);else c.stateNode=v0(k,T,c.memoizedProps);else z!==T?(z===null?y.stateNode!==null&&(y=y.stateNode,y.parentNode.removeChild(y)):z.count--,T===null?Jc(k,c.type,c.stateNode):v0(k,T,c.memoizedProps)):T===null&&c.stateNode!==null&&Nv(c,c.memoizedProps,y.memoizedProps)}break;case 27:_s(h,c),Do(c),T&512&&(ki||y===null||uc(y,y.return)),y!==null&&T&4&&Nv(c,c.memoizedProps,y.memoizedProps);break;case 5:if(_s(h,c),Do(c),T&512&&(ki||y===null||uc(y,y.return)),c.flags&32){k=c.stateNode;try{Hi(k,"")}catch(Mn){Ci(c,c.return,Mn)}}T&4&&c.stateNode!=null&&(k=c.memoizedProps,Nv(c,k,y!==null?y.memoizedProps:k)),T&1024&&(ml=!0);break;case 6:if(_s(h,c),Do(c),T&4){if(c.stateNode===null)throw Error(i(162));T=c.memoizedProps,y=c.stateNode;try{y.nodeValue=T}catch(Mn){Ci(c,c.return,Mn)}}break;case 3:if(Vy=null,k=ko,ko=wf(h.containerInfo),_s(h,c),ko=k,Do(c),T&4&&y!==null&&y.memoizedState.isDehydrated)try{Vp(h.containerInfo)}catch(Mn){Ci(c,c.return,Mn)}ml&&(ml=!1,Cy(c));break;case 4:T=ko,ko=wf(c.stateNode.containerInfo),_s(h,c),Do(c),ko=T;break;case 12:_s(h,c),Do(c);break;case 31:_s(h,c),Do(c),T&4&&(T=c.updateQueue,T!==null&&(c.updateQueue=null,Sy(c,T)));break;case 13:_s(h,c),Do(c),c.child.flags&8192&&c.memoizedState!==null!=(y!==null&&y.memoizedState!==null)&&(Wh=Xn()),T&4&&(T=c.updateQueue,T!==null&&(c.updateQueue=null,Sy(c,T)));break;case 22:k=c.memoizedState!==null;var We=y!==null&&y.memoizedState!==null,mt=uo,Pt=ki;if(uo=mt||k,ki=Pt||We,_s(h,c),ki=Pt,uo=mt,Do(c),T&8192)e:for(h=c.stateNode,h._visibility=k?h._visibility&-2:h._visibility|1,k&&(y===null||We||uo||ki||uf(c)),y=null,h=c;;){if(h.tag===5||h.tag===26){if(y===null){We=y=h;try{if(z=We.stateNode,k)ee=z.style,typeof ee.setProperty=="function"?ee.setProperty("display","none","important"):ee.display="none";else{xe=We.stateNode;var Ft=We.memoizedProps.style,gt=Ft!=null&&Ft.hasOwnProperty("display")?Ft.display:null;xe.style.display=gt==null||typeof gt=="boolean"?"":(""+gt).trim()}}catch(Mn){Ci(We,We.return,Mn)}}}else if(h.tag===6){if(y===null){We=h;try{We.stateNode.nodeValue=k?"":We.memoizedProps}catch(Mn){Ci(We,We.return,Mn)}}}else if(h.tag===18){if(y===null){We=h;try{var Tt=We.stateNode;k?h0(Tt,!0):h0(We.stateNode,!1)}catch(Mn){Ci(We,We.return,Mn)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===c)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break e;for(;h.sibling===null;){if(h.return===null||h.return===c)break e;y===h&&(y=null),h=h.return}y===h&&(y=null),h.sibling.return=h.return,h=h.sibling}T&4&&(T=c.updateQueue,T!==null&&(y=T.retryQueue,y!==null&&(T.retryQueue=null,Sy(c,y))));break;case 19:_s(h,c),Do(c),T&4&&(T=c.updateQueue,T!==null&&(c.updateQueue=null,Sy(c,T)));break;case 30:break;case 21:break;default:_s(h,c),Do(c)}}function Do(c){var h=c.flags;if(h&2){try{for(var y,T=c.return;T!==null;){if(wp(T)){y=T;break}T=T.return}if(y==null)throw Error(i(160));switch(y.tag){case 27:var k=y.stateNode,z=by(c);Yr(c,z,k);break;case 5:var ee=y.stateNode;y.flags&32&&(Hi(ee,""),y.flags&=-33);var xe=by(c);Yr(c,xe,ee);break;case 3:case 4:var We=y.stateNode.containerInfo,mt=by(c);Hc(c,mt,We);break;default:throw Error(i(161))}}catch(Pt){Ci(c,c.return,Pt)}c.flags&=-3}h&4096&&(c.flags&=-4097)}function Cy(c){if(c.subtreeFlags&1024)for(c=c.child;c!==null;){var h=c;Cy(h),h.tag===5&&h.flags&1024&&h.stateNode.reset(),c=c.sibling}}function Xc(c,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)Ws(c,h.alternate,h),h=h.sibling}function uf(c){for(c=c.child;c!==null;){var h=c;switch(h.tag){case 0:case 11:case 14:case 15:Qu(4,h,h.return),uf(h);break;case 1:uc(h,h.return);var y=h.stateNode;typeof y.componentWillUnmount=="function"&&Bv(h,h.return,y),uf(h);break;case 27:Jh(h.stateNode);case 26:case 5:uc(h,h.return),uf(h);break;case 22:h.memoizedState===null&&uf(h);break;case 30:uf(h);break;default:uf(h)}c=c.sibling}}function Zc(c,h,y){for(y=y&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var T=h.alternate,k=c,z=h,ee=z.flags;switch(z.tag){case 0:case 11:case 15:Zc(k,z,y),af(4,z);break;case 1:if(Zc(k,z,y),T=z,k=T.stateNode,typeof k.componentDidMount=="function")try{k.componentDidMount()}catch(mt){Ci(T,T.return,mt)}if(T=z,k=T.updateQueue,k!==null){var xe=T.stateNode;try{var We=k.shared.hiddenCallbacks;if(We!==null)for(k.shared.hiddenCallbacks=null,k=0;k<We.length;k++)He(We[k],xe)}catch(mt){Ci(T,T.return,mt)}}y&&ee&64&&lf(z),cf(z,z.return);break;case 27:wy(z);case 26:case 5:Zc(k,z,y),y&&T===null&&ee&4&&Ub(z),cf(z,z.return);break;case 12:Zc(k,z,y);break;case 31:Zc(k,z,y),y&&ee&4&&$b(k,z);break;case 13:Zc(k,z,y),y&&ee&4&&Ey(k,z);break;case 22:z.memoizedState===null&&Zc(k,z,y),cf(z,z.return);break;case 30:break;default:Zc(k,z,y)}h=h.sibling}}function Fv(c,h){var y=null;c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),c=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(c=h.memoizedState.cachePool.pool),c!==y&&(c!=null&&c.refCount++,y!=null&&Uc(y))}function Hm(c,h){c=null,h.alternate!==null&&(c=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==c&&(h.refCount++,c!=null&&Uc(c))}function hc(c,h,y,T){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)Ay(c,h,y,T),h=h.sibling}function Ay(c,h,y,T){var k=h.flags;switch(h.tag){case 0:case 11:case 15:hc(c,h,y,T),k&2048&&af(9,h);break;case 1:hc(c,h,y,T);break;case 3:hc(c,h,y,T),k&2048&&(c=null,h.alternate!==null&&(c=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==c&&(h.refCount++,c!=null&&Uc(c)));break;case 12:if(k&2048){hc(c,h,y,T),c=h.stateNode;try{var z=h.memoizedProps,ee=z.id,xe=z.onPostCommit;typeof xe=="function"&&xe(ee,h.alternate===null?"mount":"update",c.passiveEffectDuration,-0)}catch(We){Ci(h,h.return,We)}}else hc(c,h,y,T);break;case 31:hc(c,h,y,T);break;case 13:hc(c,h,y,T);break;case 23:break;case 22:z=h.stateNode,ee=h.alternate,h.memoizedState!==null?z._visibility&2?hc(c,h,y,T):Tp(c,h):z._visibility&2?hc(c,h,y,T):(z._visibility|=2,hf(c,h,y,T,(h.subtreeFlags&10256)!==0||!1)),k&2048&&Fv(ee,h);break;case 24:hc(c,h,y,T),k&2048&&Hm(h.alternate,h);break;default:hc(c,h,y,T)}}function hf(c,h,y,T,k){for(k=k&&((h.subtreeFlags&10256)!==0||!1),h=h.child;h!==null;){var z=c,ee=h,xe=y,We=T,mt=ee.flags;switch(ee.tag){case 0:case 11:case 15:hf(z,ee,xe,We,k),af(8,ee);break;case 23:break;case 22:var Pt=ee.stateNode;ee.memoizedState!==null?Pt._visibility&2?hf(z,ee,xe,We,k):Tp(z,ee):(Pt._visibility|=2,hf(z,ee,xe,We,k)),k&&mt&2048&&Fv(ee.alternate,ee);break;case 24:hf(z,ee,xe,We,k),k&&mt&2048&&Hm(ee.alternate,ee);break;default:hf(z,ee,xe,We,k)}h=h.sibling}}function Tp(c,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var y=c,T=h,k=T.flags;switch(T.tag){case 22:Tp(y,T),k&2048&&Fv(T.alternate,T);break;case 24:Tp(y,T),k&2048&&Hm(T.alternate,T);break;default:Tp(y,T)}h=h.sibling}}var dc=8192;function df(c,h,y){if(c.subtreeFlags&dc)for(c=c.child;c!==null;)Gb(c,h,y),c=c.sibling}function Gb(c,h,y){switch(c.tag){case 26:df(c,h,y),c.flags&dc&&c.memoizedState!==null&&k1(y,ko,c.memoizedState,c.memoizedProps);break;case 5:df(c,h,y);break;case 3:case 4:var T=ko;ko=wf(c.stateNode.containerInfo),df(c,h,y),ko=T;break;case 22:c.memoizedState===null&&(T=c.alternate,T!==null&&T.memoizedState!==null?(T=dc,dc=16777216,df(c,h,y),dc=T):df(c,h,y));break;default:df(c,h,y)}}function ff(c){var h=c.alternate;if(h!==null&&(c=h.child,c!==null)){h.child=null;do h=c.sibling,c.sibling=null,c=h;while(c!==null)}}function $h(c){var h=c.deletions;if((c.flags&16)!==0){if(h!==null)for(var y=0;y<h.length;y++){var T=h[y];Qr=T,Hb(T,c)}ff(c)}if(c.subtreeFlags&10256)for(c=c.child;c!==null;)Uv(c),c=c.sibling}function Uv(c){switch(c.tag){case 0:case 11:case 15:$h(c),c.flags&2048&&Qu(9,c,c.return);break;case 3:$h(c);break;case 12:$h(c);break;case 22:var h=c.stateNode;c.memoizedState!==null&&h._visibility&2&&(c.return===null||c.return.tag!==13)?(h._visibility&=-3,Wm(c)):$h(c);break;default:$h(c)}}function Wm(c){var h=c.deletions;if((c.flags&16)!==0){if(h!==null)for(var y=0;y<h.length;y++){var T=h[y];Qr=T,Hb(T,c)}ff(c)}for(c=c.child;c!==null;){switch(h=c,h.tag){case 0:case 11:case 15:Qu(8,h,h.return),Wm(h);break;case 22:y=h.stateNode,y._visibility&2&&(y._visibility&=-3,Wm(h));break;default:Wm(h)}c=c.sibling}}function Hb(c,h){for(;Qr!==null;){var y=Qr;switch(y.tag){case 0:case 11:case 15:Qu(8,y,h);break;case 23:case 22:if(y.memoizedState!==null&&y.memoizedState.cachePool!==null){var T=y.memoizedState.cachePool.pool;T!=null&&T.refCount++}break;case 24:Uc(y.memoizedState.cache)}if(T=y.child,T!==null)T.return=y,Qr=T;else e:for(y=c;Qr!==null;){T=Qr;var k=T.sibling,z=T.return;if(Vv(T),T===y){Qr=null;break e}if(k!==null){k.return=z,Qr=k;break e}Qr=z}}}var PE={getCacheForType:function(c){var h=Gs(_i),y=h.data.get(c);return y===void 0&&(y=c(),h.data.set(c,y)),y},cacheSignal:function(){return Gs(_i).controller.signal}},Wb=typeof WeakMap=="function"?WeakMap:Map,xi=0,Fi=null,Ur=null,Gr=0,Si=0,ja=null,Ju=!1,qh=!1,fc=!1,vs=0,xs=0,Kc=0,pf=0,jv=0,gl=0,Gh=0,Hh=null,pa=null,eh=!1,Wh=0,Xb=0,Iy=1/0,Ry=null,Xh=null,Xs=0,Zh=null,Ep=null,pc=0,$v=0,Kh=null,Zb=null,Xi=0,Sp=null;function $a(){return(xi&2)!==0&&Gr!==0?Gr&-Gr:Ie.T!==null?Oy():ir()}function Xm(){if(gl===0)if((Gr&536870912)===0||Or){var c=fe;fe<<=1,(fe&3932160)===0&&(fe=262144),gl=c}else gl=536870912;return c=_t.current,c!==null&&(c.flags|=32),gl}function Lo(c,h,y){(c===Fi&&(Si===2||Si===9)||c.cancelPendingCommit!==null)&&(Yh(c,0),Ol(c,Gr,gl,!1)),ct(c,y),((xi&2)===0||c!==Fi)&&(c===Fi&&((xi&2)===0&&(pf|=y),xs===4&&Ol(c,Gr,gl,!1)),qa(c))}function Cp(c,h,y){if((xi&6)!==0)throw Error(i(327));var T=!y&&(h&127)===0&&(h&c.expiredLanes)===0||Ge(c,h),k=T?Xv(c,h):Hv(c,h,!0),z=T;do{if(k===0){qh&&!T&&Ol(c,h,0,!1);break}else{if(y=c.current.alternate,z&&!Kb(y)){k=Hv(c,h,!1),z=!1;continue}if(k===2){if(z=h,c.errorRecoveryDisabledLanes&z)var ee=0;else ee=c.pendingLanes&-536870913,ee=ee!==0?ee:ee&536870912?536870912:0;if(ee!==0){h=ee;e:{var xe=c;k=Hh;var We=xe.current.memoizedState.isDehydrated;if(We&&(Yh(xe,ee).flags|=256),ee=Hv(xe,ee,!1),ee!==2){if(fc&&!We){xe.errorRecoveryDisabledLanes|=z,pf|=z,k=4;break e}z=pa,pa=k,z!==null&&(pa===null?pa=z:pa.push.apply(pa,z))}k=ee}if(z=!1,k!==2)continue}}if(k===1){Yh(c,0),Ol(c,h,0,!0);break}e:{switch(T=c,z=k,z){case 0:case 1:throw Error(i(345));case 4:if((h&4194048)!==h)break;case 6:Ol(T,h,gl,!Ju);break e;case 2:pa=null;break;case 3:case 5:break;default:throw Error(i(329))}if((h&62914560)===h&&(k=Wh+300-Xn(),10<k)){if(Ol(T,h,gl,!Ju),Ve(T,0,!0)!==0)break e;pc=h,T.timeoutHandle=v1(qv.bind(null,T,y,pa,Ry,eh,h,gl,pf,Gh,Ju,z,"Throttled",-0,0),k);break e}qv(T,y,pa,Ry,eh,h,gl,pf,Gh,Ju,z,null,-0,0)}}break}while(!0);qa(c)}function qv(c,h,y,T,k,z,ee,xe,We,mt,Pt,Ft,gt,Tt){if(c.timeoutHandle=-1,Ft=h.subtreeFlags,Ft&8192||(Ft&16785408)===16785408){Ft={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:So},Gb(h,z,Ft);var Mn=(z&62914560)===z?Wh-Xn():(z&4194048)===z?Xb-Xn():0;if(Mn=FE(Ft,Mn),Mn!==null){pc=z,c.cancelPendingCommit=Mn(n1.bind(null,c,h,z,y,T,k,ee,xe,We,Pt,Ft,null,gt,Tt)),Ol(c,z,ee,!mt);return}}n1(c,h,z,y,T,k,ee,xe,We)}function Kb(c){for(var h=c;;){var y=h.tag;if((y===0||y===11||y===15)&&h.flags&16384&&(y=h.updateQueue,y!==null&&(y=y.stores,y!==null)))for(var T=0;T<y.length;T++){var k=y[T],z=k.getSnapshot;k=k.value;try{if(!ca(z(),k))return!1}catch{return!1}}if(y=h.child,h.subtreeFlags&16384&&y!==null)y.return=h,h=y;else{if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function Ol(c,h,y,T){h&=~jv,h&=~pf,c.suspendedLanes|=h,c.pingedLanes&=~h,T&&(c.warmLanes|=h),T=c.expirationTimes;for(var k=h;0<k;){var z=31-$n(k),ee=1<<z;T[z]=-1,k&=~ee}y!==0&&en(c,y,h)}function Ap(){return(xi&6)===0?(kp(0),!1):!0}function Zm(){if(Ur!==null){if(Si===0)var c=Ur.return;else c=Ur,sc=Vc=null,vi(c),E=null,A=0,c=Ur;for(;c!==null;)bp(c.alternate,c),c=c.return;Ur=null}}function Yh(c,h){var y=c.timeoutHandle;y!==-1&&(c.timeoutHandle=-1,x1(y)),y=c.cancelPendingCommit,y!==null&&(c.cancelPendingCommit=null,y()),pc=0,Zm(),Fi=c,Ur=y=La(c.current,null),Gr=h,Si=0,ja=null,Ju=!1,qh=Ge(c,h),fc=!1,Gh=gl=jv=pf=Kc=xs=0,pa=Hh=null,eh=!1,(h&8)!==0&&(h|=h&32);var T=c.entangledLanes;if(T!==0)for(c=c.entanglements,T&=h;0<T;){var k=31-$n(T),z=1<<k;h|=c[k],T&=~z}return vs=h,ku(),y}function Yb(c,h){Bt=null,Ie.H=fl,h===zh||h===Bh?(h=p(),Si=3):h===Bm?(h=p(),Si=4):Si=h===Wu?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,ja=h,Ur===null&&(xs=1,Uh(c,rn(h,c.current)))}function Gv(){var c=_t.current;return c===null?!0:(Gr&4194048)===Gr?at===null:(Gr&62914560)===Gr||(Gr&536870912)!==0?c===at:!1}function Ip(){var c=Ie.H;return Ie.H=fl,c===null?fl:c}function Qb(){var c=Ie.A;return Ie.A=PE,c}function Rp(){xs=4,Ju||(Gr&4194048)!==Gr&&_t.current!==null||(qh=!0),(Kc&134217727)===0&&(pf&134217727)===0||Fi===null||Ol(Fi,Gr,gl,!1)}function Hv(c,h,y){var T=xi;xi|=2;var k=Ip(),z=Qb();(Fi!==c||Gr!==h)&&(Ry=null,Yh(c,h)),h=!1;var ee=xs;e:do try{if(Si!==0&&Ur!==null){var xe=Ur,We=ja;switch(Si){case 8:Zm(),ee=6;break e;case 3:case 2:case 9:case 6:_t.current===null&&(h=!0);var mt=Si;if(Si=0,ja=null,Mp(c,xe,We,mt),y&&qh){ee=0;break e}break;default:mt=Si,Si=0,ja=null,Mp(c,xe,We,mt)}}Wv(),ee=xs;break}catch(Pt){Yb(c,Pt)}while(!0);return h&&c.shellSuspendCounter++,sc=Vc=null,xi=T,Ie.H=k,Ie.A=z,Ur===null&&(Fi=null,Gr=0,ku()),ee}function Wv(){for(;Ur!==null;)Jb(Ur)}function Xv(c,h){var y=xi;xi|=2;var T=Ip(),k=Qb();Fi!==c||Gr!==h?(Ry=null,Iy=Xn()+500,Yh(c,h)):qh=Ge(c,h);e:do try{if(Si!==0&&Ur!==null){h=Ur;var z=ja;t:switch(Si){case 1:Si=0,ja=null,Mp(c,h,z,1);break;case 2:case 9:if(hp(z)){Si=0,ja=null,e1(h);break}h=function(){Si!==2&&Si!==9||Fi!==c||(Si=7),qa(c)},z.then(h,h);break e;case 3:Si=7;break e;case 4:Si=5;break e;case 7:hp(z)?(Si=0,ja=null,e1(h)):(Si=0,ja=null,Mp(c,h,z,7));break;case 5:var ee=null;switch(Ur.tag){case 26:ee=Ur.memoizedState;case 5:case 27:var xe=Ur;if(ee?b0(ee):xe.stateNode.complete){Si=0,ja=null;var We=xe.sibling;if(We!==null)Ur=We;else{var mt=xe.return;mt!==null?(Ur=mt,Py(mt)):Ur=null}break t}}Si=0,ja=null,Mp(c,h,z,5);break;case 6:Si=0,ja=null,Mp(c,h,z,6);break;case 8:Zm(),xs=6;break e;default:throw Error(i(462))}}My();break}catch(Pt){Yb(c,Pt)}while(!0);return sc=Vc=null,Ie.H=T,Ie.A=k,xi=y,Ur!==null?0:(Fi=null,Gr=0,ku(),xs)}function My(){for(;Ur!==null&&!mn();)Jb(Ur)}function Jb(c){var h=zv(c.alternate,c,vs);c.memoizedProps=c.pendingProps,h===null?Py(c):Ur=h}function e1(c){var h=c,y=h.alternate;switch(h.tag){case 15:case 0:h=gy(y,h,h.pendingProps,h.type,void 0,Gr);break;case 11:h=gy(y,h,h.pendingProps,h.type.render,h.ref,Gr);break;case 5:vi(h);default:bp(y,h),h=Ur=Ou(h,vs),h=zv(y,h,vs)}c.memoizedProps=c.pendingProps,h===null?Py(c):Ur=h}function Mp(c,h,y,T){sc=Vc=null,vi(h),E=null,A=0;var k=h.return;try{if(zb(c,k,h,y,Gr)){xs=1,Uh(c,rn(y,c.current)),Ur=null;return}}catch(z){if(k!==null)throw Ur=k,z;xs=1,Uh(c,rn(y,c.current)),Ur=null;return}h.flags&32768?(Or||T===1?c=!0:qh||(Gr&536870912)!==0?c=!1:(Ju=c=!0,(T===2||T===9||T===3||T===6)&&(T=_t.current,T!==null&&T.tag===13&&(T.flags|=16384))),t1(h,c)):Py(h)}function Py(c){var h=c;do{if((h.flags&32768)!==0){t1(h,Ju);return}c=h.return;var y=xy(h.alternate,h,vs);if(y!==null){Ur=y;return}if(h=h.sibling,h!==null){Ur=h;return}Ur=h=c}while(h!==null);xs===0&&(xs=5)}function t1(c,h){do{var y=Fb(c.alternate,c);if(y!==null){y.flags&=32767,Ur=y;return}if(y=c.return,y!==null&&(y.flags|=32768,y.subtreeFlags=0,y.deletions=null),!h&&(c=c.sibling,c!==null)){Ur=c;return}Ur=c=y}while(c!==null);xs=6,Ur=null}function n1(c,h,y,T,k,z,ee,xe,We){c.cancelPendingCommit=null;do ky();while(Xs!==0);if((xi&6)!==0)throw Error(i(327));if(h!==null){if(h===c.current)throw Error(i(177));if(z=h.lanes|h.childLanes,z|=Ph,Xt(c,y,z,ee,xe,We),c===Fi&&(Ur=Fi=null,Gr=0),Ep=h,Zh=c,pc=y,$v=z,Kh=k,Zb=T,(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?(c.callbackNode=null,c.callbackPriority=0,Ly(_n,function(){return i1(),null})):(c.callbackNode=null,c.callbackPriority=0),T=(h.flags&13878)!==0,(h.subtreeFlags&13878)!==0||T){T=Ie.T,Ie.T=null,k=Je.p,Je.p=2,ee=xi,xi|=4;try{jb(c,h,y)}finally{xi=ee,Je.p=k,Ie.T=T}}Xs=1,Km(),r1(),Zv()}}function Km(){if(Xs===1){Xs=0;var c=Zh,h=Ep,y=(h.flags&13878)!==0;if((h.subtreeFlags&13878)!==0||y){y=Ie.T,Ie.T=null;var T=Je.p;Je.p=2;var k=xi;xi|=4;try{Gm(h,c);var z=eg,ee=tp(c.containerInfo),xe=z.focusedElem,We=z.selectionRange;if(ee!==xe&&xe&&xe.ownerDocument&&Rm(xe.ownerDocument.documentElement,xe)){if(We!==null&&Mm(xe)){var mt=We.start,Pt=We.end;if(Pt===void 0&&(Pt=mt),"selectionStart"in xe)xe.selectionStart=mt,xe.selectionEnd=Math.min(Pt,xe.value.length);else{var Ft=xe.ownerDocument||document,gt=Ft&&Ft.defaultView||window;if(gt.getSelection){var Tt=gt.getSelection(),Mn=xe.textContent.length,Yn=Math.min(We.start,Mn),wi=We.end===void 0?Yn:Math.min(We.end,Mn);!Tt.extend&&Yn>wi&&(ee=wi,wi=Yn,Yn=ee);var it=Ch(xe,Yn),Ke=Ch(xe,wi);if(it&&Ke&&(Tt.rangeCount!==1||Tt.anchorNode!==it.node||Tt.anchorOffset!==it.offset||Tt.focusNode!==Ke.node||Tt.focusOffset!==Ke.offset)){var ft=Ft.createRange();ft.setStart(it.node,it.offset),Tt.removeAllRanges(),Yn>wi?(Tt.addRange(ft),Tt.extend(Ke.node,Ke.offset)):(ft.setEnd(Ke.node,Ke.offset),Tt.addRange(ft))}}}}for(Ft=[],Tt=xe;Tt=Tt.parentNode;)Tt.nodeType===1&&Ft.push({element:Tt,left:Tt.scrollLeft,top:Tt.scrollTop});for(typeof xe.focus=="function"&&xe.focus(),xe=0;xe<Ft.length;xe++){var kt=Ft[xe];kt.element.scrollLeft=kt.left,kt.element.scrollTop=kt.top}}Af=!!yl,eg=yl=null}finally{xi=k,Je.p=T,Ie.T=y}}c.current=h,Xs=2}}function r1(){if(Xs===2){Xs=0;var c=Zh,h=Ep,y=(h.flags&8772)!==0;if((h.subtreeFlags&8772)!==0||y){y=Ie.T,Ie.T=null;var T=Je.p;Je.p=2;var k=xi;xi|=4;try{Ws(c,h.alternate,h)}finally{xi=k,Je.p=T,Ie.T=y}}Xs=3}}function Zv(){if(Xs===4||Xs===3){Xs=0,ti();var c=Zh,h=Ep,y=pc,T=Zb;(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?Xs=5:(Xs=0,Ep=Zh=null,mf(c,c.pendingLanes));var k=c.pendingLanes;if(k===0&&(Xh=null),Hn(y),h=h.stateNode,_r&&typeof _r.onCommitFiberRoot=="function")try{_r.onCommitFiberRoot(tr,h,void 0,(h.current.flags&128)===128)}catch{}if(T!==null){h=Ie.T,k=Je.p,Je.p=2,Ie.T=null;try{for(var z=c.onRecoverableError,ee=0;ee<T.length;ee++){var xe=T[ee];z(xe.value,{componentStack:xe.stack})}}finally{Ie.T=h,Je.p=k}}(pc&3)!==0&&ky(),qa(c),k=c.pendingLanes,(y&261930)!==0&&(k&42)!==0?c===Sp?Xi++:(Xi=0,Sp=c):Xi=0,kp(0)}}function mf(c,h){(c.pooledCacheLanes&=h)===0&&(h=c.pooledCache,h!=null&&(c.pooledCache=null,Uc(h)))}function ky(){return Km(),r1(),Zv(),i1()}function i1(){if(Xs!==5)return!1;var c=Zh,h=$v;$v=0;var y=Hn(pc),T=Ie.T,k=Je.p;try{Je.p=32>y?32:y,Ie.T=null,y=Kh,Kh=null;var z=Zh,ee=pc;if(Xs=0,Ep=Zh=null,pc=0,(xi&6)!==0)throw Error(i(331));var xe=xi;if(xi|=4,Uv(z.current),Ay(z,z.current,ee,y),xi=xe,kp(0,!1),_r&&typeof _r.onPostCommitFiberRoot=="function")try{_r.onPostCommitFiberRoot(tr,z)}catch{}return!0}finally{Je.p=k,Ie.T=T,mf(c,h)}}function s1(c,h,y){h=rn(y,h),h=Cv(c.stateNode,h,2),c=Ce(c,h,2),c!==null&&(ct(c,2),qa(c))}function Ci(c,h,y){if(c.tag===3)s1(c,c,y);else for(;h!==null;){if(h.tag===3){s1(h,c,y);break}else if(h.tag===1){var T=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof T.componentDidCatch=="function"&&(Xh===null||!Xh.has(T))){c=rn(y,c),y=Ob(2),T=Ce(h,y,2),T!==null&&(Av(y,T,h,c),ct(T,2),qa(T));break}}h=h.return}}function Dy(c,h,y){var T=c.pingCache;if(T===null){T=c.pingCache=new Wb;var k=new Set;T.set(h,k)}else k=T.get(h),k===void 0&&(k=new Set,T.set(h,k));k.has(y)||(fc=!0,k.add(y),c=kE.bind(null,c,h,y),h.then(c,c))}function kE(c,h,y){var T=c.pingCache;T!==null&&T.delete(h),c.pingedLanes|=c.suspendedLanes&y,c.warmLanes&=~y,Fi===c&&(Gr&y)===y&&(xs===4||xs===3&&(Gr&62914560)===Gr&&300>Xn()-Wh?(xi&2)===0&&Yh(c,0):jv|=y,Gh===Gr&&(Gh=0)),qa(c)}function o1(c,h){h===0&&(h=Xe()),c=zc(c,h),c!==null&&(ct(c,h),qa(c))}function DE(c){var h=c.memoizedState,y=0;h!==null&&(y=h.retryLane),o1(c,y)}function Kv(c,h){var y=0;switch(c.tag){case 31:case 13:var T=c.stateNode,k=c.memoizedState;k!==null&&(y=k.retryLane);break;case 19:T=c.stateNode;break;case 22:T=c.stateNode._retryCache;break;default:throw Error(i(314))}T!==null&&T.delete(h),o1(c,y)}function Ly(c,h){return bn(c,h)}var gf=null,Pp=null,Yv=!1,Qh=!1,yf=!1,th=0;function qa(c){c!==Pp&&c.next===null&&(Pp===null?gf=Pp=c:Pp=Pp.next=c),Qh=!0,Yv||(Yv=!0,a1())}function kp(c,h){if(!yf&&Qh){yf=!0;do for(var y=!1,T=gf;T!==null;){if(c!==0){var k=T.pendingLanes;if(k===0)var z=0;else{var ee=T.suspendedLanes,xe=T.pingedLanes;z=(1<<31-$n(42|c)+1)-1,z&=k&~(ee&~xe),z=z&201326741?z&201326741|1:z?z|2:0}z!==0&&(y=!0,t0(T,z))}else z=Gr,z=Ve(T,T===Fi?z:0,T.cancelPendingCommit!==null||T.timeoutHandle!==-1),(z&3)===0||Ge(T,z)||(y=!0,t0(T,z));T=T.next}while(y);yf=!1}}function LE(){Qv()}function Qv(){Qh=Yv=!1;var c=0;th!==0&&zE()&&(c=th);for(var h=Xn(),y=null,T=gf;T!==null;){var k=T.next,z=Jv(T,h);z===0?(T.next=null,y===null?gf=k:y.next=k,k===null&&(Pp=y)):(y=T,(c!==0||(z&3)!==0)&&(Qh=!0)),T=k}Xs!==0&&Xs!==5||kp(c),th!==0&&(th=0)}function Jv(c,h){for(var y=c.suspendedLanes,T=c.pingedLanes,k=c.expirationTimes,z=c.pendingLanes&-62914561;0<z;){var ee=31-$n(z),xe=1<<ee,We=k[ee];We===-1?((xe&y)===0||(xe&T)!==0)&&(k[ee]=nt(xe,h)):We<=h&&(c.expiredLanes|=xe),z&=~xe}if(h=Fi,y=Gr,y=Ve(c,c===h?y:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),T=c.callbackNode,y===0||c===h&&(Si===2||Si===9)||c.cancelPendingCommit!==null)return T!==null&&T!==null&&zn(T),c.callbackNode=null,c.callbackPriority=0;if((y&3)===0||Ge(c,y)){if(h=y&-y,h===c.callbackPriority)return h;switch(T!==null&&zn(T),Hn(y)){case 2:case 8:y=yn;break;case 32:y=_n;break;case 268435456:y=Bn;break;default:y=_n}return T=e0.bind(null,c),y=bn(y,T),c.callbackPriority=h,c.callbackNode=y,h}return T!==null&&T!==null&&zn(T),c.callbackPriority=2,c.callbackNode=null,2}function e0(c,h){if(Xs!==0&&Xs!==5)return c.callbackNode=null,c.callbackPriority=0,null;var y=c.callbackNode;if(ky()&&c.callbackNode!==y)return null;var T=Gr;return T=Ve(c,c===Fi?T:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),T===0?null:(Cp(c,T,h),Jv(c,Xn()),c.callbackNode!=null&&c.callbackNode===y?e0.bind(null,c):null)}function t0(c,h){if(ky())return null;Cp(c,h,!0)}function a1(){b1(function(){(xi&6)!==0?bn(Jt,LE):Qv()})}function Oy(){if(th===0){var c=jc;c===0&&(c=Oe,Oe<<=1,(Oe&261888)===0&&(Oe=256)),th=c}return th}function l1(c){return c==null||typeof c=="symbol"||typeof c=="boolean"?null:typeof c=="function"?c:Eu(""+c)}function c1(c,h){var y=h.ownerDocument.createElement("input");return y.name=h.name,y.value=h.value,c.id&&y.setAttribute("form",c.id),h.parentNode.insertBefore(y,h),c=new FormData(c),y.parentNode.removeChild(y),c}function u1(c,h,y,T,k){if(h==="submit"&&y&&y.stateNode===k){var z=l1((k[Xr]||null).action),ee=T.submitter;ee&&(h=(h=ee[Xr]||null)?l1(h.formAction):ee.getAttribute("formAction"),h!==null&&(z=h,ee=null));var xe=new sa("action","action",null,T,k);c.push({event:xe,listeners:[{instance:null,listener:function(){if(T.defaultPrevented){if(th!==0){var We=ee?c1(k,ee):new FormData(k);dl(y,{pending:!0,data:We,method:k.method,action:z},null,We)}}else typeof z=="function"&&(xe.preventDefault(),We=ee?c1(k,ee):new FormData(k),dl(y,{pending:!0,data:We,method:k.method,action:z},z,We))},currentTarget:k}]})}}for(var Dp=0;Dp<Wo.length;Dp++){var zy=Wo[Dp],Yo=zy.toLowerCase(),Ym=zy[0].toUpperCase()+zy.slice(1);Ro(Yo,"on"+Ym)}Ro(ey,"onAnimationEnd"),Ro(Lm,"onAnimationIteration"),Ro(qd,"onAnimationStart"),Ro("dblclick","onDoubleClick"),Ro("focusin","onFocus"),Ro("focusout","onBlur"),Ro(Mh,"onTransitionRun"),Ro(ty,"onTransitionStart"),Ro(ny,"onTransitionCancel"),Ro(Al,"onTransitionEnd"),Ea("onMouseEnter",["mouseout","mouseover"]),Ea("onMouseLeave",["mouseout","mouseover"]),Ea("onPointerEnter",["pointerout","pointerover"]),Ea("onPointerLeave",["pointerout","pointerover"]),Ta("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ta("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ta("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ta("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ta("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ta("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qm=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Yc));function n0(c,h){h=(h&4)!==0;for(var y=0;y<c.length;y++){var T=c[y],k=T.event;T=T.listeners;e:{var z=void 0;if(h)for(var ee=T.length-1;0<=ee;ee--){var xe=T[ee],We=xe.instance,mt=xe.currentTarget;if(xe=xe.listener,We!==z&&k.isPropagationStopped())break e;z=xe,k.currentTarget=mt;try{z(k)}catch(Pt){Hd(Pt)}k.currentTarget=null,z=We}else for(ee=0;ee<T.length;ee++){if(xe=T[ee],We=xe.instance,mt=xe.currentTarget,xe=xe.listener,We!==z&&k.isPropagationStopped())break e;z=xe,k.currentTarget=mt;try{z(k)}catch(Pt){Hd(Pt)}k.currentTarget=null,z=We}}}}function zr(c,h){var y=h[Eo];y===void 0&&(y=h[Eo]=new Set);var T=c+"__bubble";y.has(T)||(h1(h,c,2,!1),y.add(T))}function r0(c,h,y){var T=0;h&&(T|=4),h1(y,c,T,h)}var By="_reactListening"+Math.random().toString(36).slice(2);function i0(c){if(!c[By]){c[By]=!0,jo.forEach(function(y){y!=="selectionchange"&&(Qm.has(y)||r0(y,!1,c),r0(y,!0,c))});var h=c.nodeType===9?c:c.ownerDocument;h===null||h[By]||(h[By]=!0,r0("selectionchange",!1,h))}}function h1(c,h,y,T){switch(If(h)){case 2:var k=qy;break;case 8:k=UE;break;default:k=T0}y=k.bind(null,h,y,c),k=void 0,!Mc||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(k=!0),T?k!==void 0?c.addEventListener(h,y,{capture:!0,passive:k}):c.addEventListener(h,y,!0):k!==void 0?c.addEventListener(h,y,{passive:k}):c.addEventListener(h,y,!1)}function s0(c,h,y,T,k){var z=T;if((h&1)===0&&(h&2)===0&&T!==null)e:for(;;){if(T===null)return;var ee=T.tag;if(ee===3||ee===4){var xe=T.stateNode.containerInfo;if(xe===k)break;if(ee===4)for(ee=T.return;ee!==null;){var We=ee.tag;if((We===3||We===4)&&ee.stateNode.containerInfo===k)return;ee=ee.return}for(;xe!==null;){if(ee=vr(xe),ee===null)return;if(We=ee.tag,We===5||We===6||We===26||We===27){T=z=ee;continue e}xe=xe.parentNode}}T=T.return}Sl(function(){var mt=z,Pt=Co(y),Ft=[];e:{var gt=Gd.get(c);if(gt!==void 0){var Tt=sa,Mn=c;switch(c){case"keypress":if(is(y)===0)break e;case"keydown":case"keyup":Tt=Th;break;case"focusin":Mn="focus",Tt=Ra;break;case"focusout":Mn="blur",Tt=Ra;break;case"beforeblur":case"afterblur":Tt=Ra;break;case"click":if(y.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Tt=aa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Tt=Ia;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Tt=H;break;case ey:case Lm:case qd:Tt=Vd;break;case Al:Tt=Ae;break;case"scroll":case"scrollend":Tt=Su;break;case"wheel":Tt=yt;break;case"copy":case"cut":case"paste":Tt=xh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Tt=Ma;break;case"toggle":case"beforetoggle":Tt=gr}var Yn=(h&4)!==0,wi=!Yn&&(c==="scroll"||c==="scrollend"),it=Yn?gt!==null?gt+"Capture":null:gt;Yn=[];for(var Ke=mt,ft;Ke!==null;){var kt=Ke;if(ft=kt.stateNode,kt=kt.tag,kt!==5&&kt!==26&&kt!==27||ft===null||it===null||(kt=Yi(Ke,it),kt!=null&&Yn.push(Jm(Ke,kt,ft))),wi)break;Ke=Ke.return}0<Yn.length&&(gt=new Tt(gt,Mn,null,y,Pt),Ft.push({event:gt,listeners:Yn}))}}if((h&7)===0){e:{if(gt=c==="mouseover"||c==="pointerover",Tt=c==="mouseout"||c==="pointerout",gt&&y!==Xl&&(Mn=y.relatedTarget||y.fromElement)&&(vr(Mn)||Mn[mi]))break e;if((Tt||gt)&&(gt=Pt.window===Pt?Pt:(gt=Pt.ownerDocument)?gt.defaultView||gt.parentWindow:window,Tt?(Mn=y.relatedTarget||y.toElement,Tt=mt,Mn=Mn?vr(Mn):null,Mn!==null&&(wi=f(Mn),Yn=Mn.tag,Mn!==wi||Yn!==5&&Yn!==27&&Yn!==6)&&(Mn=null)):(Tt=null,Mn=mt),Tt!==Mn)){if(Yn=aa,kt="onMouseLeave",it="onMouseEnter",Ke="mouse",(c==="pointerout"||c==="pointerover")&&(Yn=Ma,kt="onPointerLeave",it="onPointerEnter",Ke="pointer"),wi=Tt==null?gt:$s(Tt),ft=Mn==null?gt:$s(Mn),gt=new Yn(kt,Ke+"leave",Tt,y,Pt),gt.target=wi,gt.relatedTarget=ft,kt=null,vr(Pt)===mt&&(Yn=new Yn(it,Ke+"enter",Mn,y,Pt),Yn.target=ft,Yn.relatedTarget=wi,kt=Yn),wi=kt,Tt&&Mn)t:{for(Yn=OE,it=Tt,Ke=Mn,ft=0,kt=it;kt;kt=Yn(kt))ft++;kt=0;for(var Zn=Ke;Zn;Zn=Yn(Zn))kt++;for(;0<ft-kt;)it=Yn(it),ft--;for(;0<kt-ft;)Ke=Yn(Ke),kt--;for(;ft--;){if(it===Ke||Ke!==null&&it===Ke.alternate){Yn=it;break t}it=Yn(it),Ke=Yn(Ke)}Yn=null}else Yn=null;Tt!==null&&o0(Ft,gt,Tt,Yn,!1),Mn!==null&&wi!==null&&o0(Ft,wi,Mn,Yn,!0)}}e:{if(gt=mt?$s(mt):window,Tt=gt.nodeName&&gt.nodeName.toLowerCase(),Tt==="select"||Tt==="input"&&gt.type==="file")var ii=Yg;else if(Kf(gt))if(Eh)ii=Qg;else{ii=Am;var jn=Jf}else Tt=gt.nodeName,!Tt||Tt.toLowerCase()!=="input"||gt.type!=="checkbox"&&gt.type!=="radio"?mt&&Tl(mt.elementType)&&(ii=Yg):ii=ep;if(ii&&(ii=ii(c,mt))){Yf(Ft,ii,y,Pt);break e}jn&&jn(c,gt,mt),c==="focusout"&&mt&&gt.type==="number"&&mt.memoizedProps.value!=null&&or(gt,"number",gt.value)}switch(jn=mt?$s(mt):window,c){case"focusin":(Kf(jn)||jn.contentEditable==="true")&&(Ru=jn,Mu=mt,Ah=null);break;case"focusout":Ah=Mu=Ru=null;break;case"mousedown":Ih=!0;break;case"contextmenu":case"mouseup":case"dragend":Ih=!1,km(Ft,y,Pt);break;case"selectionchange":if(Pm)break;case"keydown":case"keyup":km(Ft,y,Pt)}var xr;if($r)e:{switch(c){case"compositionstart":var Hr="onCompositionStart";break e;case"compositionend":Hr="onCompositionEnd";break e;case"compositionupdate":Hr="onCompositionUpdate";break e}Hr=void 0}else Dc?kc(c,y)&&(Hr="onCompositionEnd"):c==="keydown"&&y.keyCode===229&&(Hr="onCompositionStart");Hr&&(Ho&&y.locale!=="ko"&&(Dc||Hr!=="onCompositionStart"?Hr==="onCompositionEnd"&&Dc&&(xr=nl()):(ri=Pt,Zl="value"in ri?ri.value:ri.textContent,Dc=!0)),jn=_f(mt,Hr),0<jn.length&&(Hr=new Io(Hr,c,null,y,Pt),Ft.push({event:Hr,listeners:jn}),xr?Hr.data=xr:(xr=ka(y),xr!==null&&(Hr.data=xr)))),(xr=nr?uv(c,y):hv(c,y))&&(Hr=_f(mt,"onBeforeInput"),0<Hr.length&&(jn=new Io("onBeforeInput","beforeinput",null,y,Pt),Ft.push({event:jn,listeners:Hr}),jn.data=xr)),u1(Ft,c,mt,y,Pt)}n0(Ft,h)})}function Jm(c,h,y){return{instance:c,listener:h,currentTarget:y}}function _f(c,h){for(var y=h+"Capture",T=[];c!==null;){var k=c,z=k.stateNode;if(k=k.tag,k!==5&&k!==26&&k!==27||z===null||(k=Yi(c,y),k!=null&&T.unshift(Jm(c,k,z)),k=Yi(c,h),k!=null&&T.push(Jm(c,k,z))),c.tag===3)return T;c=c.return}return[]}function OE(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5&&c.tag!==27);return c||null}function o0(c,h,y,T,k){for(var z=h._reactName,ee=[];y!==null&&y!==T;){var xe=y,We=xe.alternate,mt=xe.stateNode;if(xe=xe.tag,We!==null&&We===T)break;xe!==5&&xe!==26&&xe!==27||mt===null||(We=mt,k?(mt=Yi(y,z),mt!=null&&ee.unshift(Jm(y,mt,We))):k||(mt=Yi(y,z),mt!=null&&ee.push(Jm(y,mt,We)))),y=y.return}ee.length!==0&&c.push({event:h,listeners:ee})}var d1=/\r\n?/g,f1=/\u0000|\uFFFD/g;function p1(c){return(typeof c=="string"?c:""+c).replace(d1,`
`).replace(f1,"")}function m1(c,h){return h=p1(h),p1(c)===h}function Ui(c,h,y,T,k,z){switch(y){case"children":typeof T=="string"?h==="body"||h==="textarea"&&T===""||Hi(c,T):(typeof T=="number"||typeof T=="bigint")&&h!=="body"&&Hi(c,""+T);break;case"className":Zr(c,"class",T);break;case"tabIndex":Zr(c,"tabindex",T);break;case"dir":case"role":case"viewBox":case"width":case"height":Zr(c,y,T);break;case"style":na(c,T,z);break;case"data":if(h!=="object"){Zr(c,"data",T);break}case"src":case"href":if(T===""&&(h!=="a"||y!=="href")){c.removeAttribute(y);break}if(T==null||typeof T=="function"||typeof T=="symbol"||typeof T=="boolean"){c.removeAttribute(y);break}T=Eu(""+T),c.setAttribute(y,T);break;case"action":case"formAction":if(typeof T=="function"){c.setAttribute(y,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof z=="function"&&(y==="formAction"?(h!=="input"&&Ui(c,h,"name",k.name,k,null),Ui(c,h,"formEncType",k.formEncType,k,null),Ui(c,h,"formMethod",k.formMethod,k,null),Ui(c,h,"formTarget",k.formTarget,k,null)):(Ui(c,h,"encType",k.encType,k,null),Ui(c,h,"method",k.method,k,null),Ui(c,h,"target",k.target,k,null)));if(T==null||typeof T=="symbol"||typeof T=="boolean"){c.removeAttribute(y);break}T=Eu(""+T),c.setAttribute(y,T);break;case"onClick":T!=null&&(c.onclick=So);break;case"onScroll":T!=null&&zr("scroll",c);break;case"onScrollEnd":T!=null&&zr("scrollend",c);break;case"dangerouslySetInnerHTML":if(T!=null){if(typeof T!="object"||!("__html"in T))throw Error(i(61));if(y=T.__html,y!=null){if(k.children!=null)throw Error(i(60));c.innerHTML=y}}break;case"multiple":c.multiple=T&&typeof T!="function"&&typeof T!="symbol";break;case"muted":c.muted=T&&typeof T!="function"&&typeof T!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(T==null||typeof T=="function"||typeof T=="boolean"||typeof T=="symbol"){c.removeAttribute("xlink:href");break}y=Eu(""+T),c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",y);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":T!=null&&typeof T!="function"&&typeof T!="symbol"?c.setAttribute(y,""+T):c.removeAttribute(y);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":T&&typeof T!="function"&&typeof T!="symbol"?c.setAttribute(y,""):c.removeAttribute(y);break;case"capture":case"download":T===!0?c.setAttribute(y,""):T!==!1&&T!=null&&typeof T!="function"&&typeof T!="symbol"?c.setAttribute(y,T):c.removeAttribute(y);break;case"cols":case"rows":case"size":case"span":T!=null&&typeof T!="function"&&typeof T!="symbol"&&!isNaN(T)&&1<=T?c.setAttribute(y,T):c.removeAttribute(y);break;case"rowSpan":case"start":T==null||typeof T=="function"||typeof T=="symbol"||isNaN(T)?c.removeAttribute(y):c.setAttribute(y,T);break;case"popover":zr("beforetoggle",c),zr("toggle",c),$o(c,"popover",T);break;case"xlinkActuate":Dr(c,"http://www.w3.org/1999/xlink","xlink:actuate",T);break;case"xlinkArcrole":Dr(c,"http://www.w3.org/1999/xlink","xlink:arcrole",T);break;case"xlinkRole":Dr(c,"http://www.w3.org/1999/xlink","xlink:role",T);break;case"xlinkShow":Dr(c,"http://www.w3.org/1999/xlink","xlink:show",T);break;case"xlinkTitle":Dr(c,"http://www.w3.org/1999/xlink","xlink:title",T);break;case"xlinkType":Dr(c,"http://www.w3.org/1999/xlink","xlink:type",T);break;case"xmlBase":Dr(c,"http://www.w3.org/XML/1998/namespace","xml:base",T);break;case"xmlLang":Dr(c,"http://www.w3.org/XML/1998/namespace","xml:lang",T);break;case"xmlSpace":Dr(c,"http://www.w3.org/XML/1998/namespace","xml:space",T);break;case"is":$o(c,"is",T);break;case"innerText":case"textContent":break;default:(!(2<y.length)||y[0]!=="o"&&y[0]!=="O"||y[1]!=="n"&&y[1]!=="N")&&(y=Ic.get(y)||y,$o(c,y,T))}}function a0(c,h,y,T,k,z){switch(y){case"style":na(c,T,z);break;case"dangerouslySetInnerHTML":if(T!=null){if(typeof T!="object"||!("__html"in T))throw Error(i(61));if(y=T.__html,y!=null){if(k.children!=null)throw Error(i(60));c.innerHTML=y}}break;case"children":typeof T=="string"?Hi(c,T):(typeof T=="number"||typeof T=="bigint")&&Hi(c,""+T);break;case"onScroll":T!=null&&zr("scroll",c);break;case"onScrollEnd":T!=null&&zr("scrollend",c);break;case"onClick":T!=null&&(c.onclick=So);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ea.hasOwnProperty(y))e:{if(y[0]==="o"&&y[1]==="n"&&(k=y.endsWith("Capture"),h=y.slice(2,k?y.length-7:void 0),z=c[Xr]||null,z=z!=null?z[y]:null,typeof z=="function"&&c.removeEventListener(h,z,k),typeof T=="function")){typeof z!="function"&&z!==null&&(y in c?c[y]=null:c.hasAttribute(y)&&c.removeAttribute(y)),c.addEventListener(h,T,k);break e}y in c?c[y]=T:T===!0?c.setAttribute(y,""):$o(c,y,T)}}}function Oo(c,h,y){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":zr("error",c),zr("load",c);var T=!1,k=!1,z;for(z in y)if(y.hasOwnProperty(z)){var ee=y[z];if(ee!=null)switch(z){case"src":T=!0;break;case"srcSet":k=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,h));default:Ui(c,h,z,ee,y,null)}}k&&Ui(c,h,"srcSet",y.srcSet,y,null),T&&Ui(c,h,"src",y.src,y,null);return;case"input":zr("invalid",c);var xe=z=ee=k=null,We=null,mt=null;for(T in y)if(y.hasOwnProperty(T)){var Pt=y[T];if(Pt!=null)switch(T){case"name":k=Pt;break;case"type":ee=Pt;break;case"checked":We=Pt;break;case"defaultChecked":mt=Pt;break;case"value":z=Pt;break;case"defaultValue":xe=Pt;break;case"children":case"dangerouslySetInnerHTML":if(Pt!=null)throw Error(i(137,h));break;default:Ui(c,h,T,Pt,y,null)}}qo(c,z,xe,We,mt,ee,k,!1);return;case"select":zr("invalid",c),T=ee=z=null;for(k in y)if(y.hasOwnProperty(k)&&(xe=y[k],xe!=null))switch(k){case"value":z=xe;break;case"defaultValue":ee=xe;break;case"multiple":T=xe;default:Ui(c,h,k,xe,y,null)}h=z,y=ee,c.multiple=!!T,h!=null?ys(c,!!T,h,!1):y!=null&&ys(c,!!T,y,!0);return;case"textarea":zr("invalid",c),z=k=T=null;for(ee in y)if(y.hasOwnProperty(ee)&&(xe=y[ee],xe!=null))switch(ee){case"value":T=xe;break;case"defaultValue":k=xe;break;case"children":z=xe;break;case"dangerouslySetInnerHTML":if(xe!=null)throw Error(i(91));break;default:Ui(c,h,ee,xe,y,null)}Go(c,T,k,z);return;case"option":for(We in y)if(y.hasOwnProperty(We)&&(T=y[We],T!=null))switch(We){case"selected":c.selected=T&&typeof T!="function"&&typeof T!="symbol";break;default:Ui(c,h,We,T,y,null)}return;case"dialog":zr("beforetoggle",c),zr("toggle",c),zr("cancel",c),zr("close",c);break;case"iframe":case"object":zr("load",c);break;case"video":case"audio":for(T=0;T<Yc.length;T++)zr(Yc[T],c);break;case"image":zr("error",c),zr("load",c);break;case"details":zr("toggle",c);break;case"embed":case"source":case"link":zr("error",c),zr("load",c);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(mt in y)if(y.hasOwnProperty(mt)&&(T=y[mt],T!=null))switch(mt){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,h));default:Ui(c,h,mt,T,y,null)}return;default:if(Tl(h)){for(Pt in y)y.hasOwnProperty(Pt)&&(T=y[Pt],T!==void 0&&a0(c,h,Pt,T,y,void 0));return}}for(xe in y)y.hasOwnProperty(xe)&&(T=y[xe],T!=null&&Ui(c,h,xe,T,y,null))}function g1(c,h,y,T){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var k=null,z=null,ee=null,xe=null,We=null,mt=null,Pt=null;for(Tt in y){var Ft=y[Tt];if(y.hasOwnProperty(Tt)&&Ft!=null)switch(Tt){case"checked":break;case"value":break;case"defaultValue":We=Ft;default:T.hasOwnProperty(Tt)||Ui(c,h,Tt,null,T,Ft)}}for(var gt in T){var Tt=T[gt];if(Ft=y[gt],T.hasOwnProperty(gt)&&(Tt!=null||Ft!=null))switch(gt){case"type":z=Tt;break;case"name":k=Tt;break;case"checked":mt=Tt;break;case"defaultChecked":Pt=Tt;break;case"value":ee=Tt;break;case"defaultValue":xe=Tt;break;case"children":case"dangerouslySetInnerHTML":if(Tt!=null)throw Error(i(137,h));break;default:Tt!==Ft&&Ui(c,h,gt,Tt,T,Ft)}}Ds(c,ee,xe,We,mt,Pt,z,k);return;case"select":Tt=ee=xe=gt=null;for(z in y)if(We=y[z],y.hasOwnProperty(z)&&We!=null)switch(z){case"value":break;case"multiple":Tt=We;default:T.hasOwnProperty(z)||Ui(c,h,z,null,T,We)}for(k in T)if(z=T[k],We=y[k],T.hasOwnProperty(k)&&(z!=null||We!=null))switch(k){case"value":gt=z;break;case"defaultValue":xe=z;break;case"multiple":ee=z;default:z!==We&&Ui(c,h,k,z,T,We)}h=xe,y=ee,T=Tt,gt!=null?ys(c,!!y,gt,!1):!!T!=!!y&&(h!=null?ys(c,!!y,h,!0):ys(c,!!y,y?[]:"",!1));return;case"textarea":Tt=gt=null;for(xe in y)if(k=y[xe],y.hasOwnProperty(xe)&&k!=null&&!T.hasOwnProperty(xe))switch(xe){case"value":break;case"children":break;default:Ui(c,h,xe,null,T,k)}for(ee in T)if(k=T[ee],z=y[ee],T.hasOwnProperty(ee)&&(k!=null||z!=null))switch(ee){case"value":gt=k;break;case"defaultValue":Tt=k;break;case"children":break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(i(91));break;default:k!==z&&Ui(c,h,ee,k,T,z)}Ac(c,gt,Tt);return;case"option":for(var Mn in y)if(gt=y[Mn],y.hasOwnProperty(Mn)&&gt!=null&&!T.hasOwnProperty(Mn))switch(Mn){case"selected":c.selected=!1;break;default:Ui(c,h,Mn,null,T,gt)}for(We in T)if(gt=T[We],Tt=y[We],T.hasOwnProperty(We)&&gt!==Tt&&(gt!=null||Tt!=null))switch(We){case"selected":c.selected=gt&&typeof gt!="function"&&typeof gt!="symbol";break;default:Ui(c,h,We,gt,T,Tt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Yn in y)gt=y[Yn],y.hasOwnProperty(Yn)&&gt!=null&&!T.hasOwnProperty(Yn)&&Ui(c,h,Yn,null,T,gt);for(mt in T)if(gt=T[mt],Tt=y[mt],T.hasOwnProperty(mt)&&gt!==Tt&&(gt!=null||Tt!=null))switch(mt){case"children":case"dangerouslySetInnerHTML":if(gt!=null)throw Error(i(137,h));break;default:Ui(c,h,mt,gt,T,Tt)}return;default:if(Tl(h)){for(var wi in y)gt=y[wi],y.hasOwnProperty(wi)&&gt!==void 0&&!T.hasOwnProperty(wi)&&a0(c,h,wi,void 0,T,gt);for(Pt in T)gt=T[Pt],Tt=y[Pt],!T.hasOwnProperty(Pt)||gt===Tt||gt===void 0&&Tt===void 0||a0(c,h,Pt,gt,T,Tt);return}}for(var it in y)gt=y[it],y.hasOwnProperty(it)&&gt!=null&&!T.hasOwnProperty(it)&&Ui(c,h,it,null,T,gt);for(Ft in T)gt=T[Ft],Tt=y[Ft],!T.hasOwnProperty(Ft)||gt===Tt||gt==null&&Tt==null||Ui(c,h,Ft,gt,T,Tt)}function y1(c){switch(c){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Zs(){if(typeof performance.getEntriesByType=="function"){for(var c=0,h=0,y=performance.getEntriesByType("resource"),T=0;T<y.length;T++){var k=y[T],z=k.transferSize,ee=k.initiatorType,xe=k.duration;if(z&&xe&&y1(ee)){for(ee=0,xe=k.responseEnd,T+=1;T<y.length;T++){var We=y[T],mt=We.startTime;if(mt>xe)break;var Pt=We.transferSize,Ft=We.initiatorType;Pt&&y1(Ft)&&(We=We.responseEnd,ee+=Pt*(We<xe?1:(xe-mt)/(We-mt)))}if(--T,h+=8*(z+ee)/(k.duration/1e3),c++,10<c)break}}if(0<c)return h/c/1e6}return navigator.connection&&(c=navigator.connection.downlink,typeof c=="number")?c:5}var yl=null,eg=null;function vf(c){return c.nodeType===9?c:c.ownerDocument}function xf(c){switch(c){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function _1(c,h){if(c===0)switch(h){case"svg":return 1;case"math":return 2;default:return 0}return c===1&&h==="foreignObject"?0:c}function l0(c,h){return c==="textarea"||c==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.children=="bigint"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var bf=null;function zE(){var c=window.event;return c&&c.type==="popstate"?c===bf?!1:(bf=c,!0):(bf=null,!1)}var v1=typeof setTimeout=="function"?setTimeout:void 0,x1=typeof clearTimeout=="function"?clearTimeout:void 0,c0=typeof Promise=="function"?Promise:void 0,b1=typeof queueMicrotask=="function"?queueMicrotask:typeof c0<"u"?function(c){return c0.resolve(null).then(c).catch(bi)}:v1;function bi(c){setTimeout(function(){throw c})}function Qc(c){return c==="head"}function u0(c,h){var y=h,T=0;do{var k=y.nextSibling;if(c.removeChild(y),k&&k.nodeType===8)if(y=k.data,y==="/$"||y==="/&"){if(T===0){c.removeChild(k),Vp(h);return}T--}else if(y==="$"||y==="$?"||y==="$~"||y==="$!"||y==="&")T++;else if(y==="html")Jh(c.ownerDocument.documentElement);else if(y==="head"){y=c.ownerDocument.head,Jh(y);for(var z=y.firstChild;z;){var ee=z.nextSibling,xe=z.nodeName;z[wl]||xe==="SCRIPT"||xe==="STYLE"||xe==="LINK"&&z.rel.toLowerCase()==="stylesheet"||y.removeChild(z),z=ee}}else y==="body"&&Jh(c.ownerDocument.body);y=k}while(y);Vp(h)}function h0(c,h){var y=c;c=0;do{var T=y.nextSibling;if(y.nodeType===1?h?(y._stashedDisplay=y.style.display,y.style.display="none"):(y.style.display=y._stashedDisplay||"",y.getAttribute("style")===""&&y.removeAttribute("style")):y.nodeType===3&&(h?(y._stashedText=y.nodeValue,y.nodeValue=""):y.nodeValue=y._stashedText||""),T&&T.nodeType===8)if(y=T.data,y==="/$"){if(c===0)break;c--}else y!=="$"&&y!=="$?"&&y!=="$~"&&y!=="$!"||c++;y=T}while(y)}function mc(c){var h=c.firstChild;for(h&&h.nodeType===10&&(h=h.nextSibling);h;){var y=h;switch(h=h.nextSibling,y.nodeName){case"HTML":case"HEAD":case"BODY":mc(y),wu(y);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(y.rel.toLowerCase()==="stylesheet")continue}c.removeChild(y)}}function Lp(c,h,y,T){for(;c.nodeType===1;){var k=y;if(c.nodeName.toLowerCase()!==h.toLowerCase()){if(!T&&(c.nodeName!=="INPUT"||c.type!=="hidden"))break}else if(T){if(!c[wl])switch(h){case"meta":if(!c.hasAttribute("itemprop"))break;return c;case"link":if(z=c.getAttribute("rel"),z==="stylesheet"&&c.hasAttribute("data-precedence"))break;if(z!==k.rel||c.getAttribute("href")!==(k.href==null||k.href===""?null:k.href)||c.getAttribute("crossorigin")!==(k.crossOrigin==null?null:k.crossOrigin)||c.getAttribute("title")!==(k.title==null?null:k.title))break;return c;case"style":if(c.hasAttribute("data-precedence"))break;return c;case"script":if(z=c.getAttribute("src"),(z!==(k.src==null?null:k.src)||c.getAttribute("type")!==(k.type==null?null:k.type)||c.getAttribute("crossorigin")!==(k.crossOrigin==null?null:k.crossOrigin))&&z&&c.hasAttribute("async")&&!c.hasAttribute("itemprop"))break;return c;default:return c}}else if(h==="input"&&c.type==="hidden"){var z=k.name==null?null:""+k.name;if(k.type==="hidden"&&c.getAttribute("name")===z)return c}else return c;if(c=zl(c.nextSibling),c===null)break}return null}function w1(c,h,y){if(h==="")return null;for(;c.nodeType!==3;)if((c.nodeType!==1||c.nodeName!=="INPUT"||c.type!=="hidden")&&!y||(c=zl(c.nextSibling),c===null))return null;return c}function T1(c,h){for(;c.nodeType!==8;)if((c.nodeType!==1||c.nodeName!=="INPUT"||c.type!=="hidden")&&!h||(c=zl(c.nextSibling),c===null))return null;return c}function d0(c){return c.data==="$?"||c.data==="$~"}function f0(c){return c.data==="$!"||c.data==="$?"&&c.ownerDocument.readyState!=="loading"}function BE(c,h){var y=c.ownerDocument;if(c.data==="$~")c._reactRetry=h;else if(c.data!=="$?"||y.readyState!=="loading")h();else{var T=function(){h(),y.removeEventListener("DOMContentLoaded",T)};y.addEventListener("DOMContentLoaded",T),c._reactRetry=T}}function zl(c){for(;c!=null;c=c.nextSibling){var h=c.nodeType;if(h===1||h===3)break;if(h===8){if(h=c.data,h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"||h==="F!"||h==="F")break;if(h==="/$"||h==="/&")return null}}return c}var p0=null;function E1(c){c=c.nextSibling;for(var h=0;c;){if(c.nodeType===8){var y=c.data;if(y==="/$"||y==="/&"){if(h===0)return zl(c.nextSibling);h--}else y!=="$"&&y!=="$!"&&y!=="$?"&&y!=="$~"&&y!=="&"||h++}c=c.nextSibling}return null}function S1(c){c=c.previousSibling;for(var h=0;c;){if(c.nodeType===8){var y=c.data;if(y==="$"||y==="$!"||y==="$?"||y==="$~"||y==="&"){if(h===0)return c;h--}else y!=="/$"&&y!=="/&"||h++}c=c.previousSibling}return null}function C1(c,h,y){switch(h=vf(y),c){case"html":if(c=h.documentElement,!c)throw Error(i(452));return c;case"head":if(c=h.head,!c)throw Error(i(453));return c;case"body":if(c=h.body,!c)throw Error(i(454));return c;default:throw Error(i(451))}}function Jh(c){for(var h=c.attributes;h.length;)c.removeAttributeNode(h[0]);wu(c)}var zo=new Map,m0=new Set;function wf(c){return typeof c.getRootNode=="function"?c.getRootNode():c.nodeType===9?c:c.ownerDocument}var gc=Je.d;Je.d={f:NE,r:VE,D:y0,C:ma,L:_0,m:A1,X:I1,S:_l,M:tg};function NE(){var c=gc.f(),h=Ap();return c||h}function VE(c){var h=Uo(c);h!==null&&h.tag===5&&h.type==="form"?Vh(h):gc.r(c)}var Op=typeof document>"u"?null:document;function g0(c,h,y){var T=Op;if(T&&typeof h=="string"&&h){var k=Wn(h);k='link[rel="'+c+'"][href="'+k+'"]',typeof y=="string"&&(k+='[crossorigin="'+y+'"]'),m0.has(k)||(m0.add(k),c={rel:c,crossOrigin:y,href:h},T.querySelector(k)===null&&(h=T.createElement("link"),Oo(h,"link",c),ts(h),T.head.appendChild(h)))}}function y0(c){gc.D(c),g0("dns-prefetch",c,null)}function ma(c,h){gc.C(c,h),g0("preconnect",c,h)}function _0(c,h,y){gc.L(c,h,y);var T=Op;if(T&&c&&h){var k='link[rel="preload"][as="'+Wn(h)+'"]';h==="image"&&y&&y.imageSrcSet?(k+='[imagesrcset="'+Wn(y.imageSrcSet)+'"]',typeof y.imageSizes=="string"&&(k+='[imagesizes="'+Wn(y.imageSizes)+'"]')):k+='[href="'+Wn(c)+'"]';var z=k;switch(h){case"style":z=ed(c);break;case"script":z=Ef(c)}zo.has(z)||(c=O({rel:"preload",href:h==="image"&&y&&y.imageSrcSet?void 0:c,as:h},y),zo.set(z,c),T.querySelector(k)!==null||h==="style"&&T.querySelector(td(z))||h==="script"&&T.querySelector(ng(z))||(h=T.createElement("link"),Oo(h,"link",c),ts(h),T.head.appendChild(h)))}}function A1(c,h){gc.m(c,h);var y=Op;if(y&&c){var T=h&&typeof h.as=="string"?h.as:"script",k='link[rel="modulepreload"][as="'+Wn(T)+'"][href="'+Wn(c)+'"]',z=k;switch(T){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":z=Ef(c)}if(!zo.has(z)&&(c=O({rel:"modulepreload",href:c},h),zo.set(z,c),y.querySelector(k)===null)){switch(T){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(y.querySelector(ng(z)))return}T=y.createElement("link"),Oo(T,"link",c),ts(T),y.head.appendChild(T)}}}function _l(c,h,y){gc.S(c,h,y);var T=Op;if(T&&c){var k=wa(T).hoistableStyles,z=ed(c);h=h||"default";var ee=k.get(z);if(!ee){var xe={loading:0,preload:null};if(ee=T.querySelector(td(z)))xe.loading=5;else{c=O({rel:"stylesheet",href:c,"data-precedence":h},y),(y=zo.get(z))&&ig(c,y);var We=ee=T.createElement("link");ts(We),Oo(We,"link",c),We._p=new Promise(function(mt,Pt){We.onload=mt,We.onerror=Pt}),We.addEventListener("load",function(){xe.loading|=1}),We.addEventListener("error",function(){xe.loading|=2}),xe.loading|=4,rg(ee,h,T)}ee={type:"stylesheet",instance:ee,count:1,state:xe},k.set(z,ee)}}}function I1(c,h){gc.X(c,h);var y=Op;if(y&&c){var T=wa(y).hoistableScripts,k=Ef(c),z=T.get(k);z||(z=y.querySelector(ng(k)),z||(c=O({src:c,async:!0},h),(h=zo.get(k))&&Ny(c,h),z=y.createElement("script"),ts(z),Oo(z,"link",c),y.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},T.set(k,z))}}function tg(c,h){gc.M(c,h);var y=Op;if(y&&c){var T=wa(y).hoistableScripts,k=Ef(c),z=T.get(k);z||(z=y.querySelector(ng(k)),z||(c=O({src:c,async:!0,type:"module"},h),(h=zo.get(k))&&Ny(c,h),z=y.createElement("script"),ts(z),Oo(z,"link",c),y.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},T.set(k,z))}}function Tf(c,h,y,T){var k=(k=Ut.current)?wf(k):null;if(!k)throw Error(i(446));switch(c){case"meta":case"title":return null;case"style":return typeof y.precedence=="string"&&typeof y.href=="string"?(h=ed(y.href),y=wa(k).hoistableStyles,T=y.get(h),T||(T={type:"style",instance:null,count:0,state:null},y.set(h,T)),T):{type:"void",instance:null,count:0,state:null};case"link":if(y.rel==="stylesheet"&&typeof y.href=="string"&&typeof y.precedence=="string"){c=ed(y.href);var z=wa(k).hoistableStyles,ee=z.get(c);if(ee||(k=k.ownerDocument||k,ee={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},z.set(c,ee),(z=k.querySelector(td(c)))&&!z._p&&(ee.instance=z,ee.state.loading=5),zo.has(c)||(y={rel:"preload",as:"style",href:y.href,crossOrigin:y.crossOrigin,integrity:y.integrity,media:y.media,hrefLang:y.hrefLang,referrerPolicy:y.referrerPolicy},zo.set(c,y),z||M1(k,c,y,ee.state))),h&&T===null)throw Error(i(528,""));return ee}if(h&&T!==null)throw Error(i(529,""));return null;case"script":return h=y.async,y=y.src,typeof y=="string"&&h&&typeof h!="function"&&typeof h!="symbol"?(h=Ef(y),y=wa(k).hoistableScripts,T=y.get(h),T||(T={type:"script",instance:null,count:0,state:null},y.set(h,T)),T):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,c))}}function ed(c){return'href="'+Wn(c)+'"'}function td(c){return'link[rel="stylesheet"]['+c+"]"}function R1(c){return O({},c,{"data-precedence":c.precedence,precedence:null})}function M1(c,h,y,T){c.querySelector('link[rel="preload"][as="style"]['+h+"]")?T.loading=1:(h=c.createElement("link"),T.preload=h,h.addEventListener("load",function(){return T.loading|=1}),h.addEventListener("error",function(){return T.loading|=2}),Oo(h,"link",y),ts(h),c.head.appendChild(h))}function Ef(c){return'[src="'+Wn(c)+'"]'}function ng(c){return"script[async]"+c}function v0(c,h,y){if(h.count++,h.instance===null)switch(h.type){case"style":var T=c.querySelector('style[data-href~="'+Wn(y.href)+'"]');if(T)return h.instance=T,ts(T),T;var k=O({},y,{"data-href":y.href,"data-precedence":y.precedence,href:null,precedence:null});return T=(c.ownerDocument||c).createElement("style"),ts(T),Oo(T,"style",k),rg(T,y.precedence,c),h.instance=T;case"stylesheet":k=ed(y.href);var z=c.querySelector(td(k));if(z)return h.state.loading|=4,h.instance=z,ts(z),z;T=R1(y),(k=zo.get(k))&&ig(T,k),z=(c.ownerDocument||c).createElement("link"),ts(z);var ee=z;return ee._p=new Promise(function(xe,We){ee.onload=xe,ee.onerror=We}),Oo(z,"link",T),h.state.loading|=4,rg(z,y.precedence,c),h.instance=z;case"script":return z=Ef(y.src),(k=c.querySelector(ng(z)))?(h.instance=k,ts(k),k):(T=y,(k=zo.get(z))&&(T=O({},y),Ny(T,k)),c=c.ownerDocument||c,k=c.createElement("script"),ts(k),Oo(k,"link",T),c.head.appendChild(k),h.instance=k);case"void":return null;default:throw Error(i(443,h.type))}else h.type==="stylesheet"&&(h.state.loading&4)===0&&(T=h.instance,h.state.loading|=4,rg(T,y.precedence,c));return h.instance}function rg(c,h,y){for(var T=y.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),k=T.length?T[T.length-1]:null,z=k,ee=0;ee<T.length;ee++){var xe=T[ee];if(xe.dataset.precedence===h)z=xe;else if(z!==k)break}z?z.parentNode.insertBefore(c,z.nextSibling):(h=y.nodeType===9?y.head:y,h.insertBefore(c,h.firstChild))}function ig(c,h){c.crossOrigin==null&&(c.crossOrigin=h.crossOrigin),c.referrerPolicy==null&&(c.referrerPolicy=h.referrerPolicy),c.title==null&&(c.title=h.title)}function Ny(c,h){c.crossOrigin==null&&(c.crossOrigin=h.crossOrigin),c.referrerPolicy==null&&(c.referrerPolicy=h.referrerPolicy),c.integrity==null&&(c.integrity=h.integrity)}var Vy=null;function x0(c,h,y){if(Vy===null){var T=new Map,k=Vy=new Map;k.set(y,T)}else k=Vy,T=k.get(y),T||(T=new Map,k.set(y,T));if(T.has(c))return T;for(T.set(c,null),y=y.getElementsByTagName(c),k=0;k<y.length;k++){var z=y[k];if(!(z[wl]||z[Cr]||c==="link"&&z.getAttribute("rel")==="stylesheet")&&z.namespaceURI!=="http://www.w3.org/2000/svg"){var ee=z.getAttribute(h)||"";ee=c+ee;var xe=T.get(ee);xe?xe.push(z):T.set(ee,[z])}}return T}function Jc(c,h,y){c=c.ownerDocument||c,c.head.insertBefore(y,h==="title"?c.querySelector("head > title"):null)}function P1(c,h,y){if(y===1||h.itemProp!=null)return!1;switch(c){case"meta":case"title":return!0;case"style":if(typeof h.precedence!="string"||typeof h.href!="string"||h.href==="")break;return!0;case"link":if(typeof h.rel!="string"||typeof h.href!="string"||h.href===""||h.onLoad||h.onError)break;switch(h.rel){case"stylesheet":return c=h.disabled,typeof h.precedence=="string"&&c==null;default:return!0}case"script":if(h.async&&typeof h.async!="function"&&typeof h.async!="symbol"&&!h.onLoad&&!h.onError&&h.src&&typeof h.src=="string")return!0}return!1}function b0(c){return!(c.type==="stylesheet"&&(c.state.loading&3)===0)}function k1(c,h,y,T){if(y.type==="stylesheet"&&(typeof T.media!="string"||matchMedia(T.media).matches!==!1)&&(y.state.loading&4)===0){if(y.instance===null){var k=ed(T.href),z=h.querySelector(td(k));if(z){h=z._p,h!==null&&typeof h=="object"&&typeof h.then=="function"&&(c.count++,c=Uy.bind(c),h.then(c,c)),y.state.loading|=4,y.instance=z,ts(z);return}z=h.ownerDocument||h,T=R1(T),(k=zo.get(k))&&ig(T,k),z=z.createElement("link"),ts(z);var ee=z;ee._p=new Promise(function(xe,We){ee.onload=xe,ee.onerror=We}),Oo(z,"link",T),y.instance=z}c.stylesheets===null&&(c.stylesheets=new Map),c.stylesheets.set(y,h),(h=y.state.preload)&&(y.state.loading&3)===0&&(c.count++,y=Uy.bind(c),h.addEventListener("load",y),h.addEventListener("error",y))}}var Fy=0;function FE(c,h){return c.stylesheets&&c.count===0&&og(c,c.stylesheets),0<c.count||0<c.imgCount?function(y){var T=setTimeout(function(){if(c.stylesheets&&og(c,c.stylesheets),c.unsuspend){var z=c.unsuspend;c.unsuspend=null,z()}},6e4+h);0<c.imgBytes&&Fy===0&&(Fy=62500*Zs());var k=setTimeout(function(){if(c.waitingForImages=!1,c.count===0&&(c.stylesheets&&og(c,c.stylesheets),c.unsuspend)){var z=c.unsuspend;c.unsuspend=null,z()}},(c.imgBytes>Fy?50:800)+h);return c.unsuspend=y,function(){c.unsuspend=null,clearTimeout(T),clearTimeout(k)}}:null}function Uy(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)og(this,this.stylesheets);else if(this.unsuspend){var c=this.unsuspend;this.unsuspend=null,c()}}}var sg=null;function og(c,h){c.stylesheets=null,c.unsuspend!==null&&(c.count++,sg=new Map,h.forEach(ag,c),sg=null,Uy.call(c))}function ag(c,h){if(!(h.state.loading&4)){var y=sg.get(c);if(y)var T=y.get(null);else{y=new Map,sg.set(c,y);for(var k=c.querySelectorAll("link[data-precedence],style[data-precedence]"),z=0;z<k.length;z++){var ee=k[z];(ee.nodeName==="LINK"||ee.getAttribute("media")!=="not all")&&(y.set(ee.dataset.precedence,ee),T=ee)}T&&y.set(null,T)}k=h.instance,ee=k.getAttribute("data-precedence"),z=y.get(ee)||T,z===T&&y.set(null,k),y.set(ee,k),this.count++,T=Uy.bind(this),k.addEventListener("load",T),k.addEventListener("error",T),z?z.parentNode.insertBefore(k,z.nextSibling):(c=c.nodeType===9?c.head:c,c.insertBefore(k,c.firstChild)),h.state.loading|=4}}var zp={$$typeof:ue,Provider:null,Consumer:null,_currentValue:dt,_currentValue2:dt,_threadCount:0};function D1(c,h,y,T,k,z,ee,xe,We){this.tag=1,this.containerInfo=c,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=$e(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$e(0),this.hiddenUpdates=$e(null),this.identifierPrefix=T,this.onUncaughtError=k,this.onCaughtError=z,this.onRecoverableError=ee,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=We,this.incompleteTransitions=new Map}function Bl(c,h,y,T,k,z,ee,xe,We,mt,Pt,Ft){return c=new D1(c,h,y,ee,We,mt,Pt,Ft,xe),h=1,z===!0&&(h|=24),z=ds(3,null,null,h),c.current=z,z.stateNode=c,h=ac(),h.refCount++,c.pooledCache=h,h.refCount++,z.memoizedState={element:T,isDehydrated:y,cache:h},we(z),c}function jy(c){return c?(c=Lu,c):Lu}function Sf(c,h,y,T,k,z){k=jy(k),T.context===null?T.context=k:T.pendingContext=k,T=Ee(h),T.payload={element:y},z=z===void 0?null:z,z!==null&&(T.callback=z),y=Ce(c,T,h),y!==null&&(Lo(y,c,h),ne(y,c,h))}function Cf(c,h){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var y=c.retryLane;c.retryLane=y!==0&&y<h?y:h}}function $y(c,h){Cf(c,h),(c=c.alternate)&&Cf(c,h)}function lg(c){if(c.tag===13||c.tag===31){var h=zc(c,67108864);h!==null&&Lo(h,c,67108864),$y(c,67108864)}}function w0(c){if(c.tag===13||c.tag===31){var h=$a();h=Jn(h);var y=zc(c,h);y!==null&&Lo(y,c,h),$y(c,h)}}var Af=!0;function qy(c,h,y,T){var k=Ie.T;Ie.T=null;var z=Je.p;try{Je.p=2,T0(c,h,y,T)}finally{Je.p=z,Ie.T=k}}function UE(c,h,y,T){var k=Ie.T;Ie.T=null;var z=Je.p;try{Je.p=8,T0(c,h,y,T)}finally{Je.p=z,Ie.T=k}}function T0(c,h,y,T){if(Af){var k=E0(T);if(k===null)s0(c,h,T,Gy,y),rh(c,T);else if(L1(k,c,h,y,T))T.stopPropagation();else if(rh(c,T),h&4&&-1<ug.indexOf(c)){for(;k!==null;){var z=Uo(k);if(z!==null)switch(z.tag){case 3:if(z=z.stateNode,z.current.memoizedState.isDehydrated){var ee=Me(z.pendingLanes);if(ee!==0){var xe=z;for(xe.pendingLanes|=2,xe.entangledLanes|=2;ee;){var We=1<<31-$n(ee);xe.entanglements[1]|=We,ee&=~We}qa(z),(xi&6)===0&&(Iy=Xn()+500,kp(0))}}break;case 31:case 13:xe=zc(z,2),xe!==null&&Lo(xe,z,2),Ap(),$y(z,2)}if(z=E0(T),z===null&&s0(c,h,T,Gy,y),z===k)break;k=z}k!==null&&T.stopPropagation()}else s0(c,h,T,null,y)}}function E0(c){return c=Co(c),S0(c)}var Gy=null;function S0(c){if(Gy=null,c=vr(c),c!==null){var h=f(c);if(h===null)c=null;else{var y=h.tag;if(y===13){if(c=g(h),c!==null)return c;c=null}else if(y===31){if(c=b(h),c!==null)return c;c=null}else if(y===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;c=null}else h!==c&&(c=null)}}return Gy=c,null}function If(c){switch(c){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(on()){case Jt:return 2;case yn:return 8;case _n:case In:return 32;case Bn:return 268435456;default:return 32}default:return 32}}var nd=!1,eu=null,rd=null,nh=null,cg=new Map,Rf=new Map,id=[],ug="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function rh(c,h){switch(c){case"focusin":case"focusout":eu=null;break;case"dragenter":case"dragleave":rd=null;break;case"mouseover":case"mouseout":nh=null;break;case"pointerover":case"pointerout":cg.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rf.delete(h.pointerId)}}function Bp(c,h,y,T,k,z){return c===null||c.nativeEvent!==z?(c={blockedOn:h,domEventName:y,eventSystemFlags:T,nativeEvent:z,targetContainers:[k]},h!==null&&(h=Uo(h),h!==null&&lg(h)),c):(c.eventSystemFlags|=T,h=c.targetContainers,k!==null&&h.indexOf(k)===-1&&h.push(k),c)}function L1(c,h,y,T,k){switch(h){case"focusin":return eu=Bp(eu,c,h,y,T,k),!0;case"dragenter":return rd=Bp(rd,c,h,y,T,k),!0;case"mouseover":return nh=Bp(nh,c,h,y,T,k),!0;case"pointerover":var z=k.pointerId;return cg.set(z,Bp(cg.get(z)||null,c,h,y,T,k)),!0;case"gotpointercapture":return z=k.pointerId,Rf.set(z,Bp(Rf.get(z)||null,c,h,y,T,k)),!0}return!1}function hg(c){var h=vr(c.target);if(h!==null){var y=f(h);if(y!==null){if(h=y.tag,h===13){if(h=g(y),h!==null){c.blockedOn=h,er(c.priority,function(){w0(y)});return}}else if(h===31){if(h=b(y),h!==null){c.blockedOn=h,er(c.priority,function(){w0(y)});return}}else if(h===3&&y.stateNode.current.memoizedState.isDehydrated){c.blockedOn=y.tag===3?y.stateNode.containerInfo:null;return}}}c.blockedOn=null}function Np(c){if(c.blockedOn!==null)return!1;for(var h=c.targetContainers;0<h.length;){var y=E0(c.nativeEvent);if(y===null){y=c.nativeEvent;var T=new y.constructor(y.type,y);Xl=T,y.target.dispatchEvent(T),Xl=null}else return h=Uo(y),h!==null&&lg(h),c.blockedOn=y,!1;h.shift()}return!0}function O1(c,h,y){Np(c)&&y.delete(h)}function z1(){nd=!1,eu!==null&&Np(eu)&&(eu=null),rd!==null&&Np(rd)&&(rd=null),nh!==null&&Np(nh)&&(nh=null),cg.forEach(O1),Rf.forEach(O1)}function tu(c,h){c.blockedOn===h&&(c.blockedOn=null,nd||(nd=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,z1)))}var Hy=null;function ih(c){Hy!==c&&(Hy=c,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Hy===c&&(Hy=null);for(var h=0;h<c.length;h+=3){var y=c[h],T=c[h+1],k=c[h+2];if(typeof T!="function"){if(S0(T||y)===null)continue;break}var z=Uo(y);z!==null&&(c.splice(h,3),h-=3,dl(z,{pending:!0,data:k,method:y.method,action:T},T,k))}}))}function Vp(c){function h(We){return tu(We,c)}eu!==null&&tu(eu,c),rd!==null&&tu(rd,c),nh!==null&&tu(nh,c),cg.forEach(h),Rf.forEach(h);for(var y=0;y<id.length;y++){var T=id[y];T.blockedOn===c&&(T.blockedOn=null)}for(;0<id.length&&(y=id[0],y.blockedOn===null);)hg(y),y.blockedOn===null&&id.shift();if(y=(c.ownerDocument||c).$$reactFormReplay,y!=null)for(T=0;T<y.length;T+=3){var k=y[T],z=y[T+1],ee=k[Xr]||null;if(typeof z=="function")ee||ih(y);else if(ee){var xe=null;if(z&&z.hasAttribute("formAction")){if(k=z,ee=z[Xr]||null)xe=ee.formAction;else if(S0(k)!==null)continue}else xe=ee.action;typeof xe=="function"?y[T+1]=xe:(y.splice(T,3),T-=3),ih(y)}}}function Fp(){function c(z){z.canIntercept&&z.info==="react-transition"&&z.intercept({handler:function(){return new Promise(function(ee){return k=ee})},focusReset:"manual",scroll:"manual"})}function h(){k!==null&&(k(),k=null),T||setTimeout(y,20)}function y(){if(!T&&!navigation.transition){var z=navigation.currentEntry;z&&z.url!=null&&navigation.navigate(z.url,{state:z.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var T=!1,k=null;return navigation.addEventListener("navigate",c),navigation.addEventListener("navigatesuccess",h),navigation.addEventListener("navigateerror",h),setTimeout(y,100),function(){T=!0,navigation.removeEventListener("navigate",c),navigation.removeEventListener("navigatesuccess",h),navigation.removeEventListener("navigateerror",h),k!==null&&(k(),k=null)}}}function Mf(c){this._internalRoot=c}sd.prototype.render=Mf.prototype.render=function(c){var h=this._internalRoot;if(h===null)throw Error(i(409));var y=h.current,T=$a();Sf(y,T,c,h,null,null)},sd.prototype.unmount=Mf.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var h=c.containerInfo;Sf(c.current,2,null,c,null,null),Ap(),h[mi]=null}};function sd(c){this._internalRoot=c}sd.prototype.unstable_scheduleHydration=function(c){if(c){var h=ir();c={blockedOn:null,target:c,priority:h};for(var y=0;y<id.length&&h!==0&&h<id[y].priority;y++);id.splice(y,0,c),y===0&&hg(c)}};var Up=e.version;if(Up!=="19.2.0")throw Error(i(527,Up,"19.2.0"));Je.findDOMNode=function(c){var h=c._reactInternals;if(h===void 0)throw typeof c.render=="function"?Error(i(188)):(c=Object.keys(c).join(","),Error(i(268,c)));return c=S(h),c=c!==null?M(c):null,c=c===null?null:c.stateNode,c};var Wy={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:Ie,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xy.isDisabled&&Xy.supportsFiber)try{tr=Xy.inject(Wy),_r=Xy}catch{}}return D0.createRoot=function(c,h){if(!u(c))throw Error(i(299));var y=!1,T="",k=py,z=as,ee=Sv;return h!=null&&(h.unstable_strictMode===!0&&(y=!0),h.identifierPrefix!==void 0&&(T=h.identifierPrefix),h.onUncaughtError!==void 0&&(k=h.onUncaughtError),h.onCaughtError!==void 0&&(z=h.onCaughtError),h.onRecoverableError!==void 0&&(ee=h.onRecoverableError)),h=Bl(c,1,!1,null,null,y,T,null,k,z,ee,Fp),c[mi]=h.current,i0(c),new Mf(h)},D0.hydrateRoot=function(c,h,y){if(!u(c))throw Error(i(299));var T=!1,k="",z=py,ee=as,xe=Sv,We=null;return y!=null&&(y.unstable_strictMode===!0&&(T=!0),y.identifierPrefix!==void 0&&(k=y.identifierPrefix),y.onUncaughtError!==void 0&&(z=y.onUncaughtError),y.onCaughtError!==void 0&&(ee=y.onCaughtError),y.onRecoverableError!==void 0&&(xe=y.onRecoverableError),y.formState!==void 0&&(We=y.formState)),h=Bl(c,1,!0,h,y??null,T,k,We,z,ee,xe,Fp),h.context=jy(null),y=h.current,T=$a(),T=Jn(T),k=Ee(T),k.callback=null,Ce(y,k,T),y=T,h.current.lanes=y,ct(h,y),qa(h),c[mi]=h.current,i0(c),new sd(h)},D0.version="19.2.0",D0}var aP;function GV(){if(aP)return aS.exports;aP=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),aS.exports=qV(),aS.exports}var HV=GV();const WV=RT(HV);var lP="popstate";function XV(t={}){function e(i,u){let{pathname:f,search:g,hash:b}=i.location;return hC("",{pathname:f,search:g,hash:b},u.state&&u.state.usr||null,u.state&&u.state.key||"default")}function n(i,u){return typeof u=="string"?u:wx(u)}return KV(e,n,null,t)}function Ts(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Tc(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ZV(){return Math.random().toString(36).substring(2,10)}function cP(t,e){return{usr:t.state,key:t.key,idx:e}}function hC(t,e,n=null,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?W_(e):e,state:n,key:e&&e.key||i||ZV()}}function wx({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function W_(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substring(i),t=t.substring(0,i)),t&&(e.pathname=t)}return e}function KV(t,e,n,i={}){let{window:u=document.defaultView,v5Compat:f=!1}=i,g=u.history,b="POP",o=null,S=M();S==null&&(S=0,g.replaceState({...g.state,idx:S},""));function M(){return(g.state||{idx:null}).idx}function O(){b="POP";let Q=M(),ce=Q==null?null:Q-S;S=Q,o&&o({action:b,location:K.location,delta:ce})}function N(Q,ce){b="PUSH";let ge=hC(K.location,Q,ce);S=M()+1;let ue=cP(ge,S),pe=K.createHref(ge);try{g.pushState(ue,"",pe)}catch(me){if(me instanceof DOMException&&me.name==="DataCloneError")throw me;u.location.assign(pe)}f&&o&&o({action:b,location:K.location,delta:1})}function j(Q,ce){b="REPLACE";let ge=hC(K.location,Q,ce);S=M();let ue=cP(ge,S),pe=K.createHref(ge);g.replaceState(ue,"",pe),f&&o&&o({action:b,location:K.location,delta:0})}function Z(Q){return YV(Q)}let K={get action(){return b},get location(){return t(u,g)},listen(Q){if(o)throw new Error("A history only accepts one active listener");return u.addEventListener(lP,O),o=Q,()=>{u.removeEventListener(lP,O),o=null}},createHref(Q){return e(u,Q)},createURL:Z,encodeLocation(Q){let ce=Z(Q);return{pathname:ce.pathname,search:ce.search,hash:ce.hash}},push:N,replace:j,go(Q){return g.go(Q)}};return K}function YV(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Ts(n,"No window.location.(origin|href) available to create URL");let i=typeof t=="string"?t:wx(t);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function XO(t,e,n="/"){return QV(t,e,n,!1)}function QV(t,e,n,i){let u=typeof e=="string"?W_(e):e,f=Nf(u.pathname||"/",n);if(f==null)return null;let g=ZO(t);JV(g);let b=null;for(let o=0;b==null&&o<g.length;++o){let S=uF(f);b=lF(g[o],S,i)}return b}function ZO(t,e=[],n=[],i="",u=!1){let f=(g,b,o=u,S)=>{let M={relativePath:S===void 0?g.path||"":S,caseSensitive:g.caseSensitive===!0,childrenIndex:b,route:g};if(M.relativePath.startsWith("/")){if(!M.relativePath.startsWith(i)&&o)return;Ts(M.relativePath.startsWith(i),`Absolute route path "${M.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),M.relativePath=M.relativePath.slice(i.length)}let O=Of([i,M.relativePath]),N=n.concat(M);g.children&&g.children.length>0&&(Ts(g.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${O}".`),ZO(g.children,e,N,O,o)),!(g.path==null&&!g.index)&&e.push({path:O,score:oF(O,g.index),routesMeta:N})};return t.forEach((g,b)=>{if(g.path===""||!g.path?.includes("?"))f(g,b);else for(let o of KO(g.path))f(g,b,!0,o)}),e}function KO(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,u=n.endsWith("?"),f=n.replace(/\?$/,"");if(i.length===0)return u?[f,""]:[f];let g=KO(i.join("/")),b=[];return b.push(...g.map(o=>o===""?f:[f,o].join("/"))),u&&b.push(...g),b.map(o=>t.startsWith("/")&&o===""?"/":o)}function JV(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:aF(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var eF=/^:[\w-]+$/,tF=3,nF=2,rF=1,iF=10,sF=-2,uP=t=>t==="*";function oF(t,e){let n=t.split("/"),i=n.length;return n.some(uP)&&(i+=sF),e&&(i+=nF),n.filter(u=>!uP(u)).reduce((u,f)=>u+(eF.test(f)?tF:f===""?rF:iF),i)}function aF(t,e){return t.length===e.length&&t.slice(0,-1).every((i,u)=>i===e[u])?t[t.length-1]-e[e.length-1]:0}function lF(t,e,n=!1){let{routesMeta:i}=t,u={},f="/",g=[];for(let b=0;b<i.length;++b){let o=i[b],S=b===i.length-1,M=f==="/"?e:e.slice(f.length)||"/",O=Ww({path:o.relativePath,caseSensitive:o.caseSensitive,end:S},M),N=o.route;if(!O&&S&&n&&!i[i.length-1].route.index&&(O=Ww({path:o.relativePath,caseSensitive:o.caseSensitive,end:!1},M)),!O)return null;Object.assign(u,O.params),g.push({params:u,pathname:Of([f,O.pathname]),pathnameBase:mF(Of([f,O.pathnameBase])),route:N}),O.pathnameBase!=="/"&&(f=Of([f,O.pathnameBase]))}return g}function Ww(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=cF(t.path,t.caseSensitive,t.end),u=e.match(n);if(!u)return null;let f=u[0],g=f.replace(/(.)\/+$/,"$1"),b=u.slice(1);return{params:i.reduce((S,{paramName:M,isOptional:O},N)=>{if(M==="*"){let Z=b[N]||"";g=f.slice(0,f.length-Z.length).replace(/(.)\/+$/,"$1")}const j=b[N];return O&&!j?S[M]=void 0:S[M]=(j||"").replace(/%2F/g,"/"),S},{}),pathname:f,pathnameBase:g,pattern:t}}function cF(t,e=!1,n=!0){Tc(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let i=[],u="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(g,b,o)=>(i.push({paramName:b,isOptional:o!=null}),o?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(i.push({paramName:"*"}),u+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?u+="\\/*$":t!==""&&t!=="/"&&(u+="(?:(?=\\/|$))"),[new RegExp(u,e?void 0:"i"),i]}function uF(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Tc(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Nf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}var hF=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dF=t=>hF.test(t);function fF(t,e="/"){let{pathname:n,search:i="",hash:u=""}=typeof t=="string"?W_(t):t,f;if(n)if(dF(n))f=n;else{if(n.includes("//")){let g=n;n=n.replace(/\/\/+/g,"/"),Tc(!1,`Pathnames cannot have embedded double slashes - normalizing ${g} -> ${n}`)}n.startsWith("/")?f=hP(n.substring(1),"/"):f=hP(n,e)}else f=e;return{pathname:f,search:gF(i),hash:yF(u)}}function hP(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(u=>{u===".."?n.length>1&&n.pop():u!=="."&&n.push(u)}),n.length>1?n.join("/"):"/"}function hS(t,e,n,i){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function pF(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function VA(t){let e=pF(t);return e.map((n,i)=>i===e.length-1?n.pathname:n.pathnameBase)}function FA(t,e,n,i=!1){let u;typeof t=="string"?u=W_(t):(u={...t},Ts(!u.pathname||!u.pathname.includes("?"),hS("?","pathname","search",u)),Ts(!u.pathname||!u.pathname.includes("#"),hS("#","pathname","hash",u)),Ts(!u.search||!u.search.includes("#"),hS("#","search","hash",u)));let f=t===""||u.pathname==="",g=f?"/":u.pathname,b;if(g==null)b=n;else{let O=e.length-1;if(!i&&g.startsWith("..")){let N=g.split("/");for(;N[0]==="..";)N.shift(),O-=1;u.pathname=N.join("/")}b=O>=0?e[O]:"/"}let o=fF(u,b),S=g&&g!=="/"&&g.endsWith("/"),M=(f||g===".")&&n.endsWith("/");return!o.pathname.endsWith("/")&&(S||M)&&(o.pathname+="/"),o}var Of=t=>t.join("/").replace(/\/\/+/g,"/"),mF=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),gF=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,yF=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function _F(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var YO=["POST","PUT","PATCH","DELETE"];new Set(YO);var vF=["GET",...YO];new Set(vF);var X_=W.createContext(null);X_.displayName="DataRouter";var MT=W.createContext(null);MT.displayName="DataRouterState";W.createContext(!1);var QO=W.createContext({isTransitioning:!1});QO.displayName="ViewTransition";var xF=W.createContext(new Map);xF.displayName="Fetchers";var bF=W.createContext(null);bF.displayName="Await";var mh=W.createContext(null);mh.displayName="Navigation";var Wx=W.createContext(null);Wx.displayName="Location";var gh=W.createContext({outlet:null,matches:[],isDataRoute:!1});gh.displayName="Route";var UA=W.createContext(null);UA.displayName="RouteError";function wF(t,{relative:e}={}){Ts(Z_(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=W.useContext(mh),{hash:u,pathname:f,search:g}=Xx(t,{relative:e}),b=f;return n!=="/"&&(b=f==="/"?n:Of([n,f])),i.createHref({pathname:b,search:g,hash:u})}function Z_(){return W.useContext(Wx)!=null}function yh(){return Ts(Z_(),"useLocation() may be used only in the context of a <Router> component."),W.useContext(Wx).location}var JO="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function e3(t){W.useContext(mh).static||W.useLayoutEffect(t)}function Cc(){let{isDataRoute:t}=W.useContext(gh);return t?OF():TF()}function TF(){Ts(Z_(),"useNavigate() may be used only in the context of a <Router> component.");let t=W.useContext(X_),{basename:e,navigator:n}=W.useContext(mh),{matches:i}=W.useContext(gh),{pathname:u}=yh(),f=JSON.stringify(VA(i)),g=W.useRef(!1);return e3(()=>{g.current=!0}),W.useCallback((o,S={})=>{if(Tc(g.current,JO),!g.current)return;if(typeof o=="number"){n.go(o);return}let M=FA(o,JSON.parse(f),u,S.relative==="path");t==null&&e!=="/"&&(M.pathname=M.pathname==="/"?e:Of([e,M.pathname])),(S.replace?n.replace:n.push)(M,S.state,S)},[e,n,f,u,t])}W.createContext(null);function PT(){let{matches:t}=W.useContext(gh),e=t[t.length-1];return e?e.params:{}}function Xx(t,{relative:e}={}){let{matches:n}=W.useContext(gh),{pathname:i}=yh(),u=JSON.stringify(VA(n));return W.useMemo(()=>FA(t,JSON.parse(u),i,e==="path"),[t,u,i,e])}function EF(t,e){return t3(t,e)}function t3(t,e,n,i,u){Ts(Z_(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:f}=W.useContext(mh),{matches:g}=W.useContext(gh),b=g[g.length-1],o=b?b.params:{},S=b?b.pathname:"/",M=b?b.pathnameBase:"/",O=b&&b.route;{let ge=O&&O.path||"";n3(S,!O||ge.endsWith("*")||ge.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${S}" (under <Route path="${ge}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${ge}"> to <Route path="${ge==="/"?"*":`${ge}/*`}">.`)}let N=yh(),j;if(e){let ge=typeof e=="string"?W_(e):e;Ts(M==="/"||ge.pathname?.startsWith(M),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${M}" but pathname "${ge.pathname}" was given in the \`location\` prop.`),j=ge}else j=N;let Z=j.pathname||"/",K=Z;if(M!=="/"){let ge=M.replace(/^\//,"").split("/");K="/"+Z.replace(/^\//,"").split("/").slice(ge.length).join("/")}let Q=XO(t,{pathname:K});Tc(O||Q!=null,`No routes matched location "${j.pathname}${j.search}${j.hash}" `),Tc(Q==null||Q[Q.length-1].route.element!==void 0||Q[Q.length-1].route.Component!==void 0||Q[Q.length-1].route.lazy!==void 0,`Matched leaf route at location "${j.pathname}${j.search}${j.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let ce=RF(Q&&Q.map(ge=>Object.assign({},ge,{params:Object.assign({},o,ge.params),pathname:Of([M,f.encodeLocation?f.encodeLocation(ge.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ge.pathname]),pathnameBase:ge.pathnameBase==="/"?M:Of([M,f.encodeLocation?f.encodeLocation(ge.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ge.pathnameBase])})),g,n,i,u);return e&&ce?W.createElement(Wx.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...j},navigationType:"POP"}},ce):ce}function SF(){let t=LF(),e=_F(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",u={padding:"0.5rem",backgroundColor:i},f={padding:"2px 4px",backgroundColor:i},g=null;return console.error("Error handled by React Router default ErrorBoundary:",t),g=W.createElement(W.Fragment,null,W.createElement("p",null," Hey developer "),W.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",W.createElement("code",{style:f},"ErrorBoundary")," or"," ",W.createElement("code",{style:f},"errorElement")," prop on your route.")),W.createElement(W.Fragment,null,W.createElement("h2",null,"Unexpected Application Error!"),W.createElement("h3",{style:{fontStyle:"italic"}},e),n?W.createElement("pre",{style:u},n):null,g)}var CF=W.createElement(SF,null),AF=class extends W.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?W.createElement(gh.Provider,{value:this.props.routeContext},W.createElement(UA.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function IF({routeContext:t,match:e,children:n}){let i=W.useContext(X_);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),W.createElement(gh.Provider,{value:t},n)}function RF(t,e=[],n=null,i=null,u=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let f=t,g=n?.errors;if(g!=null){let M=f.findIndex(O=>O.route.id&&g?.[O.route.id]!==void 0);Ts(M>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(g).join(",")}`),f=f.slice(0,Math.min(f.length,M+1))}let b=!1,o=-1;if(n)for(let M=0;M<f.length;M++){let O=f[M];if((O.route.HydrateFallback||O.route.hydrateFallbackElement)&&(o=M),O.route.id){let{loaderData:N,errors:j}=n,Z=O.route.loader&&!N.hasOwnProperty(O.route.id)&&(!j||j[O.route.id]===void 0);if(O.route.lazy||Z){b=!0,o>=0?f=f.slice(0,o+1):f=[f[0]];break}}}let S=n&&i?(M,O)=>{i(M,{location:n.location,params:n.matches?.[0]?.params??{},errorInfo:O})}:void 0;return f.reduceRight((M,O,N)=>{let j,Z=!1,K=null,Q=null;n&&(j=g&&O.route.id?g[O.route.id]:void 0,K=O.route.errorElement||CF,b&&(o<0&&N===0?(n3("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),Z=!0,Q=null):o===N&&(Z=!0,Q=O.route.hydrateFallbackElement||null)));let ce=e.concat(f.slice(0,N+1)),ge=()=>{let ue;return j?ue=K:Z?ue=Q:O.route.Component?ue=W.createElement(O.route.Component,null):O.route.element?ue=O.route.element:ue=M,W.createElement(IF,{match:O,routeContext:{outlet:M,matches:ce,isDataRoute:n!=null},children:ue})};return n&&(O.route.ErrorBoundary||O.route.errorElement||N===0)?W.createElement(AF,{location:n.location,revalidation:n.revalidation,component:K,error:j,children:ge(),routeContext:{outlet:null,matches:ce,isDataRoute:!0},onError:S}):ge()},null)}function jA(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function MF(t){let e=W.useContext(X_);return Ts(e,jA(t)),e}function PF(t){let e=W.useContext(MT);return Ts(e,jA(t)),e}function kF(t){let e=W.useContext(gh);return Ts(e,jA(t)),e}function $A(t){let e=kF(t),n=e.matches[e.matches.length-1];return Ts(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function DF(){return $A("useRouteId")}function LF(){let t=W.useContext(UA),e=PF("useRouteError"),n=$A("useRouteError");return t!==void 0?t:e.errors?.[n]}function OF(){let{router:t}=MF("useNavigate"),e=$A("useNavigate"),n=W.useRef(!1);return e3(()=>{n.current=!0}),W.useCallback(async(u,f={})=>{Tc(n.current,JO),n.current&&(typeof u=="number"?t.navigate(u):await t.navigate(u,{fromRouteId:e,...f}))},[t,e])}var dP={};function n3(t,e,n){!e&&!dP[t]&&(dP[t]=!0,Tc(!1,n))}W.memo(zF);function zF({routes:t,future:e,state:n,unstable_onError:i}){return t3(t,void 0,n,i,e)}function r3({to:t,replace:e,state:n,relative:i}){Ts(Z_(),"<Navigate> may be used only in the context of a <Router> component.");let{static:u}=W.useContext(mh);Tc(!u,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:f}=W.useContext(gh),{pathname:g}=yh(),b=Cc(),o=FA(t,VA(f),g,i==="path"),S=JSON.stringify(o);return W.useEffect(()=>{b(JSON.parse(S),{replace:e,state:n,relative:i})},[b,S,i,e,n]),null}function yc(t){Ts(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function BF({basename:t="/",children:e=null,location:n,navigationType:i="POP",navigator:u,static:f=!1}){Ts(!Z_(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let g=t.replace(/^\/*/,"/"),b=W.useMemo(()=>({basename:g,navigator:u,static:f,future:{}}),[g,u,f]);typeof n=="string"&&(n=W_(n));let{pathname:o="/",search:S="",hash:M="",state:O=null,key:N="default"}=n,j=W.useMemo(()=>{let Z=Nf(o,g);return Z==null?null:{location:{pathname:Z,search:S,hash:M,state:O,key:N},navigationType:i}},[g,o,S,M,O,N,i]);return Tc(j!=null,`<Router basename="${g}"> is not able to match the URL "${o}${S}${M}" because it does not start with the basename, so the <Router> won't render anything.`),j==null?null:W.createElement(mh.Provider,{value:b},W.createElement(Wx.Provider,{children:e,value:j}))}function NF({children:t,location:e}){return EF(dC(t),e)}function dC(t,e=[]){let n=[];return W.Children.forEach(t,(i,u)=>{if(!W.isValidElement(i))return;let f=[...e,u];if(i.type===W.Fragment){n.push.apply(n,dC(i.props.children,f));return}Ts(i.type===yc,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ts(!i.props.index||!i.props.children,"An index route cannot have child routes.");let g={id:i.props.id||f.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(g.children=dC(i.props.children,f)),n.push(g)}),n}var vw="get",xw="application/x-www-form-urlencoded";function kT(t){return t!=null&&typeof t.tagName=="string"}function VF(t){return kT(t)&&t.tagName.toLowerCase()==="button"}function FF(t){return kT(t)&&t.tagName.toLowerCase()==="form"}function UF(t){return kT(t)&&t.tagName.toLowerCase()==="input"}function jF(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function $F(t,e){return t.button===0&&(!e||e==="_self")&&!jF(t)}function fC(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let i=t[n];return e.concat(Array.isArray(i)?i.map(u=>[n,u]):[[n,i]])},[]))}function qF(t,e){let n=fC(t);return e&&e.forEach((i,u)=>{n.has(u)||e.getAll(u).forEach(f=>{n.append(u,f)})}),n}var F1=null;function GF(){if(F1===null)try{new FormData(document.createElement("form"),0),F1=!1}catch{F1=!0}return F1}var HF=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function dS(t){return t!=null&&!HF.has(t)?(Tc(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${xw}"`),null):t}function WF(t,e){let n,i,u,f,g;if(FF(t)){let b=t.getAttribute("action");i=b?Nf(b,e):null,n=t.getAttribute("method")||vw,u=dS(t.getAttribute("enctype"))||xw,f=new FormData(t)}else if(VF(t)||UF(t)&&(t.type==="submit"||t.type==="image")){let b=t.form;if(b==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=t.getAttribute("formaction")||b.getAttribute("action");if(i=o?Nf(o,e):null,n=t.getAttribute("formmethod")||b.getAttribute("method")||vw,u=dS(t.getAttribute("formenctype"))||dS(b.getAttribute("enctype"))||xw,f=new FormData(b,t),!GF()){let{name:S,type:M,value:O}=t;if(M==="image"){let N=S?`${S}.`:"";f.append(`${N}x`,"0"),f.append(`${N}y`,"0")}else S&&f.append(S,O)}}else{if(kT(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=vw,i=null,u=xw,g=t}return f&&u==="text/plain"&&(g=f,f=void 0),{action:i,method:n.toLowerCase(),encType:u,formData:f,body:g}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function qA(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function XF(t,e,n){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return i.pathname==="/"?i.pathname=`_root.${n}`:e&&Nf(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${n}`,i}async function ZF(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function KF(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function YF(t,e,n){let i=await Promise.all(t.map(async u=>{let f=e.routes[u.route.id];if(f){let g=await ZF(f,n);return g.links?g.links():[]}return[]}));return t6(i.flat(1).filter(KF).filter(u=>u.rel==="stylesheet"||u.rel==="preload").map(u=>u.rel==="stylesheet"?{...u,rel:"prefetch",as:"style"}:{...u,rel:"prefetch"}))}function fP(t,e,n,i,u,f){let g=(o,S)=>n[S]?o.route.id!==n[S].route.id:!0,b=(o,S)=>n[S].pathname!==o.pathname||n[S].route.path?.endsWith("*")&&n[S].params["*"]!==o.params["*"];return f==="assets"?e.filter((o,S)=>g(o,S)||b(o,S)):f==="data"?e.filter((o,S)=>{let M=i.routes[o.route.id];if(!M||!M.hasLoader)return!1;if(g(o,S)||b(o,S))return!0;if(o.route.shouldRevalidate){let O=o.route.shouldRevalidate({currentUrl:new URL(u.pathname+u.search+u.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:o.params,defaultShouldRevalidate:!0});if(typeof O=="boolean")return O}return!0}):[]}function QF(t,e,{includeHydrateFallback:n}={}){return JF(t.map(i=>{let u=e.routes[i.route.id];if(!u)return[];let f=[u.module];return u.clientActionModule&&(f=f.concat(u.clientActionModule)),u.clientLoaderModule&&(f=f.concat(u.clientLoaderModule)),n&&u.hydrateFallbackModule&&(f=f.concat(u.hydrateFallbackModule)),u.imports&&(f=f.concat(u.imports)),f}).flat(1))}function JF(t){return[...new Set(t)]}function e6(t){let e={},n=Object.keys(t).sort();for(let i of n)e[i]=t[i];return e}function t6(t,e){let n=new Set;return new Set(e),t.reduce((i,u)=>{let f=JSON.stringify(e6(u));return n.has(f)||(n.add(f),i.push({key:f,link:u})),i},[])}function i3(){let t=W.useContext(X_);return qA(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function n6(){let t=W.useContext(MT);return qA(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var GA=W.createContext(void 0);GA.displayName="FrameworkContext";function s3(){let t=W.useContext(GA);return qA(t,"You must render this element inside a <HydratedRouter> element"),t}function r6(t,e){let n=W.useContext(GA),[i,u]=W.useState(!1),[f,g]=W.useState(!1),{onFocus:b,onBlur:o,onMouseEnter:S,onMouseLeave:M,onTouchStart:O}=e,N=W.useRef(null);W.useEffect(()=>{if(t==="render"&&g(!0),t==="viewport"){let K=ce=>{ce.forEach(ge=>{g(ge.isIntersecting)})},Q=new IntersectionObserver(K,{threshold:.5});return N.current&&Q.observe(N.current),()=>{Q.disconnect()}}},[t]),W.useEffect(()=>{if(i){let K=setTimeout(()=>{g(!0)},100);return()=>{clearTimeout(K)}}},[i]);let j=()=>{u(!0)},Z=()=>{u(!1),g(!1)};return n?t!=="intent"?[f,N,{}]:[f,N,{onFocus:L0(b,j),onBlur:L0(o,Z),onMouseEnter:L0(S,j),onMouseLeave:L0(M,Z),onTouchStart:L0(O,j)}]:[!1,N,{}]}function L0(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function i6({page:t,...e}){let{router:n}=i3(),i=W.useMemo(()=>XO(n.routes,t,n.basename),[n.routes,t,n.basename]);return i?W.createElement(o6,{page:t,matches:i,...e}):null}function s6(t){let{manifest:e,routeModules:n}=s3(),[i,u]=W.useState([]);return W.useEffect(()=>{let f=!1;return YF(t,e,n).then(g=>{f||u(g)}),()=>{f=!0}},[t,e,n]),i}function o6({page:t,matches:e,...n}){let i=yh(),{manifest:u,routeModules:f}=s3(),{basename:g}=i3(),{loaderData:b,matches:o}=n6(),S=W.useMemo(()=>fP(t,e,o,u,i,"data"),[t,e,o,u,i]),M=W.useMemo(()=>fP(t,e,o,u,i,"assets"),[t,e,o,u,i]),O=W.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let Z=new Set,K=!1;if(e.forEach(ce=>{let ge=u.routes[ce.route.id];!ge||!ge.hasLoader||(!S.some(ue=>ue.route.id===ce.route.id)&&ce.route.id in b&&f[ce.route.id]?.shouldRevalidate||ge.hasClientLoader?K=!0:Z.add(ce.route.id))}),Z.size===0)return[];let Q=XF(t,g,"data");return K&&Z.size>0&&Q.searchParams.set("_routes",e.filter(ce=>Z.has(ce.route.id)).map(ce=>ce.route.id).join(",")),[Q.pathname+Q.search]},[g,b,i,u,S,e,t,f]),N=W.useMemo(()=>QF(M,u),[M,u]),j=s6(M);return W.createElement(W.Fragment,null,O.map(Z=>W.createElement("link",{key:Z,rel:"prefetch",as:"fetch",href:Z,...n})),N.map(Z=>W.createElement("link",{key:Z,rel:"modulepreload",href:Z,...n})),j.map(({key:Z,link:K})=>W.createElement("link",{key:Z,nonce:n.nonce,...K})))}function a6(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var o3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{o3&&(window.__reactRouterVersion="7.9.6")}catch{}function l6({basename:t,children:e,window:n}){let i=W.useRef();i.current==null&&(i.current=XV({window:n,v5Compat:!0}));let u=i.current,[f,g]=W.useState({action:u.action,location:u.location}),b=W.useCallback(o=>{W.startTransition(()=>g(o))},[g]);return W.useLayoutEffect(()=>u.listen(b),[u,b]),W.createElement(BF,{basename:t,children:e,location:f.location,navigationType:f.action,navigator:u})}var a3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xc=W.forwardRef(function({onClick:e,discover:n="render",prefetch:i="none",relative:u,reloadDocument:f,replace:g,state:b,target:o,to:S,preventScrollReset:M,viewTransition:O,...N},j){let{basename:Z}=W.useContext(mh),K=typeof S=="string"&&a3.test(S),Q,ce=!1;if(typeof S=="string"&&K&&(Q=S,o3))try{let he=new URL(window.location.href),se=S.startsWith("//")?new URL(he.protocol+S):new URL(S),ve=Nf(se.pathname,Z);se.origin===he.origin&&ve!=null?S=ve+se.search+se.hash:ce=!0}catch{Tc(!1,`<Link to="${S}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let ge=wF(S,{relative:u}),[ue,pe,me]=r6(i,N),Te=d6(S,{replace:g,state:b,target:o,preventScrollReset:M,relative:u,viewTransition:O});function ae(he){e&&e(he),he.defaultPrevented||Te(he)}let re=W.createElement("a",{...N,...me,href:Q||ge,onClick:ce||f?e:ae,ref:a6(j,pe),target:o,"data-discover":!K&&n==="render"?"true":void 0});return ue&&!K?W.createElement(W.Fragment,null,re,W.createElement(i6,{page:ge})):re});xc.displayName="Link";var c6=W.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:i="",end:u=!1,style:f,to:g,viewTransition:b,children:o,...S},M){let O=Xx(g,{relative:S.relative}),N=yh(),j=W.useContext(MT),{navigator:Z,basename:K}=W.useContext(mh),Q=j!=null&&y6(O)&&b===!0,ce=Z.encodeLocation?Z.encodeLocation(O).pathname:O.pathname,ge=N.pathname,ue=j&&j.navigation&&j.navigation.location?j.navigation.location.pathname:null;n||(ge=ge.toLowerCase(),ue=ue?ue.toLowerCase():null,ce=ce.toLowerCase()),ue&&K&&(ue=Nf(ue,K)||ue);const pe=ce!=="/"&&ce.endsWith("/")?ce.length-1:ce.length;let me=ge===ce||!u&&ge.startsWith(ce)&&ge.charAt(pe)==="/",Te=ue!=null&&(ue===ce||!u&&ue.startsWith(ce)&&ue.charAt(ce.length)==="/"),ae={isActive:me,isPending:Te,isTransitioning:Q},re=me?e:void 0,he;typeof i=="function"?he=i(ae):he=[i,me?"active":null,Te?"pending":null,Q?"transitioning":null].filter(Boolean).join(" ");let se=typeof f=="function"?f(ae):f;return W.createElement(xc,{...S,"aria-current":re,className:he,ref:M,style:se,to:g,viewTransition:b},typeof o=="function"?o(ae):o)});c6.displayName="NavLink";var u6=W.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:i,replace:u,state:f,method:g=vw,action:b,onSubmit:o,relative:S,preventScrollReset:M,viewTransition:O,...N},j)=>{let Z=m6(),K=g6(b,{relative:S}),Q=g.toLowerCase()==="get"?"get":"post",ce=typeof b=="string"&&a3.test(b),ge=ue=>{if(o&&o(ue),ue.defaultPrevented)return;ue.preventDefault();let pe=ue.nativeEvent.submitter,me=pe?.getAttribute("formmethod")||g;Z(pe||ue.currentTarget,{fetcherKey:e,method:me,navigate:n,replace:u,state:f,relative:S,preventScrollReset:M,viewTransition:O})};return W.createElement("form",{ref:j,method:Q,action:K,onSubmit:i?o:ge,...N,"data-discover":!ce&&t==="render"?"true":void 0})});u6.displayName="Form";function h6(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function l3(t){let e=W.useContext(X_);return Ts(e,h6(t)),e}function d6(t,{target:e,replace:n,state:i,preventScrollReset:u,relative:f,viewTransition:g}={}){let b=Cc(),o=yh(),S=Xx(t,{relative:f});return W.useCallback(M=>{if($F(M,e)){M.preventDefault();let O=n!==void 0?n:wx(o)===wx(S);b(t,{replace:O,state:i,preventScrollReset:u,relative:f,viewTransition:g})}},[o,b,S,n,i,e,t,u,f,g])}function c3(t){Tc(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=W.useRef(fC(t)),n=W.useRef(!1),i=yh(),u=W.useMemo(()=>qF(i.search,n.current?null:e.current),[i.search]),f=Cc(),g=W.useCallback((b,o)=>{const S=fC(typeof b=="function"?b(new URLSearchParams(u)):b);n.current=!0,f("?"+S,o)},[f,u]);return[u,g]}var f6=0,p6=()=>`__${String(++f6)}__`;function m6(){let{router:t}=l3("useSubmit"),{basename:e}=W.useContext(mh),n=DF();return W.useCallback(async(i,u={})=>{let{action:f,method:g,encType:b,formData:o,body:S}=WF(i,e);if(u.navigate===!1){let M=u.fetcherKey||p6();await t.fetch(M,n,u.action||f,{preventScrollReset:u.preventScrollReset,formData:o,body:S,formMethod:u.method||g,formEncType:u.encType||b,flushSync:u.flushSync})}else await t.navigate(u.action||f,{preventScrollReset:u.preventScrollReset,formData:o,body:S,formMethod:u.method||g,formEncType:u.encType||b,replace:u.replace,state:u.state,fromRouteId:n,flushSync:u.flushSync,viewTransition:u.viewTransition})},[t,e,n])}function g6(t,{relative:e}={}){let{basename:n}=W.useContext(mh),i=W.useContext(gh);Ts(i,"useFormAction must be used inside a RouteContext");let[u]=i.matches.slice(-1),f={...Xx(t||".",{relative:e})},g=yh();if(t==null){f.search=g.search;let b=new URLSearchParams(f.search),o=b.getAll("index");if(o.some(M=>M==="")){b.delete("index"),o.filter(O=>O).forEach(O=>b.append("index",O));let M=b.toString();f.search=M?`?${M}`:""}}return(!t||t===".")&&u.route.index&&(f.search=f.search?f.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(f.pathname=f.pathname==="/"?n:Of([n,f.pathname])),wx(f)}function y6(t,{relative:e}={}){let n=W.useContext(QO);Ts(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=l3("useViewTransitionState"),u=Xx(t,{relative:e});if(!n.isTransitioning)return!1;let f=Nf(n.currentLocation.pathname,i)||n.currentLocation.pathname,g=Nf(n.nextLocation.pathname,i)||n.nextLocation.pathname;return Ww(u.pathname,g)!=null||Ww(u.pathname,f)!=null}var u3=WO();const U1=RT(u3),HA=W.createContext({});function WA(t){const e=W.useRef(null);return e.current===null&&(e.current=t()),e.current}const XA=typeof window<"u",h3=XA?W.useLayoutEffect:W.useEffect,DT=W.createContext(null);function ZA(t,e){t.indexOf(e)===-1&&t.push(e)}function KA(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const Vf=(t,e,n)=>n>e?e:n<t?t:n;let YA=()=>{};const Ff={},d3=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function f3(t){return typeof t=="object"&&t!==null}const p3=t=>/^0[^.\s]+$/u.test(t);function QA(t){let e;return()=>(e===void 0&&(e=t()),e)}const pu=t=>t,_6=(t,e)=>n=>e(t(n)),Zx=(...t)=>t.reduce(_6),Tx=(t,e,n)=>{const i=e-t;return i===0?1:(n-t)/i};class JA{constructor(){this.subscriptions=[]}add(e){return ZA(this.subscriptions,e),()=>KA(this.subscriptions,e)}notify(e,n,i){const u=this.subscriptions.length;if(u)if(u===1)this.subscriptions[0](e,n,i);else for(let f=0;f<u;f++){const g=this.subscriptions[f];g&&g(e,n,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const vd=t=>t*1e3,du=t=>t/1e3;function m3(t,e){return e?t*(1e3/e):0}const g3=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,v6=1e-7,x6=12;function b6(t,e,n,i,u){let f,g,b=0;do g=e+(n-e)/2,f=g3(g,i,u)-t,f>0?n=g:e=g;while(Math.abs(f)>v6&&++b<x6);return g}function Kx(t,e,n,i){if(t===e&&n===i)return pu;const u=f=>b6(f,0,1,t,n);return f=>f===0||f===1?f:g3(u(f),e,i)}const y3=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,_3=t=>e=>1-t(1-e),v3=Kx(.33,1.53,.69,.99),eI=_3(v3),x3=y3(eI),b3=t=>(t*=2)<1?.5*eI(t):.5*(2-Math.pow(2,-10*(t-1))),tI=t=>1-Math.sin(Math.acos(t)),w3=_3(tI),T3=y3(tI),w6=Kx(.42,0,1,1),T6=Kx(0,0,.58,1),E3=Kx(.42,0,.58,1),E6=t=>Array.isArray(t)&&typeof t[0]!="number",S3=t=>Array.isArray(t)&&typeof t[0]=="number",S6={linear:pu,easeIn:w6,easeInOut:E3,easeOut:T6,circIn:tI,circInOut:T3,circOut:w3,backIn:eI,backInOut:x3,backOut:v3,anticipate:b3},C6=t=>typeof t=="string",pP=t=>{if(S3(t)){YA(t.length===4);const[e,n,i,u]=t;return Kx(e,n,i,u)}else if(C6(t))return S6[t];return t},j1=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function A6(t,e){let n=new Set,i=new Set,u=!1,f=!1;const g=new WeakSet;let b={delta:0,timestamp:0,isProcessing:!1};function o(M){g.has(M)&&(S.schedule(M),t()),M(b)}const S={schedule:(M,O=!1,N=!1)=>{const Z=N&&u?n:i;return O&&g.add(M),Z.has(M)||Z.add(M),M},cancel:M=>{i.delete(M),g.delete(M)},process:M=>{if(b=M,u){f=!0;return}u=!0,[n,i]=[i,n],n.forEach(o),n.clear(),u=!1,f&&(f=!1,S.process(M))}};return S}const I6=40;function C3(t,e){let n=!1,i=!0;const u={delta:0,timestamp:0,isProcessing:!1},f=()=>n=!0,g=j1.reduce((ue,pe)=>(ue[pe]=A6(f),ue),{}),{setup:b,read:o,resolveKeyframes:S,preUpdate:M,update:O,preRender:N,render:j,postRender:Z}=g,K=()=>{const ue=Ff.useManualTiming?u.timestamp:performance.now();n=!1,Ff.useManualTiming||(u.delta=i?1e3/60:Math.max(Math.min(ue-u.timestamp,I6),1)),u.timestamp=ue,u.isProcessing=!0,b.process(u),o.process(u),S.process(u),M.process(u),O.process(u),N.process(u),j.process(u),Z.process(u),u.isProcessing=!1,n&&e&&(i=!1,t(K))},Q=()=>{n=!0,i=!0,u.isProcessing||t(K)};return{schedule:j1.reduce((ue,pe)=>{const me=g[pe];return ue[pe]=(Te,ae=!1,re=!1)=>(n||Q(),me.schedule(Te,ae,re)),ue},{}),cancel:ue=>{for(let pe=0;pe<j1.length;pe++)g[j1[pe]].cancel(ue)},state:u,steps:g}}const{schedule:ws,cancel:am,state:ga,steps:fS}=C3(typeof requestAnimationFrame<"u"?requestAnimationFrame:pu,!0);let bw;function R6(){bw=void 0}const Ul={now:()=>(bw===void 0&&Ul.set(ga.isProcessing||Ff.useManualTiming?ga.timestamp:performance.now()),bw),set:t=>{bw=t,queueMicrotask(R6)}},A3=t=>e=>typeof e=="string"&&e.startsWith(t),nI=A3("--"),M6=A3("var(--"),rI=t=>M6(t)?P6.test(t.split("/*")[0].trim()):!1,P6=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,K_={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Ex={...K_,transform:t=>Vf(0,1,t)},$1={...K_,default:1},ix=t=>Math.round(t*1e5)/1e5,iI=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function k6(t){return t==null}const D6=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,sI=(t,e)=>n=>!!(typeof n=="string"&&D6.test(n)&&n.startsWith(t)||e&&!k6(n)&&Object.prototype.hasOwnProperty.call(n,e)),I3=(t,e,n)=>i=>{if(typeof i!="string")return i;const[u,f,g,b]=i.match(iI);return{[t]:parseFloat(u),[e]:parseFloat(f),[n]:parseFloat(g),alpha:b!==void 0?parseFloat(b):1}},L6=t=>Vf(0,255,t),pS={...K_,transform:t=>Math.round(L6(t))},Tg={test:sI("rgb","red"),parse:I3("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:i=1})=>"rgba("+pS.transform(t)+", "+pS.transform(e)+", "+pS.transform(n)+", "+ix(Ex.transform(i))+")"};function O6(t){let e="",n="",i="",u="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),i=t.substring(5,7),u=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),i=t.substring(3,4),u=t.substring(4,5),e+=e,n+=n,i+=i,u+=u),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:u?parseInt(u,16)/255:1}}const pC={test:sI("#"),parse:O6,transform:Tg.transform},Yx=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Wp=Yx("deg"),xd=Yx("%"),yr=Yx("px"),z6=Yx("vh"),B6=Yx("vw"),mP={...xd,parse:t=>xd.parse(t)/100,transform:t=>xd.transform(t*100)},d_={test:sI("hsl","hue"),parse:I3("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:i=1})=>"hsla("+Math.round(t)+", "+xd.transform(ix(e))+", "+xd.transform(ix(n))+", "+ix(Ex.transform(i))+")"},mo={test:t=>Tg.test(t)||pC.test(t)||d_.test(t),parse:t=>Tg.test(t)?Tg.parse(t):d_.test(t)?d_.parse(t):pC.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Tg.transform(t):d_.transform(t),getAnimatableNone:t=>{const e=mo.parse(t);return e.alpha=0,mo.transform(e)}},N6=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function V6(t){return isNaN(t)&&typeof t=="string"&&(t.match(iI)?.length||0)+(t.match(N6)?.length||0)>0}const R3="number",M3="color",F6="var",U6="var(",gP="${}",j6=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Sx(t){const e=t.toString(),n=[],i={color:[],number:[],var:[]},u=[];let f=0;const b=e.replace(j6,o=>(mo.test(o)?(i.color.push(f),u.push(M3),n.push(mo.parse(o))):o.startsWith(U6)?(i.var.push(f),u.push(F6),n.push(o)):(i.number.push(f),u.push(R3),n.push(parseFloat(o))),++f,gP)).split(gP);return{values:n,split:b,indexes:i,types:u}}function P3(t){return Sx(t).values}function k3(t){const{split:e,types:n}=Sx(t),i=e.length;return u=>{let f="";for(let g=0;g<i;g++)if(f+=e[g],u[g]!==void 0){const b=n[g];b===R3?f+=ix(u[g]):b===M3?f+=mo.transform(u[g]):f+=u[g]}return f}}const $6=t=>typeof t=="number"?0:mo.test(t)?mo.getAnimatableNone(t):t;function q6(t){const e=P3(t);return k3(t)(e.map($6))}const lm={test:V6,parse:P3,createTransformer:k3,getAnimatableNone:q6};function mS(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function G6({hue:t,saturation:e,lightness:n,alpha:i}){t/=360,e/=100,n/=100;let u=0,f=0,g=0;if(!e)u=f=g=n;else{const b=n<.5?n*(1+e):n+e-n*e,o=2*n-b;u=mS(o,b,t+1/3),f=mS(o,b,t),g=mS(o,b,t-1/3)}return{red:Math.round(u*255),green:Math.round(f*255),blue:Math.round(g*255),alpha:i}}function Xw(t,e){return n=>n>0?e:t}const Ms=(t,e,n)=>t+(e-t)*n,gS=(t,e,n)=>{const i=t*t,u=n*(e*e-i)+i;return u<0?0:Math.sqrt(u)},H6=[pC,Tg,d_],W6=t=>H6.find(e=>e.test(t));function yP(t){const e=W6(t);if(!e)return!1;let n=e.parse(t);return e===d_&&(n=G6(n)),n}const _P=(t,e)=>{const n=yP(t),i=yP(e);if(!n||!i)return Xw(t,e);const u={...n};return f=>(u.red=gS(n.red,i.red,f),u.green=gS(n.green,i.green,f),u.blue=gS(n.blue,i.blue,f),u.alpha=Ms(n.alpha,i.alpha,f),Tg.transform(u))},mC=new Set(["none","hidden"]);function X6(t,e){return mC.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function Z6(t,e){return n=>Ms(t,e,n)}function oI(t){return typeof t=="number"?Z6:typeof t=="string"?rI(t)?Xw:mo.test(t)?_P:Q6:Array.isArray(t)?D3:typeof t=="object"?mo.test(t)?_P:K6:Xw}function D3(t,e){const n=[...t],i=n.length,u=t.map((f,g)=>oI(f)(f,e[g]));return f=>{for(let g=0;g<i;g++)n[g]=u[g](f);return n}}function K6(t,e){const n={...t,...e},i={};for(const u in n)t[u]!==void 0&&e[u]!==void 0&&(i[u]=oI(t[u])(t[u],e[u]));return u=>{for(const f in i)n[f]=i[f](u);return n}}function Y6(t,e){const n=[],i={color:0,var:0,number:0};for(let u=0;u<e.values.length;u++){const f=e.types[u],g=t.indexes[f][i[f]],b=t.values[g]??0;n[u]=b,i[f]++}return n}const Q6=(t,e)=>{const n=lm.createTransformer(e),i=Sx(t),u=Sx(e);return i.indexes.var.length===u.indexes.var.length&&i.indexes.color.length===u.indexes.color.length&&i.indexes.number.length>=u.indexes.number.length?mC.has(t)&&!u.values.length||mC.has(e)&&!i.values.length?X6(t,e):Zx(D3(Y6(i,u),u.values),n):Xw(t,e)};function L3(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?Ms(t,e,n):oI(t)(t,e)}const J6=t=>{const e=({timestamp:n})=>t(n);return{start:(n=!0)=>ws.update(e,n),stop:()=>am(e),now:()=>ga.isProcessing?ga.timestamp:Ul.now()}},O3=(t,e,n=10)=>{let i="";const u=Math.max(Math.round(e/n),2);for(let f=0;f<u;f++)i+=Math.round(t(f/(u-1))*1e4)/1e4+", ";return`linear(${i.substring(0,i.length-2)})`},Zw=2e4;function aI(t){let e=0;const n=50;let i=t.next(e);for(;!i.done&&e<Zw;)e+=n,i=t.next(e);return e>=Zw?1/0:e}function eU(t,e=100,n){const i=n({...t,keyframes:[0,e]}),u=Math.min(aI(i),Zw);return{type:"keyframes",ease:f=>i.next(u*f).value/e,duration:du(u)}}const tU=5;function z3(t,e,n){const i=Math.max(e-tU,0);return m3(n-t(i),e-i)}const Fs={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},yS=.001;function nU({duration:t=Fs.duration,bounce:e=Fs.bounce,velocity:n=Fs.velocity,mass:i=Fs.mass}){let u,f,g=1-e;g=Vf(Fs.minDamping,Fs.maxDamping,g),t=Vf(Fs.minDuration,Fs.maxDuration,du(t)),g<1?(u=S=>{const M=S*g,O=M*t,N=M-n,j=gC(S,g),Z=Math.exp(-O);return yS-N/j*Z},f=S=>{const O=S*g*t,N=O*n+n,j=Math.pow(g,2)*Math.pow(S,2)*t,Z=Math.exp(-O),K=gC(Math.pow(S,2),g);return(-u(S)+yS>0?-1:1)*((N-j)*Z)/K}):(u=S=>{const M=Math.exp(-S*t),O=(S-n)*t+1;return-yS+M*O},f=S=>{const M=Math.exp(-S*t),O=(n-S)*(t*t);return M*O});const b=5/t,o=iU(u,f,b);if(t=vd(t),isNaN(o))return{stiffness:Fs.stiffness,damping:Fs.damping,duration:t};{const S=Math.pow(o,2)*i;return{stiffness:S,damping:g*2*Math.sqrt(i*S),duration:t}}}const rU=12;function iU(t,e,n){let i=n;for(let u=1;u<rU;u++)i=i-t(i)/e(i);return i}function gC(t,e){return t*Math.sqrt(1-e*e)}const sU=["duration","bounce"],oU=["stiffness","damping","mass"];function vP(t,e){return e.some(n=>t[n]!==void 0)}function aU(t){let e={velocity:Fs.velocity,stiffness:Fs.stiffness,damping:Fs.damping,mass:Fs.mass,isResolvedFromDuration:!1,...t};if(!vP(t,oU)&&vP(t,sU))if(t.visualDuration){const n=t.visualDuration,i=2*Math.PI/(n*1.2),u=i*i,f=2*Vf(.05,1,1-(t.bounce||0))*Math.sqrt(u);e={...e,mass:Fs.mass,stiffness:u,damping:f}}else{const n=nU(t);e={...e,...n,mass:Fs.mass},e.isResolvedFromDuration=!0}return e}function Kw(t=Fs.visualDuration,e=Fs.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:i,restDelta:u}=n;const f=n.keyframes[0],g=n.keyframes[n.keyframes.length-1],b={done:!1,value:f},{stiffness:o,damping:S,mass:M,duration:O,velocity:N,isResolvedFromDuration:j}=aU({...n,velocity:-du(n.velocity||0)}),Z=N||0,K=S/(2*Math.sqrt(o*M)),Q=g-f,ce=du(Math.sqrt(o/M)),ge=Math.abs(Q)<5;i||(i=ge?Fs.restSpeed.granular:Fs.restSpeed.default),u||(u=ge?Fs.restDelta.granular:Fs.restDelta.default);let ue;if(K<1){const me=gC(ce,K);ue=Te=>{const ae=Math.exp(-K*ce*Te);return g-ae*((Z+K*ce*Q)/me*Math.sin(me*Te)+Q*Math.cos(me*Te))}}else if(K===1)ue=me=>g-Math.exp(-ce*me)*(Q+(Z+ce*Q)*me);else{const me=ce*Math.sqrt(K*K-1);ue=Te=>{const ae=Math.exp(-K*ce*Te),re=Math.min(me*Te,300);return g-ae*((Z+K*ce*Q)*Math.sinh(re)+me*Q*Math.cosh(re))/me}}const pe={calculatedDuration:j&&O||null,next:me=>{const Te=ue(me);if(j)b.done=me>=O;else{let ae=me===0?Z:0;K<1&&(ae=me===0?vd(Z):z3(ue,me,Te));const re=Math.abs(ae)<=i,he=Math.abs(g-Te)<=u;b.done=re&&he}return b.value=b.done?g:Te,b},toString:()=>{const me=Math.min(aI(pe),Zw),Te=O3(ae=>pe.next(me*ae).value,me,30);return me+"ms "+Te},toTransition:()=>{}};return pe}Kw.applyToOptions=t=>{const e=eU(t,100,Kw);return t.ease=e.ease,t.duration=vd(e.duration),t.type="keyframes",t};function yC({keyframes:t,velocity:e=0,power:n=.8,timeConstant:i=325,bounceDamping:u=10,bounceStiffness:f=500,modifyTarget:g,min:b,max:o,restDelta:S=.5,restSpeed:M}){const O=t[0],N={done:!1,value:O},j=re=>b!==void 0&&re<b||o!==void 0&&re>o,Z=re=>b===void 0?o:o===void 0||Math.abs(b-re)<Math.abs(o-re)?b:o;let K=n*e;const Q=O+K,ce=g===void 0?Q:g(Q);ce!==Q&&(K=ce-O);const ge=re=>-K*Math.exp(-re/i),ue=re=>ce+ge(re),pe=re=>{const he=ge(re),se=ue(re);N.done=Math.abs(he)<=S,N.value=N.done?ce:se};let me,Te;const ae=re=>{j(N.value)&&(me=re,Te=Kw({keyframes:[N.value,Z(N.value)],velocity:z3(ue,re,N.value),damping:u,stiffness:f,restDelta:S,restSpeed:M}))};return ae(0),{calculatedDuration:null,next:re=>{let he=!1;return!Te&&me===void 0&&(he=!0,pe(re),ae(re)),me!==void 0&&re>=me?Te.next(re-me):(!he&&pe(re),N)}}}function lU(t,e,n){const i=[],u=n||Ff.mix||L3,f=t.length-1;for(let g=0;g<f;g++){let b=u(t[g],t[g+1]);if(e){const o=Array.isArray(e)?e[g]||pu:e;b=Zx(o,b)}i.push(b)}return i}function cU(t,e,{clamp:n=!0,ease:i,mixer:u}={}){const f=t.length;if(YA(f===e.length),f===1)return()=>e[0];if(f===2&&e[0]===e[1])return()=>e[1];const g=t[0]===t[1];t[0]>t[f-1]&&(t=[...t].reverse(),e=[...e].reverse());const b=lU(e,i,u),o=b.length,S=M=>{if(g&&M<t[0])return e[0];let O=0;if(o>1)for(;O<t.length-2&&!(M<t[O+1]);O++);const N=Tx(t[O],t[O+1],M);return b[O](N)};return n?M=>S(Vf(t[0],t[f-1],M)):S}function uU(t,e){const n=t[t.length-1];for(let i=1;i<=e;i++){const u=Tx(0,e,i);t.push(Ms(n,1,u))}}function hU(t){const e=[0];return uU(e,t.length-1),e}function dU(t,e){return t.map(n=>n*e)}function fU(t,e){return t.map(()=>e||E3).splice(0,t.length-1)}function sx({duration:t=300,keyframes:e,times:n,ease:i="easeInOut"}){const u=E6(i)?i.map(pP):pP(i),f={done:!1,value:e[0]},g=dU(n&&n.length===e.length?n:hU(e),t),b=cU(g,e,{ease:Array.isArray(u)?u:fU(e,u)});return{calculatedDuration:t,next:o=>(f.value=b(o),f.done=o>=t,f)}}const pU=t=>t!==null;function lI(t,{repeat:e,repeatType:n="loop"},i,u=1){const f=t.filter(pU),b=u<0||e&&n!=="loop"&&e%2===1?0:f.length-1;return!b||i===void 0?f[b]:i}const mU={decay:yC,inertia:yC,tween:sx,keyframes:sx,spring:Kw};function B3(t){typeof t.type=="string"&&(t.type=mU[t.type])}class cI{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,n){return this.finished.then(e,n)}}const gU=t=>t/100;class uI extends cI{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;n&&n.updatedAt!==Ul.now()&&this.tick(Ul.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;B3(e);const{type:n=sx,repeat:i=0,repeatDelay:u=0,repeatType:f,velocity:g=0}=e;let{keyframes:b}=e;const o=n||sx;o!==sx&&typeof b[0]!="number"&&(this.mixKeyframes=Zx(gU,L3(b[0],b[1])),b=[0,100]);const S=o({...e,keyframes:b});f==="mirror"&&(this.mirroredGenerator=o({...e,keyframes:[...b].reverse(),velocity:-g})),S.calculatedDuration===null&&(S.calculatedDuration=aI(S));const{calculatedDuration:M}=S;this.calculatedDuration=M,this.resolvedDuration=M+u,this.totalDuration=this.resolvedDuration*(i+1)-u,this.generator=S}updateTime(e){const n=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(e,n=!1){const{generator:i,totalDuration:u,mixKeyframes:f,mirroredGenerator:g,resolvedDuration:b,calculatedDuration:o}=this;if(this.startTime===null)return i.next(0);const{delay:S=0,keyframes:M,repeat:O,repeatType:N,repeatDelay:j,type:Z,onUpdate:K,finalKeyframe:Q}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-u/this.speed,this.startTime)),n?this.currentTime=e:this.updateTime(e);const ce=this.currentTime-S*(this.playbackSpeed>=0?1:-1),ge=this.playbackSpeed>=0?ce<0:ce>u;this.currentTime=Math.max(ce,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let ue=this.currentTime,pe=i;if(O){const re=Math.min(this.currentTime,u)/b;let he=Math.floor(re),se=re%1;!se&&re>=1&&(se=1),se===1&&he--,he=Math.min(he,O+1),!!(he%2)&&(N==="reverse"?(se=1-se,j&&(se-=j/b)):N==="mirror"&&(pe=g)),ue=Vf(0,1,se)*b}const me=ge?{done:!1,value:M[0]}:pe.next(ue);f&&(me.value=f(me.value));let{done:Te}=me;!ge&&o!==null&&(Te=this.playbackSpeed>=0?this.currentTime>=u:this.currentTime<=0);const ae=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&Te);return ae&&Z!==yC&&(me.value=lI(M,this.options,Q,this.speed)),K&&K(me.value),ae&&this.finish(),me}then(e,n){return this.finished.then(e,n)}get duration(){return du(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+du(e)}get time(){return du(this.currentTime)}set time(e){e=vd(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Ul.now());const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=du(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=J6,startTime:n}=this.options;this.driver||(this.driver=e(u=>this.tick(u))),this.options.onPlay?.();const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=n??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ul.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function yU(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const Eg=t=>t*180/Math.PI,_C=t=>{const e=Eg(Math.atan2(t[1],t[0]));return vC(e)},_U={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:_C,rotateZ:_C,skewX:t=>Eg(Math.atan(t[1])),skewY:t=>Eg(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},vC=t=>(t=t%360,t<0&&(t+=360),t),xP=_C,bP=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),wP=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),vU={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:bP,scaleY:wP,scale:t=>(bP(t)+wP(t))/2,rotateX:t=>vC(Eg(Math.atan2(t[6],t[5]))),rotateY:t=>vC(Eg(Math.atan2(-t[2],t[0]))),rotateZ:xP,rotate:xP,skewX:t=>Eg(Math.atan(t[4])),skewY:t=>Eg(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function xC(t){return t.includes("scale")?1:0}function bC(t,e){if(!t||t==="none")return xC(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,u;if(n)i=vU,u=n;else{const b=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=_U,u=b}if(!u)return xC(e);const f=i[e],g=u[1].split(",").map(bU);return typeof f=="function"?f(g):g[f]}const xU=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return bC(n,e)};function bU(t){return parseFloat(t.trim())}const Y_=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Q_=new Set(Y_),TP=t=>t===K_||t===yr,wU=new Set(["x","y","z"]),TU=Y_.filter(t=>!wU.has(t));function EU(t){const e=[];return TU.forEach(n=>{const i=t.getValue(n);i!==void 0&&(e.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))}),e}const Rg={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>bC(e,"x"),y:(t,{transform:e})=>bC(e,"y")};Rg.translateX=Rg.x;Rg.translateY=Rg.y;const Mg=new Set;let wC=!1,TC=!1,EC=!1;function N3(){if(TC){const t=Array.from(Mg).filter(i=>i.needsMeasurement),e=new Set(t.map(i=>i.element)),n=new Map;e.forEach(i=>{const u=EU(i);u.length&&(n.set(i,u),i.render())}),t.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const u=n.get(i);u&&u.forEach(([f,g])=>{i.getValue(f)?.set(g)})}),t.forEach(i=>i.measureEndState()),t.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}TC=!1,wC=!1,Mg.forEach(t=>t.complete(EC)),Mg.clear()}function V3(){Mg.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(TC=!0)})}function SU(){EC=!0,V3(),N3(),EC=!1}class hI{constructor(e,n,i,u,f,g=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=i,this.motionValue=u,this.element=f,this.isAsync=g}scheduleResolve(){this.state="scheduled",this.isAsync?(Mg.add(this),wC||(wC=!0,ws.read(V3),ws.resolveKeyframes(N3))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:i,motionValue:u}=this;if(e[0]===null){const f=u?.get(),g=e[e.length-1];if(f!==void 0)e[0]=f;else if(i&&n){const b=i.readValue(n,g);b!=null&&(e[0]=b)}e[0]===void 0&&(e[0]=g),u&&f===void 0&&u.set(e[0])}yU(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Mg.delete(this)}cancel(){this.state==="scheduled"&&(Mg.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const CU=t=>t.startsWith("--");function AU(t,e,n){CU(e)?t.style.setProperty(e,n):t.style[e]=n}const IU=QA(()=>window.ScrollTimeline!==void 0),RU={};function MU(t,e){const n=QA(t);return()=>RU[e]??n()}const F3=MU(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),H0=([t,e,n,i])=>`cubic-bezier(${t}, ${e}, ${n}, ${i})`,EP={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:H0([0,.65,.55,1]),circOut:H0([.55,0,1,.45]),backIn:H0([.31,.01,.66,-.59]),backOut:H0([.33,1.53,.69,.99])};function U3(t,e){if(t)return typeof t=="function"?F3()?O3(t,e):"ease-out":S3(t)?H0(t):Array.isArray(t)?t.map(n=>U3(n,e)||EP.easeOut):EP[t]}function PU(t,e,n,{delay:i=0,duration:u=300,repeat:f=0,repeatType:g="loop",ease:b="easeOut",times:o}={},S=void 0){const M={[e]:n};o&&(M.offset=o);const O=U3(b,u);Array.isArray(O)&&(M.easing=O);const N={delay:i,duration:u,easing:Array.isArray(O)?"linear":O,fill:"both",iterations:f+1,direction:g==="reverse"?"alternate":"normal"};return S&&(N.pseudoElement=S),t.animate(M,N)}function j3(t){return typeof t=="function"&&"applyToOptions"in t}function kU({type:t,...e}){return j3(t)&&F3()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class DU extends cI{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:n,name:i,keyframes:u,pseudoElement:f,allowFlatten:g=!1,finalKeyframe:b,onComplete:o}=e;this.isPseudoElement=!!f,this.allowFlatten=g,this.options=e,YA(typeof e.type!="string");const S=kU(e);this.animation=PU(n,i,u,S,f),S.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!f){const M=lI(u,this.options,b,this.speed);this.updateMotionValue?this.updateMotionValue(M):AU(n,i,M),this.animation.cancel()}o?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return du(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+du(e)}get time(){return du(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=vd(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:n}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&IU()?(this.animation.timeline=e,pu):n(this)}}const $3={anticipate:b3,backInOut:x3,circInOut:T3};function LU(t){return t in $3}function OU(t){typeof t.ease=="string"&&LU(t.ease)&&(t.ease=$3[t.ease])}const SP=10;class zU extends DU{constructor(e){OU(e),B3(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:n,onUpdate:i,onComplete:u,element:f,...g}=this.options;if(!n)return;if(e!==void 0){n.set(e);return}const b=new uI({...g,autoplay:!1}),o=vd(this.finishedTime??this.time);n.setWithVelocity(b.sample(o-SP).value,b.sample(o).value,SP),b.stop()}}const CP=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(lm.test(t)||t==="0")&&!t.startsWith("url("));function BU(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function NU(t,e,n,i){const u=t[0];if(u===null)return!1;if(e==="display"||e==="visibility")return!0;const f=t[t.length-1],g=CP(u,e),b=CP(f,e);return!g||!b?!1:BU(t)||(n==="spring"||j3(n))&&i}function SC(t){t.duration=0,t.type="keyframes"}const VU=new Set(["opacity","clipPath","filter","transform"]),FU=QA(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function UU(t){const{motionValue:e,name:n,repeatDelay:i,repeatType:u,damping:f,type:g}=t;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:o,transformTemplate:S}=e.owner.getProps();return FU()&&n&&VU.has(n)&&(n!=="transform"||!S)&&!o&&!i&&u!=="mirror"&&f!==0&&g!=="inertia"}const jU=40;class $U extends cI{constructor({autoplay:e=!0,delay:n=0,type:i="keyframes",repeat:u=0,repeatDelay:f=0,repeatType:g="loop",keyframes:b,name:o,motionValue:S,element:M,...O}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Ul.now();const N={autoplay:e,delay:n,type:i,repeat:u,repeatDelay:f,repeatType:g,name:o,motionValue:S,element:M,...O},j=M?.KeyframeResolver||hI;this.keyframeResolver=new j(b,(Z,K,Q)=>this.onKeyframesResolved(Z,K,N,!Q),o,S,M),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,n,i,u){this.keyframeResolver=void 0;const{name:f,type:g,velocity:b,delay:o,isHandoff:S,onUpdate:M}=i;this.resolvedAt=Ul.now(),NU(e,f,g,b)||((Ff.instantAnimations||!o)&&M?.(lI(e,i,n)),e[0]=e[e.length-1],SC(i),i.repeat=0);const N={startTime:u?this.resolvedAt?this.resolvedAt-this.createdAt>jU?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...i,keyframes:e},j=!S&&UU(N)?new zU({...N,element:N.motionValue.owner.current}):new uI(N);j.finished.then(()=>this.notifyFinished()).catch(pu),this.pendingTimeline&&(this.stopTimeline=j.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=j}get finished(){return this._animation?this.animation.finished:this._finished}then(e,n){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),SU()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const qU=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function GU(t){const e=qU.exec(t);if(!e)return[,];const[,n,i,u]=e;return[`--${n??i}`,u]}function q3(t,e,n=1){const[i,u]=GU(t);if(!i)return;const f=window.getComputedStyle(e).getPropertyValue(i);if(f){const g=f.trim();return d3(g)?parseFloat(g):g}return rI(u)?q3(u,e,n+1):u}function dI(t,e){return t?.[e]??t?.default??t}const G3=new Set(["width","height","top","left","right","bottom",...Y_]),HU={test:t=>t==="auto",parse:t=>t},H3=t=>e=>e.test(t),W3=[K_,yr,xd,Wp,B6,z6,HU],AP=t=>W3.find(H3(t));function WU(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||p3(t):!0}const XU=new Set(["brightness","contrast","saturate","opacity"]);function ZU(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[i]=n.match(iI)||[];if(!i)return t;const u=n.replace(i,"");let f=XU.has(e)?1:0;return i!==n&&(f*=100),e+"("+f+u+")"}const KU=/\b([a-z-]*)\(.*?\)/gu,CC={...lm,getAnimatableNone:t=>{const e=t.match(KU);return e?e.map(ZU).join(" "):t}},IP={...K_,transform:Math.round},YU={rotate:Wp,rotateX:Wp,rotateY:Wp,rotateZ:Wp,scale:$1,scaleX:$1,scaleY:$1,scaleZ:$1,skew:Wp,skewX:Wp,skewY:Wp,distance:yr,translateX:yr,translateY:yr,translateZ:yr,x:yr,y:yr,z:yr,perspective:yr,transformPerspective:yr,opacity:Ex,originX:mP,originY:mP,originZ:yr},fI={borderWidth:yr,borderTopWidth:yr,borderRightWidth:yr,borderBottomWidth:yr,borderLeftWidth:yr,borderRadius:yr,radius:yr,borderTopLeftRadius:yr,borderTopRightRadius:yr,borderBottomRightRadius:yr,borderBottomLeftRadius:yr,width:yr,maxWidth:yr,height:yr,maxHeight:yr,top:yr,right:yr,bottom:yr,left:yr,padding:yr,paddingTop:yr,paddingRight:yr,paddingBottom:yr,paddingLeft:yr,margin:yr,marginTop:yr,marginRight:yr,marginBottom:yr,marginLeft:yr,backgroundPositionX:yr,backgroundPositionY:yr,...YU,zIndex:IP,fillOpacity:Ex,strokeOpacity:Ex,numOctaves:IP},QU={...fI,color:mo,backgroundColor:mo,outlineColor:mo,fill:mo,stroke:mo,borderColor:mo,borderTopColor:mo,borderRightColor:mo,borderBottomColor:mo,borderLeftColor:mo,filter:CC,WebkitFilter:CC},X3=t=>QU[t];function Z3(t,e){let n=X3(t);return n!==CC&&(n=lm),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const JU=new Set(["auto","none","0"]);function ej(t,e,n){let i=0,u;for(;i<t.length&&!u;){const f=t[i];typeof f=="string"&&!JU.has(f)&&Sx(f).values.length&&(u=t[i]),i++}if(u&&n)for(const f of e)t[f]=Z3(n,u)}class tj extends hI{constructor(e,n,i,u,f){super(e,n,i,u,f,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:i}=this;if(!n||!n.current)return;super.readKeyframes();for(let o=0;o<e.length;o++){let S=e[o];if(typeof S=="string"&&(S=S.trim(),rI(S))){const M=q3(S,n.current);M!==void 0&&(e[o]=M),o===e.length-1&&(this.finalKeyframe=S)}}if(this.resolveNoneKeyframes(),!G3.has(i)||e.length!==2)return;const[u,f]=e,g=AP(u),b=AP(f);if(g!==b)if(TP(g)&&TP(b))for(let o=0;o<e.length;o++){const S=e[o];typeof S=="string"&&(e[o]=parseFloat(S))}else Rg[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,i=[];for(let u=0;u<e.length;u++)(e[u]===null||WU(e[u]))&&i.push(u);i.length&&ej(e,i,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Rg[i](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const u=n[n.length-1];u!==void 0&&e.getValue(i,u).jump(u,!1)}measureEndState(){const{element:e,name:n,unresolvedKeyframes:i}=this;if(!e||!e.current)return;const u=e.getValue(n);u&&u.jump(this.measuredOrigin,!1);const f=i.length-1,g=i[f];i[f]=Rg[n](e.measureViewportBox(),window.getComputedStyle(e.current)),g!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=g),this.removedTransforms?.length&&this.removedTransforms.forEach(([b,o])=>{e.getValue(b).set(o)}),this.resolveNoneKeyframes()}}function nj(t,e,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let i=document;const u=n?.[t]??i.querySelectorAll(t);return u?Array.from(u):[]}return Array.from(t)}const K3=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function Y3(t){return f3(t)&&"offsetHeight"in t}const RP=30,rj=t=>!isNaN(parseFloat(t));class ij{constructor(e,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=i=>{const u=Ul.now();if(this.updatedAt!==u&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const f of this.dependents)f.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Ul.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=rj(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new JA);const i=this.events[e].add(n);return e==="change"?()=>{i(),ws.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,n,i){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Ul.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>RP)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,RP);return m3(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function R_(t,e){return new ij(t,e)}const{schedule:pI}=C3(queueMicrotask,!1),lh={x:!1,y:!1};function Q3(){return lh.x||lh.y}function sj(t){return t==="x"||t==="y"?lh[t]?null:(lh[t]=!0,()=>{lh[t]=!1}):lh.x||lh.y?null:(lh.x=lh.y=!0,()=>{lh.x=lh.y=!1})}function J3(t,e){const n=nj(t),i=new AbortController,u={passive:!0,...e,signal:i.signal};return[n,u,()=>i.abort()]}function MP(t){return!(t.pointerType==="touch"||Q3())}function oj(t,e,n={}){const[i,u,f]=J3(t,n),g=b=>{if(!MP(b))return;const{target:o}=b,S=e(o,b);if(typeof S!="function"||!o)return;const M=O=>{MP(O)&&(S(O),o.removeEventListener("pointerleave",M))};o.addEventListener("pointerleave",M,u)};return i.forEach(b=>{b.addEventListener("pointerenter",g,u)}),f}const ez=(t,e)=>e?t===e?!0:ez(t,e.parentElement):!1,mI=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,aj=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function lj(t){return aj.has(t.tagName)||t.tabIndex!==-1}const ww=new WeakSet;function PP(t){return e=>{e.key==="Enter"&&t(e)}}function _S(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const cj=(t,e)=>{const n=t.currentTarget;if(!n)return;const i=PP(()=>{if(ww.has(n))return;_S(n,"down");const u=PP(()=>{_S(n,"up")}),f=()=>_S(n,"cancel");n.addEventListener("keyup",u,e),n.addEventListener("blur",f,e)});n.addEventListener("keydown",i,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",i),e)};function kP(t){return mI(t)&&!Q3()}function uj(t,e,n={}){const[i,u,f]=J3(t,n),g=b=>{const o=b.currentTarget;if(!kP(b))return;ww.add(o);const S=e(o,b),M=(j,Z)=>{window.removeEventListener("pointerup",O),window.removeEventListener("pointercancel",N),ww.has(o)&&ww.delete(o),kP(j)&&typeof S=="function"&&S(j,{success:Z})},O=j=>{M(j,o===window||o===document||n.useGlobalTarget||ez(o,j.target))},N=j=>{M(j,!1)};window.addEventListener("pointerup",O,u),window.addEventListener("pointercancel",N,u)};return i.forEach(b=>{(n.useGlobalTarget?window:b).addEventListener("pointerdown",g,u),Y3(b)&&(b.addEventListener("focus",S=>cj(S,u)),!lj(b)&&!b.hasAttribute("tabindex")&&(b.tabIndex=0))}),f}function tz(t){return f3(t)&&"ownerSVGElement"in t}function hj(t){return tz(t)&&t.tagName==="svg"}const Qa=t=>!!(t&&t.getVelocity),dj=[...W3,mo,lm],fj=t=>dj.find(H3(t)),gI=W.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function DP(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function pj(...t){return e=>{let n=!1;const i=t.map(u=>{const f=DP(u,e);return!n&&typeof f=="function"&&(n=!0),f});if(n)return()=>{for(let u=0;u<i.length;u++){const f=i[u];typeof f=="function"?f():DP(t[u],null)}}}}function mj(...t){return W.useCallback(pj(...t),t)}class gj extends W.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const i=n.offsetParent,u=Y3(i)&&i.offsetWidth||0,f=this.props.sizeRef.current;f.height=n.offsetHeight||0,f.width=n.offsetWidth||0,f.top=n.offsetTop,f.left=n.offsetLeft,f.right=u-f.width-f.left}return null}componentDidUpdate(){}render(){return this.props.children}}function yj({children:t,isPresent:e,anchorX:n,root:i}){const u=W.useId(),f=W.useRef(null),g=W.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:b}=W.useContext(gI),o=mj(f,t?.ref);return W.useInsertionEffect(()=>{const{width:S,height:M,top:O,left:N,right:j}=g.current;if(e||!f.current||!S||!M)return;const Z=n==="left"?`left: ${N}`:`right: ${j}`;f.current.dataset.motionPopId=u;const K=document.createElement("style");b&&(K.nonce=b);const Q=i??document.head;return Q.appendChild(K),K.sheet&&K.sheet.insertRule(`
          [data-motion-pop-id="${u}"] {
            position: absolute !important;
            width: ${S}px !important;
            height: ${M}px !important;
            ${Z}px !important;
            top: ${O}px !important;
          }
        `),()=>{Q.contains(K)&&Q.removeChild(K)}},[e]),U.jsx(gj,{isPresent:e,childRef:f,sizeRef:g,children:W.cloneElement(t,{ref:o})})}const _j=({children:t,initial:e,isPresent:n,onExitComplete:i,custom:u,presenceAffectsLayout:f,mode:g,anchorX:b,root:o})=>{const S=WA(vj),M=W.useId();let O=!0,N=W.useMemo(()=>(O=!1,{id:M,initial:e,isPresent:n,custom:u,onExitComplete:j=>{S.set(j,!0);for(const Z of S.values())if(!Z)return;i&&i()},register:j=>(S.set(j,!1),()=>S.delete(j))}),[n,S,i]);return f&&O&&(N={...N}),W.useMemo(()=>{S.forEach((j,Z)=>S.set(Z,!1))},[n]),W.useEffect(()=>{!n&&!S.size&&i&&i()},[n]),g==="popLayout"&&(t=U.jsx(yj,{isPresent:n,anchorX:b,root:o,children:t})),U.jsx(DT.Provider,{value:N,children:t})};function vj(){return new Map}function nz(t=!0){const e=W.useContext(DT);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:i,register:u}=e,f=W.useId();W.useEffect(()=>{if(t)return u(f)},[t]);const g=W.useCallback(()=>t&&i&&i(f),[f,i,t]);return!n&&i?[!1,g]:[!0]}const q1=t=>t.key||"";function LP(t){const e=[];return W.Children.forEach(t,n=>{W.isValidElement(n)&&e.push(n)}),e}const xj=({children:t,custom:e,initial:n=!0,onExitComplete:i,presenceAffectsLayout:u=!0,mode:f="sync",propagate:g=!1,anchorX:b="left",root:o})=>{const[S,M]=nz(g),O=W.useMemo(()=>LP(t),[t]),N=g&&!S?[]:O.map(q1),j=W.useRef(!0),Z=W.useRef(O),K=WA(()=>new Map),[Q,ce]=W.useState(O),[ge,ue]=W.useState(O);h3(()=>{j.current=!1,Z.current=O;for(let Te=0;Te<ge.length;Te++){const ae=q1(ge[Te]);N.includes(ae)?K.delete(ae):K.get(ae)!==!0&&K.set(ae,!1)}},[ge,N.length,N.join("-")]);const pe=[];if(O!==Q){let Te=[...O];for(let ae=0;ae<ge.length;ae++){const re=ge[ae],he=q1(re);N.includes(he)||(Te.splice(ae,0,re),pe.push(re))}return f==="wait"&&pe.length&&(Te=pe),ue(LP(Te)),ce(O),null}const{forceRender:me}=W.useContext(HA);return U.jsx(U.Fragment,{children:ge.map(Te=>{const ae=q1(Te),re=g&&!S?!1:O===ge||N.includes(ae),he=()=>{if(K.has(ae))K.set(ae,!0);else return;let se=!0;K.forEach(ve=>{ve||(se=!1)}),se&&(me?.(),ue(Z.current),g&&M?.(),i&&i())};return U.jsx(_j,{isPresent:re,initial:!j.current||n?void 0:!1,custom:e,presenceAffectsLayout:u,mode:f,root:o,onExitComplete:re?void 0:he,anchorX:b,children:Te},ae)})})},rz=W.createContext({strict:!1}),OP={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},M_={};for(const t in OP)M_[t]={isEnabled:e=>OP[t].some(n=>!!e[n])};function bj(t){for(const e in t)M_[e]={...M_[e],...t[e]}}const wj=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Yw(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||wj.has(t)}let iz=t=>!Yw(t);function Tj(t){typeof t=="function"&&(iz=e=>e.startsWith("on")?!Yw(e):t(e))}try{Tj(require("@emotion/is-prop-valid").default)}catch{}function Ej(t,e,n){const i={};for(const u in t)u==="values"&&typeof t.values=="object"||(iz(u)||n===!0&&Yw(u)||!e&&!Yw(u)||t.draggable&&u.startsWith("onDrag"))&&(i[u]=t[u]);return i}const LT=W.createContext({});function OT(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Cx(t){return typeof t=="string"||Array.isArray(t)}const yI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],_I=["initial",...yI];function zT(t){return OT(t.animate)||_I.some(e=>Cx(t[e]))}function sz(t){return!!(zT(t)||t.variants)}function Sj(t,e){if(zT(t)){const{initial:n,animate:i}=t;return{initial:n===!1||Cx(n)?n:void 0,animate:Cx(i)?i:void 0}}return t.inherit!==!1?e:{}}function Cj(t){const{initial:e,animate:n}=Sj(t,W.useContext(LT));return W.useMemo(()=>({initial:e,animate:n}),[zP(e),zP(n)])}function zP(t){return Array.isArray(t)?t.join(" "):t}const Ax={};function Aj(t){for(const e in t)Ax[e]=t[e],nI(e)&&(Ax[e].isCSSVariable=!0)}function oz(t,{layout:e,layoutId:n}){return Q_.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!Ax[t]||t==="opacity")}const Ij={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Rj=Y_.length;function Mj(t,e,n){let i="",u=!0;for(let f=0;f<Rj;f++){const g=Y_[f],b=t[g];if(b===void 0)continue;let o=!0;if(typeof b=="number"?o=b===(g.startsWith("scale")?1:0):o=parseFloat(b)===0,!o||n){const S=K3(b,fI[g]);if(!o){u=!1;const M=Ij[g]||g;i+=`${M}(${S}) `}n&&(e[g]=S)}}return i=i.trim(),n?i=n(e,u?"":i):u&&(i="none"),i}function vI(t,e,n){const{style:i,vars:u,transformOrigin:f}=t;let g=!1,b=!1;for(const o in e){const S=e[o];if(Q_.has(o)){g=!0;continue}else if(nI(o)){u[o]=S;continue}else{const M=K3(S,fI[o]);o.startsWith("origin")?(b=!0,f[o]=M):i[o]=M}}if(e.transform||(g||n?i.transform=Mj(e,t.transform,n):i.transform&&(i.transform="none")),b){const{originX:o="50%",originY:S="50%",originZ:M=0}=f;i.transformOrigin=`${o} ${S} ${M}`}}const xI=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function az(t,e,n){for(const i in e)!Qa(e[i])&&!oz(i,n)&&(t[i]=e[i])}function Pj({transformTemplate:t},e){return W.useMemo(()=>{const n=xI();return vI(n,e,t),Object.assign({},n.vars,n.style)},[e])}function kj(t,e){const n=t.style||{},i={};return az(i,n,t),Object.assign(i,Pj(t,e)),i}function Dj(t,e){const n={},i=kj(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=i,n}const Lj={offset:"stroke-dashoffset",array:"stroke-dasharray"},Oj={offset:"strokeDashoffset",array:"strokeDasharray"};function zj(t,e,n=1,i=0,u=!0){t.pathLength=1;const f=u?Lj:Oj;t[f.offset]=yr.transform(-i);const g=yr.transform(e),b=yr.transform(n);t[f.array]=`${g} ${b}`}function lz(t,{attrX:e,attrY:n,attrScale:i,pathLength:u,pathSpacing:f=1,pathOffset:g=0,...b},o,S,M){if(vI(t,b,S),o){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:O,style:N}=t;O.transform&&(N.transform=O.transform,delete O.transform),(N.transform||O.transformOrigin)&&(N.transformOrigin=O.transformOrigin??"50% 50%",delete O.transformOrigin),N.transform&&(N.transformBox=M?.transformBox??"fill-box",delete O.transformBox),e!==void 0&&(O.x=e),n!==void 0&&(O.y=n),i!==void 0&&(O.scale=i),u!==void 0&&zj(O,u,f,g,!1)}const cz=()=>({...xI(),attrs:{}}),uz=t=>typeof t=="string"&&t.toLowerCase()==="svg";function Bj(t,e,n,i){const u=W.useMemo(()=>{const f=cz();return lz(f,e,uz(i),t.transformTemplate,t.style),{...f.attrs,style:{...f.style}}},[e]);if(t.style){const f={};az(f,t.style,t),u.style={...f,...u.style}}return u}const Nj=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function bI(t){return typeof t!="string"||t.includes("-")?!1:!!(Nj.indexOf(t)>-1||/[A-Z]/u.test(t))}function Vj(t,e,n,{latestValues:i},u,f=!1){const b=(bI(t)?Bj:Dj)(e,i,u,t),o=Ej(e,typeof t=="string",f),S=t!==W.Fragment?{...o,...b,ref:n}:{},{children:M}=e,O=W.useMemo(()=>Qa(M)?M.get():M,[M]);return W.createElement(t,{...S,children:O})}function BP(t){const e=[{},{}];return t?.values.forEach((n,i)=>{e[0][i]=n.get(),e[1][i]=n.getVelocity()}),e}function wI(t,e,n,i){if(typeof e=="function"){const[u,f]=BP(i);e=e(n!==void 0?n:t.custom,u,f)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[u,f]=BP(i);e=e(n!==void 0?n:t.custom,u,f)}return e}function Tw(t){return Qa(t)?t.get():t}function Fj({scrapeMotionValuesFromProps:t,createRenderState:e},n,i,u){return{latestValues:Uj(n,i,u,t),renderState:e()}}function Uj(t,e,n,i){const u={},f=i(t,{});for(const N in f)u[N]=Tw(f[N]);let{initial:g,animate:b}=t;const o=zT(t),S=sz(t);e&&S&&!o&&t.inherit!==!1&&(g===void 0&&(g=e.initial),b===void 0&&(b=e.animate));let M=n?n.initial===!1:!1;M=M||g===!1;const O=M?b:g;if(O&&typeof O!="boolean"&&!OT(O)){const N=Array.isArray(O)?O:[O];for(let j=0;j<N.length;j++){const Z=wI(t,N[j]);if(Z){const{transitionEnd:K,transition:Q,...ce}=Z;for(const ge in ce){let ue=ce[ge];if(Array.isArray(ue)){const pe=M?ue.length-1:0;ue=ue[pe]}ue!==null&&(u[ge]=ue)}for(const ge in K)u[ge]=K[ge]}}}return u}const hz=t=>(e,n)=>{const i=W.useContext(LT),u=W.useContext(DT),f=()=>Fj(t,e,i,u);return n?f():WA(f)};function TI(t,e,n){const{style:i}=t,u={};for(const f in i)(Qa(i[f])||e.style&&Qa(e.style[f])||oz(f,t)||n?.getValue(f)?.liveStyle!==void 0)&&(u[f]=i[f]);return u}const jj=hz({scrapeMotionValuesFromProps:TI,createRenderState:xI});function dz(t,e,n){const i=TI(t,e,n);for(const u in t)if(Qa(t[u])||Qa(e[u])){const f=Y_.indexOf(u)!==-1?"attr"+u.charAt(0).toUpperCase()+u.substring(1):u;i[f]=t[u]}return i}const $j=hz({scrapeMotionValuesFromProps:dz,createRenderState:cz}),qj=Symbol.for("motionComponentSymbol");function f_(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Gj(t,e,n){return W.useCallback(i=>{i&&t.onMount&&t.onMount(i),e&&(i?e.mount(i):e.unmount()),n&&(typeof n=="function"?n(i):f_(n)&&(n.current=i))},[e])}const EI=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Hj="framerAppearId",fz="data-"+EI(Hj),pz=W.createContext({});function Wj(t,e,n,i,u){const{visualElement:f}=W.useContext(LT),g=W.useContext(rz),b=W.useContext(DT),o=W.useContext(gI).reducedMotion,S=W.useRef(null);i=i||g.renderer,!S.current&&i&&(S.current=i(t,{visualState:e,parent:f,props:n,presenceContext:b,blockInitialAnimation:b?b.initial===!1:!1,reducedMotionConfig:o}));const M=S.current,O=W.useContext(pz);M&&!M.projection&&u&&(M.type==="html"||M.type==="svg")&&Xj(S.current,n,u,O);const N=W.useRef(!1);W.useInsertionEffect(()=>{M&&N.current&&M.update(n,b)});const j=n[fz],Z=W.useRef(!!j&&!window.MotionHandoffIsComplete?.(j)&&window.MotionHasOptimisedAnimation?.(j));return h3(()=>{M&&(N.current=!0,window.MotionIsMounted=!0,M.updateFeatures(),M.scheduleRenderMicrotask(),Z.current&&M.animationState&&M.animationState.animateChanges())}),W.useEffect(()=>{M&&(!Z.current&&M.animationState&&M.animationState.animateChanges(),Z.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(j)}),Z.current=!1),M.enteringChildren=void 0)}),M}function Xj(t,e,n,i){const{layoutId:u,layout:f,drag:g,dragConstraints:b,layoutScroll:o,layoutRoot:S,layoutCrossfade:M}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:mz(t.parent)),t.projection.setOptions({layoutId:u,layout:f,alwaysMeasureLayout:!!g||b&&f_(b),visualElement:t,animationType:typeof f=="string"?f:"both",initialPromotionConfig:i,crossfade:M,layoutScroll:o,layoutRoot:S})}function mz(t){if(t)return t.options.allowProjection!==!1?t.projection:mz(t.parent)}function vS(t,{forwardMotionProps:e=!1}={},n,i){n&&bj(n);const u=bI(t)?$j:jj;function f(b,o){let S;const M={...W.useContext(gI),...b,layoutId:Zj(b)},{isStatic:O}=M,N=Cj(b),j=u(b,O);if(!O&&XA){Kj();const Z=Yj(M);S=Z.MeasureLayout,N.visualElement=Wj(t,j,M,i,Z.ProjectionNode)}return U.jsxs(LT.Provider,{value:N,children:[S&&N.visualElement?U.jsx(S,{visualElement:N.visualElement,...M}):null,Vj(t,b,Gj(j,N.visualElement,o),j,O,e)]})}f.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const g=W.forwardRef(f);return g[qj]=t,g}function Zj({layoutId:t}){const e=W.useContext(HA).id;return e&&t!==void 0?e+"-"+t:t}function Kj(t,e){W.useContext(rz).strict}function Yj(t){const{drag:e,layout:n}=M_;if(!e&&!n)return{};const i={...e,...n};return{MeasureLayout:e?.isEnabled(t)||n?.isEnabled(t)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}function Qj(t,e){if(typeof Proxy>"u")return vS;const n=new Map,i=(f,g)=>vS(f,g,t,e),u=(f,g)=>i(f,g);return new Proxy(u,{get:(f,g)=>g==="create"?i:(n.has(g)||n.set(g,vS(g,void 0,t,e)),n.get(g))})}function gz({top:t,left:e,right:n,bottom:i}){return{x:{min:e,max:n},y:{min:t,max:i}}}function Jj({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function e8(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),i=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}function xS(t){return t===void 0||t===1}function AC({scale:t,scaleX:e,scaleY:n}){return!xS(t)||!xS(e)||!xS(n)}function vg(t){return AC(t)||yz(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function yz(t){return NP(t.x)||NP(t.y)}function NP(t){return t&&t!=="0%"}function Qw(t,e,n){const i=t-n,u=e*i;return n+u}function VP(t,e,n,i,u){return u!==void 0&&(t=Qw(t,u,i)),Qw(t,n,i)+e}function IC(t,e=0,n=1,i,u){t.min=VP(t.min,e,n,i,u),t.max=VP(t.max,e,n,i,u)}function _z(t,{x:e,y:n}){IC(t.x,e.translate,e.scale,e.originPoint),IC(t.y,n.translate,n.scale,n.originPoint)}const FP=.999999999999,UP=1.0000000000001;function t8(t,e,n,i=!1){const u=n.length;if(!u)return;e.x=e.y=1;let f,g;for(let b=0;b<u;b++){f=n[b],g=f.projectionDelta;const{visualElement:o}=f.options;o&&o.props.style&&o.props.style.display==="contents"||(i&&f.options.layoutScroll&&f.scroll&&f!==f.root&&m_(t,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),g&&(e.x*=g.x.scale,e.y*=g.y.scale,_z(t,g)),i&&vg(f.latestValues)&&m_(t,f.latestValues))}e.x<UP&&e.x>FP&&(e.x=1),e.y<UP&&e.y>FP&&(e.y=1)}function p_(t,e){t.min=t.min+e,t.max=t.max+e}function jP(t,e,n,i,u=.5){const f=Ms(t.min,t.max,u);IC(t,e,n,f,i)}function m_(t,e){jP(t.x,e.x,e.scaleX,e.scale,e.originX),jP(t.y,e.y,e.scaleY,e.scale,e.originY)}function vz(t,e){return gz(e8(t.getBoundingClientRect(),e))}function n8(t,e,n){const i=vz(t,n),{scroll:u}=e;return u&&(p_(i.x,u.offset.x),p_(i.y,u.offset.y)),i}const $P=()=>({translate:0,scale:1,origin:0,originPoint:0}),g_=()=>({x:$P(),y:$P()}),qP=()=>({min:0,max:0}),Ks=()=>({x:qP(),y:qP()}),RC={current:null},xz={current:!1};function r8(){if(xz.current=!0,!!XA)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>RC.current=t.matches;t.addEventListener("change",e),e()}else RC.current=!1}const i8=new WeakMap;function s8(t,e,n){for(const i in e){const u=e[i],f=n[i];if(Qa(u))t.addValue(i,u);else if(Qa(f))t.addValue(i,R_(u,{owner:t}));else if(f!==u)if(t.hasValue(i)){const g=t.getValue(i);g.liveStyle===!0?g.jump(u):g.hasAnimated||g.set(u)}else{const g=t.getStaticValue(i);t.addValue(i,R_(g!==void 0?g:u,{owner:t}))}}for(const i in n)e[i]===void 0&&t.removeValue(i);return e}const GP=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class o8{scrapeMotionValuesFromProps(e,n,i){return{}}constructor({parent:e,props:n,presenceContext:i,reducedMotionConfig:u,blockInitialAnimation:f,visualState:g},b={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=hI,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const N=Ul.now();this.renderScheduledAt<N&&(this.renderScheduledAt=N,ws.render(this.render,!1,!0))};const{latestValues:o,renderState:S}=g;this.latestValues=o,this.baseTarget={...o},this.initialValues=n.initial?{...o}:{},this.renderState=S,this.parent=e,this.props=n,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=u,this.options=b,this.blockInitialAnimation=!!f,this.isControllingVariants=zT(n),this.isVariantNode=sz(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:M,...O}=this.scrapeMotionValuesFromProps(n,{},this);for(const N in O){const j=O[N];o[N]!==void 0&&Qa(j)&&j.set(o[N])}}mount(e){this.current=e,i8.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,i)=>this.bindToMotionValue(i,n)),xz.current||r8(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:RC.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),am(this.notifyUpdate),am(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Q_.has(e);i&&this.onBindTransform&&this.onBindTransform();const u=n.on("change",g=>{this.latestValues[e]=g,this.props.onUpdate&&ws.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let f;window.MotionCheckAppearSync&&(f=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{u(),f&&f(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in M_){const n=M_[e];if(!n)continue;const{isEnabled:i,Feature:u}=n;if(!this.features[e]&&u&&i(this.props)&&(this.features[e]=new u(this)),this.features[e]){const f=this.features[e];f.isMounted?f.update():(f.mount(),f.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ks()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let i=0;i<GP.length;i++){const u=GP[i];this.propEventSubscriptions[u]&&(this.propEventSubscriptions[u](),delete this.propEventSubscriptions[u]);const f="on"+u,g=e[f];g&&(this.propEventSubscriptions[u]=this.on(u,g))}this.prevMotionValues=s8(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const i=this.values.get(e);n!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&n!==void 0&&(i=R_(n===null?void 0:n,{owner:this}),this.addValue(e,i)),i}readValue(e,n){let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(d3(i)||p3(i))?i=parseFloat(i):!fj(i)&&lm.test(n)&&(i=Z3(e,n)),this.setBaseTarget(e,Qa(i)?i.get():i)),Qa(i)?i.get():i}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){const{initial:n}=this.props;let i;if(typeof n=="string"||typeof n=="object"){const f=wI(this.props,n,this.presenceContext?.custom);f&&(i=f[e])}if(n&&i!==void 0)return i;const u=this.getBaseTargetFromProps(this.props,e);return u!==void 0&&!Qa(u)?u:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new JA),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}scheduleRenderMicrotask(){pI.render(this.render)}}class bz extends o8{constructor(){super(...arguments),this.KeyframeResolver=tj}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:i}){delete n[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Qa(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function wz(t,{style:e,vars:n},i,u){const f=t.style;let g;for(g in e)f[g]=e[g];u?.applyProjectionStyles(f,i);for(g in n)f.setProperty(g,n[g])}function a8(t){return window.getComputedStyle(t)}class l8 extends bz{constructor(){super(...arguments),this.type="html",this.renderInstance=wz}readValueFromInstance(e,n){if(Q_.has(n))return this.projection?.isProjecting?xC(n):xU(e,n);{const i=a8(e),u=(nI(n)?i.getPropertyValue(n):i[n])||0;return typeof u=="string"?u.trim():u}}measureInstanceViewportBox(e,{transformPagePoint:n}){return vz(e,n)}build(e,n,i){vI(e,n,i.transformTemplate)}scrapeMotionValuesFromProps(e,n,i){return TI(e,n,i)}}const Tz=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function c8(t,e,n,i){wz(t,e,void 0,i);for(const u in e.attrs)t.setAttribute(Tz.has(u)?u:EI(u),e.attrs[u])}class u8 extends bz{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ks}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Q_.has(n)){const i=X3(n);return i&&i.default||0}return n=Tz.has(n)?n:EI(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,i){return dz(e,n,i)}build(e,n,i){lz(e,n,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(e,n,i,u){c8(e,n,i,u)}mount(e){this.isSVGTag=uz(e.tagName),super.mount(e)}}const h8=(t,e)=>bI(t)?new u8(e):new l8(e,{allowProjection:t!==W.Fragment});function x_(t,e,n){const i=t.getProps();return wI(i,e,n!==void 0?n:i.custom,t)}const MC=t=>Array.isArray(t);function d8(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,R_(n))}function f8(t){return MC(t)?t[t.length-1]||0:t}function p8(t,e){const n=x_(t,e);let{transitionEnd:i={},transition:u={},...f}=n||{};f={...f,...i};for(const g in f){const b=f8(f[g]);d8(t,g,b)}}function m8(t){return!!(Qa(t)&&t.add)}function PC(t,e){const n=t.getValue("willChange");if(m8(n))return n.add(e);if(!n&&Ff.WillChange){const i=new Ff.WillChange("auto");t.addValue("willChange",i),i.add(e)}}function Ez(t){return t.props[fz]}const g8=t=>t!==null;function y8(t,{repeat:e,repeatType:n="loop"},i){const u=t.filter(g8),f=e&&n!=="loop"&&e%2===1?0:u.length-1;return u[f]}const _8={type:"spring",stiffness:500,damping:25,restSpeed:10},v8=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),x8={type:"keyframes",duration:.8},b8={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},w8=(t,{keyframes:e})=>e.length>2?x8:Q_.has(t)?t.startsWith("scale")?v8(e[1]):_8:b8;function T8({when:t,delay:e,delayChildren:n,staggerChildren:i,staggerDirection:u,repeat:f,repeatType:g,repeatDelay:b,from:o,elapsed:S,...M}){return!!Object.keys(M).length}const SI=(t,e,n,i={},u,f)=>g=>{const b=dI(i,t)||{},o=b.delay||i.delay||0;let{elapsed:S=0}=i;S=S-vd(o);const M={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...b,delay:-S,onUpdate:N=>{e.set(N),b.onUpdate&&b.onUpdate(N)},onComplete:()=>{g(),b.onComplete&&b.onComplete()},name:t,motionValue:e,element:f?void 0:u};T8(b)||Object.assign(M,w8(t,M)),M.duration&&(M.duration=vd(M.duration)),M.repeatDelay&&(M.repeatDelay=vd(M.repeatDelay)),M.from!==void 0&&(M.keyframes[0]=M.from);let O=!1;if((M.type===!1||M.duration===0&&!M.repeatDelay)&&(SC(M),M.delay===0&&(O=!0)),(Ff.instantAnimations||Ff.skipAnimations)&&(O=!0,SC(M),M.delay=0),M.allowFlatten=!b.type&&!b.ease,O&&!f&&e.get()!==void 0){const N=y8(M.keyframes,b);if(N!==void 0){ws.update(()=>{M.onUpdate(N),M.onComplete()});return}}return b.isSync?new uI(M):new $U(M)};function E8({protectedKeys:t,needsAnimating:e},n){const i=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,i}function Sz(t,e,{delay:n=0,transitionOverride:i,type:u}={}){let{transition:f=t.getDefaultTransition(),transitionEnd:g,...b}=e;i&&(f=i);const o=[],S=u&&t.animationState&&t.animationState.getState()[u];for(const M in b){const O=t.getValue(M,t.latestValues[M]??null),N=b[M];if(N===void 0||S&&E8(S,M))continue;const j={delay:n,...dI(f||{},M)},Z=O.get();if(Z!==void 0&&!O.isAnimating&&!Array.isArray(N)&&N===Z&&!j.velocity)continue;let K=!1;if(window.MotionHandoffAnimation){const ce=Ez(t);if(ce){const ge=window.MotionHandoffAnimation(ce,M,ws);ge!==null&&(j.startTime=ge,K=!0)}}PC(t,M),O.start(SI(M,O,N,t.shouldReduceMotion&&G3.has(M)?{type:!1}:j,t,K));const Q=O.animation;Q&&o.push(Q)}return g&&Promise.all(o).then(()=>{ws.update(()=>{g&&p8(t,g)})}),o}function Cz(t,e,n,i=0,u=1){const f=Array.from(t).sort((S,M)=>S.sortNodePosition(M)).indexOf(e),g=t.size,b=(g-1)*i;return typeof n=="function"?n(f,g):u===1?f*i:b-f*i}function kC(t,e,n={}){const i=x_(t,e,n.type==="exit"?t.presenceContext?.custom:void 0);let{transition:u=t.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(u=n.transitionOverride);const f=i?()=>Promise.all(Sz(t,i,n)):()=>Promise.resolve(),g=t.variantChildren&&t.variantChildren.size?(o=0)=>{const{delayChildren:S=0,staggerChildren:M,staggerDirection:O}=u;return S8(t,e,o,S,M,O,n)}:()=>Promise.resolve(),{when:b}=u;if(b){const[o,S]=b==="beforeChildren"?[f,g]:[g,f];return o().then(()=>S())}else return Promise.all([f(),g(n.delay)])}function S8(t,e,n=0,i=0,u=0,f=1,g){const b=[];for(const o of t.variantChildren)o.notify("AnimationStart",e),b.push(kC(o,e,{...g,delay:n+(typeof i=="function"?0:i)+Cz(t.variantChildren,o,i,u,f)}).then(()=>o.notify("AnimationComplete",e)));return Promise.all(b)}function C8(t,e,n={}){t.notify("AnimationStart",e);let i;if(Array.isArray(e)){const u=e.map(f=>kC(t,f,n));i=Promise.all(u)}else if(typeof e=="string")i=kC(t,e,n);else{const u=typeof e=="function"?x_(t,e,n.custom):e;i=Promise.all(Sz(t,u,n))}return i.then(()=>{t.notify("AnimationComplete",e)})}function Az(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let i=0;i<n;i++)if(e[i]!==t[i])return!1;return!0}const A8=_I.length;function Iz(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?Iz(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<A8;n++){const i=_I[n],u=t.props[i];(Cx(u)||u===!1)&&(e[i]=u)}return e}const I8=[...yI].reverse(),R8=yI.length;function M8(t){return e=>Promise.all(e.map(({animation:n,options:i})=>C8(t,n,i)))}function P8(t){let e=M8(t),n=HP(),i=!0;const u=o=>(S,M)=>{const O=x_(t,M,o==="exit"?t.presenceContext?.custom:void 0);if(O){const{transition:N,transitionEnd:j,...Z}=O;S={...S,...Z,...j}}return S};function f(o){e=o(t)}function g(o){const{props:S}=t,M=Iz(t.parent)||{},O=[],N=new Set;let j={},Z=1/0;for(let Q=0;Q<R8;Q++){const ce=I8[Q],ge=n[ce],ue=S[ce]!==void 0?S[ce]:M[ce],pe=Cx(ue),me=ce===o?ge.isActive:null;me===!1&&(Z=Q);let Te=ue===M[ce]&&ue!==S[ce]&&pe;if(Te&&i&&t.manuallyAnimateOnMount&&(Te=!1),ge.protectedKeys={...j},!ge.isActive&&me===null||!ue&&!ge.prevProp||OT(ue)||typeof ue=="boolean")continue;const ae=k8(ge.prevProp,ue);let re=ae||ce===o&&ge.isActive&&!Te&&pe||Q>Z&&pe,he=!1;const se=Array.isArray(ue)?ue:[ue];let ve=se.reduce(u(ce),{});me===!1&&(ve={});const{prevResolvedValues:Y={}}=ge,le={...Y,...ve},Ne=Je=>{re=!0,N.has(Je)&&(he=!0,N.delete(Je)),ge.needsAnimating[Je]=!0;const dt=t.getValue(Je);dt&&(dt.liveStyle=!1)};for(const Je in le){const dt=ve[Je],et=Y[Je];if(j.hasOwnProperty(Je))continue;let Kt=!1;MC(dt)&&MC(et)?Kt=!Az(dt,et):Kt=dt!==et,Kt?dt!=null?Ne(Je):N.add(Je):dt!==void 0&&N.has(Je)?Ne(Je):ge.protectedKeys[Je]=!0}ge.prevProp=ue,ge.prevResolvedValues=ve,ge.isActive&&(j={...j,...ve}),i&&t.blockInitialAnimation&&(re=!1);const Ze=Te&&ae;re&&(!Ze||he)&&O.push(...se.map(Je=>{const dt={type:ce};if(typeof Je=="string"&&i&&!Ze&&t.manuallyAnimateOnMount&&t.parent){const{parent:et}=t,Kt=x_(et,Je);if(et.enteringChildren&&Kt){const{delayChildren:De}=Kt.transition||{};dt.delay=Cz(et.enteringChildren,t,De)}}return{animation:Je,options:dt}}))}if(N.size){const Q={};if(typeof S.initial!="boolean"){const ce=x_(t,Array.isArray(S.initial)?S.initial[0]:S.initial);ce&&ce.transition&&(Q.transition=ce.transition)}N.forEach(ce=>{const ge=t.getBaseTarget(ce),ue=t.getValue(ce);ue&&(ue.liveStyle=!0),Q[ce]=ge??null}),O.push({animation:Q})}let K=!!O.length;return i&&(S.initial===!1||S.initial===S.animate)&&!t.manuallyAnimateOnMount&&(K=!1),i=!1,K?e(O):Promise.resolve()}function b(o,S){if(n[o].isActive===S)return Promise.resolve();t.variantChildren?.forEach(O=>O.animationState?.setActive(o,S)),n[o].isActive=S;const M=g(o);for(const O in n)n[O].protectedKeys={};return M}return{animateChanges:g,setActive:b,setAnimateFunction:f,getState:()=>n,reset:()=>{n=HP()}}}function k8(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!Az(e,t):!1}function mg(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function HP(){return{animate:mg(!0),whileInView:mg(),whileHover:mg(),whileTap:mg(),whileDrag:mg(),whileFocus:mg(),exit:mg()}}class vm{constructor(e){this.isMounted=!1,this.node=e}update(){}}class D8 extends vm{constructor(e){super(e),e.animationState||(e.animationState=P8(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();OT(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let L8=0;class O8 extends vm{constructor(){super(...arguments),this.id=L8++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const u=this.node.animationState.setActive("exit",!e);n&&!e&&u.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const z8={animation:{Feature:D8},exit:{Feature:O8}};function Ix(t,e,n,i={passive:!0}){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n)}function Qx(t){return{point:{x:t.pageX,y:t.pageY}}}const B8=t=>e=>mI(e)&&t(e,Qx(e));function ox(t,e,n,i){return Ix(t,e,B8(n),i)}const Rz=1e-4,N8=1-Rz,V8=1+Rz,Mz=.01,F8=0-Mz,U8=0+Mz;function xl(t){return t.max-t.min}function j8(t,e,n){return Math.abs(t-e)<=n}function WP(t,e,n,i=.5){t.origin=i,t.originPoint=Ms(e.min,e.max,t.origin),t.scale=xl(n)/xl(e),t.translate=Ms(n.min,n.max,t.origin)-t.originPoint,(t.scale>=N8&&t.scale<=V8||isNaN(t.scale))&&(t.scale=1),(t.translate>=F8&&t.translate<=U8||isNaN(t.translate))&&(t.translate=0)}function ax(t,e,n,i){WP(t.x,e.x,n.x,i?i.originX:void 0),WP(t.y,e.y,n.y,i?i.originY:void 0)}function XP(t,e,n){t.min=n.min+e.min,t.max=t.min+xl(e)}function $8(t,e,n){XP(t.x,e.x,n.x),XP(t.y,e.y,n.y)}function ZP(t,e,n){t.min=e.min-n.min,t.max=t.min+xl(e)}function lx(t,e,n){ZP(t.x,e.x,n.x),ZP(t.y,e.y,n.y)}function su(t){return[t("x"),t("y")]}const Pz=({current:t})=>t?t.ownerDocument.defaultView:null,KP=(t,e)=>Math.abs(t-e);function q8(t,e){const n=KP(t.x,e.x),i=KP(t.y,e.y);return Math.sqrt(n**2+i**2)}class kz{constructor(e,n,{transformPagePoint:i,contextWindow:u=window,dragSnapToOrigin:f=!1,distanceThreshold:g=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const N=wS(this.lastMoveEventInfo,this.history),j=this.startEvent!==null,Z=q8(N.offset,{x:0,y:0})>=this.distanceThreshold;if(!j&&!Z)return;const{point:K}=N,{timestamp:Q}=ga;this.history.push({...K,timestamp:Q});const{onStart:ce,onMove:ge}=this.handlers;j||(ce&&ce(this.lastMoveEvent,N),this.startEvent=this.lastMoveEvent),ge&&ge(this.lastMoveEvent,N)},this.handlePointerMove=(N,j)=>{this.lastMoveEvent=N,this.lastMoveEventInfo=bS(j,this.transformPagePoint),ws.update(this.updatePoint,!0)},this.handlePointerUp=(N,j)=>{this.end();const{onEnd:Z,onSessionEnd:K,resumeAnimation:Q}=this.handlers;if(this.dragSnapToOrigin&&Q&&Q(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const ce=wS(N.type==="pointercancel"?this.lastMoveEventInfo:bS(j,this.transformPagePoint),this.history);this.startEvent&&Z&&Z(N,ce),K&&K(N,ce)},!mI(e))return;this.dragSnapToOrigin=f,this.handlers=n,this.transformPagePoint=i,this.distanceThreshold=g,this.contextWindow=u||window;const b=Qx(e),o=bS(b,this.transformPagePoint),{point:S}=o,{timestamp:M}=ga;this.history=[{...S,timestamp:M}];const{onSessionStart:O}=n;O&&O(e,wS(o,this.history)),this.removeListeners=Zx(ox(this.contextWindow,"pointermove",this.handlePointerMove),ox(this.contextWindow,"pointerup",this.handlePointerUp),ox(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),am(this.updatePoint)}}function bS(t,e){return e?{point:e(t.point)}:t}function YP(t,e){return{x:t.x-e.x,y:t.y-e.y}}function wS({point:t},e){return{point:t,delta:YP(t,Dz(e)),offset:YP(t,G8(e)),velocity:H8(e,.1)}}function G8(t){return t[0]}function Dz(t){return t[t.length-1]}function H8(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,i=null;const u=Dz(t);for(;n>=0&&(i=t[n],!(u.timestamp-i.timestamp>vd(e)));)n--;if(!i)return{x:0,y:0};const f=du(u.timestamp-i.timestamp);if(f===0)return{x:0,y:0};const g={x:(u.x-i.x)/f,y:(u.y-i.y)/f};return g.x===1/0&&(g.x=0),g.y===1/0&&(g.y=0),g}function W8(t,{min:e,max:n},i){return e!==void 0&&t<e?t=i?Ms(e,t,i.min):Math.max(t,e):n!==void 0&&t>n&&(t=i?Ms(n,t,i.max):Math.min(t,n)),t}function QP(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function X8(t,{top:e,left:n,bottom:i,right:u}){return{x:QP(t.x,n,u),y:QP(t.y,e,i)}}function JP(t,e){let n=e.min-t.min,i=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,i]=[i,n]),{min:n,max:i}}function Z8(t,e){return{x:JP(t.x,e.x),y:JP(t.y,e.y)}}function K8(t,e){let n=.5;const i=xl(t),u=xl(e);return u>i?n=Tx(e.min,e.max-i,t.min):i>u&&(n=Tx(t.min,t.max-u,e.min)),Vf(0,1,n)}function Y8(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const DC=.35;function Q8(t=DC){return t===!1?t=0:t===!0&&(t=DC),{x:ek(t,"left","right"),y:ek(t,"top","bottom")}}function ek(t,e,n){return{min:tk(t,e),max:tk(t,n)}}function tk(t,e){return typeof t=="number"?t:t[e]||0}const J8=new WeakMap;class e${constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ks(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:n=!1,distanceThreshold:i}={}){const{presenceContext:u}=this.visualElement;if(u&&u.isPresent===!1)return;const f=O=>{const{dragSnapToOrigin:N}=this.getProps();N?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Qx(O).point)},g=(O,N)=>{const{drag:j,dragPropagation:Z,onDragStart:K}=this.getProps();if(j&&!Z&&(this.openDragLock&&this.openDragLock(),this.openDragLock=sj(j),!this.openDragLock))return;this.latestPointerEvent=O,this.latestPanInfo=N,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),su(ce=>{let ge=this.getAxisMotionValue(ce).get()||0;if(xd.test(ge)){const{projection:ue}=this.visualElement;if(ue&&ue.layout){const pe=ue.layout.layoutBox[ce];pe&&(ge=xl(pe)*(parseFloat(ge)/100))}}this.originPoint[ce]=ge}),K&&ws.postRender(()=>K(O,N)),PC(this.visualElement,"transform");const{animationState:Q}=this.visualElement;Q&&Q.setActive("whileDrag",!0)},b=(O,N)=>{this.latestPointerEvent=O,this.latestPanInfo=N;const{dragPropagation:j,dragDirectionLock:Z,onDirectionLock:K,onDrag:Q}=this.getProps();if(!j&&!this.openDragLock)return;const{offset:ce}=N;if(Z&&this.currentDirection===null){this.currentDirection=t$(ce),this.currentDirection!==null&&K&&K(this.currentDirection);return}this.updateAxis("x",N.point,ce),this.updateAxis("y",N.point,ce),this.visualElement.render(),Q&&Q(O,N)},o=(O,N)=>{this.latestPointerEvent=O,this.latestPanInfo=N,this.stop(O,N),this.latestPointerEvent=null,this.latestPanInfo=null},S=()=>su(O=>this.getAnimationState(O)==="paused"&&this.getAxisMotionValue(O).animation?.play()),{dragSnapToOrigin:M}=this.getProps();this.panSession=new kz(e,{onSessionStart:f,onStart:g,onMove:b,onSessionEnd:o,resumeAnimation:S},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:M,distanceThreshold:i,contextWindow:Pz(this.visualElement)})}stop(e,n){const i=e||this.latestPointerEvent,u=n||this.latestPanInfo,f=this.isDragging;if(this.cancel(),!f||!u||!i)return;const{velocity:g}=u;this.startAnimation(g);const{onDragEnd:b}=this.getProps();b&&ws.postRender(()=>b(i,u))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,i){const{drag:u}=this.getProps();if(!i||!G1(e,u,this.currentDirection))return;const f=this.getAxisMotionValue(e);let g=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(g=W8(g,this.constraints[e],this.elastic[e])),f.set(g)}resolveConstraints(){const{dragConstraints:e,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,u=this.constraints;e&&f_(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&i?this.constraints=X8(i.layoutBox,e):this.constraints=!1,this.elastic=Q8(n),u!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&su(f=>{this.constraints!==!1&&this.getAxisMotionValue(f)&&(this.constraints[f]=Y8(i.layoutBox[f],this.constraints[f]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!f_(e))return!1;const i=e.current,{projection:u}=this.visualElement;if(!u||!u.layout)return!1;const f=n8(i,u.root,this.visualElement.getTransformPagePoint());let g=Z8(u.layout.layoutBox,f);if(n){const b=n(Jj(g));this.hasMutatedConstraints=!!b,b&&(g=gz(b))}return g}startAnimation(e){const{drag:n,dragMomentum:i,dragElastic:u,dragTransition:f,dragSnapToOrigin:g,onDragTransitionEnd:b}=this.getProps(),o=this.constraints||{},S=su(M=>{if(!G1(M,n,this.currentDirection))return;let O=o&&o[M]||{};g&&(O={min:0,max:0});const N=u?200:1e6,j=u?40:1e7,Z={type:"inertia",velocity:i?e[M]:0,bounceStiffness:N,bounceDamping:j,timeConstant:750,restDelta:1,restSpeed:10,...f,...O};return this.startAxisValueAnimation(M,Z)});return Promise.all(S).then(b)}startAxisValueAnimation(e,n){const i=this.getAxisMotionValue(e);return PC(this.visualElement,e),i.start(SI(e,i,0,n,this.visualElement,!1))}stopAnimation(){su(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){su(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),u=i[n];return u||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){su(n=>{const{drag:i}=this.getProps();if(!G1(n,i,this.currentDirection))return;const{projection:u}=this.visualElement,f=this.getAxisMotionValue(n);if(u&&u.layout){const{min:g,max:b}=u.layout.layoutBox[n];f.set(e[n]-Ms(g,b,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:i}=this.visualElement;if(!f_(n)||!i||!this.constraints)return;this.stopAnimation();const u={x:0,y:0};su(g=>{const b=this.getAxisMotionValue(g);if(b&&this.constraints!==!1){const o=b.get();u[g]=K8({min:o,max:o},this.constraints[g])}});const{transformTemplate:f}=this.visualElement.getProps();this.visualElement.current.style.transform=f?f({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),su(g=>{if(!G1(g,e,null))return;const b=this.getAxisMotionValue(g),{min:o,max:S}=this.constraints[g];b.set(Ms(o,S,u[g]))})}addListeners(){if(!this.visualElement.current)return;J8.set(this.visualElement,this);const e=this.visualElement.current,n=ox(e,"pointerdown",o=>{const{drag:S,dragListener:M=!0}=this.getProps();S&&M&&this.start(o)}),i=()=>{const{dragConstraints:o}=this.getProps();f_(o)&&o.current&&(this.constraints=this.resolveRefConstraints())},{projection:u}=this.visualElement,f=u.addEventListener("measure",i);u&&!u.layout&&(u.root&&u.root.updateScroll(),u.updateLayout()),ws.read(i);const g=Ix(window,"resize",()=>this.scalePositionWithinConstraints()),b=u.addEventListener("didUpdate",(({delta:o,hasLayoutChanged:S})=>{this.isDragging&&S&&(su(M=>{const O=this.getAxisMotionValue(M);O&&(this.originPoint[M]+=o[M].translate,O.set(O.get()+o[M].translate))}),this.visualElement.render())}));return()=>{g(),n(),f(),b&&b()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:i=!1,dragPropagation:u=!1,dragConstraints:f=!1,dragElastic:g=DC,dragMomentum:b=!0}=e;return{...e,drag:n,dragDirectionLock:i,dragPropagation:u,dragConstraints:f,dragElastic:g,dragMomentum:b}}}function G1(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function t$(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class n$ extends vm{constructor(e){super(e),this.removeGroupControls=pu,this.removeListeners=pu,this.controls=new e$(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||pu}unmount(){this.removeGroupControls(),this.removeListeners()}}const nk=t=>(e,n)=>{t&&ws.postRender(()=>t(e,n))};class r$ extends vm{constructor(){super(...arguments),this.removePointerDownListener=pu}onPointerDown(e){this.session=new kz(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Pz(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:i,onPanEnd:u}=this.node.getProps();return{onSessionStart:nk(e),onStart:nk(n),onMove:i,onEnd:(f,g)=>{delete this.session,u&&ws.postRender(()=>u(f,g))}}}mount(){this.removePointerDownListener=ox(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Ew={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function rk(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const O0={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(yr.test(t))t=parseFloat(t);else return t;const n=rk(t,e.target.x),i=rk(t,e.target.y);return`${n}% ${i}%`}},i$={correct:(t,{treeScale:e,projectionDelta:n})=>{const i=t,u=lm.parse(t);if(u.length>5)return i;const f=lm.createTransformer(t),g=typeof u[0]!="number"?1:0,b=n.x.scale*e.x,o=n.y.scale*e.y;u[0+g]/=b,u[1+g]/=o;const S=Ms(b,o,.5);return typeof u[2+g]=="number"&&(u[2+g]/=S),typeof u[3+g]=="number"&&(u[3+g]/=S),f(u)}};let TS=!1;class s$ extends W.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:i,layoutId:u}=this.props,{projection:f}=e;Aj(o$),f&&(n.group&&n.group.add(f),i&&i.register&&u&&i.register(f),TS&&f.root.didUpdate(),f.addEventListener("animationComplete",()=>{this.safeToRemove()}),f.setOptions({...f.options,onExitComplete:()=>this.safeToRemove()})),Ew.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:i,drag:u,isPresent:f}=this.props,{projection:g}=i;return g&&(g.isPresent=f,TS=!0,u||e.layoutDependency!==n||n===void 0||e.isPresent!==f?g.willUpdate():this.safeToRemove(),e.isPresent!==f&&(f?g.promote():g.relegate()||ws.postRender(()=>{const b=g.getStack();(!b||!b.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),pI.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:i}=this.props,{projection:u}=e;TS=!0,u&&(u.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(u),i&&i.deregister&&i.deregister(u))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Lz(t){const[e,n]=nz(),i=W.useContext(HA);return U.jsx(s$,{...t,layoutGroup:i,switchLayoutGroup:W.useContext(pz),isPresent:e,safeToRemove:n})}const o$={borderRadius:{...O0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:O0,borderTopRightRadius:O0,borderBottomLeftRadius:O0,borderBottomRightRadius:O0,boxShadow:i$};function a$(t,e,n){const i=Qa(t)?t:R_(t);return i.start(SI("",i,e,n)),i.animation}const l$=(t,e)=>t.depth-e.depth;class c${constructor(){this.children=[],this.isDirty=!1}add(e){ZA(this.children,e),this.isDirty=!0}remove(e){KA(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(l$),this.isDirty=!1,this.children.forEach(e)}}function u$(t,e){const n=Ul.now(),i=({timestamp:u})=>{const f=u-n;f>=e&&(am(i),t(f-e))};return ws.setup(i,!0),()=>am(i)}const Oz=["TopLeft","TopRight","BottomLeft","BottomRight"],h$=Oz.length,ik=t=>typeof t=="string"?parseFloat(t):t,sk=t=>typeof t=="number"||yr.test(t);function d$(t,e,n,i,u,f){u?(t.opacity=Ms(0,n.opacity??1,f$(i)),t.opacityExit=Ms(e.opacity??1,0,p$(i))):f&&(t.opacity=Ms(e.opacity??1,n.opacity??1,i));for(let g=0;g<h$;g++){const b=`border${Oz[g]}Radius`;let o=ok(e,b),S=ok(n,b);if(o===void 0&&S===void 0)continue;o||(o=0),S||(S=0),o===0||S===0||sk(o)===sk(S)?(t[b]=Math.max(Ms(ik(o),ik(S),i),0),(xd.test(S)||xd.test(o))&&(t[b]+="%")):t[b]=S}(e.rotate||n.rotate)&&(t.rotate=Ms(e.rotate||0,n.rotate||0,i))}function ok(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const f$=zz(0,.5,w3),p$=zz(.5,.95,pu);function zz(t,e,n){return i=>i<t?0:i>e?1:n(Tx(t,e,i))}function ak(t,e){t.min=e.min,t.max=e.max}function ru(t,e){ak(t.x,e.x),ak(t.y,e.y)}function lk(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function ck(t,e,n,i,u){return t-=e,t=Qw(t,1/n,i),u!==void 0&&(t=Qw(t,1/u,i)),t}function m$(t,e=0,n=1,i=.5,u,f=t,g=t){if(xd.test(e)&&(e=parseFloat(e),e=Ms(g.min,g.max,e/100)-g.min),typeof e!="number")return;let b=Ms(f.min,f.max,i);t===f&&(b-=e),t.min=ck(t.min,e,n,b,u),t.max=ck(t.max,e,n,b,u)}function uk(t,e,[n,i,u],f,g){m$(t,e[n],e[i],e[u],e.scale,f,g)}const g$=["x","scaleX","originX"],y$=["y","scaleY","originY"];function hk(t,e,n,i){uk(t.x,e,g$,n?n.x:void 0,i?i.x:void 0),uk(t.y,e,y$,n?n.y:void 0,i?i.y:void 0)}function dk(t){return t.translate===0&&t.scale===1}function Bz(t){return dk(t.x)&&dk(t.y)}function fk(t,e){return t.min===e.min&&t.max===e.max}function _$(t,e){return fk(t.x,e.x)&&fk(t.y,e.y)}function pk(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function Nz(t,e){return pk(t.x,e.x)&&pk(t.y,e.y)}function mk(t){return xl(t.x)/xl(t.y)}function gk(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class v${constructor(){this.members=[]}add(e){ZA(this.members,e),e.scheduleRender()}remove(e){if(KA(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(u=>e===u);if(n===0)return!1;let i;for(let u=n;u>=0;u--){const f=this.members[u];if(f.isPresent!==!1){i=f;break}}return i?(this.promote(i),!0):!1}promote(e,n){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,n&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:u}=e.options;u===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:i}=e;n.onExitComplete&&n.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function x$(t,e,n){let i="";const u=t.x.translate/e.x,f=t.y.translate/e.y,g=n?.z||0;if((u||f||g)&&(i=`translate3d(${u}px, ${f}px, ${g}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:S,rotate:M,rotateX:O,rotateY:N,skewX:j,skewY:Z}=n;S&&(i=`perspective(${S}px) ${i}`),M&&(i+=`rotate(${M}deg) `),O&&(i+=`rotateX(${O}deg) `),N&&(i+=`rotateY(${N}deg) `),j&&(i+=`skewX(${j}deg) `),Z&&(i+=`skewY(${Z}deg) `)}const b=t.x.scale*e.x,o=t.y.scale*e.y;return(b!==1||o!==1)&&(i+=`scale(${b}, ${o})`),i||"none"}const ES=["","X","Y","Z"],b$=1e3;let w$=0;function SS(t,e,n,i){const{latestValues:u}=e;u[t]&&(n[t]=u[t],e.setStaticValue(t,0),i&&(i[t]=0))}function Vz(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=Ez(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:u,layoutId:f}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",ws,!(u||f))}const{parent:i}=t;i&&!i.hasCheckedOptimisedAppear&&Vz(i)}function Fz({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:i,resetTransform:u}){return class{constructor(g={},b=e?.()){this.id=w$++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(S$),this.nodes.forEach(R$),this.nodes.forEach(M$),this.nodes.forEach(C$)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=g,this.root=b?b.root||b:this,this.path=b?[...b.path,b]:[],this.parent=b,this.depth=b?b.depth+1:0;for(let o=0;o<this.path.length;o++)this.path[o].shouldResetTransform=!0;this.root===this&&(this.nodes=new c$)}addEventListener(g,b){return this.eventHandlers.has(g)||this.eventHandlers.set(g,new JA),this.eventHandlers.get(g).add(b)}notifyListeners(g,...b){const o=this.eventHandlers.get(g);o&&o.notify(...b)}hasListeners(g){return this.eventHandlers.has(g)}mount(g){if(this.instance)return;this.isSVG=tz(g)&&!hj(g),this.instance=g;const{layoutId:b,layout:o,visualElement:S}=this.options;if(S&&!S.current&&S.mount(g),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(o||b)&&(this.isLayoutDirty=!0),t){let M,O=0;const N=()=>this.root.updateBlockedByResize=!1;ws.read(()=>{O=window.innerWidth}),t(g,()=>{const j=window.innerWidth;j!==O&&(O=j,this.root.updateBlockedByResize=!0,M&&M(),M=u$(N,250),Ew.hasAnimatedSinceResize&&(Ew.hasAnimatedSinceResize=!1,this.nodes.forEach(vk)))})}b&&this.root.registerSharedNode(b,this),this.options.animate!==!1&&S&&(b||o)&&this.addEventListener("didUpdate",({delta:M,hasLayoutChanged:O,hasRelativeLayoutChanged:N,layout:j})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const Z=this.options.transition||S.getDefaultTransition()||O$,{onLayoutAnimationStart:K,onLayoutAnimationComplete:Q}=S.getProps(),ce=!this.targetLayout||!Nz(this.targetLayout,j),ge=!O&&N;if(this.options.layoutRoot||this.resumeFrom||ge||O&&(ce||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const ue={...dI(Z,"layout"),onPlay:K,onComplete:Q};(S.shouldReduceMotion||this.options.layoutRoot)&&(ue.delay=0,ue.type=!1),this.startAnimation(ue),this.setAnimationOrigin(M,ge)}else O||vk(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=j})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const g=this.getStack();g&&g.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),am(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(P$),this.animationId++)}getTransformTemplate(){const{visualElement:g}=this.options;return g&&g.getProps().transformTemplate}willUpdate(g=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Vz(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let M=0;M<this.path.length;M++){const O=this.path[M];O.shouldResetTransform=!0,O.updateScroll("snapshot"),O.options.layoutRoot&&O.willUpdate(!1)}const{layoutId:b,layout:o}=this.options;if(b===void 0&&!o)return;const S=this.getTransformTemplate();this.prevTransformTemplateValue=S?S(this.latestValues,""):void 0,this.updateSnapshot(),g&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(yk);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(_k);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(I$),this.nodes.forEach(T$),this.nodes.forEach(E$)):this.nodes.forEach(_k),this.clearAllSnapshots();const b=Ul.now();ga.delta=Vf(0,1e3/60,b-ga.timestamp),ga.timestamp=b,ga.isProcessing=!0,fS.update.process(ga),fS.preRender.process(ga),fS.render.process(ga),ga.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,pI.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(A$),this.sharedNodes.forEach(k$)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ws.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ws.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!xl(this.snapshot.measuredBox.x)&&!xl(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let o=0;o<this.path.length;o++)this.path[o].updateScroll();const g=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ks(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:b}=this.options;b&&b.notify("LayoutMeasure",this.layout.layoutBox,g?g.layoutBox:void 0)}updateScroll(g="measure"){let b=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===g&&(b=!1),b&&this.instance){const o=i(this.instance);this.scroll={animationId:this.root.animationId,phase:g,isRoot:o,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:o}}}resetTransform(){if(!u)return;const g=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,b=this.projectionDelta&&!Bz(this.projectionDelta),o=this.getTransformTemplate(),S=o?o(this.latestValues,""):void 0,M=S!==this.prevTransformTemplateValue;g&&this.instance&&(b||vg(this.latestValues)||M)&&(u(this.instance,S),this.shouldResetTransform=!1,this.scheduleRender())}measure(g=!0){const b=this.measurePageBox();let o=this.removeElementScroll(b);return g&&(o=this.removeTransform(o)),z$(o),{animationId:this.root.animationId,measuredBox:b,layoutBox:o,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:g}=this.options;if(!g)return Ks();const b=g.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(B$))){const{scroll:S}=this.root;S&&(p_(b.x,S.offset.x),p_(b.y,S.offset.y))}return b}removeElementScroll(g){const b=Ks();if(ru(b,g),this.scroll?.wasRoot)return b;for(let o=0;o<this.path.length;o++){const S=this.path[o],{scroll:M,options:O}=S;S!==this.root&&M&&O.layoutScroll&&(M.wasRoot&&ru(b,g),p_(b.x,M.offset.x),p_(b.y,M.offset.y))}return b}applyTransform(g,b=!1){const o=Ks();ru(o,g);for(let S=0;S<this.path.length;S++){const M=this.path[S];!b&&M.options.layoutScroll&&M.scroll&&M!==M.root&&m_(o,{x:-M.scroll.offset.x,y:-M.scroll.offset.y}),vg(M.latestValues)&&m_(o,M.latestValues)}return vg(this.latestValues)&&m_(o,this.latestValues),o}removeTransform(g){const b=Ks();ru(b,g);for(let o=0;o<this.path.length;o++){const S=this.path[o];if(!S.instance||!vg(S.latestValues))continue;AC(S.latestValues)&&S.updateSnapshot();const M=Ks(),O=S.measurePageBox();ru(M,O),hk(b,S.latestValues,S.snapshot?S.snapshot.layoutBox:void 0,M)}return vg(this.latestValues)&&hk(b,this.latestValues),b}setTargetDelta(g){this.targetDelta=g,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(g){this.options={...this.options,...g,crossfade:g.crossfade!==void 0?g.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ga.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(g=!1){const b=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=b.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=b.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=b.isSharedProjectionDirty);const o=!!this.resumingFrom||this!==b;if(!(g||o&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:M,layoutId:O}=this.options;if(!(!this.layout||!(M||O))){if(this.resolvedRelativeTargetAt=ga.timestamp,!this.targetDelta&&!this.relativeTarget){const N=this.getClosestProjectingParent();N&&N.layout&&this.animationProgress!==1?(this.relativeParent=N,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ks(),this.relativeTargetOrigin=Ks(),lx(this.relativeTargetOrigin,this.layout.layoutBox,N.layout.layoutBox),ru(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Ks(),this.targetWithTransforms=Ks()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),$8(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ru(this.target,this.layout.layoutBox),_z(this.target,this.targetDelta)):ru(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const N=this.getClosestProjectingParent();N&&!!N.resumingFrom==!!this.resumingFrom&&!N.options.layoutScroll&&N.target&&this.animationProgress!==1?(this.relativeParent=N,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ks(),this.relativeTargetOrigin=Ks(),lx(this.relativeTargetOrigin,this.target,N.target),ru(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||AC(this.parent.latestValues)||yz(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const g=this.getLead(),b=!!this.resumingFrom||this!==g;let o=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(o=!1),b&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(o=!1),this.resolvedRelativeTargetAt===ga.timestamp&&(o=!1),o)return;const{layout:S,layoutId:M}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(S||M))return;ru(this.layoutCorrected,this.layout.layoutBox);const O=this.treeScale.x,N=this.treeScale.y;t8(this.layoutCorrected,this.treeScale,this.path,b),g.layout&&!g.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(g.target=g.layout.layoutBox,g.targetWithTransforms=Ks());const{target:j}=g;if(!j){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(lk(this.prevProjectionDelta.x,this.projectionDelta.x),lk(this.prevProjectionDelta.y,this.projectionDelta.y)),ax(this.projectionDelta,this.layoutCorrected,j,this.latestValues),(this.treeScale.x!==O||this.treeScale.y!==N||!gk(this.projectionDelta.x,this.prevProjectionDelta.x)||!gk(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",j))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(g=!0){if(this.options.visualElement?.scheduleRender(),g){const b=this.getStack();b&&b.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=g_(),this.projectionDelta=g_(),this.projectionDeltaWithTransform=g_()}setAnimationOrigin(g,b=!1){const o=this.snapshot,S=o?o.latestValues:{},M={...this.latestValues},O=g_();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!b;const N=Ks(),j=o?o.source:void 0,Z=this.layout?this.layout.source:void 0,K=j!==Z,Q=this.getStack(),ce=!Q||Q.members.length<=1,ge=!!(K&&!ce&&this.options.crossfade===!0&&!this.path.some(L$));this.animationProgress=0;let ue;this.mixTargetDelta=pe=>{const me=pe/1e3;xk(O.x,g.x,me),xk(O.y,g.y,me),this.setTargetDelta(O),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(lx(N,this.layout.layoutBox,this.relativeParent.layout.layoutBox),D$(this.relativeTarget,this.relativeTargetOrigin,N,me),ue&&_$(this.relativeTarget,ue)&&(this.isProjectionDirty=!1),ue||(ue=Ks()),ru(ue,this.relativeTarget)),K&&(this.animationValues=M,d$(M,S,this.latestValues,me,ge,ce)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=me},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(g){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(am(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ws.update(()=>{Ew.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=R_(0)),this.currentAnimation=a$(this.motionValue,[0,1e3],{...g,velocity:0,isSync:!0,onUpdate:b=>{this.mixTargetDelta(b),g.onUpdate&&g.onUpdate(b)},onStop:()=>{},onComplete:()=>{g.onComplete&&g.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const g=this.getStack();g&&g.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(b$),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const g=this.getLead();let{targetWithTransforms:b,target:o,layout:S,latestValues:M}=g;if(!(!b||!o||!S)){if(this!==g&&this.layout&&S&&Uz(this.options.animationType,this.layout.layoutBox,S.layoutBox)){o=this.target||Ks();const O=xl(this.layout.layoutBox.x);o.x.min=g.target.x.min,o.x.max=o.x.min+O;const N=xl(this.layout.layoutBox.y);o.y.min=g.target.y.min,o.y.max=o.y.min+N}ru(b,o),m_(b,M),ax(this.projectionDeltaWithTransform,this.layoutCorrected,b,M)}}registerSharedNode(g,b){this.sharedNodes.has(g)||this.sharedNodes.set(g,new v$),this.sharedNodes.get(g).add(b);const S=b.options.initialPromotionConfig;b.promote({transition:S?S.transition:void 0,preserveFollowOpacity:S&&S.shouldPreserveFollowOpacity?S.shouldPreserveFollowOpacity(b):void 0})}isLead(){const g=this.getStack();return g?g.lead===this:!0}getLead(){const{layoutId:g}=this.options;return g?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:g}=this.options;return g?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:g}=this.options;if(g)return this.root.sharedNodes.get(g)}promote({needsReset:g,transition:b,preserveFollowOpacity:o}={}){const S=this.getStack();S&&S.promote(this,o),g&&(this.projectionDelta=void 0,this.needsReset=!0),b&&this.setOptions({transition:b})}relegate(){const g=this.getStack();return g?g.relegate(this):!1}resetSkewAndRotation(){const{visualElement:g}=this.options;if(!g)return;let b=!1;const{latestValues:o}=g;if((o.z||o.rotate||o.rotateX||o.rotateY||o.rotateZ||o.skewX||o.skewY)&&(b=!0),!b)return;const S={};o.z&&SS("z",g,S,this.animationValues);for(let M=0;M<ES.length;M++)SS(`rotate${ES[M]}`,g,S,this.animationValues),SS(`skew${ES[M]}`,g,S,this.animationValues);g.render();for(const M in S)g.setStaticValue(M,S[M]),this.animationValues&&(this.animationValues[M]=S[M]);g.scheduleRender()}applyProjectionStyles(g,b){if(!this.instance||this.isSVG)return;if(!this.isVisible){g.visibility="hidden";return}const o=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,g.visibility="",g.opacity="",g.pointerEvents=Tw(b?.pointerEvents)||"",g.transform=o?o(this.latestValues,""):"none";return}const S=this.getLead();if(!this.projectionDelta||!this.layout||!S.target){this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=Tw(b?.pointerEvents)||""),this.hasProjected&&!vg(this.latestValues)&&(g.transform=o?o({},""):"none",this.hasProjected=!1);return}g.visibility="";const M=S.animationValues||S.latestValues;this.applyTransformsToTarget();let O=x$(this.projectionDeltaWithTransform,this.treeScale,M);o&&(O=o(M,O)),g.transform=O;const{x:N,y:j}=this.projectionDelta;g.transformOrigin=`${N.origin*100}% ${j.origin*100}% 0`,S.animationValues?g.opacity=S===this?M.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:M.opacityExit:g.opacity=S===this?M.opacity!==void 0?M.opacity:"":M.opacityExit!==void 0?M.opacityExit:0;for(const Z in Ax){if(M[Z]===void 0)continue;const{correct:K,applyTo:Q,isCSSVariable:ce}=Ax[Z],ge=O==="none"?M[Z]:K(M[Z],S);if(Q){const ue=Q.length;for(let pe=0;pe<ue;pe++)g[Q[pe]]=ge}else ce?this.options.visualElement.renderState.vars[Z]=ge:g[Z]=ge}this.options.layoutId&&(g.pointerEvents=S===this?Tw(b?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(g=>g.currentAnimation?.stop()),this.root.nodes.forEach(yk),this.root.sharedNodes.clear()}}}function T$(t){t.updateLayout()}function E$(t){const e=t.resumeFrom?.snapshot||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=t.layout,{animationType:u}=t.options,f=e.source!==t.layout.source;u==="size"?su(M=>{const O=f?e.measuredBox[M]:e.layoutBox[M],N=xl(O);O.min=n[M].min,O.max=O.min+N}):Uz(u,e.layoutBox,n)&&su(M=>{const O=f?e.measuredBox[M]:e.layoutBox[M],N=xl(n[M]);O.max=O.min+N,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[M].max=t.relativeTarget[M].min+N)});const g=g_();ax(g,n,e.layoutBox);const b=g_();f?ax(b,t.applyTransform(i,!0),e.measuredBox):ax(b,n,e.layoutBox);const o=!Bz(g);let S=!1;if(!t.resumeFrom){const M=t.getClosestProjectingParent();if(M&&!M.resumeFrom){const{snapshot:O,layout:N}=M;if(O&&N){const j=Ks();lx(j,e.layoutBox,O.layoutBox);const Z=Ks();lx(Z,n,N.layoutBox),Nz(j,Z)||(S=!0),M.options.layoutRoot&&(t.relativeTarget=Z,t.relativeTargetOrigin=j,t.relativeParent=M)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:b,layoutDelta:g,hasLayoutChanged:o,hasRelativeLayoutChanged:S})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function S$(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function C$(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function A$(t){t.clearSnapshot()}function yk(t){t.clearMeasurements()}function _k(t){t.isLayoutDirty=!1}function I$(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function vk(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function R$(t){t.resolveTargetDelta()}function M$(t){t.calcProjection()}function P$(t){t.resetSkewAndRotation()}function k$(t){t.removeLeadSnapshot()}function xk(t,e,n){t.translate=Ms(e.translate,0,n),t.scale=Ms(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function bk(t,e,n,i){t.min=Ms(e.min,n.min,i),t.max=Ms(e.max,n.max,i)}function D$(t,e,n,i){bk(t.x,e.x,n.x,i),bk(t.y,e.y,n.y,i)}function L$(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const O$={duration:.45,ease:[.4,0,.1,1]},wk=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),Tk=wk("applewebkit/")&&!wk("chrome/")?Math.round:pu;function Ek(t){t.min=Tk(t.min),t.max=Tk(t.max)}function z$(t){Ek(t.x),Ek(t.y)}function Uz(t,e,n){return t==="position"||t==="preserve-aspect"&&!j8(mk(e),mk(n),.2)}function B$(t){return t!==t.root&&t.scroll?.wasRoot}const N$=Fz({attachResizeListener:(t,e)=>Ix(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),CS={current:void 0},jz=Fz({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!CS.current){const t=new N$({});t.mount(window),t.setOptions({layoutScroll:!0}),CS.current=t}return CS.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),V$={pan:{Feature:r$},drag:{Feature:n$,ProjectionNode:jz,MeasureLayout:Lz}};function Sk(t,e,n){const{props:i}=t;t.animationState&&i.whileHover&&t.animationState.setActive("whileHover",n==="Start");const u="onHover"+n,f=i[u];f&&ws.postRender(()=>f(e,Qx(e)))}class F$ extends vm{mount(){const{current:e}=this.node;e&&(this.unmount=oj(e,(n,i)=>(Sk(this.node,i,"Start"),u=>Sk(this.node,u,"End"))))}unmount(){}}class U$ extends vm{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Zx(Ix(this.node.current,"focus",()=>this.onFocus()),Ix(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Ck(t,e,n){const{props:i}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&i.whileTap&&t.animationState.setActive("whileTap",n==="Start");const u="onTap"+(n==="End"?"":n),f=i[u];f&&ws.postRender(()=>f(e,Qx(e)))}class j$ extends vm{mount(){const{current:e}=this.node;e&&(this.unmount=uj(e,(n,i)=>(Ck(this.node,i,"Start"),(u,{success:f})=>Ck(this.node,u,f?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const LC=new WeakMap,AS=new WeakMap,$$=t=>{const e=LC.get(t.target);e&&e(t)},q$=t=>{t.forEach($$)};function G$({root:t,...e}){const n=t||document;AS.has(n)||AS.set(n,{});const i=AS.get(n),u=JSON.stringify(e);return i[u]||(i[u]=new IntersectionObserver(q$,{root:t,...e})),i[u]}function H$(t,e,n){const i=G$(e);return LC.set(t,n),i.observe(t),()=>{LC.delete(t),i.unobserve(t)}}const W$={some:0,all:1};class X$ extends vm{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:i,amount:u="some",once:f}=e,g={root:n?n.current:void 0,rootMargin:i,threshold:typeof u=="number"?u:W$[u]},b=o=>{const{isIntersecting:S}=o;if(this.isInView===S||(this.isInView=S,f&&!S&&this.hasEnteredView))return;S&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",S);const{onViewportEnter:M,onViewportLeave:O}=this.node.getProps(),N=S?M:O;N&&N(o)};return H$(this.node.current,g,b)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(Z$(e,n))&&this.startObserver()}unmount(){}}function Z$({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const K$={inView:{Feature:X$},tap:{Feature:j$},focus:{Feature:U$},hover:{Feature:F$}},Y$={layout:{ProjectionNode:jz,MeasureLayout:Lz}},Q$={...z8,...K$,...V$,...Y$},Xf=Qj(Q$,h8),J$=()=>{};var Ak={};const $z=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let u=t.charCodeAt(i);u<128?e[n++]=u:u<2048?(e[n++]=u>>6|192,e[n++]=u&63|128):(u&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(u=65536+((u&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=u>>18|240,e[n++]=u>>12&63|128,e[n++]=u>>6&63|128,e[n++]=u&63|128):(e[n++]=u>>12|224,e[n++]=u>>6&63|128,e[n++]=u&63|128)}return e},e9=function(t){const e=[];let n=0,i=0;for(;n<t.length;){const u=t[n++];if(u<128)e[i++]=String.fromCharCode(u);else if(u>191&&u<224){const f=t[n++];e[i++]=String.fromCharCode((u&31)<<6|f&63)}else if(u>239&&u<365){const f=t[n++],g=t[n++],b=t[n++],o=((u&7)<<18|(f&63)<<12|(g&63)<<6|b&63)-65536;e[i++]=String.fromCharCode(55296+(o>>10)),e[i++]=String.fromCharCode(56320+(o&1023))}else{const f=t[n++],g=t[n++];e[i++]=String.fromCharCode((u&15)<<12|(f&63)<<6|g&63)}}return e.join("")},qz={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let u=0;u<t.length;u+=3){const f=t[u],g=u+1<t.length,b=g?t[u+1]:0,o=u+2<t.length,S=o?t[u+2]:0,M=f>>2,O=(f&3)<<4|b>>4;let N=(b&15)<<2|S>>6,j=S&63;o||(j=64,g||(N=64)),i.push(n[M],n[O],n[N],n[j])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray($z(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):e9(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let u=0;u<t.length;){const f=n[t.charAt(u++)],b=u<t.length?n[t.charAt(u)]:0;++u;const S=u<t.length?n[t.charAt(u)]:64;++u;const O=u<t.length?n[t.charAt(u)]:64;if(++u,f==null||b==null||S==null||O==null)throw new t9;const N=f<<2|b>>4;if(i.push(N),S!==64){const j=b<<4&240|S>>2;if(i.push(j),O!==64){const Z=S<<6&192|O;i.push(Z)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class t9 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const n9=function(t){const e=$z(t);return qz.encodeByteArray(e,!0)},Jw=function(t){return n9(t).replace(/\./g,"")},Gz=function(t){try{return qz.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function r9(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const i9=()=>r9().__FIREBASE_DEFAULTS__,s9=()=>{if(typeof process>"u"||typeof Ak>"u")return;const t=Ak.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},o9=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Gz(t[1]);return e&&JSON.parse(e)},BT=()=>{try{return J$()||i9()||s9()||o9()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Hz=t=>BT()?.emulatorHosts?.[t],Wz=t=>{const e=Hz(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},Xz=()=>BT()?.config,Zz=t=>BT()?.[`_${t}`];class a9{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}function xm(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function CI(t){return(await fetch(t,{credentials:"include"})).ok}function Kz(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",u=t.iat||0,f=t.sub||t.user_id;if(!f)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const g={iss:`https://securetoken.google.com/${i}`,aud:i,iat:u,exp:u+3600,auth_time:u,sub:f,user_id:f,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Jw(JSON.stringify(n)),Jw(JSON.stringify(g)),""].join(".")}const cx={};function l9(){const t={prod:[],emulator:[]};for(const e of Object.keys(cx))cx[e]?t.emulator.push(e):t.prod.push(e);return t}function c9(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Ik=!1;function AI(t,e){if(typeof window>"u"||typeof document>"u"||!xm(window.location.host)||cx[t]===e||cx[t]||Ik)return;cx[t]=e;function n(N){return`__firebase__banner__${N}`}const i="__firebase__banner",f=l9().prod.length>0;function g(){const N=document.getElementById(i);N&&N.remove()}function b(N){N.style.display="flex",N.style.background="#7faaf0",N.style.position="fixed",N.style.bottom="5px",N.style.left="5px",N.style.padding=".5em",N.style.borderRadius="5px",N.style.alignItems="center"}function o(N,j){N.setAttribute("width","24"),N.setAttribute("id",j),N.setAttribute("height","24"),N.setAttribute("viewBox","0 0 24 24"),N.setAttribute("fill","none"),N.style.marginLeft="-6px"}function S(){const N=document.createElement("span");return N.style.cursor="pointer",N.style.marginLeft="16px",N.style.fontSize="24px",N.innerHTML=" &times;",N.onclick=()=>{Ik=!0,g()},N}function M(N,j){N.setAttribute("id",j),N.innerText="Learn more",N.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",N.setAttribute("target","__blank"),N.style.paddingLeft="5px",N.style.textDecoration="underline"}function O(){const N=c9(i),j=n("text"),Z=document.getElementById(j)||document.createElement("span"),K=n("learnmore"),Q=document.getElementById(K)||document.createElement("a"),ce=n("preprendIcon"),ge=document.getElementById(ce)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(N.created){const ue=N.element;b(ue),M(Q,K);const pe=S();o(ge,ce),ue.append(ge,Z,Q,pe),document.body.appendChild(ue)}f?(Z.innerText="Preview backend disconnected.",ge.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ge.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,Z.innerText="Preview backend running in this workspace."),Z.setAttribute("id",j)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",O):O()}function Ja(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function u9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ja())}function h9(){const t=BT()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function d9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function f9(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function p9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function m9(){const t=Ja();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function g9(){return!h9()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function y9(){try{return typeof indexedDB=="object"}catch{return!1}}function _9(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",u=self.indexedDB.open(i);u.onsuccess=()=>{u.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},u.onupgradeneeded=()=>{n=!1},u.onerror=()=>{e(u.error?.message||"")}}catch(n){e(n)}})}const v9="FirebaseError";class xu extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=v9,Object.setPrototypeOf(this,xu.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Jx.prototype.create)}}class Jx{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},u=`${this.service}/${e}`,f=this.errors[e],g=f?x9(f,i):"Error",b=`${this.serviceName}: ${g} (${u}).`;return new xu(u,b,i)}}function x9(t,e){return t.replace(b9,(n,i)=>{const u=e[i];return u!=null?String(u):`<${i}?>`})}const b9=/\{\$([^}]+)}/g;function w9(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Lg(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const u of n){if(!i.includes(u))return!1;const f=t[u],g=e[u];if(Rk(f)&&Rk(g)){if(!Lg(f,g))return!1}else if(f!==g)return!1}for(const u of i)if(!n.includes(u))return!1;return!0}function Rk(t){return t!==null&&typeof t=="object"}function eb(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(u=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(u))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function W0(t){const e={};return t.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[u,f]=i.split("=");e[decodeURIComponent(u)]=decodeURIComponent(f)}}),e}function X0(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function T9(t,e){const n=new E9(t,e);return n.subscribe.bind(n)}class E9{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let u;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");S9(e,["next","error","complete"])?u=e:u={next:e,error:n,complete:i},u.next===void 0&&(u.next=IS),u.error===void 0&&(u.error=IS),u.complete===void 0&&(u.complete=IS);const f=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?u.error(this.finalError):u.complete()}catch{}}),this.observers.push(u),f}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function S9(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function IS(){}function wo(t){return t&&t._delegate?t._delegate:t}class cm{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const xg="[DEFAULT]";class C9{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new a9;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const u=this.getOrInitializeService({instanceIdentifier:n});u&&i.resolve(u)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(u){if(i)return null;throw u}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(I9(e))try{this.getOrInitializeService({instanceIdentifier:xg})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(n);try{const f=this.getOrInitializeService({instanceIdentifier:u});i.resolve(f)}catch{}}}}clearInstance(e=xg){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xg){return this.instances.has(e)}getOptions(e=xg){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const u=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[f,g]of this.instancesDeferred.entries()){const b=this.normalizeInstanceIdentifier(f);i===b&&g.resolve(u)}return u}onInit(e,n){const i=this.normalizeInstanceIdentifier(n),u=this.onInitCallbacks.get(i)??new Set;u.add(e),this.onInitCallbacks.set(i,u);const f=this.instances.get(i);return f&&e(f,i),()=>{u.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const u of i)try{u(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:A9(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=xg){return this.component?this.component.multipleInstances?e:xg:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function A9(t){return t===xg?void 0:t}function I9(t){return t.instantiationMode==="EAGER"}class R9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new C9(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var si;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(si||(si={}));const M9={debug:si.DEBUG,verbose:si.VERBOSE,info:si.INFO,warn:si.WARN,error:si.ERROR,silent:si.SILENT},P9=si.INFO,k9={[si.DEBUG]:"log",[si.VERBOSE]:"log",[si.INFO]:"info",[si.WARN]:"warn",[si.ERROR]:"error"},D9=(t,e,...n)=>{if(e<t.logLevel)return;const i=new Date().toISOString(),u=k9[e];if(u)console[u](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class II{constructor(e){this.name=e,this._logLevel=P9,this._logHandler=D9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in si))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?M9[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,si.DEBUG,...e),this._logHandler(this,si.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,si.VERBOSE,...e),this._logHandler(this,si.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,si.INFO,...e),this._logHandler(this,si.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,si.WARN,...e),this._logHandler(this,si.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,si.ERROR,...e),this._logHandler(this,si.ERROR,...e)}}const L9=(t,e)=>e.some(n=>t instanceof n);let Mk,Pk;function O9(){return Mk||(Mk=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function z9(){return Pk||(Pk=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Yz=new WeakMap,OC=new WeakMap,Qz=new WeakMap,RS=new WeakMap,RI=new WeakMap;function B9(t){const e=new Promise((n,i)=>{const u=()=>{t.removeEventListener("success",f),t.removeEventListener("error",g)},f=()=>{n(em(t.result)),u()},g=()=>{i(t.error),u()};t.addEventListener("success",f),t.addEventListener("error",g)});return e.then(n=>{n instanceof IDBCursor&&Yz.set(n,t)}).catch(()=>{}),RI.set(e,t),e}function N9(t){if(OC.has(t))return;const e=new Promise((n,i)=>{const u=()=>{t.removeEventListener("complete",f),t.removeEventListener("error",g),t.removeEventListener("abort",g)},f=()=>{n(),u()},g=()=>{i(t.error||new DOMException("AbortError","AbortError")),u()};t.addEventListener("complete",f),t.addEventListener("error",g),t.addEventListener("abort",g)});OC.set(t,e)}let zC={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return OC.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Qz.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return em(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function V9(t){zC=t(zC)}function F9(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=t.call(MS(this),e,...n);return Qz.set(i,e.sort?e.sort():[e]),em(i)}:z9().includes(t)?function(...e){return t.apply(MS(this),e),em(Yz.get(this))}:function(...e){return em(t.apply(MS(this),e))}}function U9(t){return typeof t=="function"?F9(t):(t instanceof IDBTransaction&&N9(t),L9(t,O9())?new Proxy(t,zC):t)}function em(t){if(t instanceof IDBRequest)return B9(t);if(RS.has(t))return RS.get(t);const e=U9(t);return e!==t&&(RS.set(t,e),RI.set(e,t)),e}const MS=t=>RI.get(t);function j9(t,e,{blocked:n,upgrade:i,blocking:u,terminated:f}={}){const g=indexedDB.open(t,e),b=em(g);return i&&g.addEventListener("upgradeneeded",o=>{i(em(g.result),o.oldVersion,o.newVersion,em(g.transaction),o)}),n&&g.addEventListener("blocked",o=>n(o.oldVersion,o.newVersion,o)),b.then(o=>{f&&o.addEventListener("close",()=>f()),u&&o.addEventListener("versionchange",S=>u(S.oldVersion,S.newVersion,S))}).catch(()=>{}),b}const $9=["get","getKey","getAll","getAllKeys","count"],q9=["put","add","delete","clear"],PS=new Map;function kk(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(PS.get(e))return PS.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,u=q9.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(u||$9.includes(n)))return;const f=async function(g,...b){const o=this.transaction(g,u?"readwrite":"readonly");let S=o.store;return i&&(S=S.index(b.shift())),(await Promise.all([S[n](...b),u&&o.done]))[0]};return PS.set(e,f),f}V9(t=>({...t,get:(e,n,i)=>kk(e,n)||t.get(e,n,i),has:(e,n)=>!!kk(e,n)||t.has(e,n)}));class G9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(H9(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function H9(t){return t.getComponent()?.type==="VERSION"}const BC="@firebase/app",Dk="0.14.6";const Uf=new II("@firebase/app"),W9="@firebase/app-compat",X9="@firebase/analytics-compat",Z9="@firebase/analytics",K9="@firebase/app-check-compat",Y9="@firebase/app-check",Q9="@firebase/auth",J9="@firebase/auth-compat",e2="@firebase/database",t2="@firebase/data-connect",n2="@firebase/database-compat",r2="@firebase/functions",i2="@firebase/functions-compat",s2="@firebase/installations",o2="@firebase/installations-compat",a2="@firebase/messaging",l2="@firebase/messaging-compat",c2="@firebase/performance",u2="@firebase/performance-compat",h2="@firebase/remote-config",d2="@firebase/remote-config-compat",f2="@firebase/storage",p2="@firebase/storage-compat",m2="@firebase/firestore",g2="@firebase/ai",y2="@firebase/firestore-compat",_2="firebase",v2="12.6.0";const NC="[DEFAULT]",x2={[BC]:"fire-core",[W9]:"fire-core-compat",[Z9]:"fire-analytics",[X9]:"fire-analytics-compat",[Y9]:"fire-app-check",[K9]:"fire-app-check-compat",[Q9]:"fire-auth",[J9]:"fire-auth-compat",[e2]:"fire-rtdb",[t2]:"fire-data-connect",[n2]:"fire-rtdb-compat",[r2]:"fire-fn",[i2]:"fire-fn-compat",[s2]:"fire-iid",[o2]:"fire-iid-compat",[a2]:"fire-fcm",[l2]:"fire-fcm-compat",[c2]:"fire-perf",[u2]:"fire-perf-compat",[h2]:"fire-rc",[d2]:"fire-rc-compat",[f2]:"fire-gcs",[p2]:"fire-gcs-compat",[m2]:"fire-fst",[y2]:"fire-fst-compat",[g2]:"fire-vertex","fire-js":"fire-js",[_2]:"fire-js-all"};const eT=new Map,b2=new Map,VC=new Map;function Lk(t,e){try{t.container.addComponent(e)}catch(n){Uf.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Og(t){const e=t.name;if(VC.has(e))return Uf.debug(`There were multiple attempts to register component ${e}.`),!1;VC.set(e,t);for(const n of eT.values())Lk(n,t);for(const n of b2.values())Lk(n,t);return!0}function NT(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function _c(t){return t==null?!1:t.settings!==void 0}const w2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},tm=new Jx("app","Firebase",w2);class T2{constructor(e,n,i){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new cm("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw tm.create("app-deleted",{appName:this._name})}}const qg=v2;function Jz(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const i={name:NC,automaticDataCollectionEnabled:!0,...e},u=i.name;if(typeof u!="string"||!u)throw tm.create("bad-app-name",{appName:String(u)});if(n||(n=Xz()),!n)throw tm.create("no-options");const f=eT.get(u);if(f){if(Lg(n,f.options)&&Lg(i,f.config))return f;throw tm.create("duplicate-app",{appName:u})}const g=new R9(u);for(const o of VC.values())g.addComponent(o);const b=new T2(n,i,g);return eT.set(u,b),b}function MI(t=NC){const e=eT.get(t);if(!e&&t===NC&&Xz())return Jz();if(!e)throw tm.create("no-app",{appName:t});return e}function bd(t,e,n){let i=x2[t]??t;n&&(i+=`-${n}`);const u=i.match(/\s|\//),f=e.match(/\s|\//);if(u||f){const g=[`Unable to register library "${i}" with version "${e}":`];u&&g.push(`library name "${i}" contains illegal characters (whitespace or "/")`),u&&f&&g.push("and"),f&&g.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Uf.warn(g.join(" "));return}Og(new cm(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const E2="firebase-heartbeat-database",S2=1,Rx="firebase-heartbeat-store";let kS=null;function e5(){return kS||(kS=j9(E2,S2,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Rx)}catch(n){console.warn(n)}}}}).catch(t=>{throw tm.create("idb-open",{originalErrorMessage:t.message})})),kS}async function C2(t){try{const n=(await e5()).transaction(Rx),i=await n.objectStore(Rx).get(t5(t));return await n.done,i}catch(e){if(e instanceof xu)Uf.warn(e.message);else{const n=tm.create("idb-get",{originalErrorMessage:e?.message});Uf.warn(n.message)}}}async function Ok(t,e){try{const i=(await e5()).transaction(Rx,"readwrite");await i.objectStore(Rx).put(e,t5(t)),await i.done}catch(n){if(n instanceof xu)Uf.warn(n.message);else{const i=tm.create("idb-set",{originalErrorMessage:n?.message});Uf.warn(i.message)}}}function t5(t){return`${t.name}!${t.options.appId}`}const A2=1024,I2=30;class R2{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new P2(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=zk();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(u=>u.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>I2){const u=k2(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Uf.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=zk(),{heartbeatsToSend:n,unsentEntries:i}=M2(this._heartbeatsCache.heartbeats),u=Jw(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),u}catch(e){return Uf.warn(e),""}}}function zk(){return new Date().toISOString().substring(0,10)}function M2(t,e=A2){const n=[];let i=t.slice();for(const u of t){const f=n.find(g=>g.agent===u.agent);if(f){if(f.dates.push(u.date),Bk(n)>e){f.dates.pop();break}}else if(n.push({agent:u.agent,dates:[u.date]}),Bk(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class P2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return y9()?_9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await C2(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Ok(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Ok(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Bk(t){return Jw(JSON.stringify({version:2,heartbeats:t})).length}function k2(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let i=1;i<t.length;i++)t[i].date<n&&(n=t[i].date,e=i);return e}function D2(t){Og(new cm("platform-logger",e=>new G9(e),"PRIVATE")),Og(new cm("heartbeat",e=>new R2(e),"PRIVATE")),bd(BC,Dk,t),bd(BC,Dk,"esm2020"),bd("fire-js","")}D2("");var L2="firebase",O2="12.6.0";bd(L2,O2,"app");function n5(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const z2=n5,r5=new Jx("auth","Firebase",n5());const tT=new II("@firebase/auth");function B2(t,...e){tT.logLevel<=si.WARN&&tT.warn(`Auth (${qg}): ${t}`,...e)}function Sw(t,...e){tT.logLevel<=si.ERROR&&tT.error(`Auth (${qg}): ${t}`,...e)}function dh(t,...e){throw PI(t,...e)}function wd(t,...e){return PI(t,...e)}function i5(t,e,n){const i={...z2(),[e]:n};return new Jx("auth","Firebase",i).create(e,{appName:t.name})}function zf(t){return i5(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function PI(t,...e){if(typeof t!="string"){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return r5.create(t,...e)}function pr(t,e,...n){if(!t)throw PI(e,...n)}function Df(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Sw(e),new Error(e)}function jf(t,e){t||Df(e)}function FC(){return typeof self<"u"&&self.location?.href||""}function N2(){return Nk()==="http:"||Nk()==="https:"}function Nk(){return typeof self<"u"&&self.location?.protocol||null}function V2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(N2()||f9()||"connection"in navigator)?navigator.onLine:!0}function F2(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class tb{constructor(e,n){this.shortDelay=e,this.longDelay=n,jf(n>e,"Short delay should be less than long delay!"),this.isMobile=u9()||p9()}get(){return V2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function kI(t,e){jf(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class s5{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Df("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Df("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Df("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const U2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const j2=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],$2=new tb(3e4,6e4);function bm(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function wm(t,e,n,i,u={}){return o5(t,u,async()=>{let f={},g={};i&&(e==="GET"?g=i:f={body:JSON.stringify(i)});const b=eb({key:t.config.apiKey,...g}).slice(1),o=await t._getAdditionalHeaders();o["Content-Type"]="application/json",t.languageCode&&(o["X-Firebase-Locale"]=t.languageCode);const S={method:e,headers:o,...f};return d9()||(S.referrerPolicy="no-referrer"),t.emulatorConfig&&xm(t.emulatorConfig.host)&&(S.credentials="include"),s5.fetch()(await a5(t,t.config.apiHost,n,b),S)})}async function o5(t,e,n){t._canInitEmulator=!1;const i={...U2,...e};try{const u=new G2(t),f=await Promise.race([n(),u.promise]);u.clearNetworkTimeout();const g=await f.json();if("needConfirmation"in g)throw H1(t,"account-exists-with-different-credential",g);if(f.ok&&!("errorMessage"in g))return g;{const b=f.ok?g.errorMessage:g.error.message,[o,S]=b.split(" : ");if(o==="FEDERATED_USER_ID_ALREADY_LINKED")throw H1(t,"credential-already-in-use",g);if(o==="EMAIL_EXISTS")throw H1(t,"email-already-in-use",g);if(o==="USER_DISABLED")throw H1(t,"user-disabled",g);const M=i[o]||o.toLowerCase().replace(/[_\s]+/g,"-");if(S)throw i5(t,M,S);dh(t,M)}}catch(u){if(u instanceof xu)throw u;dh(t,"network-request-failed",{message:String(u)})}}async function nb(t,e,n,i,u={}){const f=await wm(t,e,n,i,u);return"mfaPendingCredential"in f&&dh(t,"multi-factor-auth-required",{_serverResponse:f}),f}async function a5(t,e,n,i){const u=`${e}${n}?${i}`,f=t,g=f.config.emulator?kI(t.config,u):`${t.config.apiScheme}://${u}`;return j2.includes(n)&&(await f._persistenceManagerAvailable,f._getPersistenceType()==="COOKIE")?f._getPersistence()._getFinalTarget(g).toString():g}function q2(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class G2{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(wd(this.auth,"network-request-failed")),$2.get())})}}function H1(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const u=wd(t,e,i);return u.customData._tokenResponse=n,u}function Vk(t){return t!==void 0&&t.enterprise!==void 0}class H2{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return q2(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function W2(t,e){return wm(t,"GET","/v2/recaptchaConfig",bm(t,e))}async function X2(t,e){return wm(t,"POST","/v1/accounts:delete",e)}async function nT(t,e){return wm(t,"POST","/v1/accounts:lookup",e)}function ux(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Z2(t,e=!1){const n=wo(t),i=await n.getIdToken(e),u=DI(i);pr(u&&u.exp&&u.auth_time&&u.iat,n.auth,"internal-error");const f=typeof u.firebase=="object"?u.firebase:void 0,g=f?.sign_in_provider;return{claims:u,token:i,authTime:ux(DS(u.auth_time)),issuedAtTime:ux(DS(u.iat)),expirationTime:ux(DS(u.exp)),signInProvider:g||null,signInSecondFactor:f?.sign_in_second_factor||null}}function DS(t){return Number(t)*1e3}function DI(t){const[e,n,i]=t.split(".");if(e===void 0||n===void 0||i===void 0)return Sw("JWT malformed, contained fewer than 3 sections"),null;try{const u=Gz(n);return u?JSON.parse(u):(Sw("Failed to decode base64 JWT payload"),null)}catch(u){return Sw("Caught error parsing JWT payload as JSON",u?.toString()),null}}function Fk(t){const e=DI(t);return pr(e,"internal-error"),pr(typeof e.exp<"u","internal-error"),pr(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Mx(t,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof xu&&K2(i)&&t.auth.currentUser===t&&await t.auth.signOut(),i}}function K2({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class Y2{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class UC{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ux(this.lastLoginAt),this.creationTime=ux(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function rT(t){const e=t.auth,n=await t.getIdToken(),i=await Mx(t,nT(e,{idToken:n}));pr(i?.users.length,e,"internal-error");const u=i.users[0];t._notifyReloadListener(u);const f=u.providerUserInfo?.length?l5(u.providerUserInfo):[],g=J2(t.providerData,f),b=t.isAnonymous,o=!(t.email&&u.passwordHash)&&!g?.length,S=b?o:!1,M={uid:u.localId,displayName:u.displayName||null,photoURL:u.photoUrl||null,email:u.email||null,emailVerified:u.emailVerified||!1,phoneNumber:u.phoneNumber||null,tenantId:u.tenantId||null,providerData:g,metadata:new UC(u.createdAt,u.lastLoginAt),isAnonymous:S};Object.assign(t,M)}async function Q2(t){const e=wo(t);await rT(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function J2(t,e){return[...t.filter(i=>!e.some(u=>u.providerId===i.providerId)),...e]}function l5(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function eq(t,e){const n=await o5(t,{},async()=>{const i=eb({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:u,apiKey:f}=t.config,g=await a5(t,u,"/v1/token",`key=${f}`),b=await t._getAdditionalHeaders();b["Content-Type"]="application/x-www-form-urlencoded";const o={method:"POST",headers:b,body:i};return t.emulatorConfig&&xm(t.emulatorConfig.host)&&(o.credentials="include"),s5.fetch()(g,o)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function tq(t,e){return wm(t,"POST","/v2/accounts:revokeToken",bm(t,e))}class b_{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){pr(e.idToken,"internal-error"),pr(typeof e.idToken<"u","internal-error"),pr(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Fk(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){pr(e.length!==0,"internal-error");const n=Fk(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(pr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:i,refreshToken:u,expiresIn:f}=await eq(e,n);this.updateTokensAndExpiration(i,u,Number(f))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){const{refreshToken:i,accessToken:u,expirationTime:f}=n,g=new b_;return i&&(pr(typeof i=="string","internal-error",{appName:e}),g.refreshToken=i),u&&(pr(typeof u=="string","internal-error",{appName:e}),g.accessToken=u),f&&(pr(typeof f=="number","internal-error",{appName:e}),g.expirationTime=f),g}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new b_,this.toJSON())}_performRefresh(){return Df("not implemented")}}function Hp(t,e){pr(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class uh{constructor({uid:e,auth:n,stsTokenManager:i,...u}){this.providerId="firebase",this.proactiveRefresh=new Y2(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=u.displayName||null,this.email=u.email||null,this.emailVerified=u.emailVerified||!1,this.phoneNumber=u.phoneNumber||null,this.photoURL=u.photoURL||null,this.isAnonymous=u.isAnonymous||!1,this.tenantId=u.tenantId||null,this.providerData=u.providerData?[...u.providerData]:[],this.metadata=new UC(u.createdAt||void 0,u.lastLoginAt||void 0)}async getIdToken(e){const n=await Mx(this,this.stsTokenManager.getToken(this.auth,e));return pr(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Z2(this,e)}reload(){return Q2(this)}_assign(e){this!==e&&(pr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new uh({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){pr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await rT(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(_c(this.auth.app))return Promise.reject(zf(this.auth));const e=await this.getIdToken();return await Mx(this,X2(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const i=n.displayName??void 0,u=n.email??void 0,f=n.phoneNumber??void 0,g=n.photoURL??void 0,b=n.tenantId??void 0,o=n._redirectEventId??void 0,S=n.createdAt??void 0,M=n.lastLoginAt??void 0,{uid:O,emailVerified:N,isAnonymous:j,providerData:Z,stsTokenManager:K}=n;pr(O&&K,e,"internal-error");const Q=b_.fromJSON(this.name,K);pr(typeof O=="string",e,"internal-error"),Hp(i,e.name),Hp(u,e.name),pr(typeof N=="boolean",e,"internal-error"),pr(typeof j=="boolean",e,"internal-error"),Hp(f,e.name),Hp(g,e.name),Hp(b,e.name),Hp(o,e.name),Hp(S,e.name),Hp(M,e.name);const ce=new uh({uid:O,auth:e,email:u,emailVerified:N,displayName:i,isAnonymous:j,photoURL:g,phoneNumber:f,tenantId:b,stsTokenManager:Q,createdAt:S,lastLoginAt:M});return Z&&Array.isArray(Z)&&(ce.providerData=Z.map(ge=>({...ge}))),o&&(ce._redirectEventId=o),ce}static async _fromIdTokenResponse(e,n,i=!1){const u=new b_;u.updateFromServerResponse(n);const f=new uh({uid:n.localId,auth:e,stsTokenManager:u,isAnonymous:i});return await rT(f),f}static async _fromGetAccountInfoResponse(e,n,i){const u=n.users[0];pr(u.localId!==void 0,"internal-error");const f=u.providerUserInfo!==void 0?l5(u.providerUserInfo):[],g=!(u.email&&u.passwordHash)&&!f?.length,b=new b_;b.updateFromIdToken(i);const o=new uh({uid:u.localId,auth:e,stsTokenManager:b,isAnonymous:g}),S={uid:u.localId,displayName:u.displayName||null,photoURL:u.photoUrl||null,email:u.email||null,emailVerified:u.emailVerified||!1,phoneNumber:u.phoneNumber||null,tenantId:u.tenantId||null,providerData:f,metadata:new UC(u.createdAt,u.lastLoginAt),isAnonymous:!(u.email&&u.passwordHash)&&!f?.length};return Object.assign(o,S),o}}const Uk=new Map;function Lf(t){jf(t instanceof Function,"Expected a class definition");let e=Uk.get(t);return e?(jf(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Uk.set(t,e),e)}class c5{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}c5.type="NONE";const jk=c5;function Cw(t,e,n){return`firebase:${t}:${e}:${n}`}class w_{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;const{config:u,name:f}=this.auth;this.fullUserKey=Cw(this.userKey,u.apiKey,f),this.fullPersistenceKey=Cw("persistence",u.apiKey,f),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await nT(this.auth,{idToken:e}).catch(()=>{});return n?uh._fromGetAccountInfoResponse(this.auth,n,e):null}return uh._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new w_(Lf(jk),e,i);const u=(await Promise.all(n.map(async S=>{if(await S._isAvailable())return S}))).filter(S=>S);let f=u[0]||Lf(jk);const g=Cw(i,e.config.apiKey,e.name);let b=null;for(const S of n)try{const M=await S._get(g);if(M){let O;if(typeof M=="string"){const N=await nT(e,{idToken:M}).catch(()=>{});if(!N)break;O=await uh._fromGetAccountInfoResponse(e,N,M)}else O=uh._fromJSON(e,M);S!==f&&(b=O),f=S;break}}catch{}const o=u.filter(S=>S._shouldAllowMigration);return!f._shouldAllowMigration||!o.length?new w_(f,e,i):(f=o[0],b&&await f._set(g,b.toJSON()),await Promise.all(n.map(async S=>{if(S!==f)try{await S._remove(g)}catch{}})),new w_(f,e,i))}}function $k(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(f5(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(u5(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(m5(e))return"Blackberry";if(g5(e))return"Webos";if(h5(e))return"Safari";if((e.includes("chrome/")||d5(e))&&!e.includes("edge/"))return"Chrome";if(p5(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=t.match(n);if(i?.length===2)return i[1]}return"Other"}function u5(t=Ja()){return/firefox\//i.test(t)}function h5(t=Ja()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function d5(t=Ja()){return/crios\//i.test(t)}function f5(t=Ja()){return/iemobile/i.test(t)}function p5(t=Ja()){return/android/i.test(t)}function m5(t=Ja()){return/blackberry/i.test(t)}function g5(t=Ja()){return/webos/i.test(t)}function LI(t=Ja()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function nq(t=Ja()){return LI(t)&&!!window.navigator?.standalone}function rq(){return m9()&&document.documentMode===10}function y5(t=Ja()){return LI(t)||p5(t)||g5(t)||m5(t)||/windows phone/i.test(t)||f5(t)}function _5(t,e=[]){let n;switch(t){case"Browser":n=$k(Ja());break;case"Worker":n=`${$k(Ja())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${qg}/${i}`}class iq{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const i=f=>new Promise((g,b)=>{try{const o=e(f);g(o)}catch(o){b(o)}});i.onAbort=n,this.queue.push(i);const u=this.queue.length-1;return()=>{this.queue[u]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const u of n)try{u()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function sq(t,e={}){return wm(t,"GET","/v2/passwordPolicy",bm(t,e))}const oq=6;class aq{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??oq,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const i=this.customStrengthOptions.minPasswordLength,u=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),u&&(n.meetsMaxPasswordLength=e.length<=u)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let u=0;u<e.length;u++)i=e.charAt(u),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,u,f){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=u)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=f))}}class lq{constructor(e,n,i,u){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=u,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new qk(this),this.idTokenSubscription=new qk(this),this.beforeStateQueue=new iq(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=r5,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=u.sdkClientVersion,this._persistenceManagerAvailable=new Promise(f=>this._resolvePersistenceManagerAvailable=f)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Lf(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await w_.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await nT(this,{idToken:e}),i=await uh._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(_c(this.app)){const f=this.app.settings.authIdToken;return f?new Promise(g=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(f).then(g,g))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,u=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const f=this.redirectUser?._redirectEventId,g=i?._redirectEventId,b=await this.tryRedirectSignIn(e);(!f||f===g)&&b?.user&&(i=b.user,u=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(u)try{await this.beforeStateQueue.runMiddleware(i)}catch(f){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(f))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return pr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await rT(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=F2()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(_c(this.app))return Promise.reject(zf(this));const n=e?wo(e):null;return n&&pr(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&pr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return _c(this.app)?Promise.reject(zf(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return _c(this.app)?Promise.reject(zf(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Lf(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await sq(this),n=new aq(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Jx("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await tq(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Lf(e)||this._popupRedirectResolver;pr(n,this,"argument-error"),this.redirectPersistenceManager=await w_.create(this,[Lf(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,u){if(this._deleted)return()=>{};const f=typeof n=="function"?n:n.next.bind(n);let g=!1;const b=this._isInitialized?Promise.resolve():this._initializationPromise;if(pr(b,this,"internal-error"),b.then(()=>{g||f(this.currentUser)}),typeof n=="function"){const o=e.addObserver(n,i,u);return()=>{g=!0,o()}}else{const o=e.addObserver(n);return()=>{g=!0,o()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return pr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_5(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(_c(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&B2(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Gg(t){return wo(t)}class qk{constructor(e){this.auth=e,this.observer=null,this.addObserver=T9(n=>this.observer=n)}get next(){return pr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let VT={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function cq(t){VT=t}function v5(t){return VT.loadJS(t)}function uq(){return VT.recaptchaEnterpriseScript}function hq(){return VT.gapiScript}function dq(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class fq{constructor(){this.enterprise=new pq}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class pq{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const mq="recaptcha-enterprise",x5="NO_RECAPTCHA";class gq{constructor(e){this.type=mq,this.auth=Gg(e)}async verify(e="verify",n=!1){async function i(f){if(!n){if(f.tenantId==null&&f._agentRecaptchaConfig!=null)return f._agentRecaptchaConfig.siteKey;if(f.tenantId!=null&&f._tenantRecaptchaConfigs[f.tenantId]!==void 0)return f._tenantRecaptchaConfigs[f.tenantId].siteKey}return new Promise(async(g,b)=>{W2(f,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(o=>{if(o.recaptchaKey===void 0)b(new Error("recaptcha Enterprise site key undefined"));else{const S=new H2(o);return f.tenantId==null?f._agentRecaptchaConfig=S:f._tenantRecaptchaConfigs[f.tenantId]=S,g(S.siteKey)}}).catch(o=>{b(o)})})}function u(f,g,b){const o=window.grecaptcha;Vk(o)?o.enterprise.ready(()=>{o.enterprise.execute(f,{action:e}).then(S=>{g(S)}).catch(()=>{g(x5)})}):b(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new fq().execute("siteKey",{action:"verify"}):new Promise((f,g)=>{i(this.auth).then(b=>{if(!n&&Vk(window.grecaptcha))u(b,f,g);else{if(typeof window>"u"){g(new Error("RecaptchaVerifier is only supported in browser"));return}let o=uq();o.length!==0&&(o+=b),v5(o).then(()=>{u(b,f,g)}).catch(S=>{g(S)})}}).catch(b=>{g(b)})})}}async function Gk(t,e,n,i=!1,u=!1){const f=new gq(t);let g;if(u)g=x5;else try{g=await f.verify(n)}catch{g=await f.verify(n,!0)}const b={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in b){const o=b.phoneEnrollmentInfo.phoneNumber,S=b.phoneEnrollmentInfo.recaptchaToken;Object.assign(b,{phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:S,captchaResponse:g,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in b){const o=b.phoneSignInInfo.recaptchaToken;Object.assign(b,{phoneSignInInfo:{recaptchaToken:o,captchaResponse:g,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return b}return i?Object.assign(b,{captchaResp:g}):Object.assign(b,{captchaResponse:g}),Object.assign(b,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(b,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),b}async function jC(t,e,n,i,u){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const f=await Gk(t,e,n,n==="getOobCode");return i(t,f)}else return i(t,e).catch(async f=>{if(f.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const g=await Gk(t,e,n,n==="getOobCode");return i(t,g)}else return Promise.reject(f)})}function yq(t,e){const n=NT(t,"auth");if(n.isInitialized()){const u=n.getImmediate(),f=n.getOptions();if(Lg(f,e??{}))return u;dh(u,"already-initialized")}return n.initialize({options:e})}function _q(t,e){const n=e?.persistence||[],i=(Array.isArray(n)?n:[n]).map(Lf);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,e?.popupRedirectResolver)}function vq(t,e,n){const i=Gg(t);pr(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const u=!1,f=b5(e),{host:g,port:b}=xq(e),o=b===null?"":`:${b}`,S={url:`${f}//${g}${o}/`},M=Object.freeze({host:g,port:b,protocol:f.replace(":",""),options:Object.freeze({disableWarnings:u})});if(!i._canInitEmulator){pr(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),pr(Lg(S,i.config.emulator)&&Lg(M,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=S,i.emulatorConfig=M,i.settings.appVerificationDisabledForTesting=!0,xm(g)?(CI(`${f}//${g}${o}`),AI("Auth",!0)):bq()}function b5(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function xq(t){const e=b5(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",u=/^(\[[^\]]+\])(:|$)/.exec(i);if(u){const f=u[1];return{host:f,port:Hk(i.substr(f.length+1))}}else{const[f,g]=i.split(":");return{host:f,port:Hk(g)}}}function Hk(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function bq(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class OI{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Df("not implemented")}_getIdTokenResponse(e){return Df("not implemented")}_linkToIdToken(e,n){return Df("not implemented")}_getReauthenticationResolver(e){return Df("not implemented")}}async function wq(t,e){return wm(t,"POST","/v1/accounts:signUp",e)}async function Tq(t,e){return nb(t,"POST","/v1/accounts:signInWithPassword",bm(t,e))}async function Eq(t,e){return nb(t,"POST","/v1/accounts:signInWithEmailLink",bm(t,e))}async function Sq(t,e){return nb(t,"POST","/v1/accounts:signInWithEmailLink",bm(t,e))}class Px extends OI{constructor(e,n,i,u=null){super("password",i),this._email=e,this._password=n,this._tenantId=u}static _fromEmailAndPassword(e,n){return new Px(e,n,"password")}static _fromEmailAndCode(e,n,i=null){return new Px(e,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return jC(e,n,"signInWithPassword",Tq);case"emailLink":return Eq(e,{email:this._email,oobCode:this._password});default:dh(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const i={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return jC(e,i,"signUpPassword",wq);case"emailLink":return Sq(e,{idToken:n,email:this._email,oobCode:this._password});default:dh(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function T_(t,e){return nb(t,"POST","/v1/accounts:signInWithIdp",bm(t,e))}const Cq="http://localhost";class zg extends OI{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new zg(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):dh("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:u,...f}=n;if(!i||!u)return null;const g=new zg(i,u);return g.idToken=f.idToken||void 0,g.accessToken=f.accessToken||void 0,g.secret=f.secret,g.nonce=f.nonce,g.pendingToken=f.pendingToken||null,g}_getIdTokenResponse(e){const n=this.buildRequest();return T_(e,n)}_linkToIdToken(e,n){const i=this.buildRequest();return i.idToken=n,T_(e,i)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,T_(e,n)}buildRequest(){const e={requestUri:Cq,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=eb(n)}return e}}function Aq(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Iq(t){const e=W0(X0(t)).link,n=e?W0(X0(e)).deep_link_id:null,i=W0(X0(t)).deep_link_id;return(i?W0(X0(i)).link:null)||i||n||e||t}class zI{constructor(e){const n=W0(X0(e)),i=n.apiKey??null,u=n.oobCode??null,f=Aq(n.mode??null);pr(i&&u&&f,"argument-error"),this.apiKey=i,this.operation=f,this.code=u,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=Iq(e);try{return new zI(n)}catch{return null}}}class J_{constructor(){this.providerId=J_.PROVIDER_ID}static credential(e,n){return Px._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const i=zI.parseLink(n);return pr(i,"argument-error"),Px._fromEmailAndCode(e,i.code,i.tenantId)}}J_.PROVIDER_ID="password";J_.EMAIL_PASSWORD_SIGN_IN_METHOD="password";J_.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class w5{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class rb extends w5{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Xp extends rb{constructor(){super("facebook.com")}static credential(e){return zg._fromParams({providerId:Xp.PROVIDER_ID,signInMethod:Xp.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xp.credentialFromTaggedObject(e)}static credentialFromError(e){return Xp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xp.credential(e.oauthAccessToken)}catch{return null}}}Xp.FACEBOOK_SIGN_IN_METHOD="facebook.com";Xp.PROVIDER_ID="facebook.com";class Zp extends rb{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return zg._fromParams({providerId:Zp.PROVIDER_ID,signInMethod:Zp.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Zp.credentialFromTaggedObject(e)}static credentialFromError(e){return Zp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return Zp.credential(n,i)}catch{return null}}}Zp.GOOGLE_SIGN_IN_METHOD="google.com";Zp.PROVIDER_ID="google.com";class Kp extends rb{constructor(){super("github.com")}static credential(e){return zg._fromParams({providerId:Kp.PROVIDER_ID,signInMethod:Kp.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Kp.credentialFromTaggedObject(e)}static credentialFromError(e){return Kp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Kp.credential(e.oauthAccessToken)}catch{return null}}}Kp.GITHUB_SIGN_IN_METHOD="github.com";Kp.PROVIDER_ID="github.com";class Yp extends rb{constructor(){super("twitter.com")}static credential(e,n){return zg._fromParams({providerId:Yp.PROVIDER_ID,signInMethod:Yp.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Yp.credentialFromTaggedObject(e)}static credentialFromError(e){return Yp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return Yp.credential(n,i)}catch{return null}}}Yp.TWITTER_SIGN_IN_METHOD="twitter.com";Yp.PROVIDER_ID="twitter.com";async function Rq(t,e){return nb(t,"POST","/v1/accounts:signUp",bm(t,e))}class Bg{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,u=!1){const f=await uh._fromIdTokenResponse(e,i,u),g=Wk(i);return new Bg({user:f,providerId:g,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);const u=Wk(i);return new Bg({user:e,providerId:u,_tokenResponse:i,operationType:n})}}function Wk(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class iT extends xu{constructor(e,n,i,u){super(n.code,n.message),this.operationType=i,this.user=u,Object.setPrototypeOf(this,iT.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,u){return new iT(e,n,i,u)}}function T5(t,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(f=>{throw f.code==="auth/multi-factor-auth-required"?iT._fromErrorAndOperation(t,f,e,i):f})}async function Mq(t,e,n=!1){const i=await Mx(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Bg._forOperation(t,"link",i)}async function Pq(t,e,n=!1){const{auth:i}=t;if(_c(i.app))return Promise.reject(zf(i));const u="reauthenticate";try{const f=await Mx(t,T5(i,u,e,t),n);pr(f.idToken,i,"internal-error");const g=DI(f.idToken);pr(g,i,"internal-error");const{sub:b}=g;return pr(t.uid===b,i,"user-mismatch"),Bg._forOperation(t,u,f)}catch(f){throw f?.code==="auth/user-not-found"&&dh(i,"user-mismatch"),f}}async function E5(t,e,n=!1){if(_c(t.app))return Promise.reject(zf(t));const i="signIn",u=await T5(t,i,e),f=await Bg._fromIdTokenResponse(t,i,u);return n||await t._updateCurrentUser(f.user),f}async function kq(t,e){return E5(Gg(t),e)}async function S5(t){const e=Gg(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Dq(t,e,n){if(_c(t.app))return Promise.reject(zf(t));const i=Gg(t),g=await jC(i,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Rq).catch(o=>{throw o.code==="auth/password-does-not-meet-requirements"&&S5(t),o}),b=await Bg._fromIdTokenResponse(i,"signIn",g);return await i._updateCurrentUser(b.user),b}function Lq(t,e,n){return _c(t.app)?Promise.reject(zf(t)):kq(wo(t),J_.credential(e,n)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&S5(t),i})}function Oq(t,e){return wo(t).setPersistence(e)}function zq(t,e,n,i){return wo(t).onIdTokenChanged(e,n,i)}function Bq(t,e,n){return wo(t).beforeAuthStateChanged(e,n)}function Nq(t,e,n,i){return wo(t).onAuthStateChanged(e,n,i)}function Vq(t){return wo(t).signOut()}const sT="__sak";class C5{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(sT,"1"),this.storage.removeItem(sT),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Fq=1e3,Uq=10;class A5 extends C5{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=y5(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),u=this.localCache[n];i!==u&&e(n,u,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((g,b,o)=>{this.notifyListeners(g,o)});return}const i=e.key;n?this.detachListener():this.stopPolling();const u=()=>{const g=this.storage.getItem(i);!n&&this.localCache[i]===g||this.notifyListeners(i,g)},f=this.storage.getItem(i);rq()&&f!==e.newValue&&e.newValue!==e.oldValue?setTimeout(u,Uq):u()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const u of Array.from(i))u(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},Fq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}A5.type="LOCAL";const I5=A5;class R5 extends C5{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}R5.type="SESSION";const M5=R5;function jq(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class FT{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(u=>u.isListeningto(e));if(n)return n;const i=new FT(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:i,eventType:u,data:f}=n.data,g=this.handlersMap[u];if(!g?.size)return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:u});const b=Array.from(g).map(async S=>S(n.origin,f)),o=await jq(b);n.ports[0].postMessage({status:"done",eventId:i,eventType:u,response:o})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}FT.receivers=[];function BI(t="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return t+n}class $q{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){const u=typeof MessageChannel<"u"?new MessageChannel:null;if(!u)throw new Error("connection_unavailable");let f,g;return new Promise((b,o)=>{const S=BI("",20);u.port1.start();const M=setTimeout(()=>{o(new Error("unsupported_event"))},i);g={messageChannel:u,onMessage(O){const N=O;if(N.data.eventId===S)switch(N.data.status){case"ack":clearTimeout(M),f=setTimeout(()=>{o(new Error("timeout"))},3e3);break;case"done":clearTimeout(f),b(N.data.response);break;default:clearTimeout(M),clearTimeout(f),o(new Error("invalid_response"));break}}},this.handlers.add(g),u.port1.addEventListener("message",g.onMessage),this.target.postMessage({eventType:e,eventId:S,data:n},[u.port2])}).finally(()=>{g&&this.removeMessageHandler(g)})}}function Td(){return window}function qq(t){Td().location.href=t}function P5(){return typeof Td().WorkerGlobalScope<"u"&&typeof Td().importScripts=="function"}async function Gq(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Hq(){return navigator?.serviceWorker?.controller||null}function Wq(){return P5()?self:null}const k5="firebaseLocalStorageDb",Xq=1,oT="firebaseLocalStorage",D5="fbase_key";class ib{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function UT(t,e){return t.transaction([oT],e?"readwrite":"readonly").objectStore(oT)}function Zq(){const t=indexedDB.deleteDatabase(k5);return new ib(t).toPromise()}function $C(){const t=indexedDB.open(k5,Xq);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const i=t.result;try{i.createObjectStore(oT,{keyPath:D5})}catch(u){n(u)}}),t.addEventListener("success",async()=>{const i=t.result;i.objectStoreNames.contains(oT)?e(i):(i.close(),await Zq(),e(await $C()))})})}async function Xk(t,e,n){const i=UT(t,!0).put({[D5]:e,value:n});return new ib(i).toPromise()}async function Kq(t,e){const n=UT(t,!1).get(e),i=await new ib(n).toPromise();return i===void 0?null:i.value}function Zk(t,e){const n=UT(t,!0).delete(e);return new ib(n).toPromise()}const Yq=800,Qq=3;class L5{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await $C(),this.db)}async _withRetries(e){let n=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(n++>Qq)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return P5()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=FT._getInstance(Wq()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Gq(),!this.activeServiceWorker)return;this.sender=new $q(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Hq()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await $C();return await Xk(e,sT,"1"),await Zk(e,sT),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>Xk(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(i=>Kq(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Zk(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(u=>{const f=UT(u,!1).getAll();return new ib(f).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(e.length!==0)for(const{fbase_key:u,value:f}of e)i.add(u),JSON.stringify(this.localCache[u])!==JSON.stringify(f)&&(this.notifyListeners(u,f),n.push(u));for(const u of Object.keys(this.localCache))this.localCache[u]&&!i.has(u)&&(this.notifyListeners(u,null),n.push(u));return n}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const u of Array.from(i))u(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Yq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}L5.type="LOCAL";const Jq=L5;new tb(3e4,6e4);function e7(t,e){return e?Lf(e):(pr(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class NI extends OI{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return T_(e,this._buildIdpRequest())}_linkToIdToken(e,n){return T_(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return T_(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function t7(t){return E5(t.auth,new NI(t),t.bypassAuthState)}function n7(t){const{auth:e,user:n}=t;return pr(n,e,"internal-error"),Pq(n,new NI(t),t.bypassAuthState)}async function r7(t){const{auth:e,user:n}=t;return pr(n,e,"internal-error"),Mq(n,new NI(t),t.bypassAuthState)}class O5{constructor(e,n,i,u,f=!1){this.auth=e,this.resolver=i,this.user=u,this.bypassAuthState=f,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:i,postBody:u,tenantId:f,error:g,type:b}=e;if(g){this.reject(g);return}const o={auth:this.auth,requestUri:n,sessionId:i,tenantId:f||void 0,postBody:u||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(b)(o))}catch(S){this.reject(S)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return t7;case"linkViaPopup":case"linkViaRedirect":return r7;case"reauthViaPopup":case"reauthViaRedirect":return n7;default:dh(this.auth,"internal-error")}}resolve(e){jf(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){jf(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const i7=new tb(2e3,1e4);class y_ extends O5{constructor(e,n,i,u,f){super(e,n,u,f),this.provider=i,this.authWindow=null,this.pollId=null,y_.currentPopupAction&&y_.currentPopupAction.cancel(),y_.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return pr(e,this.auth,"internal-error"),e}async onExecution(){jf(this.filter.length===1,"Popup operations only handle one event");const e=BI();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(wd(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(wd(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,y_.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(wd(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,i7.get())};e()}}y_.currentPopupAction=null;const s7="pendingRedirect",Aw=new Map;class o7 extends O5{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=Aw.get(this.auth._key());if(!e){try{const i=await a7(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}Aw.set(this.auth._key(),e)}return this.bypassAuthState||Aw.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function a7(t,e){const n=u7(e),i=c7(t);if(!await i._isAvailable())return!1;const u=await i._get(n)==="true";return await i._remove(n),u}function l7(t,e){Aw.set(t._key(),e)}function c7(t){return Lf(t._redirectPersistence)}function u7(t){return Cw(s7,t.config.apiKey,t.name)}async function h7(t,e,n=!1){if(_c(t.app))return Promise.reject(zf(t));const i=Gg(t),u=e7(i,e),g=await new o7(i,u,n).execute();return g&&!n&&(delete g.user._redirectEventId,await i._persistUserIfCurrent(g.user),await i._setRedirectUser(null,e)),g}const d7=600*1e3;class f7{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!p7(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!z5(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";n.onError(wd(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=d7&&this.cachedEventUids.clear(),this.cachedEventUids.has(Kk(e))}saveEventToCache(e){this.cachedEventUids.add(Kk(e)),this.lastProcessedEventTime=Date.now()}}function Kk(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function z5({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function p7(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return z5(t);default:return!1}}async function m7(t,e={}){return wm(t,"GET","/v1/projects",e)}const g7=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,y7=/^https?/;async function _7(t){if(t.config.emulator)return;const{authorizedDomains:e}=await m7(t);for(const n of e)try{if(v7(n))return}catch{}dh(t,"unauthorized-domain")}function v7(t){const e=FC(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const g=new URL(t);return g.hostname===""&&i===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&g.hostname===i}if(!y7.test(n))return!1;if(g7.test(t))return i===t;const u=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+u+"|"+u+")$","i").test(i)}const x7=new tb(3e4,6e4);function Yk(){const t=Td().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function b7(t){return new Promise((e,n)=>{function i(){Yk(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Yk(),n(wd(t,"network-request-failed"))},timeout:x7.get()})}if(Td().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Td().gapi?.load)i();else{const u=dq("iframefcb");return Td()[u]=()=>{gapi.load?i():n(wd(t,"network-request-failed"))},v5(`${hq()}?onload=${u}`).catch(f=>n(f))}}).catch(e=>{throw Iw=null,e})}let Iw=null;function w7(t){return Iw=Iw||b7(t),Iw}const T7=new tb(5e3,15e3),E7="__/auth/iframe",S7="emulator/auth/iframe",C7={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},A7=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function I7(t){const e=t.config;pr(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?kI(e,S7):`https://${t.config.authDomain}/${E7}`,i={apiKey:e.apiKey,appName:t.name,v:qg},u=A7.get(t.config.apiHost);u&&(i.eid=u);const f=t._getFrameworks();return f.length&&(i.fw=f.join(",")),`${n}?${eb(i).slice(1)}`}async function R7(t){const e=await w7(t),n=Td().gapi;return pr(n,t,"internal-error"),e.open({where:document.body,url:I7(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:C7,dontclear:!0},i=>new Promise(async(u,f)=>{await i.restyle({setHideOnLeave:!1});const g=wd(t,"network-request-failed"),b=Td().setTimeout(()=>{f(g)},T7.get());function o(){Td().clearTimeout(b),u(i)}i.ping(o).then(o,()=>{f(g)})}))}const M7={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},P7=500,k7=600,D7="_blank",L7="http://localhost";class Qk{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function O7(t,e,n,i=P7,u=k7){const f=Math.max((window.screen.availHeight-u)/2,0).toString(),g=Math.max((window.screen.availWidth-i)/2,0).toString();let b="";const o={...M7,width:i.toString(),height:u.toString(),top:f,left:g},S=Ja().toLowerCase();n&&(b=d5(S)?D7:n),u5(S)&&(e=e||L7,o.scrollbars="yes");const M=Object.entries(o).reduce((N,[j,Z])=>`${N}${j}=${Z},`,"");if(nq(S)&&b!=="_self")return z7(e||"",b),new Qk(null);const O=window.open(e||"",b,M);pr(O,t,"popup-blocked");try{O.focus()}catch{}return new Qk(O)}function z7(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}const B7="__/auth/handler",N7="emulator/auth/handler",V7=encodeURIComponent("fac");async function Jk(t,e,n,i,u,f){pr(t.config.authDomain,t,"auth-domain-config-required"),pr(t.config.apiKey,t,"invalid-api-key");const g={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:qg,eventId:u};if(e instanceof w5){e.setDefaultLanguage(t.languageCode),g.providerId=e.providerId||"",w9(e.getCustomParameters())||(g.customParameters=JSON.stringify(e.getCustomParameters()));for(const[M,O]of Object.entries({}))g[M]=O}if(e instanceof rb){const M=e.getScopes().filter(O=>O!=="");M.length>0&&(g.scopes=M.join(","))}t.tenantId&&(g.tid=t.tenantId);const b=g;for(const M of Object.keys(b))b[M]===void 0&&delete b[M];const o=await t._getAppCheckToken(),S=o?`#${V7}=${encodeURIComponent(o)}`:"";return`${F7(t)}?${eb(b).slice(1)}${S}`}function F7({config:t}){return t.emulator?kI(t,N7):`https://${t.authDomain}/${B7}`}const LS="webStorageSupport";class U7{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=M5,this._completeRedirectFn=h7,this._overrideRedirectResult=l7}async _openPopup(e,n,i,u){jf(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const f=await Jk(e,n,i,FC(),u);return O7(e,f,BI())}async _openRedirect(e,n,i,u){await this._originValidation(e);const f=await Jk(e,n,i,FC(),u);return qq(f),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:u,promise:f}=this.eventManagers[n];return u?Promise.resolve(u):(jf(f,"If manager is not set, promise should be"),f)}const i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){const n=await R7(e),i=new f7(e);return n.register("authEvent",u=>(pr(u?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(u.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(LS,{type:LS},u=>{const f=u?.[0]?.[LS];f!==void 0&&n(!!f),dh(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=_7(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return y5()||h5()||LI()}}const j7=U7;var eD="@firebase/auth",tD="1.11.1";class $7{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){pr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function q7(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function G7(t){Og(new cm("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),u=e.getProvider("heartbeat"),f=e.getProvider("app-check-internal"),{apiKey:g,authDomain:b}=i.options;pr(g&&!g.includes(":"),"invalid-api-key",{appName:i.name});const o={apiKey:g,authDomain:b,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_5(t)},S=new lq(i,u,f,o);return _q(S,n),S},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),Og(new cm("auth-internal",e=>{const n=Gg(e.getProvider("auth").getImmediate());return(i=>new $7(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),bd(eD,tD,q7(t)),bd(eD,tD,"esm2020")}const H7=300,W7=Zz("authIdTokenMaxAge")||H7;let nD=null;const X7=t=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>W7)return;const u=n?.token;nD!==u&&(nD=u,await fetch(t,{method:u?"POST":"DELETE",headers:u?{Authorization:`Bearer ${u}`}:{}}))};function Z7(t=MI()){const e=NT(t,"auth");if(e.isInitialized())return e.getImmediate();const n=yq(t,{popupRedirectResolver:j7,persistence:[Jq,I5,M5]}),i=Zz("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const f=new URL(i,location.origin);if(location.origin===f.origin){const g=X7(f.toString());Bq(n,g,()=>g(n.currentUser)),zq(n,b=>g(b))}}const u=Hz("auth");return u&&vq(n,`http://${u}`),n}function K7(){return document.getElementsByTagName("head")?.[0]??document}cq({loadJS(t){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=u=>{const f=wd("internal-error");f.customData=u,n(f)},i.type="text/javascript",i.charset="UTF-8",K7().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});G7("Browser");var rD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var nm,B5;(function(){var t;function e(ae,re){function he(){}he.prototype=re.prototype,ae.F=re.prototype,ae.prototype=new he,ae.prototype.constructor=ae,ae.D=function(se,ve,Y){for(var le=Array(arguments.length-2),Ne=2;Ne<arguments.length;Ne++)le[Ne-2]=arguments[Ne];return re.prototype[ve].apply(se,le)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function u(ae,re,he){he||(he=0);const se=Array(16);if(typeof re=="string")for(var ve=0;ve<16;++ve)se[ve]=re.charCodeAt(he++)|re.charCodeAt(he++)<<8|re.charCodeAt(he++)<<16|re.charCodeAt(he++)<<24;else for(ve=0;ve<16;++ve)se[ve]=re[he++]|re[he++]<<8|re[he++]<<16|re[he++]<<24;re=ae.g[0],he=ae.g[1],ve=ae.g[2];let Y=ae.g[3],le;le=re+(Y^he&(ve^Y))+se[0]+3614090360&4294967295,re=he+(le<<7&4294967295|le>>>25),le=Y+(ve^re&(he^ve))+se[1]+3905402710&4294967295,Y=re+(le<<12&4294967295|le>>>20),le=ve+(he^Y&(re^he))+se[2]+606105819&4294967295,ve=Y+(le<<17&4294967295|le>>>15),le=he+(re^ve&(Y^re))+se[3]+3250441966&4294967295,he=ve+(le<<22&4294967295|le>>>10),le=re+(Y^he&(ve^Y))+se[4]+4118548399&4294967295,re=he+(le<<7&4294967295|le>>>25),le=Y+(ve^re&(he^ve))+se[5]+1200080426&4294967295,Y=re+(le<<12&4294967295|le>>>20),le=ve+(he^Y&(re^he))+se[6]+2821735955&4294967295,ve=Y+(le<<17&4294967295|le>>>15),le=he+(re^ve&(Y^re))+se[7]+4249261313&4294967295,he=ve+(le<<22&4294967295|le>>>10),le=re+(Y^he&(ve^Y))+se[8]+1770035416&4294967295,re=he+(le<<7&4294967295|le>>>25),le=Y+(ve^re&(he^ve))+se[9]+2336552879&4294967295,Y=re+(le<<12&4294967295|le>>>20),le=ve+(he^Y&(re^he))+se[10]+4294925233&4294967295,ve=Y+(le<<17&4294967295|le>>>15),le=he+(re^ve&(Y^re))+se[11]+2304563134&4294967295,he=ve+(le<<22&4294967295|le>>>10),le=re+(Y^he&(ve^Y))+se[12]+1804603682&4294967295,re=he+(le<<7&4294967295|le>>>25),le=Y+(ve^re&(he^ve))+se[13]+4254626195&4294967295,Y=re+(le<<12&4294967295|le>>>20),le=ve+(he^Y&(re^he))+se[14]+2792965006&4294967295,ve=Y+(le<<17&4294967295|le>>>15),le=he+(re^ve&(Y^re))+se[15]+1236535329&4294967295,he=ve+(le<<22&4294967295|le>>>10),le=re+(ve^Y&(he^ve))+se[1]+4129170786&4294967295,re=he+(le<<5&4294967295|le>>>27),le=Y+(he^ve&(re^he))+se[6]+3225465664&4294967295,Y=re+(le<<9&4294967295|le>>>23),le=ve+(re^he&(Y^re))+se[11]+643717713&4294967295,ve=Y+(le<<14&4294967295|le>>>18),le=he+(Y^re&(ve^Y))+se[0]+3921069994&4294967295,he=ve+(le<<20&4294967295|le>>>12),le=re+(ve^Y&(he^ve))+se[5]+3593408605&4294967295,re=he+(le<<5&4294967295|le>>>27),le=Y+(he^ve&(re^he))+se[10]+38016083&4294967295,Y=re+(le<<9&4294967295|le>>>23),le=ve+(re^he&(Y^re))+se[15]+3634488961&4294967295,ve=Y+(le<<14&4294967295|le>>>18),le=he+(Y^re&(ve^Y))+se[4]+3889429448&4294967295,he=ve+(le<<20&4294967295|le>>>12),le=re+(ve^Y&(he^ve))+se[9]+568446438&4294967295,re=he+(le<<5&4294967295|le>>>27),le=Y+(he^ve&(re^he))+se[14]+3275163606&4294967295,Y=re+(le<<9&4294967295|le>>>23),le=ve+(re^he&(Y^re))+se[3]+4107603335&4294967295,ve=Y+(le<<14&4294967295|le>>>18),le=he+(Y^re&(ve^Y))+se[8]+1163531501&4294967295,he=ve+(le<<20&4294967295|le>>>12),le=re+(ve^Y&(he^ve))+se[13]+2850285829&4294967295,re=he+(le<<5&4294967295|le>>>27),le=Y+(he^ve&(re^he))+se[2]+4243563512&4294967295,Y=re+(le<<9&4294967295|le>>>23),le=ve+(re^he&(Y^re))+se[7]+1735328473&4294967295,ve=Y+(le<<14&4294967295|le>>>18),le=he+(Y^re&(ve^Y))+se[12]+2368359562&4294967295,he=ve+(le<<20&4294967295|le>>>12),le=re+(he^ve^Y)+se[5]+4294588738&4294967295,re=he+(le<<4&4294967295|le>>>28),le=Y+(re^he^ve)+se[8]+2272392833&4294967295,Y=re+(le<<11&4294967295|le>>>21),le=ve+(Y^re^he)+se[11]+1839030562&4294967295,ve=Y+(le<<16&4294967295|le>>>16),le=he+(ve^Y^re)+se[14]+4259657740&4294967295,he=ve+(le<<23&4294967295|le>>>9),le=re+(he^ve^Y)+se[1]+2763975236&4294967295,re=he+(le<<4&4294967295|le>>>28),le=Y+(re^he^ve)+se[4]+1272893353&4294967295,Y=re+(le<<11&4294967295|le>>>21),le=ve+(Y^re^he)+se[7]+4139469664&4294967295,ve=Y+(le<<16&4294967295|le>>>16),le=he+(ve^Y^re)+se[10]+3200236656&4294967295,he=ve+(le<<23&4294967295|le>>>9),le=re+(he^ve^Y)+se[13]+681279174&4294967295,re=he+(le<<4&4294967295|le>>>28),le=Y+(re^he^ve)+se[0]+3936430074&4294967295,Y=re+(le<<11&4294967295|le>>>21),le=ve+(Y^re^he)+se[3]+3572445317&4294967295,ve=Y+(le<<16&4294967295|le>>>16),le=he+(ve^Y^re)+se[6]+76029189&4294967295,he=ve+(le<<23&4294967295|le>>>9),le=re+(he^ve^Y)+se[9]+3654602809&4294967295,re=he+(le<<4&4294967295|le>>>28),le=Y+(re^he^ve)+se[12]+3873151461&4294967295,Y=re+(le<<11&4294967295|le>>>21),le=ve+(Y^re^he)+se[15]+530742520&4294967295,ve=Y+(le<<16&4294967295|le>>>16),le=he+(ve^Y^re)+se[2]+3299628645&4294967295,he=ve+(le<<23&4294967295|le>>>9),le=re+(ve^(he|~Y))+se[0]+4096336452&4294967295,re=he+(le<<6&4294967295|le>>>26),le=Y+(he^(re|~ve))+se[7]+1126891415&4294967295,Y=re+(le<<10&4294967295|le>>>22),le=ve+(re^(Y|~he))+se[14]+2878612391&4294967295,ve=Y+(le<<15&4294967295|le>>>17),le=he+(Y^(ve|~re))+se[5]+4237533241&4294967295,he=ve+(le<<21&4294967295|le>>>11),le=re+(ve^(he|~Y))+se[12]+1700485571&4294967295,re=he+(le<<6&4294967295|le>>>26),le=Y+(he^(re|~ve))+se[3]+2399980690&4294967295,Y=re+(le<<10&4294967295|le>>>22),le=ve+(re^(Y|~he))+se[10]+4293915773&4294967295,ve=Y+(le<<15&4294967295|le>>>17),le=he+(Y^(ve|~re))+se[1]+2240044497&4294967295,he=ve+(le<<21&4294967295|le>>>11),le=re+(ve^(he|~Y))+se[8]+1873313359&4294967295,re=he+(le<<6&4294967295|le>>>26),le=Y+(he^(re|~ve))+se[15]+4264355552&4294967295,Y=re+(le<<10&4294967295|le>>>22),le=ve+(re^(Y|~he))+se[6]+2734768916&4294967295,ve=Y+(le<<15&4294967295|le>>>17),le=he+(Y^(ve|~re))+se[13]+1309151649&4294967295,he=ve+(le<<21&4294967295|le>>>11),le=re+(ve^(he|~Y))+se[4]+4149444226&4294967295,re=he+(le<<6&4294967295|le>>>26),le=Y+(he^(re|~ve))+se[11]+3174756917&4294967295,Y=re+(le<<10&4294967295|le>>>22),le=ve+(re^(Y|~he))+se[2]+718787259&4294967295,ve=Y+(le<<15&4294967295|le>>>17),le=he+(Y^(ve|~re))+se[9]+3951481745&4294967295,ae.g[0]=ae.g[0]+re&4294967295,ae.g[1]=ae.g[1]+(ve+(le<<21&4294967295|le>>>11))&4294967295,ae.g[2]=ae.g[2]+ve&4294967295,ae.g[3]=ae.g[3]+Y&4294967295}i.prototype.v=function(ae,re){re===void 0&&(re=ae.length);const he=re-this.blockSize,se=this.C;let ve=this.h,Y=0;for(;Y<re;){if(ve==0)for(;Y<=he;)u(this,ae,Y),Y+=this.blockSize;if(typeof ae=="string"){for(;Y<re;)if(se[ve++]=ae.charCodeAt(Y++),ve==this.blockSize){u(this,se),ve=0;break}}else for(;Y<re;)if(se[ve++]=ae[Y++],ve==this.blockSize){u(this,se),ve=0;break}}this.h=ve,this.o+=re},i.prototype.A=function(){var ae=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);ae[0]=128;for(var re=1;re<ae.length-8;++re)ae[re]=0;re=this.o*8;for(var he=ae.length-8;he<ae.length;++he)ae[he]=re&255,re/=256;for(this.v(ae),ae=Array(16),re=0,he=0;he<4;++he)for(let se=0;se<32;se+=8)ae[re++]=this.g[he]>>>se&255;return ae};function f(ae,re){var he=b;return Object.prototype.hasOwnProperty.call(he,ae)?he[ae]:he[ae]=re(ae)}function g(ae,re){this.h=re;const he=[];let se=!0;for(let ve=ae.length-1;ve>=0;ve--){const Y=ae[ve]|0;se&&Y==re||(he[ve]=Y,se=!1)}this.g=he}var b={};function o(ae){return-128<=ae&&ae<128?f(ae,function(re){return new g([re|0],re<0?-1:0)}):new g([ae|0],ae<0?-1:0)}function S(ae){if(isNaN(ae)||!isFinite(ae))return O;if(ae<0)return Q(S(-ae));const re=[];let he=1;for(let se=0;ae>=he;se++)re[se]=ae/he|0,he*=4294967296;return new g(re,0)}function M(ae,re){if(ae.length==0)throw Error("number format error: empty string");if(re=re||10,re<2||36<re)throw Error("radix out of range: "+re);if(ae.charAt(0)=="-")return Q(M(ae.substring(1),re));if(ae.indexOf("-")>=0)throw Error('number format error: interior "-" character');const he=S(Math.pow(re,8));let se=O;for(let Y=0;Y<ae.length;Y+=8){var ve=Math.min(8,ae.length-Y);const le=parseInt(ae.substring(Y,Y+ve),re);ve<8?(ve=S(Math.pow(re,ve)),se=se.j(ve).add(S(le))):(se=se.j(he),se=se.add(S(le)))}return se}var O=o(0),N=o(1),j=o(16777216);t=g.prototype,t.m=function(){if(K(this))return-Q(this).m();let ae=0,re=1;for(let he=0;he<this.g.length;he++){const se=this.i(he);ae+=(se>=0?se:4294967296+se)*re,re*=4294967296}return ae},t.toString=function(ae){if(ae=ae||10,ae<2||36<ae)throw Error("radix out of range: "+ae);if(Z(this))return"0";if(K(this))return"-"+Q(this).toString(ae);const re=S(Math.pow(ae,6));var he=this;let se="";for(;;){const ve=pe(he,re).g;he=ce(he,ve.j(re));let Y=((he.g.length>0?he.g[0]:he.h)>>>0).toString(ae);if(he=ve,Z(he))return Y+se;for(;Y.length<6;)Y="0"+Y;se=Y+se}},t.i=function(ae){return ae<0?0:ae<this.g.length?this.g[ae]:this.h};function Z(ae){if(ae.h!=0)return!1;for(let re=0;re<ae.g.length;re++)if(ae.g[re]!=0)return!1;return!0}function K(ae){return ae.h==-1}t.l=function(ae){return ae=ce(this,ae),K(ae)?-1:Z(ae)?0:1};function Q(ae){const re=ae.g.length,he=[];for(let se=0;se<re;se++)he[se]=~ae.g[se];return new g(he,~ae.h).add(N)}t.abs=function(){return K(this)?Q(this):this},t.add=function(ae){const re=Math.max(this.g.length,ae.g.length),he=[];let se=0;for(let ve=0;ve<=re;ve++){let Y=se+(this.i(ve)&65535)+(ae.i(ve)&65535),le=(Y>>>16)+(this.i(ve)>>>16)+(ae.i(ve)>>>16);se=le>>>16,Y&=65535,le&=65535,he[ve]=le<<16|Y}return new g(he,he[he.length-1]&-2147483648?-1:0)};function ce(ae,re){return ae.add(Q(re))}t.j=function(ae){if(Z(this)||Z(ae))return O;if(K(this))return K(ae)?Q(this).j(Q(ae)):Q(Q(this).j(ae));if(K(ae))return Q(this.j(Q(ae)));if(this.l(j)<0&&ae.l(j)<0)return S(this.m()*ae.m());const re=this.g.length+ae.g.length,he=[];for(var se=0;se<2*re;se++)he[se]=0;for(se=0;se<this.g.length;se++)for(let ve=0;ve<ae.g.length;ve++){const Y=this.i(se)>>>16,le=this.i(se)&65535,Ne=ae.i(ve)>>>16,Ze=ae.i(ve)&65535;he[2*se+2*ve]+=le*Ze,ge(he,2*se+2*ve),he[2*se+2*ve+1]+=Y*Ze,ge(he,2*se+2*ve+1),he[2*se+2*ve+1]+=le*Ne,ge(he,2*se+2*ve+1),he[2*se+2*ve+2]+=Y*Ne,ge(he,2*se+2*ve+2)}for(ae=0;ae<re;ae++)he[ae]=he[2*ae+1]<<16|he[2*ae];for(ae=re;ae<2*re;ae++)he[ae]=0;return new g(he,0)};function ge(ae,re){for(;(ae[re]&65535)!=ae[re];)ae[re+1]+=ae[re]>>>16,ae[re]&=65535,re++}function ue(ae,re){this.g=ae,this.h=re}function pe(ae,re){if(Z(re))throw Error("division by zero");if(Z(ae))return new ue(O,O);if(K(ae))return re=pe(Q(ae),re),new ue(Q(re.g),Q(re.h));if(K(re))return re=pe(ae,Q(re)),new ue(Q(re.g),re.h);if(ae.g.length>30){if(K(ae)||K(re))throw Error("slowDivide_ only works with positive integers.");for(var he=N,se=re;se.l(ae)<=0;)he=me(he),se=me(se);var ve=Te(he,1),Y=Te(se,1);for(se=Te(se,2),he=Te(he,2);!Z(se);){var le=Y.add(se);le.l(ae)<=0&&(ve=ve.add(he),Y=le),se=Te(se,1),he=Te(he,1)}return re=ce(ae,ve.j(re)),new ue(ve,re)}for(ve=O;ae.l(re)>=0;){for(he=Math.max(1,Math.floor(ae.m()/re.m())),se=Math.ceil(Math.log(he)/Math.LN2),se=se<=48?1:Math.pow(2,se-48),Y=S(he),le=Y.j(re);K(le)||le.l(ae)>0;)he-=se,Y=S(he),le=Y.j(re);Z(Y)&&(Y=N),ve=ve.add(Y),ae=ce(ae,le)}return new ue(ve,ae)}t.B=function(ae){return pe(this,ae).h},t.and=function(ae){const re=Math.max(this.g.length,ae.g.length),he=[];for(let se=0;se<re;se++)he[se]=this.i(se)&ae.i(se);return new g(he,this.h&ae.h)},t.or=function(ae){const re=Math.max(this.g.length,ae.g.length),he=[];for(let se=0;se<re;se++)he[se]=this.i(se)|ae.i(se);return new g(he,this.h|ae.h)},t.xor=function(ae){const re=Math.max(this.g.length,ae.g.length),he=[];for(let se=0;se<re;se++)he[se]=this.i(se)^ae.i(se);return new g(he,this.h^ae.h)};function me(ae){const re=ae.g.length+1,he=[];for(let se=0;se<re;se++)he[se]=ae.i(se)<<1|ae.i(se-1)>>>31;return new g(he,ae.h)}function Te(ae,re){const he=re>>5;re%=32;const se=ae.g.length-he,ve=[];for(let Y=0;Y<se;Y++)ve[Y]=re>0?ae.i(Y+he)>>>re|ae.i(Y+he+1)<<32-re:ae.i(Y+he);return new g(ve,ae.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,B5=i,g.prototype.add=g.prototype.add,g.prototype.multiply=g.prototype.j,g.prototype.modulo=g.prototype.B,g.prototype.compare=g.prototype.l,g.prototype.toNumber=g.prototype.m,g.prototype.toString=g.prototype.toString,g.prototype.getBits=g.prototype.i,g.fromNumber=S,g.fromString=M,nm=g}).apply(typeof rD<"u"?rD:typeof self<"u"?self:typeof window<"u"?window:{});var W1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var N5,Z0,V5,Rw,qC,F5,U5,j5;(function(){var t,e=Object.defineProperty;function n(R){R=[typeof globalThis=="object"&&globalThis,R,typeof window=="object"&&window,typeof self=="object"&&self,typeof W1=="object"&&W1];for(var H=0;H<R.length;++H){var ie=R[H];if(ie&&ie.Math==Math)return ie}throw Error("Cannot find global object")}var i=n(this);function u(R,H){if(H)e:{var ie=i;R=R.split(".");for(var Ae=0;Ae<R.length-1;Ae++){var ht=R[Ae];if(!(ht in ie))break e;ie=ie[ht]}R=R[R.length-1],Ae=ie[R],H=H(Ae),H!=Ae&&H!=null&&e(ie,R,{configurable:!0,writable:!0,value:H})}}u("Symbol.dispose",function(R){return R||Symbol("Symbol.dispose")}),u("Array.prototype.values",function(R){return R||function(){return this[Symbol.iterator]()}}),u("Object.entries",function(R){return R||function(H){var ie=[],Ae;for(Ae in H)Object.prototype.hasOwnProperty.call(H,Ae)&&ie.push([Ae,H[Ae]]);return ie}});var f=f||{},g=this||self;function b(R){var H=typeof R;return H=="object"&&R!=null||H=="function"}function o(R,H,ie){return R.call.apply(R.bind,arguments)}function S(R,H,ie){return S=o,S.apply(null,arguments)}function M(R,H){var ie=Array.prototype.slice.call(arguments,1);return function(){var Ae=ie.slice();return Ae.push.apply(Ae,arguments),R.apply(this,Ae)}}function O(R,H){function ie(){}ie.prototype=H.prototype,R.Z=H.prototype,R.prototype=new ie,R.prototype.constructor=R,R.Ob=function(Ae,ht,yt){for(var pn=Array(arguments.length-2),gr=2;gr<arguments.length;gr++)pn[gr-2]=arguments[gr];return H.prototype[ht].apply(Ae,pn)}}var N=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?R=>R&&AsyncContext.Snapshot.wrap(R):R=>R;function j(R){const H=R.length;if(H>0){const ie=Array(H);for(let Ae=0;Ae<H;Ae++)ie[Ae]=R[Ae];return ie}return[]}function Z(R,H){for(let Ae=1;Ae<arguments.length;Ae++){const ht=arguments[Ae];var ie=typeof ht;if(ie=ie!="object"?ie:ht?Array.isArray(ht)?"array":ie:"null",ie=="array"||ie=="object"&&typeof ht.length=="number"){ie=R.length||0;const yt=ht.length||0;R.length=ie+yt;for(let pn=0;pn<yt;pn++)R[ie+pn]=ht[pn]}else R.push(ht)}}class K{constructor(H,ie){this.i=H,this.j=ie,this.h=0,this.g=null}get(){let H;return this.h>0?(this.h--,H=this.g,this.g=H.next,H.next=null):H=this.i(),H}}function Q(R){g.setTimeout(()=>{throw R},0)}function ce(){var R=ae;let H=null;return R.g&&(H=R.g,R.g=R.g.next,R.g||(R.h=null),H.next=null),H}class ge{constructor(){this.h=this.g=null}add(H,ie){const Ae=ue.get();Ae.set(H,ie),this.h?this.h.next=Ae:this.g=Ae,this.h=Ae}}var ue=new K(()=>new pe,R=>R.reset());class pe{constructor(){this.next=this.g=this.h=null}set(H,ie){this.h=H,this.g=ie,this.next=null}reset(){this.next=this.g=this.h=null}}let me,Te=!1,ae=new ge,re=()=>{const R=Promise.resolve(void 0);me=()=>{R.then(he)}};function he(){for(var R;R=ce();){try{R.h.call(R.g)}catch(ie){Q(ie)}var H=ue;H.j(R),H.h<100&&(H.h++,R.next=H.g,H.g=R)}Te=!1}function se(){this.u=this.u,this.C=this.C}se.prototype.u=!1,se.prototype.dispose=function(){this.u||(this.u=!0,this.N())},se.prototype[Symbol.dispose]=function(){this.dispose()},se.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ve(R,H){this.type=R,this.g=this.target=H,this.defaultPrevented=!1}ve.prototype.h=function(){this.defaultPrevented=!0};var Y=(function(){if(!g.addEventListener||!Object.defineProperty)return!1;var R=!1,H=Object.defineProperty({},"passive",{get:function(){R=!0}});try{const ie=()=>{};g.addEventListener("test",ie,H),g.removeEventListener("test",ie,H)}catch{}return R})();function le(R){return/^[\s\xa0]*$/.test(R)}function Ne(R,H){ve.call(this,R?R.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,R&&this.init(R,H)}O(Ne,ve),Ne.prototype.init=function(R,H){const ie=this.type=R.type,Ae=R.changedTouches&&R.changedTouches.length?R.changedTouches[0]:null;this.target=R.target||R.srcElement,this.g=H,H=R.relatedTarget,H||(ie=="mouseover"?H=R.fromElement:ie=="mouseout"&&(H=R.toElement)),this.relatedTarget=H,Ae?(this.clientX=Ae.clientX!==void 0?Ae.clientX:Ae.pageX,this.clientY=Ae.clientY!==void 0?Ae.clientY:Ae.pageY,this.screenX=Ae.screenX||0,this.screenY=Ae.screenY||0):(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0),this.button=R.button,this.key=R.key||"",this.ctrlKey=R.ctrlKey,this.altKey=R.altKey,this.shiftKey=R.shiftKey,this.metaKey=R.metaKey,this.pointerId=R.pointerId||0,this.pointerType=R.pointerType,this.state=R.state,this.i=R,R.defaultPrevented&&Ne.Z.h.call(this)},Ne.prototype.h=function(){Ne.Z.h.call(this);const R=this.i;R.preventDefault?R.preventDefault():R.returnValue=!1};var Ze="closure_listenable_"+(Math.random()*1e6|0),Ie=0;function Je(R,H,ie,Ae,ht){this.listener=R,this.proxy=null,this.src=H,this.type=ie,this.capture=!!Ae,this.ha=ht,this.key=++Ie,this.da=this.fa=!1}function dt(R){R.da=!0,R.listener=null,R.proxy=null,R.src=null,R.ha=null}function et(R,H,ie){for(const Ae in R)H.call(ie,R[Ae],Ae,R)}function Kt(R,H){for(const ie in R)H.call(void 0,R[ie],ie,R)}function De(R){const H={};for(const ie in R)H[ie]=R[ie];return H}const tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Et(R,H){let ie,Ae;for(let ht=1;ht<arguments.length;ht++){Ae=arguments[ht];for(ie in Ae)R[ie]=Ae[ie];for(let yt=0;yt<tt.length;yt++)ie=tt[yt],Object.prototype.hasOwnProperty.call(Ae,ie)&&(R[ie]=Ae[ie])}}function wt(R){this.src=R,this.g={},this.h=0}wt.prototype.add=function(R,H,ie,Ae,ht){const yt=R.toString();R=this.g[yt],R||(R=this.g[yt]=[],this.h++);const pn=Ut(R,H,Ae,ht);return pn>-1?(H=R[pn],ie||(H.fa=!1)):(H=new Je(H,this.src,yt,!!Ae,ht),H.fa=ie,R.push(H)),H};function Lt(R,H){const ie=H.type;if(ie in R.g){var Ae=R.g[ie],ht=Array.prototype.indexOf.call(Ae,H,void 0),yt;(yt=ht>=0)&&Array.prototype.splice.call(Ae,ht,1),yt&&(dt(H),R.g[ie].length==0&&(delete R.g[ie],R.h--))}}function Ut(R,H,ie,Ae){for(let ht=0;ht<R.length;++ht){const yt=R[ht];if(!yt.da&&yt.listener==H&&yt.capture==!!ie&&yt.ha==Ae)return ht}return-1}var an="closure_lm_"+(Math.random()*1e6|0),At={};function Qt(R,H,ie,Ae,ht){if(Array.isArray(H)){for(let yt=0;yt<H.length;yt++)Qt(R,H[yt],ie,Ae,ht);return null}return ie=rr(ie),R&&R[Ze]?R.J(H,ie,b(Ae)?!!Ae.capture:!1,ht):Wt(R,H,ie,!1,Ae,ht)}function Wt(R,H,ie,Ae,ht,yt){if(!H)throw Error("Invalid event type");const pn=b(ht)?!!ht.capture:!!ht;let gr=Rn(R);if(gr||(R[an]=gr=new wt(R)),ie=gr.add(H,ie,Ae,pn,yt),ie.proxy)return ie;if(Ae=vn(),ie.proxy=Ae,Ae.src=R,Ae.listener=ie,R.addEventListener)Y||(ht=pn),ht===void 0&&(ht=!1),R.addEventListener(H.toString(),Ae,ht);else if(R.attachEvent)R.attachEvent(ln(H.toString()),Ae);else if(R.addListener&&R.removeListener)R.addListener(Ae);else throw Error("addEventListener and attachEvent are unavailable.");return ie}function vn(){function R(ie){return H.call(R.src,R.listener,ie)}const H=qn;return R}function Gt(R,H,ie,Ae,ht){if(Array.isArray(H))for(var yt=0;yt<H.length;yt++)Gt(R,H[yt],ie,Ae,ht);else Ae=b(Ae)?!!Ae.capture:!!Ae,ie=rr(ie),R&&R[Ze]?(R=R.i,yt=String(H).toString(),yt in R.g&&(H=R.g[yt],ie=Ut(H,ie,Ae,ht),ie>-1&&(dt(H[ie]),Array.prototype.splice.call(H,ie,1),H.length==0&&(delete R.g[yt],R.h--)))):R&&(R=Rn(R))&&(H=R.g[H.toString()],R=-1,H&&(R=Ut(H,ie,Ae,ht)),(ie=R>-1?H[R]:null)&&Cn(ie))}function Cn(R){if(typeof R!="number"&&R&&!R.da){var H=R.src;if(H&&H[Ze])Lt(H.i,R);else{var ie=R.type,Ae=R.proxy;H.removeEventListener?H.removeEventListener(ie,Ae,R.capture):H.detachEvent?H.detachEvent(ln(ie),Ae):H.addListener&&H.removeListener&&H.removeListener(Ae),(ie=Rn(H))?(Lt(ie,R),ie.h==0&&(ie.src=null,H[an]=null)):dt(R)}}}function ln(R){return R in At?At[R]:At[R]="on"+R}function qn(R,H){if(R.da)R=!0;else{H=new Ne(H,this);const ie=R.listener,Ae=R.ha||R.src;R.fa&&Cn(R),R=ie.call(Ae,H)}return R}function Rn(R){return R=R[an],R instanceof wt?R:null}var An="__closure_events_fn_"+(Math.random()*1e9>>>0);function rr(R){return typeof R=="function"?R:(R[An]||(R[An]=function(H){return R.handleEvent(H)}),R[An])}function En(){se.call(this),this.i=new wt(this),this.M=this,this.G=null}O(En,se),En.prototype[Ze]=!0,En.prototype.removeEventListener=function(R,H,ie,Ae){Gt(this,R,H,ie,Ae)};function bn(R,H){var ie,Ae=R.G;if(Ae)for(ie=[];Ae;Ae=Ae.G)ie.push(Ae);if(R=R.M,Ae=H.type||H,typeof H=="string")H=new ve(H,R);else if(H instanceof ve)H.target=H.target||R;else{var ht=H;H=new ve(Ae,R),Et(H,ht)}ht=!0;let yt,pn;if(ie)for(pn=ie.length-1;pn>=0;pn--)yt=H.g=ie[pn],ht=zn(yt,Ae,!0,H)&&ht;if(yt=H.g=R,ht=zn(yt,Ae,!0,H)&&ht,ht=zn(yt,Ae,!1,H)&&ht,ie)for(pn=0;pn<ie.length;pn++)yt=H.g=ie[pn],ht=zn(yt,Ae,!1,H)&&ht}En.prototype.N=function(){if(En.Z.N.call(this),this.i){var R=this.i;for(const H in R.g){const ie=R.g[H];for(let Ae=0;Ae<ie.length;Ae++)dt(ie[Ae]);delete R.g[H],R.h--}}this.G=null},En.prototype.J=function(R,H,ie,Ae){return this.i.add(String(R),H,!1,ie,Ae)},En.prototype.K=function(R,H,ie,Ae){return this.i.add(String(R),H,!0,ie,Ae)};function zn(R,H,ie,Ae){if(H=R.i.g[String(H)],!H)return!0;H=H.concat();let ht=!0;for(let yt=0;yt<H.length;++yt){const pn=H[yt];if(pn&&!pn.da&&pn.capture==ie){const gr=pn.listener,Qi=pn.ha||pn.src;pn.fa&&Lt(R.i,pn),ht=gr.call(Qi,Ae)!==!1&&ht}}return ht&&!Ae.defaultPrevented}function mn(R,H){if(typeof R!="function")if(R&&typeof R.handleEvent=="function")R=S(R.handleEvent,R);else throw Error("Invalid listener argument");return Number(H)>2147483647?-1:g.setTimeout(R,H||0)}function ti(R){R.g=mn(()=>{R.g=null,R.i&&(R.i=!1,ti(R))},R.l);const H=R.h;R.h=null,R.m.apply(null,H)}class Xn extends se{constructor(H,ie){super(),this.m=H,this.l=ie,this.h=null,this.i=!1,this.g=null}j(H){this.h=arguments,this.g?this.i=!0:ti(this)}N(){super.N(),this.g&&(g.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function on(R){se.call(this),this.h=R,this.g={}}O(on,se);var Jt=[];function yn(R){et(R.g,function(H,ie){this.g.hasOwnProperty(ie)&&Cn(H)},R),R.g={}}on.prototype.N=function(){on.Z.N.call(this),yn(this)},on.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _n=g.JSON.stringify,In=g.JSON.parse,Bn=class{stringify(R){return g.JSON.stringify(R,void 0)}parse(R){return g.JSON.parse(R,void 0)}};function Nn(){}function Br(){}var tr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function _r(){ve.call(this,"d")}O(_r,ve);function xn(){ve.call(this,"c")}O(xn,ve);var $n={},jr=null;function Gi(){return jr=jr||new En}$n.Ia="serverreachability";function eo(R){ve.call(this,$n.Ia,R)}O(eo,ve);function Oe(R){const H=Gi();bn(H,new eo(H))}$n.STAT_EVENT="statevent";function fe(R,H){ve.call(this,$n.STAT_EVENT,R),this.stat=H}O(fe,ve);function de(R){const H=Gi();bn(H,new fe(H,R))}$n.Ja="timingevent";function Me(R,H){ve.call(this,$n.Ja,R),this.size=H}O(Me,ve);function Ve(R,H){if(typeof R!="function")throw Error("Fn must not be null and must be a function");return g.setTimeout(function(){R()},H)}function Ge(){this.g=!0}Ge.prototype.ua=function(){this.g=!1};function nt(R,H,ie,Ae,ht,yt){R.info(function(){if(R.g)if(yt){var pn="",gr=yt.split("&");for(let $r=0;$r<gr.length;$r++){var Qi=gr[$r].split("=");if(Qi.length>1){const Vi=Qi[0];Qi=Qi[1];const nr=Vi.split("_");pn=nr.length>=2&&nr[1]=="type"?pn+(Vi+"="+Qi+"&"):pn+(Vi+"=redacted&")}}}else pn=null;else pn=yt;return"XMLHTTP REQ ("+Ae+") [attempt "+ht+"]: "+H+`
`+ie+`
`+pn})}function Xe(R,H,ie,Ae,ht,yt,pn){R.info(function(){return"XMLHTTP RESP ("+Ae+") [ attempt "+ht+"]: "+H+`
`+ie+`
`+yt+" "+pn})}function $e(R,H,ie,Ae){R.info(function(){return"XMLHTTP TEXT ("+H+"): "+Xt(R,ie)+(Ae?" "+Ae:"")})}function ct(R,H){R.info(function(){return"TIMEOUT: "+H})}Ge.prototype.info=function(){};function Xt(R,H){if(!R.g)return H;if(!H)return null;try{const yt=JSON.parse(H);if(yt){for(R=0;R<yt.length;R++)if(Array.isArray(yt[R])){var ie=yt[R];if(!(ie.length<2)){var Ae=ie[1];if(Array.isArray(Ae)&&!(Ae.length<1)){var ht=Ae[0];if(ht!="noop"&&ht!="stop"&&ht!="close")for(let pn=1;pn<Ae.length;pn++)Ae[pn]=""}}}}return _n(yt)}catch{return H}}var en={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},jt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Kn;function Jn(){}O(Jn,Nn),Jn.prototype.g=function(){return new XMLHttpRequest},Kn=new Jn;function Hn(R){return encodeURIComponent(String(R))}function ir(R){var H=1;R=R.split(":");const ie=[];for(;H>0&&R.length;)ie.push(R.shift()),H--;return R.length&&ie.push(R.join(":")),ie}function er(R,H,ie,Ae){this.j=R,this.i=H,this.l=ie,this.S=Ae||1,this.V=new on(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Nr}function Nr(){this.i=null,this.g="",this.h=!1}var Cr={},Xr={};function mi(R,H,ie){R.M=1,R.A=Sa(Dr(H)),R.u=ie,R.R=!0,Eo(R,null)}function Eo(R,H){R.F=Date.now(),wl(R),R.B=Dr(R.A);var ie=R.B,Ae=R.S;Array.isArray(Ae)||(Ae=[String(Ae)]),Tl(ie.i,"t",Ae),R.C=0,ie=R.j.L,R.h=new Nr,R.g=wh(R.j,ie?H:null,!R.u),R.P>0&&(R.O=new Xn(S(R.Y,R,R.g),R.P)),H=R.V,ie=R.g,Ae=R.ba;var ht="readystatechange";Array.isArray(ht)||(ht&&(Jt[0]=ht.toString()),ht=Jt);for(let yt=0;yt<ht.length;yt++){const pn=Qt(ie,ht[yt],Ae||H.handleEvent,!1,H.h||H);if(!pn)break;H.g[pn.key]=pn}H=R.J?De(R.J):{},R.u?(R.v||(R.v="POST"),H["Content-Type"]="application/x-www-form-urlencoded",R.g.ea(R.B,R.v,R.u,H)):(R.v="GET",R.g.ea(R.B,R.v,null,H)),Oe(),nt(R.i,R.v,R.B,R.l,R.S,R.u)}er.prototype.ba=function(R){R=R.target;const H=this.O;H&&ia(R)==3?H.j():this.Y(R)},er.prototype.Y=function(R){try{if(R==this.g)e:{const gr=ia(this.g),Qi=this.g.ya(),$r=this.g.ca();if(!(gr<3)&&(gr!=3||this.g&&(this.h.h||this.g.la()||Wi(this.g)))){this.K||gr!=4||Qi==7||(Qi==8||$r<=0?Oe(3):Oe(2)),vr(this);var H=this.g.ca();this.X=H;var ie=gs(this);if(this.o=H==200,Xe(this.i,this.v,this.B,this.l,this.S,gr,H),this.o){if(this.U&&!this.L){t:{if(this.g){var Ae,ht=this.g;if((Ae=ht.g?ht.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!le(Ae)){var yt=Ae;break t}}yt=null}if(R=yt)$e(this.i,this.l,R,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,wa(this,R);else{this.o=!1,this.m=3,de(12),$s(this),Uo(this);break e}}if(this.R){R=!0;let Vi;for(;!this.K&&this.C<ie.length;)if(Vi=Hl(this,ie),Vi==Xr){gr==4&&(this.m=4,de(14),R=!1),$e(this.i,this.l,null,"[Incomplete Response]");break}else if(Vi==Cr){this.m=4,de(15),$e(this.i,this.l,ie,"[Invalid Chunk]"),R=!1;break}else $e(this.i,this.l,Vi,null),wa(this,Vi);if(ks(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),gr!=4||ie.length!=0||this.h.h||(this.m=1,de(16),R=!1),this.o=this.o&&R,!R)$e(this.i,this.l,ie,"[Invalid Chunked Response]"),$s(this),Uo(this);else if(ie.length>0&&!this.W){this.W=!0;var pn=this.j;pn.g==this&&pn.aa&&!pn.P&&(pn.j.info("Great, no buffering proxy detected. Bytes received: "+ie.length),Yl(pn),pn.P=!0,de(11))}}else $e(this.i,this.l,ie,null),wa(this,ie);gr==4&&$s(this),this.o&&!this.K&&(gr==4?xh(this.j,this):(this.o=!1,wl(this)))}else to(this.g),H==400&&ie.indexOf("Unknown SID")>0?(this.m=3,de(12)):(this.m=0,de(13)),$s(this),Uo(this)}}}catch{}finally{}};function gs(R){if(!ks(R))return R.g.la();const H=Wi(R.g);if(H==="")return"";let ie="";const Ae=H.length,ht=ia(R.g)==4;if(!R.h.i){if(typeof TextDecoder>"u")return $s(R),Uo(R),"";R.h.i=new g.TextDecoder}for(let yt=0;yt<Ae;yt++)R.h.h=!0,ie+=R.h.i.decode(H[yt],{stream:!(ht&&yt==Ae-1)});return H.length=0,R.h.g+=ie,R.C=0,R.h.g}function ks(R){return R.g?R.v=="GET"&&R.M!=2&&R.j.Aa:!1}function Hl(R,H){var ie=R.C,Ae=H.indexOf(`
`,ie);return Ae==-1?Xr:(ie=Number(H.substring(ie,Ae)),isNaN(ie)?Cr:(Ae+=1,Ae+ie>H.length?Xr:(H=H.slice(Ae,Ae+ie),R.C=Ae+ie,H)))}er.prototype.cancel=function(){this.K=!0,$s(this)};function wl(R){R.T=Date.now()+R.H,wu(R,R.H)}function wu(R,H){if(R.D!=null)throw Error("WatchDog timer not null");R.D=Ve(S(R.aa,R),H)}function vr(R){R.D&&(g.clearTimeout(R.D),R.D=null)}er.prototype.aa=function(){this.D=null;const R=Date.now();R-this.T>=0?(ct(this.i,this.B),this.M!=2&&(Oe(),de(17)),$s(this),this.m=2,Uo(this)):wu(this,this.T-R)};function Uo(R){R.j.I==0||R.K||xh(R.j,R)}function $s(R){vr(R);var H=R.O;H&&typeof H.dispose=="function"&&H.dispose(),R.O=null,yn(R.V),R.g&&(H=R.g,R.g=null,H.abort(),H.dispose())}function wa(R,H){try{var ie=R.j;if(ie.I!=0&&(ie.g==R||Ea(ie.h,R))){if(!R.L&&Ea(ie.h,R)&&ie.I==3){try{var Ae=ie.Ba.g.parse(H)}catch{Ae=null}if(Array.isArray(Ae)&&Ae.length==3){var ht=Ae;if(ht[0]==0){e:if(!ie.v){if(ie.g)if(ie.g.F+3e3<R.F)Ql(ie),oa(ie);else break e;Ra(ie),de(18)}}else ie.xa=ht[1],0<ie.xa-ie.K&&ht[2]<37500&&ie.F&&ie.A==0&&!ie.C&&(ie.C=Ve(S(ie.Va,ie),6e3));Ta(ie.h)<=1&&ie.ta&&(ie.ta=void 0)}else Io(ie,11)}else if((R.L||ie.g==R)&&Ql(ie),!le(H))for(ht=ie.Ba.g.parse(H),H=0;H<ht.length;H++){let $r=ht[H];const Vi=$r[0];if(!(Vi<=ie.K))if(ie.K=Vi,$r=$r[1],ie.I==2)if($r[0]=="c"){ie.M=$r[1],ie.ba=$r[2];const nr=$r[3];nr!=null&&(ie.ka=nr,ie.j.info("VER="+ie.ka));const Ho=$r[4];Ho!=null&&(ie.za=Ho,ie.j.info("SVER="+ie.za));const Pa=$r[5];Pa!=null&&typeof Pa=="number"&&Pa>0&&(Ae=1.5*Pa,ie.O=Ae,ie.j.info("backChannelRequestTimeoutMs_="+Ae)),Ae=ie;const la=R.g;if(la){const kc=la.g?la.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(kc){var yt=Ae.h;yt.g||kc.indexOf("spdy")==-1&&kc.indexOf("quic")==-1&&kc.indexOf("h2")==-1||(yt.j=yt.l,yt.g=new Set,yt.h&&(tl(yt,yt.h),yt.h=null))}if(Ae.G){const ka=la.g?la.g.getResponseHeader("X-HTTP-Session-Id"):null;ka&&(Ae.wa=ka,ui(Ae.J,Ae.G,ka))}}ie.I=3,ie.l&&ie.l.ra(),ie.aa&&(ie.T=Date.now()-R.F,ie.j.info("Handshake RTT: "+ie.T+"ms")),Ae=ie;var pn=R;if(Ae.na=Zf(Ae,Ae.L?Ae.ba:null,Ae.W),pn.L){ta(Ae.h,pn);var gr=pn,Qi=Ae.O;Qi&&(gr.H=Qi),gr.D&&(vr(gr),wl(gr)),Ae.g=pn}else Cu(Ae);ie.i.length>0&&Ca(ie)}else $r[0]!="stop"&&$r[0]!="close"||Io(ie,7);else ie.I==3&&($r[0]=="stop"||$r[0]=="close"?$r[0]=="stop"?Io(ie,7):Su(ie):$r[0]!="noop"&&ie.l&&ie.l.qa($r),ie.A=0)}}Oe(4)}catch{}}var ts=class{constructor(R,H){this.g=R,this.map=H}};function jo(R){this.l=R||10,g.PerformanceNavigationTiming?(R=g.performance.getEntriesByType("navigation"),R=R.length>0&&(R[0].nextHopProtocol=="hq"||R[0].nextHopProtocol=="h2")):R=!!(g.chrome&&g.chrome.loadTimes&&g.chrome.loadTimes()&&g.chrome.loadTimes().wasFetchedViaSpdy),this.j=R?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ea(R){return R.h?!0:R.g?R.g.size>=R.j:!1}function Ta(R){return R.h?1:R.g?R.g.size:0}function Ea(R,H){return R.h?R.h==H:R.g?R.g.has(H):!1}function tl(R,H){R.g?R.g.add(H):R.h=H}function ta(R,H){R.h&&R.h==H?R.h=null:R.g&&R.g.has(H)&&R.g.delete(H)}jo.prototype.cancel=function(){if(this.i=Wl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const R of this.g.values())R.cancel();this.g.clear()}};function Wl(R){if(R.h!=null)return R.i.concat(R.h.G);if(R.g!=null&&R.g.size!==0){let H=R.i;for(const ie of R.g.values())H=H.concat(ie.G);return H}return j(R.i)}var vt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function $o(R,H){if(R){R=R.split("&");for(let ie=0;ie<R.length;ie++){const Ae=R[ie].indexOf("=");let ht,yt=null;Ae>=0?(ht=R[ie].substring(0,Ae),yt=R[ie].substring(Ae+1)):ht=R[ie],H(ht,yt?decodeURIComponent(yt.replace(/\+/g," ")):"")}}}function Zr(R){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let H;R instanceof Zr?(this.l=R.l,Es(this,R.j),this.o=R.o,this.g=R.g,qs(this,R.u),this.h=R.h,Tu(this,Ic(R.i)),this.m=R.m):R&&(H=String(R).match(vt))?(this.l=!1,Es(this,H[1]||"",!0),this.o=nn(H[2]||""),this.g=nn(H[3]||"",!0),qs(this,H[4]),this.h=nn(H[5]||"",!0),Tu(this,H[6]||"",!0),this.m=nn(H[7]||"")):(this.l=!1,this.i=new Go(null,this.l))}Zr.prototype.toString=function(){const R=[];var H=this.j;H&&R.push(sr(H,Ds,!0),":");var ie=this.g;return(ie||H=="file")&&(R.push("//"),(H=this.o)&&R.push(sr(H,Ds,!0),"@"),R.push(Hn(ie).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ie=this.u,ie!=null&&R.push(":",String(ie))),(ie=this.h)&&(this.g&&ie.charAt(0)!="/"&&R.push("/"),R.push(sr(ie,ie.charAt(0)=="/"?or:qo,!0))),(ie=this.i.toString())&&R.push("?",ie),(ie=this.m)&&R.push("#",sr(ie,Ac)),R.join("")},Zr.prototype.resolve=function(R){const H=Dr(this);let ie=!!R.j;ie?Es(H,R.j):ie=!!R.o,ie?H.o=R.o:ie=!!R.g,ie?H.g=R.g:ie=R.u!=null;var Ae=R.h;if(ie)qs(H,R.u);else if(ie=!!R.h){if(Ae.charAt(0)!="/")if(this.g&&!this.h)Ae="/"+Ae;else{var ht=H.h.lastIndexOf("/");ht!=-1&&(Ae=H.h.slice(0,ht+1)+Ae)}if(ht=Ae,ht==".."||ht==".")Ae="";else if(ht.indexOf("./")!=-1||ht.indexOf("/.")!=-1){Ae=ht.lastIndexOf("/",0)==0,ht=ht.split("/");const yt=[];for(let pn=0;pn<ht.length;){const gr=ht[pn++];gr=="."?Ae&&pn==ht.length&&yt.push(""):gr==".."?((yt.length>1||yt.length==1&&yt[0]!="")&&yt.pop(),Ae&&pn==ht.length&&yt.push("")):(yt.push(gr),Ae=!0)}Ae=yt.join("/")}else Ae=ht}return ie?H.h=Ae:ie=R.i.toString()!=="",ie?Tu(H,Ic(R.i)):ie=!!R.m,ie&&(H.m=R.m),H};function Dr(R){return new Zr(R)}function Es(R,H,ie){R.j=ie?nn(H,!0):H,R.j&&(R.j=R.j.replace(/:$/,""))}function qs(R,H){if(H){if(H=Number(H),isNaN(H)||H<0)throw Error("Bad port number "+H);R.u=H}else R.u=null}function Tu(R,H,ie){H instanceof Go?(R.i=H,Eu(R.i,R.l)):(ie||(H=sr(H,ys)),R.i=new Go(H,R.l))}function ui(R,H,ie){R.i.set(H,ie)}function Sa(R){return ui(R,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),R}function nn(R,H){return R?H?decodeURI(R.replace(/%25/g,"%2525")):decodeURIComponent(R):""}function sr(R,H,ie){return typeof R=="string"?(R=encodeURI(R).replace(H,Wn),ie&&(R=R.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),R):null}function Wn(R){return R=R.charCodeAt(0),"%"+(R>>4&15).toString(16)+(R&15).toString(16)}var Ds=/[#\/\?@]/g,qo=/[#\?:]/g,or=/[#\?]/g,ys=/[#\?@]/g,Ac=/#/g;function Go(R,H){this.h=this.g=null,this.i=R||null,this.j=!!H}function Hi(R){R.g||(R.g=new Map,R.h=0,R.i&&$o(R.i,function(H,ie){R.add(decodeURIComponent(H.replace(/\+/g," ")),ie)}))}t=Go.prototype,t.add=function(R,H){Hi(this),this.i=null,R=El(this,R);let ie=this.g.get(R);return ie||this.g.set(R,ie=[]),ie.push(H),this.h+=1,this};function gi(R,H){Hi(R),H=El(R,H),R.g.has(H)&&(R.i=null,R.h-=R.g.get(H).length,R.g.delete(H))}function vh(R,H){return Hi(R),H=El(R,H),R.g.has(H)}t.forEach=function(R,H){Hi(this),this.g.forEach(function(ie,Ae){ie.forEach(function(ht){R.call(H,ht,Ae,this)},this)},this)};function na(R,H){Hi(R);let ie=[];if(typeof H=="string")vh(R,H)&&(ie=ie.concat(R.g.get(El(R,H))));else for(R=Array.from(R.g.values()),H=0;H<R.length;H++)ie=ie.concat(R[H]);return ie}t.set=function(R,H){return Hi(this),this.i=null,R=El(this,R),vh(this,R)&&(this.h-=this.g.get(R).length),this.g.set(R,[H]),this.h+=1,this},t.get=function(R,H){return R?(R=na(this,R),R.length>0?String(R[0]):H):H};function Tl(R,H,ie){gi(R,H),ie.length>0&&(R.i=null,R.g.set(El(R,H),j(ie)),R.h+=ie.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const R=[],H=Array.from(this.g.keys());for(let Ae=0;Ae<H.length;Ae++){var ie=H[Ae];const ht=Hn(ie);ie=na(this,ie);for(let yt=0;yt<ie.length;yt++){let pn=ht;ie[yt]!==""&&(pn+="="+Hn(ie[yt])),R.push(pn)}}return this.i=R.join("&")};function Ic(R){const H=new Go;return H.i=R.i,R.g&&(H.g=new Map(R.g),H.h=R.h),H}function El(R,H){return H=String(H),R.j&&(H=H.toLowerCase()),H}function Eu(R,H){H&&!R.j&&(Hi(R),R.i=null,R.g.forEach(function(ie,Ae){const ht=Ae.toLowerCase();Ae!=ht&&(gi(this,Ae),Tl(this,ht,ie))},R)),R.j=H}function So(R,H){const ie=new Ge;if(g.Image){const Ae=new Image;Ae.onload=M(Co,ie,"TestLoadImage: loaded",!0,H,Ae),Ae.onerror=M(Co,ie,"TestLoadImage: error",!1,H,Ae),Ae.onabort=M(Co,ie,"TestLoadImage: abort",!1,H,Ae),Ae.ontimeout=M(Co,ie,"TestLoadImage: timeout",!1,H,Ae),g.setTimeout(function(){Ae.ontimeout&&Ae.ontimeout()},1e4),Ae.src=R}else H(!1)}function Xl(R,H){const ie=new Ge,Ae=new AbortController,ht=setTimeout(()=>{Ae.abort(),Co(ie,"TestPingServer: timeout",!1,H)},1e4);fetch(R,{signal:Ae.signal}).then(yt=>{clearTimeout(ht),yt.ok?Co(ie,"TestPingServer: ok",!0,H):Co(ie,"TestPingServer: server error",!1,H)}).catch(()=>{clearTimeout(ht),Co(ie,"TestPingServer: error",!1,H)})}function Co(R,H,ie,Ae,ht){try{ht&&(ht.onload=null,ht.onerror=null,ht.onabort=null,ht.ontimeout=null),Ae(ie)}catch{}}function ra(){this.g=new Bn}function ns(R){this.i=R.Sb||null,this.h=R.ab||!1}O(ns,Nn),ns.prototype.g=function(){return new Ti(this.i,this.h)};function Ti(R,H){En.call(this),this.H=R,this.o=H,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}O(Ti,En),t=Ti.prototype,t.open=function(R,H){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=R,this.D=H,this.readyState=1,Yi(this)},t.send=function(R){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const H={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};R&&(H.body=R),(this.H||g).fetch(new Request(this.D,H)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Sl(this)),this.readyState=0},t.Pa=function(R){if(this.g&&(this.l=R,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=R.headers,this.readyState=2,Yi(this)),this.g&&(this.readyState=3,Yi(this),this.g)))if(this.responseType==="arraybuffer")R.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof g.ReadableStream<"u"&&"body"in R){if(this.j=R.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Rc(this)}else R.text().then(this.Oa.bind(this),this.ga.bind(this))};function Rc(R){R.j.read().then(R.Ma.bind(R)).catch(R.ga.bind(R))}t.Ma=function(R){if(this.g){if(this.o&&R.value)this.response.push(R.value);else if(!this.o){var H=R.value?R.value:new Uint8Array(0);(H=this.B.decode(H,{stream:!R.done}))&&(this.response=this.responseText+=H)}R.done?Sl(this):Yi(this),this.readyState==3&&Rc(this)}},t.Oa=function(R){this.g&&(this.response=this.responseText=R,Sl(this))},t.Na=function(R){this.g&&(this.response=R,Sl(this))},t.ga=function(){this.g&&Sl(this)};function Sl(R){R.readyState=4,R.l=null,R.j=null,R.B=null,Yi(R)}t.setRequestHeader=function(R,H){this.A.append(R,H)},t.getResponseHeader=function(R){return this.h&&this.h.get(R.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const R=[],H=this.h.entries();for(var ie=H.next();!ie.done;)ie=ie.value,R.push(ie[0]+": "+ie[1]),ie=H.next();return R.join(`\r
`)};function Yi(R){R.onreadystatechange&&R.onreadystatechange.call(R)}Object.defineProperty(Ti.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(R){this.m=R?"include":"same-origin"}});function rs(R){let H="";return et(R,function(ie,Ae){H+=Ae,H+=":",H+=ie,H+=`\r
`}),H}function Mc(R,H,ie){e:{for(Ae in ie){var Ae=!1;break e}Ae=!0}Ae||(ie=rs(ie),typeof R=="string"?ie!=null&&Hn(ie):ui(R,H,ie))}function ni(R){En.call(this),this.headers=new Map,this.L=R||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}O(ni,En);var ri=/^https?$/i,Zl=["POST","PUT"];t=ni.prototype,t.Fa=function(R){this.H=R},t.ea=function(R,H,ie,Ae){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+R);H=H?H.toUpperCase():"GET",this.D=R,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Kn.g(),this.g.onreadystatechange=N(S(this.Ca,this));try{this.B=!0,this.g.open(H,String(R),!0),this.B=!1}catch(yt){Kl(this,yt);return}if(R=ie||"",ie=new Map(this.headers),Ae)if(Object.getPrototypeOf(Ae)===Object.prototype)for(var ht in Ae)ie.set(ht,Ae[ht]);else if(typeof Ae.keys=="function"&&typeof Ae.get=="function")for(const yt of Ae.keys())ie.set(yt,Ae.get(yt));else throw Error("Unknown input type for opt_headers: "+String(Ae));Ae=Array.from(ie.keys()).find(yt=>yt.toLowerCase()=="content-type"),ht=g.FormData&&R instanceof g.FormData,!(Array.prototype.indexOf.call(Zl,H,void 0)>=0)||Ae||ht||ie.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[yt,pn]of ie)this.g.setRequestHeader(yt,pn);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(R),this.v=!1}catch(yt){Kl(this,yt)}};function Kl(R,H){R.h=!1,R.g&&(R.j=!0,R.g.abort(),R.j=!1),R.l=H,R.o=5,nl(R),rl(R)}function nl(R){R.A||(R.A=!0,bn(R,"complete"),bn(R,"error"))}t.abort=function(R){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=R||7,bn(this,"complete"),bn(this,"abort"),rl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),rl(this,!0)),ni.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?is(this):this.Xa())},t.Xa=function(){is(this)};function is(R){if(R.h&&typeof f<"u"){if(R.v&&ia(R)==4)setTimeout(R.Ca.bind(R),0);else if(bn(R,"readystatechange"),ia(R)==4){R.h=!1;try{const yt=R.ca();e:switch(yt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var H=!0;break e;default:H=!1}var ie;if(!(ie=H)){var Ae;if(Ae=yt===0){let pn=String(R.D).match(vt)[1]||null;!pn&&g.self&&g.self.location&&(pn=g.self.location.protocol.slice(0,-1)),Ae=!ri.test(pn?pn.toLowerCase():"")}ie=Ae}if(ie)bn(R,"complete"),bn(R,"success");else{R.o=6;try{var ht=ia(R)>2?R.g.statusText:""}catch{ht=""}R.l=ht+" ["+R.ca()+"]",nl(R)}}finally{rl(R)}}}}function rl(R,H){if(R.g){R.m&&(clearTimeout(R.m),R.m=null);const ie=R.g;R.g=null,H||bn(R,"ready");try{ie.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function ia(R){return R.g?R.g.readyState:0}t.ca=function(){try{return ia(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(R){if(this.g){var H=this.g.responseText;return R&&H.indexOf(R)==0&&(H=H.substring(R.length)),In(H)}};function Wi(R){try{if(!R.g)return null;if("response"in R.g)return R.g.response;switch(R.F){case"":case"text":return R.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in R.g)return R.g.mozResponseArrayBuffer}return null}catch{return null}}function to(R){const H={};R=(R.g&&ia(R)>=2&&R.g.getAllResponseHeaders()||"").split(`\r
`);for(let Ae=0;Ae<R.length;Ae++){if(le(R[Ae]))continue;var ie=ir(R[Ae]);const ht=ie[0];if(ie=ie[1],typeof ie!="string")continue;ie=ie.trim();const yt=H[ht]||[];H[ht]=yt,yt.push(ie)}Kt(H,function(Ae){return Ae.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function sa(R,H,ie){return ie&&ie.internalChannelParams&&ie.internalChannelParams[R]||H}function Pc(R){this.za=0,this.i=[],this.j=new Ge,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=sa("failFast",!1,R),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=sa("baseRetryDelayMs",5e3,R),this.Za=sa("retryDelaySeedMs",1e4,R),this.Ta=sa("forwardChannelMaxRetries",2,R),this.va=sa("forwardChannelRequestTimeoutMs",2e4,R),this.ma=R&&R.xmlHttpFactory||void 0,this.Ua=R&&R.Rb||void 0,this.Aa=R&&R.useFetchStreams||!1,this.O=void 0,this.L=R&&R.supportsCrossDomainXhr||!1,this.M="",this.h=new jo(R&&R.concurrentRequestLimit),this.Ba=new ra,this.S=R&&R.fastHandshake||!1,this.R=R&&R.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=R&&R.Pb||!1,R&&R.ua&&this.j.ua(),R&&R.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&R&&R.detectBufferingProxy||!1,this.ia=void 0,R&&R.longPollingTimeout&&R.longPollingTimeout>0&&(this.ia=R.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Pc.prototype,t.ka=8,t.I=1,t.connect=function(R,H,ie,Ae){de(0),this.W=R,this.H=H||{},ie&&Ae!==void 0&&(this.H.OSID=ie,this.H.OAID=Ae),this.F=this.X,this.J=Zf(this,null,this.W),Ca(this)};function Su(R){if(Ao(R),R.I==3){var H=R.V++,ie=Dr(R.J);if(ui(ie,"SID",R.M),ui(ie,"RID",H),ui(ie,"TYPE","terminate"),il(R,ie),H=new er(R,R.j,H),H.M=2,H.A=Sa(Dr(ie)),ie=!1,g.navigator&&g.navigator.sendBeacon)try{ie=g.navigator.sendBeacon(H.A.toString(),"")}catch{}!ie&&g.Image&&(new Image().src=H.A,ie=!0),ie||(H.g=wh(H.j,null),H.g.ea(H.A)),H.F=Date.now(),wl(H)}Lr(R)}function oa(R){R.g&&(Yl(R),R.g.cancel(),R.g=null)}function Ao(R){oa(R),R.v&&(g.clearTimeout(R.v),R.v=null),Ql(R),R.h.cancel(),R.m&&(typeof R.m=="number"&&g.clearTimeout(R.m),R.m=null)}function Ca(R){if(!ea(R.h)&&!R.m){R.m=!0;var H=R.Ea;me||re(),Te||(me(),Te=!0),ae.add(H,R),R.D=0}}function Aa(R,H){return Ta(R.h)>=R.h.j-(R.m?1:0)?!1:R.m?(R.i=H.G.concat(R.i),!0):R.I==1||R.I==2||R.D>=(R.Sa?0:R.Ta)?!1:(R.m=Ve(S(R.Ea,R,H),bh(R,R.D)),R.D++,!0)}t.Ea=function(R){if(this.m)if(this.m=null,this.I==1){if(!R){this.V=Math.floor(Math.random()*1e5),R=this.V++;const ht=new er(this,this.j,R);let yt=this.o;if(this.U&&(yt?(yt=De(yt),Et(yt,this.U)):yt=this.U),this.u!==null||this.R||(ht.J=yt,yt=null),this.S)e:{for(var H=0,ie=0;ie<this.i.length;ie++){t:{var Ae=this.i[ie];if("__data__"in Ae.map&&(Ae=Ae.map.__data__,typeof Ae=="string")){Ae=Ae.length;break t}Ae=void 0}if(Ae===void 0)break;if(H+=Ae,H>4096){H=ie;break e}if(H===4096||ie===this.i.length-1){H=ie+1;break e}}H=1e3}else H=1e3;H=Ia(this,ht,H),ie=Dr(this.J),ui(ie,"RID",R),ui(ie,"CVER",22),this.G&&ui(ie,"X-HTTP-Session-Id",this.G),il(this,ie),yt&&(this.R?H="headers="+Hn(rs(yt))+"&"+H:this.u&&Mc(ie,this.u,yt)),tl(this.h,ht),this.Ra&&ui(ie,"TYPE","init"),this.S?(ui(ie,"$req",H),ui(ie,"SID","null"),ht.U=!0,mi(ht,ie,null)):mi(ht,ie,H),this.I=2}}else this.I==3&&(R?aa(this,R):this.i.length==0||ea(this.h)||aa(this))};function aa(R,H){var ie;H?ie=H.l:ie=R.V++;const Ae=Dr(R.J);ui(Ae,"SID",R.M),ui(Ae,"RID",ie),ui(Ae,"AID",R.K),il(R,Ae),R.u&&R.o&&Mc(Ae,R.u,R.o),ie=new er(R,R.j,ie,R.D+1),R.u===null&&(ie.J=R.o),H&&(R.i=H.G.concat(R.i)),H=Ia(R,ie,1e3),ie.H=Math.round(R.va*.5)+Math.round(R.va*.5*Math.random()),tl(R.h,ie),mi(ie,Ae,H)}function il(R,H){R.H&&et(R.H,function(ie,Ae){ui(H,Ae,ie)}),R.l&&et({},function(ie,Ae){ui(H,Ae,ie)})}function Ia(R,H,ie){ie=Math.min(R.i.length,ie);const Ae=R.l?S(R.l.Ka,R.l,R):null;e:{var ht=R.i;let gr=-1;for(;;){const Qi=["count="+ie];gr==-1?ie>0?(gr=ht[0].g,Qi.push("ofs="+gr)):gr=0:Qi.push("ofs="+gr);let $r=!0;for(let Vi=0;Vi<ie;Vi++){var yt=ht[Vi].g;const nr=ht[Vi].map;if(yt-=gr,yt<0)gr=Math.max(0,ht[Vi].g-100),$r=!1;else try{yt="req"+yt+"_"||"";try{var pn=nr instanceof Map?nr:Object.entries(nr);for(const[Ho,Pa]of pn){let la=Pa;b(Pa)&&(la=_n(Pa)),Qi.push(yt+Ho+"="+encodeURIComponent(la))}}catch(Ho){throw Qi.push(yt+"type="+encodeURIComponent("_badmap")),Ho}}catch{Ae&&Ae(nr)}}if($r){pn=Qi.join("&");break e}}pn=void 0}return R=R.i.splice(0,ie),H.G=R,pn}function Cu(R){if(!R.g&&!R.v){R.Y=1;var H=R.Da;me||re(),Te||(me(),Te=!0),ae.add(H,R),R.A=0}}function Ra(R){return R.g||R.v||R.A>=3?!1:(R.Y++,R.v=Ve(S(R.Da,R),bh(R,R.A)),R.A++,!0)}t.Da=function(){if(this.v=null,Vd(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var R=4*this.T;this.j.info("BP detection timer enabled: "+R),this.B=Ve(S(this.Wa,this),R)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,de(10),oa(this),Vd(this))};function Yl(R){R.B!=null&&(g.clearTimeout(R.B),R.B=null)}function Vd(R){R.g=new er(R,R.j,"rpc",R.Y),R.u===null&&(R.g.J=R.o),R.g.P=0;var H=Dr(R.na);ui(H,"RID","rpc"),ui(H,"SID",R.M),ui(H,"AID",R.K),ui(H,"CI",R.F?"0":"1"),!R.F&&R.ia&&ui(H,"TO",R.ia),ui(H,"TYPE","xmlhttp"),il(R,H),R.u&&R.o&&Mc(H,R.u,R.o),R.O&&(R.g.H=R.O);var ie=R.g;R=R.ba,ie.M=1,ie.A=Sa(Dr(H)),ie.u=null,ie.R=!0,Eo(ie,R)}t.Va=function(){this.C!=null&&(this.C=null,oa(this),Ra(this),de(19))};function Ql(R){R.C!=null&&(g.clearTimeout(R.C),R.C=null)}function xh(R,H){var ie=null;if(R.g==H){Ql(R),Yl(R),R.g=null;var Ae=2}else if(Ea(R.h,H))ie=H.G,ta(R.h,H),Ae=1;else return;if(R.I!=0){if(H.o)if(Ae==1){ie=H.u?H.u.length:0,H=Date.now()-H.F;var ht=R.D;Ae=Gi(),bn(Ae,new Me(Ae,ie)),Ca(R)}else Cu(R);else if(ht=H.m,ht==3||ht==0&&H.X>0||!(Ae==1&&Aa(R,H)||Ae==2&&Ra(R)))switch(ie&&ie.length>0&&(H=R.h,H.i=H.i.concat(ie)),ht){case 1:Io(R,5);break;case 4:Io(R,10);break;case 3:Io(R,6);break;default:Io(R,2)}}}function bh(R,H){let ie=R.Qa+Math.floor(Math.random()*R.Za);return R.isActive()||(ie*=2),ie*H}function Io(R,H){if(R.j.info("Error code "+H),H==2){var ie=S(R.bb,R),Ae=R.Ua;const ht=!Ae;Ae=new Zr(Ae||"//www.google.com/images/cleardot.gif"),g.location&&g.location.protocol=="http"||Es(Ae,"https"),Sa(Ae),ht?So(Ae.toString(),ie):Xl(Ae.toString(),ie)}else de(2);R.I=0,R.l&&R.l.pa(H),Lr(R),Ao(R)}t.bb=function(R){R?(this.j.info("Successfully pinged google.com"),de(2)):(this.j.info("Failed to ping google.com"),de(1))};function Lr(R){if(R.I=0,R.ja=[],R.l){const H=Wl(R.h);(H.length!=0||R.i.length!=0)&&(Z(R.ja,H),Z(R.ja,R.i),R.h.i.length=0,j(R.i),R.i.length=0),R.l.oa()}}function Zf(R,H,ie){var Ae=ie instanceof Zr?Dr(ie):new Zr(ie);if(Ae.g!="")H&&(Ae.g=H+"."+Ae.g),qs(Ae,Ae.u);else{var ht=g.location;Ae=ht.protocol,H=H?H+"."+ht.hostname:ht.hostname,ht=+ht.port;const yt=new Zr(null);Ae&&Es(yt,Ae),H&&(yt.g=H),ht&&qs(yt,ht),ie&&(yt.h=ie),Ae=yt}return ie=R.G,H=R.wa,ie&&H&&ui(Ae,ie,H),ui(Ae,"VER",R.ka),il(R,Ae),Ae}function wh(R,H,ie){if(H&&!R.L)throw Error("Can't create secondary domain capable XhrIo object.");return H=R.Aa&&!R.ma?new ni(new ns({ab:ie})):new ni(R.ma),H.Fa(R.L),H}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Fd(){}t=Fd.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Cl(){}Cl.prototype.g=function(R,H){return new no(R,H)};function no(R,H){En.call(this),this.g=new Pc(H),this.l=R,this.h=H&&H.messageUrlParams||null,R=H&&H.messageHeaders||null,H&&H.clientProtocolHeaderRequired&&(R?R["X-Client-Protocol"]="webchannel":R={"X-Client-Protocol":"webchannel"}),this.g.o=R,R=H&&H.initMessageHeaders||null,H&&H.messageContentType&&(R?R["X-WebChannel-Content-Type"]=H.messageContentType:R={"X-WebChannel-Content-Type":H.messageContentType}),H&&H.sa&&(R?R["X-WebChannel-Client-Profile"]=H.sa:R={"X-WebChannel-Client-Profile":H.sa}),this.g.U=R,(R=H&&H.Qb)&&!le(R)&&(this.g.u=R),this.A=H&&H.supportsCrossDomainXhr||!1,this.v=H&&H.sendRawJson||!1,(H=H&&H.httpSessionIdParam)&&!le(H)&&(this.g.G=H,R=this.h,R!==null&&H in R&&(R=this.h,H in R&&delete R[H])),this.j=new Ma(this)}O(no,En),no.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},no.prototype.close=function(){Su(this.g)},no.prototype.o=function(R){var H=this.g;if(typeof R=="string"){var ie={};ie.__data__=R,R=ie}else this.v&&(ie={},ie.__data__=_n(R),R=ie);H.i.push(new ts(H.Ya++,R)),H.I==3&&Ca(H)},no.prototype.N=function(){this.g.l=null,delete this.j,Su(this.g),delete this.g,no.Z.N.call(this)};function Th(R){_r.call(this),R.__headers__&&(this.headers=R.__headers__,this.statusCode=R.__status__,delete R.__headers__,delete R.__status__);var H=R.__sm__;if(H){e:{for(const ie in H){R=ie;break e}R=void 0}(this.i=R)&&(R=this.i,H=H!==null&&R in H?H[R]:void 0),this.data=H}else this.data=R}O(Th,_r);function Jl(){xn.call(this),this.status=1}O(Jl,xn);function Ma(R){this.g=R}O(Ma,Fd),Ma.prototype.ra=function(){bn(this.g,"a")},Ma.prototype.qa=function(R){bn(this.g,new Th(R))},Ma.prototype.pa=function(R){bn(this.g,new Jl)},Ma.prototype.oa=function(){bn(this.g,"b")},Cl.prototype.createWebChannel=Cl.prototype.g,no.prototype.send=no.prototype.o,no.prototype.open=no.prototype.m,no.prototype.close=no.prototype.close,j5=function(){return new Cl},U5=function(){return Gi()},F5=$n,qC={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},en.NO_ERROR=0,en.TIMEOUT=8,en.HTTP_ERROR=6,Rw=en,jt.COMPLETE="complete",V5=jt,Br.EventType=tr,tr.OPEN="a",tr.CLOSE="b",tr.ERROR="c",tr.MESSAGE="d",En.prototype.listen=En.prototype.J,Z0=Br,ni.prototype.listenOnce=ni.prototype.K,ni.prototype.getLastError=ni.prototype.Ha,ni.prototype.getLastErrorCode=ni.prototype.ya,ni.prototype.getStatus=ni.prototype.ca,ni.prototype.getResponseJson=ni.prototype.La,ni.prototype.getResponseText=ni.prototype.la,ni.prototype.send=ni.prototype.ea,ni.prototype.setWithCredentials=ni.prototype.Fa,N5=ni}).apply(typeof W1<"u"?W1:typeof self<"u"?self:typeof window<"u"?window:{});const iD="@firebase/firestore",sD="4.9.2";class Ka{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ka.UNAUTHENTICATED=new Ka(null),Ka.GOOGLE_CREDENTIALS=new Ka("google-credentials-uid"),Ka.FIRST_PARTY=new Ka("first-party-uid"),Ka.MOCK_USER=new Ka("mock-user");let ev="12.3.0";const Ng=new II("@firebase/firestore");function o_(){return Ng.logLevel}function Ln(t,...e){if(Ng.logLevel<=si.DEBUG){const n=e.map(VI);Ng.debug(`Firestore (${ev}): ${t}`,...n)}}function $f(t,...e){if(Ng.logLevel<=si.ERROR){const n=e.map(VI);Ng.error(`Firestore (${ev}): ${t}`,...n)}}function P_(t,...e){if(Ng.logLevel<=si.WARN){const n=e.map(VI);Ng.warn(`Firestore (${ev}): ${t}`,...n)}}function VI(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function mr(t,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,$5(t,i,n)}function $5(t,e,n){let i=`FIRESTORE (${ev}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw $f(i),new Error(i)}function qi(t,e,n,i){let u="Unexpected state";typeof n=="string"?u=n:i=n,t||$5(e,u,i)}function Ir(t,e){return t}const qt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class kn extends xu{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Bf{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class q5{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Y7{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(Ka.UNAUTHENTICATED)))}shutdown(){}}class Q7{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class J7{constructor(e){this.t=e,this.currentUser=Ka.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){qi(this.o===void 0,42304);let i=this.i;const u=o=>this.i!==i?(i=this.i,n(o)):Promise.resolve();let f=new Bf;this.o=()=>{this.i++,this.currentUser=this.u(),f.resolve(),f=new Bf,e.enqueueRetryable((()=>u(this.currentUser)))};const g=()=>{const o=f;e.enqueueRetryable((async()=>{await o.promise,await u(this.currentUser)}))},b=o=>{Ln("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=o,this.o&&(this.auth.addAuthTokenListener(this.o),g())};this.t.onInit((o=>b(o))),setTimeout((()=>{if(!this.auth){const o=this.t.getImmediate({optional:!0});o?b(o):(Ln("FirebaseAuthCredentialsProvider","Auth not yet detected"),f.resolve(),f=new Bf)}}),0),g()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((i=>this.i!==e?(Ln("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(qi(typeof i.accessToken=="string",31837,{l:i}),new q5(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return qi(e===null||typeof e=="string",2055,{h:e}),new Ka(e)}}class eG{constructor(e,n,i){this.P=e,this.T=n,this.I=i,this.type="FirstParty",this.user=Ka.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class tG{constructor(e,n,i){this.P=e,this.T=n,this.I=i}getToken(){return Promise.resolve(new eG(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(Ka.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class oD{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class nG{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,_c(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){qi(this.o===void 0,3512);const i=f=>{f.error!=null&&Ln("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${f.error.message}`);const g=f.token!==this.m;return this.m=f.token,Ln("FirebaseAppCheckTokenProvider",`Received ${g?"new":"existing"} token.`),g?n(f.token):Promise.resolve()};this.o=f=>{e.enqueueRetryable((()=>i(f)))};const u=f=>{Ln("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=f,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((f=>u(f))),setTimeout((()=>{if(!this.appCheck){const f=this.V.getImmediate({optional:!0});f?u(f):Ln("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new oD(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(qi(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new oD(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function rG(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}class FI{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const u=rG(40);for(let f=0;f<u.length;++f)i.length<20&&u[f]<n&&(i+=e.charAt(u[f]%62))}return i}}function oi(t,e){return t<e?-1:t>e?1:0}function GC(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const u=t.charAt(i),f=e.charAt(i);if(u!==f)return OS(u)===OS(f)?oi(u,f):OS(u)?1:-1}return oi(t.length,e.length)}const iG=55296,sG=57343;function OS(t){const e=t.charCodeAt(0);return e>=iG&&e<=sG}function k_(t,e,n){return t.length===e.length&&t.every(((i,u)=>n(i,e[u])))}const aD="__name__";class pd{constructor(e,n,i){n===void 0?n=0:n>e.length&&mr(637,{offset:n,range:e.length}),i===void 0?i=e.length-n:i>e.length-n&&mr(1746,{length:i,range:e.length-n}),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return pd.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof pd?e.forEach((i=>{n.push(i)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let u=0;u<i;u++){const f=pd.compareSegments(e.get(u),n.get(u));if(f!==0)return f}return oi(e.length,n.length)}static compareSegments(e,n){const i=pd.isNumericId(e),u=pd.isNumericId(n);return i&&!u?-1:!i&&u?1:i&&u?pd.extractNumericId(e).compare(pd.extractNumericId(n)):GC(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return nm.fromString(e.substring(4,e.length-2))}}class hs extends pd{construct(e,n,i){return new hs(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new kn(qt.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter((u=>u.length>0)))}return new hs(n)}static emptyPath(){return new hs([])}}const oG=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class va extends pd{construct(e,n,i){return new va(e,n,i)}static isValidIdentifier(e){return oG.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),va.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===aD}static keyField(){return new va([aD])}static fromServerFormat(e){const n=[];let i="",u=0;const f=()=>{if(i.length===0)throw new kn(qt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let g=!1;for(;u<e.length;){const b=e[u];if(b==="\\"){if(u+1===e.length)throw new kn(qt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const o=e[u+1];if(o!=="\\"&&o!=="."&&o!=="`")throw new kn(qt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=o,u+=2}else b==="`"?(g=!g,u++):b!=="."||g?(i+=b,u++):(f(),u++)}if(f(),g)throw new kn(qt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new va(n)}static emptyPath(){return new va([])}}class Qn{constructor(e){this.path=e}static fromPath(e){return new Qn(hs.fromString(e))}static fromName(e){return new Qn(hs.fromString(e).popFirst(5))}static empty(){return new Qn(hs.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&hs.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return hs.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Qn(new hs(e.slice()))}}function G5(t,e,n){if(!n)throw new kn(qt.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function aG(t,e,n,i){if(e===!0&&i===!0)throw new kn(qt.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function lD(t){if(!Qn.isDocumentKey(t))throw new kn(qt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function cD(t){if(Qn.isDocumentKey(t))throw new kn(qt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function H5(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function jT(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":mr(12329,{type:typeof t})}function um(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new kn(qt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=jT(t);throw new kn(qt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function vo(t,e){const n={typeString:t};return e&&(n.value=e),n}function sb(t,e){if(!H5(t))throw new kn(qt.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in e)if(e[i]){const u=e[i].typeString,f="value"in e[i]?{value:e[i].value}:void 0;if(!(i in t)){n=`JSON missing required field: '${i}'`;break}const g=t[i];if(u&&typeof g!==u){n=`JSON field '${i}' must be a ${u}.`;break}if(f!==void 0&&g!==f.value){n=`Expected '${i}' field to equal '${f.value}'`;break}}if(n)throw new kn(qt.INVALID_ARGUMENT,n);return!0}const uD=-62135596800,hD=1e6;class ms{static now(){return ms.fromMillis(Date.now())}static fromDate(e){return ms.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor((e-1e3*n)*hD);return new ms(n,i)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new kn(qt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new kn(qt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<uD)throw new kn(qt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new kn(qt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/hD}_compareTo(e){return this.seconds===e.seconds?oi(this.nanoseconds,e.nanoseconds):oi(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ms._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(sb(e,ms._jsonSchema))return new ms(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-uD;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ms._jsonSchemaVersion="firestore/timestamp/1.0",ms._jsonSchema={type:vo("string",ms._jsonSchemaVersion),seconds:vo("number"),nanoseconds:vo("number")};class Er{static fromTimestamp(e){return new Er(e)}static min(){return new Er(new ms(0,0))}static max(){return new Er(new ms(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const kx=-1;function lG(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,u=Er.fromTimestamp(i===1e9?new ms(n+1,0):new ms(n,i));return new hm(u,Qn.empty(),e)}function cG(t){return new hm(t.readTime,t.key,kx)}class hm{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new hm(Er.min(),Qn.empty(),kx)}static max(){return new hm(Er.max(),Qn.empty(),kx)}}function uG(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Qn.comparator(t.documentKey,e.documentKey),n!==0?n:oi(t.largestBatchId,e.largestBatchId))}const hG="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class dG{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function tv(t){if(t.code!==qt.FAILED_PRECONDITION||t.message!==hG)throw t;Ln("LocalStore","Unexpectedly lost primary lease")}class Ht{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&mr(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Ht(((i,u)=>{this.nextCallback=f=>{this.wrapSuccess(e,f).next(i,u)},this.catchCallback=f=>{this.wrapFailure(n,f).next(i,u)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof Ht?n:Ht.resolve(n)}catch(n){return Ht.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):Ht.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):Ht.reject(n)}static resolve(e){return new Ht(((n,i)=>{n(e)}))}static reject(e){return new Ht(((n,i)=>{i(e)}))}static waitFor(e){return new Ht(((n,i)=>{let u=0,f=0,g=!1;e.forEach((b=>{++u,b.next((()=>{++f,g&&f===u&&n()}),(o=>i(o)))})),g=!0,f===u&&n()}))}static or(e){let n=Ht.resolve(!1);for(const i of e)n=n.next((u=>u?Ht.resolve(u):i()));return n}static forEach(e,n){const i=[];return e.forEach(((u,f)=>{i.push(n.call(this,u,f))})),this.waitFor(i)}static mapArray(e,n){return new Ht(((i,u)=>{const f=e.length,g=new Array(f);let b=0;for(let o=0;o<f;o++){const S=o;n(e[S]).next((M=>{g[S]=M,++b,b===f&&i(g)}),(M=>u(M)))}}))}static doWhile(e,n){return new Ht(((i,u)=>{const f=()=>{e()===!0?n().next((()=>{f()}),u):i()};f()}))}}function fG(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function nv(t){return t.name==="IndexedDbTransactionError"}class $T{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}$T.ce=-1;const UI=-1;function qT(t){return t==null}function aT(t){return t===0&&1/t==-1/0}function pG(t){return typeof t=="number"&&Number.isInteger(t)&&!aT(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const W5="";function mG(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=dD(e)),e=gG(t.get(n),e);return dD(e)}function gG(t,e){let n=e;const i=t.length;for(let u=0;u<i;u++){const f=t.charAt(u);switch(f){case"\0":n+="";break;case W5:n+="";break;default:n+=f}}return n}function dD(t){return t+W5+""}function fD(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Hg(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function X5(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Ps{constructor(e,n){this.comparator=e,this.root=n||ya.EMPTY}insert(e,n){return new Ps(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ya.BLACK,null,null))}remove(e){return new Ps(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ya.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const u=this.comparator(e,i.key);if(u===0)return n+i.left.size;u<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,i)=>(e(n,i),!1)))}toString(){const e=[];return this.inorderTraversal(((n,i)=>(e.push(`${n}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new X1(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new X1(this.root,e,this.comparator,!1)}getReverseIterator(){return new X1(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new X1(this.root,e,this.comparator,!0)}}class X1{constructor(e,n,i,u){this.isReverse=u,this.nodeStack=[];let f=1;for(;!e.isEmpty();)if(f=n?i(e.key,n):1,n&&u&&(f*=-1),f<0)e=this.isReverse?e.left:e.right;else{if(f===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ya{constructor(e,n,i,u,f){this.key=e,this.value=n,this.color=i??ya.RED,this.left=u??ya.EMPTY,this.right=f??ya.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,u,f){return new ya(e??this.key,n??this.value,i??this.color,u??this.left,f??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let u=this;const f=i(e,u.key);return u=f<0?u.copy(null,null,null,u.left.insert(e,n,i),null):f===0?u.copy(null,n,null,null,null):u.copy(null,null,null,null,u.right.insert(e,n,i)),u.fixUp()}removeMin(){if(this.left.isEmpty())return ya.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,u=this;if(n(e,u.key)<0)u.left.isEmpty()||u.left.isRed()||u.left.left.isRed()||(u=u.moveRedLeft()),u=u.copy(null,null,null,u.left.remove(e,n),null);else{if(u.left.isRed()&&(u=u.rotateRight()),u.right.isEmpty()||u.right.isRed()||u.right.left.isRed()||(u=u.moveRedRight()),n(e,u.key)===0){if(u.right.isEmpty())return ya.EMPTY;i=u.right.min(),u=u.copy(i.key,i.value,null,null,u.right.removeMin())}u=u.copy(null,null,null,null,u.right.remove(e,n))}return u.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ya.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ya.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw mr(43730,{key:this.key,value:this.value});if(this.right.isRed())throw mr(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw mr(27949);return e+(this.isRed()?0:1)}}ya.EMPTY=null,ya.RED=!0,ya.BLACK=!1;ya.EMPTY=new class{constructor(){this.size=0}get key(){throw mr(57766)}get value(){throw mr(16141)}get color(){throw mr(16727)}get left(){throw mr(29726)}get right(){throw mr(36894)}copy(e,n,i,u,f){return this}insert(e,n,i){return new ya(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Vo{constructor(e){this.comparator=e,this.data=new Ps(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,i)=>(e(n),!1)))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const u=i.getNext();if(this.comparator(u.key,e[1])>=0)return;n(u.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new pD(this.data.getIterator())}getIteratorFrom(e){return new pD(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((i=>{n=n.add(i)})),n}isEqual(e){if(!(e instanceof Vo)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const u=n.getNext().key,f=i.getNext().key;if(this.comparator(u,f)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new Vo(this.comparator);return n.data=e,n}}class pD{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class hh{constructor(e){this.fields=e,e.sort(va.comparator)}static empty(){return new hh([])}unionWith(e){let n=new Vo(va.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new hh(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return k_(this.fields,e.fields,((n,i)=>n.isEqual(i)))}}class Z5 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ba{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(u){try{return atob(u)}catch(f){throw typeof DOMException<"u"&&f instanceof DOMException?new Z5("Invalid base64 string: "+f):f}})(e);return new ba(n)}static fromUint8Array(e){const n=(function(u){let f="";for(let g=0;g<u.length;++g)f+=String.fromCharCode(u[g]);return f})(e);return new ba(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const i=new Uint8Array(n.length);for(let u=0;u<n.length;u++)i[u]=n.charCodeAt(u);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return oi(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ba.EMPTY_BYTE_STRING=new ba("");const yG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function dm(t){if(qi(!!t,39018),typeof t=="string"){let e=0;const n=yG.exec(t);if(qi(!!n,46558,{timestamp:t}),n[1]){let u=n[1];u=(u+"000000000").substr(0,9),e=Number(u)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Qs(t.seconds),nanos:Qs(t.nanos)}}function Qs(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function fm(t){return typeof t=="string"?ba.fromBase64String(t):ba.fromUint8Array(t)}const K5="server_timestamp",Y5="__type__",Q5="__previous_value__",J5="__local_write_time__";function jI(t){return(t?.mapValue?.fields||{})[Y5]?.stringValue===K5}function GT(t){const e=t.mapValue.fields[Q5];return jI(e)?GT(e):e}function Dx(t){const e=dm(t.mapValue.fields[J5].timestampValue);return new ms(e.seconds,e.nanos)}class _G{constructor(e,n,i,u,f,g,b,o,S,M){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=u,this.ssl=f,this.forceLongPolling=g,this.autoDetectLongPolling=b,this.longPollingOptions=o,this.useFetchStreams=S,this.isUsingEmulator=M}}const lT="(default)";class Lx{constructor(e,n){this.projectId=e,this.database=n||lT}static empty(){return new Lx("","")}get isDefaultDatabase(){return this.database===lT}isEqual(e){return e instanceof Lx&&e.projectId===this.projectId&&e.database===this.database}}const e4="__type__",vG="__max__",Z1={mapValue:{}},t4="__vector__",cT="value";function pm(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?jI(t)?4:bG(t)?9007199254740991:xG(t)?10:11:mr(28295,{value:t})}function kd(t,e){if(t===e)return!0;const n=pm(t);if(n!==pm(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Dx(t).isEqual(Dx(e));case 3:return(function(u,f){if(typeof u.timestampValue=="string"&&typeof f.timestampValue=="string"&&u.timestampValue.length===f.timestampValue.length)return u.timestampValue===f.timestampValue;const g=dm(u.timestampValue),b=dm(f.timestampValue);return g.seconds===b.seconds&&g.nanos===b.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(u,f){return fm(u.bytesValue).isEqual(fm(f.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(u,f){return Qs(u.geoPointValue.latitude)===Qs(f.geoPointValue.latitude)&&Qs(u.geoPointValue.longitude)===Qs(f.geoPointValue.longitude)})(t,e);case 2:return(function(u,f){if("integerValue"in u&&"integerValue"in f)return Qs(u.integerValue)===Qs(f.integerValue);if("doubleValue"in u&&"doubleValue"in f){const g=Qs(u.doubleValue),b=Qs(f.doubleValue);return g===b?aT(g)===aT(b):isNaN(g)&&isNaN(b)}return!1})(t,e);case 9:return k_(t.arrayValue.values||[],e.arrayValue.values||[],kd);case 10:case 11:return(function(u,f){const g=u.mapValue.fields||{},b=f.mapValue.fields||{};if(fD(g)!==fD(b))return!1;for(const o in g)if(g.hasOwnProperty(o)&&(b[o]===void 0||!kd(g[o],b[o])))return!1;return!0})(t,e);default:return mr(52216,{left:t})}}function Ox(t,e){return(t.values||[]).find((n=>kd(n,e)))!==void 0}function D_(t,e){if(t===e)return 0;const n=pm(t),i=pm(e);if(n!==i)return oi(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return oi(t.booleanValue,e.booleanValue);case 2:return(function(f,g){const b=Qs(f.integerValue||f.doubleValue),o=Qs(g.integerValue||g.doubleValue);return b<o?-1:b>o?1:b===o?0:isNaN(b)?isNaN(o)?0:-1:1})(t,e);case 3:return mD(t.timestampValue,e.timestampValue);case 4:return mD(Dx(t),Dx(e));case 5:return GC(t.stringValue,e.stringValue);case 6:return(function(f,g){const b=fm(f),o=fm(g);return b.compareTo(o)})(t.bytesValue,e.bytesValue);case 7:return(function(f,g){const b=f.split("/"),o=g.split("/");for(let S=0;S<b.length&&S<o.length;S++){const M=oi(b[S],o[S]);if(M!==0)return M}return oi(b.length,o.length)})(t.referenceValue,e.referenceValue);case 8:return(function(f,g){const b=oi(Qs(f.latitude),Qs(g.latitude));return b!==0?b:oi(Qs(f.longitude),Qs(g.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return gD(t.arrayValue,e.arrayValue);case 10:return(function(f,g){const b=f.fields||{},o=g.fields||{},S=b[cT]?.arrayValue,M=o[cT]?.arrayValue,O=oi(S?.values?.length||0,M?.values?.length||0);return O!==0?O:gD(S,M)})(t.mapValue,e.mapValue);case 11:return(function(f,g){if(f===Z1.mapValue&&g===Z1.mapValue)return 0;if(f===Z1.mapValue)return 1;if(g===Z1.mapValue)return-1;const b=f.fields||{},o=Object.keys(b),S=g.fields||{},M=Object.keys(S);o.sort(),M.sort();for(let O=0;O<o.length&&O<M.length;++O){const N=GC(o[O],M[O]);if(N!==0)return N;const j=D_(b[o[O]],S[M[O]]);if(j!==0)return j}return oi(o.length,M.length)})(t.mapValue,e.mapValue);default:throw mr(23264,{he:n})}}function mD(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return oi(t,e);const n=dm(t),i=dm(e),u=oi(n.seconds,i.seconds);return u!==0?u:oi(n.nanos,i.nanos)}function gD(t,e){const n=t.values||[],i=e.values||[];for(let u=0;u<n.length&&u<i.length;++u){const f=D_(n[u],i[u]);if(f)return f}return oi(n.length,i.length)}function L_(t){return HC(t)}function HC(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const i=dm(n);return`time(${i.seconds},${i.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return fm(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return Qn.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let i="[",u=!0;for(const f of n.values||[])u?u=!1:i+=",",i+=HC(f);return i+"]"})(t.arrayValue):"mapValue"in t?(function(n){const i=Object.keys(n.fields||{}).sort();let u="{",f=!0;for(const g of i)f?f=!1:u+=",",u+=`${g}:${HC(n.fields[g])}`;return u+"}"})(t.mapValue):mr(61005,{value:t})}function Mw(t){switch(pm(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=GT(t);return e?16+Mw(e):16;case 5:return 2*t.stringValue.length;case 6:return fm(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((u,f)=>u+Mw(f)),0)})(t.arrayValue);case 10:case 11:return(function(i){let u=0;return Hg(i.fields,((f,g)=>{u+=f.length+Mw(g)})),u})(t.mapValue);default:throw mr(13486,{value:t})}}function yD(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function WC(t){return!!t&&"integerValue"in t}function $I(t){return!!t&&"arrayValue"in t}function _D(t){return!!t&&"nullValue"in t}function vD(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Pw(t){return!!t&&"mapValue"in t}function xG(t){return(t?.mapValue?.fields||{})[e4]?.stringValue===t4}function hx(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Hg(t.mapValue.fields,((n,i)=>e.mapValue.fields[n]=hx(i))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=hx(t.arrayValue.values[n]);return e}return{...t}}function bG(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===vG}class cu{constructor(e){this.value=e}static empty(){return new cu({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!Pw(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=hx(n)}setAll(e){let n=va.emptyPath(),i={},u=[];e.forEach(((g,b)=>{if(!n.isImmediateParentOf(b)){const o=this.getFieldsMap(n);this.applyChanges(o,i,u),i={},u=[],n=b.popLast()}g?i[b.lastSegment()]=hx(g):u.push(b.lastSegment())}));const f=this.getFieldsMap(n);this.applyChanges(f,i,u)}delete(e){const n=this.field(e.popLast());Pw(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return kd(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let u=n.mapValue.fields[e.get(i)];Pw(u)&&u.mapValue.fields||(u={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=u),n=u}return n.mapValue.fields}applyChanges(e,n,i){Hg(n,((u,f)=>e[u]=f));for(const u of i)delete e[u]}clone(){return new cu(hx(this.value))}}function n4(t){const e=[];return Hg(t.fields,((n,i)=>{const u=new va([n]);if(Pw(i)){const f=n4(i.mapValue).fields;if(f.length===0)e.push(u);else for(const g of f)e.push(u.child(g))}else e.push(u)})),new hh(e)}class Ya{constructor(e,n,i,u,f,g,b){this.key=e,this.documentType=n,this.version=i,this.readTime=u,this.createTime=f,this.data=g,this.documentState=b}static newInvalidDocument(e){return new Ya(e,0,Er.min(),Er.min(),Er.min(),cu.empty(),0)}static newFoundDocument(e,n,i,u){return new Ya(e,1,n,Er.min(),i,u,0)}static newNoDocument(e,n){return new Ya(e,2,n,Er.min(),Er.min(),cu.empty(),0)}static newUnknownDocument(e,n){return new Ya(e,3,n,Er.min(),Er.min(),cu.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Er.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=cu.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=cu.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Er.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ya&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ya(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class uT{constructor(e,n){this.position=e,this.inclusive=n}}function xD(t,e,n){let i=0;for(let u=0;u<t.position.length;u++){const f=e[u],g=t.position[u];if(f.field.isKeyField()?i=Qn.comparator(Qn.fromName(g.referenceValue),n.key):i=D_(g,n.data.field(f.field)),f.dir==="desc"&&(i*=-1),i!==0)break}return i}function bD(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!kd(t.position[n],e.position[n]))return!1;return!0}class hT{constructor(e,n="asc"){this.field=e,this.dir=n}}function wG(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class r4{}class yo extends r4{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new EG(e,n,i):n==="array-contains"?new AG(e,i):n==="in"?new IG(e,i):n==="not-in"?new RG(e,i):n==="array-contains-any"?new MG(e,i):new yo(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new SG(e,i):new CG(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(D_(n,this.value)):n!==null&&pm(this.value)===pm(n)&&this.matchesComparison(D_(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return mr(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class fh extends r4{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new fh(e,n)}matches(e){return i4(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function i4(t){return t.op==="and"}function s4(t){return TG(t)&&i4(t)}function TG(t){for(const e of t.filters)if(e instanceof fh)return!1;return!0}function XC(t){if(t instanceof yo)return t.field.canonicalString()+t.op.toString()+L_(t.value);if(s4(t))return t.filters.map((e=>XC(e))).join(",");{const e=t.filters.map((n=>XC(n))).join(",");return`${t.op}(${e})`}}function o4(t,e){return t instanceof yo?(function(i,u){return u instanceof yo&&i.op===u.op&&i.field.isEqual(u.field)&&kd(i.value,u.value)})(t,e):t instanceof fh?(function(i,u){return u instanceof fh&&i.op===u.op&&i.filters.length===u.filters.length?i.filters.reduce(((f,g,b)=>f&&o4(g,u.filters[b])),!0):!1})(t,e):void mr(19439)}function a4(t){return t instanceof yo?(function(n){return`${n.field.canonicalString()} ${n.op} ${L_(n.value)}`})(t):t instanceof fh?(function(n){return n.op.toString()+" {"+n.getFilters().map(a4).join(" ,")+"}"})(t):"Filter"}class EG extends yo{constructor(e,n,i){super(e,n,i),this.key=Qn.fromName(i.referenceValue)}matches(e){const n=Qn.comparator(e.key,this.key);return this.matchesComparison(n)}}class SG extends yo{constructor(e,n){super(e,"in",n),this.keys=l4("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class CG extends yo{constructor(e,n){super(e,"not-in",n),this.keys=l4("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function l4(t,e){return(e.arrayValue?.values||[]).map((n=>Qn.fromName(n.referenceValue)))}class AG extends yo{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return $I(n)&&Ox(n.arrayValue,this.value)}}class IG extends yo{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ox(this.value.arrayValue,n)}}class RG extends yo{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ox(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Ox(this.value.arrayValue,n)}}class MG extends yo{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!$I(n)||!n.arrayValue.values)&&n.arrayValue.values.some((i=>Ox(this.value.arrayValue,i)))}}class PG{constructor(e,n=null,i=[],u=[],f=null,g=null,b=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=u,this.limit=f,this.startAt=g,this.endAt=b,this.Te=null}}function wD(t,e=null,n=[],i=[],u=null,f=null,g=null){return new PG(t,e,n,i,u,f,g)}function qI(t){const e=Ir(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((i=>XC(i))).join(","),n+="|ob:",n+=e.orderBy.map((i=>(function(f){return f.field.canonicalString()+f.dir})(i))).join(","),qT(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>L_(i))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>L_(i))).join(",")),e.Te=n}return e.Te}function GI(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!wG(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!o4(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!bD(t.startAt,e.startAt)&&bD(t.endAt,e.endAt)}function ZC(t){return Qn.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class ob{constructor(e,n=null,i=[],u=[],f=null,g="F",b=null,o=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=u,this.limit=f,this.limitType=g,this.startAt=b,this.endAt=o,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function kG(t,e,n,i,u,f,g,b){return new ob(t,e,n,i,u,f,g,b)}function HI(t){return new ob(t)}function TD(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function c4(t){return t.collectionGroup!==null}function dx(t){const e=Ir(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const f of e.explicitOrderBy)e.Ie.push(f),n.add(f.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(g){let b=new Vo(va.comparator);return g.filters.forEach((o=>{o.getFlattenedFilters().forEach((S=>{S.isInequality()&&(b=b.add(S.field))}))})),b})(e).forEach((f=>{n.has(f.canonicalString())||f.isKeyField()||e.Ie.push(new hT(f,i))})),n.has(va.keyField().canonicalString())||e.Ie.push(new hT(va.keyField(),i))}return e.Ie}function Ed(t){const e=Ir(t);return e.Ee||(e.Ee=DG(e,dx(t))),e.Ee}function DG(t,e){if(t.limitType==="F")return wD(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((u=>{const f=u.dir==="desc"?"asc":"desc";return new hT(u.field,f)}));const n=t.endAt?new uT(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new uT(t.startAt.position,t.startAt.inclusive):null;return wD(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function KC(t,e){const n=t.filters.concat([e]);return new ob(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function YC(t,e,n){return new ob(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function HT(t,e){return GI(Ed(t),Ed(e))&&t.limitType===e.limitType}function u4(t){return`${qI(Ed(t))}|lt:${t.limitType}`}function a_(t){return`Query(target=${(function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map((u=>a4(u))).join(", ")}]`),qT(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map((u=>(function(g){return`${g.field.canonicalString()} (${g.dir})`})(u))).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map((u=>L_(u))).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map((u=>L_(u))).join(",")),`Target(${i})`})(Ed(t))}; limitType=${t.limitType})`}function WT(t,e){return e.isFoundDocument()&&(function(i,u){const f=u.key.path;return i.collectionGroup!==null?u.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(f):Qn.isDocumentKey(i.path)?i.path.isEqual(f):i.path.isImmediateParentOf(f)})(t,e)&&(function(i,u){for(const f of dx(i))if(!f.field.isKeyField()&&u.data.field(f.field)===null)return!1;return!0})(t,e)&&(function(i,u){for(const f of i.filters)if(!f.matches(u))return!1;return!0})(t,e)&&(function(i,u){return!(i.startAt&&!(function(g,b,o){const S=xD(g,b,o);return g.inclusive?S<=0:S<0})(i.startAt,dx(i),u)||i.endAt&&!(function(g,b,o){const S=xD(g,b,o);return g.inclusive?S>=0:S>0})(i.endAt,dx(i),u))})(t,e)}function LG(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function h4(t){return(e,n)=>{let i=!1;for(const u of dx(t)){const f=OG(u,e,n);if(f!==0)return f;i=i||u.field.isKeyField()}return 0}}function OG(t,e,n){const i=t.field.isKeyField()?Qn.comparator(e.key,n.key):(function(f,g,b){const o=g.data.field(f),S=b.data.field(f);return o!==null&&S!==null?D_(o,S):mr(42886)})(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return mr(19790,{direction:t.dir})}}class Wg{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[u,f]of i)if(this.equalsFn(u,e))return f}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),u=this.inner[i];if(u===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let f=0;f<u.length;f++)if(this.equalsFn(u[f][0],e))return void(u[f]=[e,n]);u.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let u=0;u<i.length;u++)if(this.equalsFn(i[u][0],e))return i.length===1?delete this.inner[n]:i.splice(u,1),this.innerSize--,!0;return!1}forEach(e){Hg(this.inner,((n,i)=>{for(const[u,f]of i)e(u,f)}))}isEmpty(){return X5(this.inner)}size(){return this.innerSize}}const zG=new Ps(Qn.comparator);function qf(){return zG}const d4=new Ps(Qn.comparator);function K0(...t){let e=d4;for(const n of t)e=e.insert(n.key,n);return e}function f4(t){let e=d4;return t.forEach(((n,i)=>e=e.insert(n,i.overlayedDocument))),e}function Sg(){return fx()}function p4(){return fx()}function fx(){return new Wg((t=>t.toString()),((t,e)=>t.isEqual(e)))}const BG=new Ps(Qn.comparator),NG=new Vo(Qn.comparator);function ai(...t){let e=NG;for(const n of t)e=e.add(n);return e}const VG=new Vo(oi);function FG(){return VG}function WI(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:aT(e)?"-0":e}}function m4(t){return{integerValue:""+t}}function UG(t,e){return pG(e)?m4(e):WI(t,e)}class XT{constructor(){this._=void 0}}function jG(t,e,n){return t instanceof zx?(function(u,f){const g={fields:{[Y5]:{stringValue:K5},[J5]:{timestampValue:{seconds:u.seconds,nanos:u.nanoseconds}}}};return f&&jI(f)&&(f=GT(f)),f&&(g.fields[Q5]=f),{mapValue:g}})(n,e):t instanceof Bx?y4(t,e):t instanceof Nx?_4(t,e):(function(u,f){const g=g4(u,f),b=ED(g)+ED(u.Ae);return WC(g)&&WC(u.Ae)?m4(b):WI(u.serializer,b)})(t,e)}function $G(t,e,n){return t instanceof Bx?y4(t,e):t instanceof Nx?_4(t,e):n}function g4(t,e){return t instanceof dT?(function(i){return WC(i)||(function(f){return!!f&&"doubleValue"in f})(i)})(e)?e:{integerValue:0}:null}class zx extends XT{}class Bx extends XT{constructor(e){super(),this.elements=e}}function y4(t,e){const n=v4(e);for(const i of t.elements)n.some((u=>kd(u,i)))||n.push(i);return{arrayValue:{values:n}}}class Nx extends XT{constructor(e){super(),this.elements=e}}function _4(t,e){let n=v4(e);for(const i of t.elements)n=n.filter((u=>!kd(u,i)));return{arrayValue:{values:n}}}class dT extends XT{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function ED(t){return Qs(t.integerValue||t.doubleValue)}function v4(t){return $I(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class qG{constructor(e,n){this.field=e,this.transform=n}}function GG(t,e){return t.field.isEqual(e.field)&&(function(i,u){return i instanceof Bx&&u instanceof Bx||i instanceof Nx&&u instanceof Nx?k_(i.elements,u.elements,kd):i instanceof dT&&u instanceof dT?kd(i.Ae,u.Ae):i instanceof zx&&u instanceof zx})(t.transform,e.transform)}class HG{constructor(e,n){this.version=e,this.transformResults=n}}class Sd{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Sd}static exists(e){return new Sd(void 0,e)}static updateTime(e){return new Sd(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function kw(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ZT{}function x4(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new XI(t.key,Sd.none()):new ab(t.key,t.data,Sd.none());{const n=t.data,i=cu.empty();let u=new Vo(va.comparator);for(let f of e.fields)if(!u.has(f)){let g=n.field(f);g===null&&f.length>1&&(f=f.popLast(),g=n.field(f)),g===null?i.delete(f):i.set(f,g),u=u.add(f)}return new Xg(t.key,i,new hh(u.toArray()),Sd.none())}}function WG(t,e,n){t instanceof ab?(function(u,f,g){const b=u.value.clone(),o=CD(u.fieldTransforms,f,g.transformResults);b.setAll(o),f.convertToFoundDocument(g.version,b).setHasCommittedMutations()})(t,e,n):t instanceof Xg?(function(u,f,g){if(!kw(u.precondition,f))return void f.convertToUnknownDocument(g.version);const b=CD(u.fieldTransforms,f,g.transformResults),o=f.data;o.setAll(b4(u)),o.setAll(b),f.convertToFoundDocument(g.version,o).setHasCommittedMutations()})(t,e,n):(function(u,f,g){f.convertToNoDocument(g.version).setHasCommittedMutations()})(0,e,n)}function px(t,e,n,i){return t instanceof ab?(function(f,g,b,o){if(!kw(f.precondition,g))return b;const S=f.value.clone(),M=AD(f.fieldTransforms,o,g);return S.setAll(M),g.convertToFoundDocument(g.version,S).setHasLocalMutations(),null})(t,e,n,i):t instanceof Xg?(function(f,g,b,o){if(!kw(f.precondition,g))return b;const S=AD(f.fieldTransforms,o,g),M=g.data;return M.setAll(b4(f)),M.setAll(S),g.convertToFoundDocument(g.version,M).setHasLocalMutations(),b===null?null:b.unionWith(f.fieldMask.fields).unionWith(f.fieldTransforms.map((O=>O.field)))})(t,e,n,i):(function(f,g,b){return kw(f.precondition,g)?(g.convertToNoDocument(g.version).setHasLocalMutations(),null):b})(t,e,n)}function XG(t,e){let n=null;for(const i of t.fieldTransforms){const u=e.data.field(i.field),f=g4(i.transform,u||null);f!=null&&(n===null&&(n=cu.empty()),n.set(i.field,f))}return n||null}function SD(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(i,u){return i===void 0&&u===void 0||!(!i||!u)&&k_(i,u,((f,g)=>GG(f,g)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ab extends ZT{constructor(e,n,i,u=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=u,this.type=0}getFieldMask(){return null}}class Xg extends ZT{constructor(e,n,i,u,f=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=u,this.fieldTransforms=f,this.type=1}getFieldMask(){return this.fieldMask}}function b4(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function CD(t,e,n){const i=new Map;qi(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let u=0;u<n.length;u++){const f=t[u],g=f.transform,b=e.data.field(f.field);i.set(f.field,$G(g,b,n[u]))}return i}function AD(t,e,n){const i=new Map;for(const u of t){const f=u.transform,g=n.data.field(u.field);i.set(u.field,jG(f,g,e))}return i}class XI extends ZT{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ZG extends ZT{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class KG{constructor(e,n,i,u){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=u}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let u=0;u<this.mutations.length;u++){const f=this.mutations[u];f.key.isEqual(e.key)&&WG(f,e,i[u])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=px(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=px(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=p4();return this.mutations.forEach((u=>{const f=e.get(u.key),g=f.overlayedDocument;let b=this.applyToLocalView(g,f.mutatedFields);b=n.has(u.key)?null:b;const o=x4(g,b);o!==null&&i.set(u.key,o),g.isValidDocument()||g.convertToNoDocument(Er.min())})),i}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),ai())}isEqual(e){return this.batchId===e.batchId&&k_(this.mutations,e.mutations,((n,i)=>SD(n,i)))&&k_(this.baseMutations,e.baseMutations,((n,i)=>SD(n,i)))}}class ZI{constructor(e,n,i,u){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=u}static from(e,n,i){qi(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let u=(function(){return BG})();const f=e.mutations;for(let g=0;g<f.length;g++)u=u.insert(f[g].key,i[g].version);return new ZI(e,n,i,u)}}class YG{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class QG{constructor(e,n){this.count=e,this.unchangedNames=n}}var po,fi;function JG(t){switch(t){case qt.OK:return mr(64938);case qt.CANCELLED:case qt.UNKNOWN:case qt.DEADLINE_EXCEEDED:case qt.RESOURCE_EXHAUSTED:case qt.INTERNAL:case qt.UNAVAILABLE:case qt.UNAUTHENTICATED:return!1;case qt.INVALID_ARGUMENT:case qt.NOT_FOUND:case qt.ALREADY_EXISTS:case qt.PERMISSION_DENIED:case qt.FAILED_PRECONDITION:case qt.ABORTED:case qt.OUT_OF_RANGE:case qt.UNIMPLEMENTED:case qt.DATA_LOSS:return!0;default:return mr(15467,{code:t})}}function w4(t){if(t===void 0)return $f("GRPC error has no .code"),qt.UNKNOWN;switch(t){case po.OK:return qt.OK;case po.CANCELLED:return qt.CANCELLED;case po.UNKNOWN:return qt.UNKNOWN;case po.DEADLINE_EXCEEDED:return qt.DEADLINE_EXCEEDED;case po.RESOURCE_EXHAUSTED:return qt.RESOURCE_EXHAUSTED;case po.INTERNAL:return qt.INTERNAL;case po.UNAVAILABLE:return qt.UNAVAILABLE;case po.UNAUTHENTICATED:return qt.UNAUTHENTICATED;case po.INVALID_ARGUMENT:return qt.INVALID_ARGUMENT;case po.NOT_FOUND:return qt.NOT_FOUND;case po.ALREADY_EXISTS:return qt.ALREADY_EXISTS;case po.PERMISSION_DENIED:return qt.PERMISSION_DENIED;case po.FAILED_PRECONDITION:return qt.FAILED_PRECONDITION;case po.ABORTED:return qt.ABORTED;case po.OUT_OF_RANGE:return qt.OUT_OF_RANGE;case po.UNIMPLEMENTED:return qt.UNIMPLEMENTED;case po.DATA_LOSS:return qt.DATA_LOSS;default:return mr(39323,{code:t})}}(fi=po||(po={}))[fi.OK=0]="OK",fi[fi.CANCELLED=1]="CANCELLED",fi[fi.UNKNOWN=2]="UNKNOWN",fi[fi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",fi[fi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",fi[fi.NOT_FOUND=5]="NOT_FOUND",fi[fi.ALREADY_EXISTS=6]="ALREADY_EXISTS",fi[fi.PERMISSION_DENIED=7]="PERMISSION_DENIED",fi[fi.UNAUTHENTICATED=16]="UNAUTHENTICATED",fi[fi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",fi[fi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",fi[fi.ABORTED=10]="ABORTED",fi[fi.OUT_OF_RANGE=11]="OUT_OF_RANGE",fi[fi.UNIMPLEMENTED=12]="UNIMPLEMENTED",fi[fi.INTERNAL=13]="INTERNAL",fi[fi.UNAVAILABLE=14]="UNAVAILABLE",fi[fi.DATA_LOSS=15]="DATA_LOSS";function eH(){return new TextEncoder}const tH=new nm([4294967295,4294967295],0);function ID(t){const e=eH().encode(t),n=new B5;return n.update(e),new Uint8Array(n.digest())}function RD(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),u=e.getUint32(8,!0),f=e.getUint32(12,!0);return[new nm([n,i],0),new nm([u,f],0)]}class KI{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new Y0(`Invalid padding: ${n}`);if(i<0)throw new Y0(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Y0(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new Y0(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=nm.fromNumber(this.ge)}ye(e,n,i){let u=e.add(n.multiply(nm.fromNumber(i)));return u.compare(tH)===1&&(u=new nm([u.getBits(0),u.getBits(1)],0)),u.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=ID(e),[i,u]=RD(n);for(let f=0;f<this.hashCount;f++){const g=this.ye(i,u,f);if(!this.we(g))return!1}return!0}static create(e,n,i){const u=e%8==0?0:8-e%8,f=new Uint8Array(Math.ceil(e/8)),g=new KI(f,u,n);return i.forEach((b=>g.insert(b))),g}insert(e){if(this.ge===0)return;const n=ID(e),[i,u]=RD(n);for(let f=0;f<this.hashCount;f++){const g=this.ye(i,u,f);this.Se(g)}}Se(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class Y0 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class KT{constructor(e,n,i,u,f){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=u,this.resolvedLimboDocuments=f}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const u=new Map;return u.set(e,lb.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new KT(Er.min(),u,new Ps(oi),qf(),ai())}}class lb{constructor(e,n,i,u,f){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=u,this.removedDocuments=f}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new lb(i,n,ai(),ai(),ai())}}class Dw{constructor(e,n,i,u){this.be=e,this.removedTargetIds=n,this.key=i,this.De=u}}class T4{constructor(e,n){this.targetId=e,this.Ce=n}}class E4{constructor(e,n,i=ba.EMPTY_BYTE_STRING,u=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=u}}class MD{constructor(){this.ve=0,this.Fe=PD(),this.Me=ba.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ai(),n=ai(),i=ai();return this.Fe.forEach(((u,f)=>{switch(f){case 0:e=e.add(u);break;case 2:n=n.add(u);break;case 1:i=i.add(u);break;default:mr(38017,{changeType:f})}})),new lb(this.Me,this.xe,e,n,i)}qe(){this.Oe=!1,this.Fe=PD()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,qi(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class nH{constructor(e){this.Ge=e,this.ze=new Map,this.je=qf(),this.Je=K1(),this.He=K1(),this.Ye=new Ps(oi)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const i=this.nt(n);switch(e.state){case 0:this.rt(n)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(e.resumeToken));break;default:mr(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((i,u)=>{this.rt(u)&&n(u)}))}st(e){const n=e.targetId,i=e.Ce.count,u=this.ot(n);if(u){const f=u.target;if(ZC(f))if(i===0){const g=new Qn(f.path);this.et(n,g,Ya.newNoDocument(g,Er.min()))}else qi(i===1,20013,{expectedCount:i});else{const g=this._t(n);if(g!==i){const b=this.ut(e),o=b?this.ct(b,e,g):1;if(o!==0){this.it(n);const S=o===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,S)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:u=0},hashCount:f=0}=n;let g,b;try{g=fm(i).toUint8Array()}catch(o){if(o instanceof Z5)return P_("Decoding the base64 bloom filter in existence filter failed ("+o.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw o}try{b=new KI(g,u,f)}catch(o){return P_(o instanceof Y0?"BloomFilter error: ":"Applying bloom filter failed: ",o),null}return b.ge===0?null:b}ct(e,n,i){return n.Ce.count===i-this.Pt(e,n.targetId)?0:2}Pt(e,n){const i=this.Ge.getRemoteKeysForTarget(n);let u=0;return i.forEach((f=>{const g=this.Ge.ht(),b=`projects/${g.projectId}/databases/${g.database}/documents/${f.path.canonicalString()}`;e.mightContain(b)||(this.et(n,f,null),u++)})),u}Tt(e){const n=new Map;this.ze.forEach(((f,g)=>{const b=this.ot(g);if(b){if(f.current&&ZC(b.target)){const o=new Qn(b.target.path);this.It(o).has(g)||this.Et(g,o)||this.et(g,o,Ya.newNoDocument(o,e))}f.Be&&(n.set(g,f.ke()),f.qe())}}));let i=ai();this.He.forEach(((f,g)=>{let b=!0;g.forEachWhile((o=>{const S=this.ot(o);return!S||S.purpose==="TargetPurposeLimboResolution"||(b=!1,!1)})),b&&(i=i.add(f))})),this.je.forEach(((f,g)=>g.setReadTime(e)));const u=new KT(e,n,this.Ye,this.je,i);return this.je=qf(),this.Je=K1(),this.He=K1(),this.Ye=new Ps(oi),u}Xe(e,n){if(!this.rt(e))return;const i=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,i),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,i){if(!this.rt(e))return;const u=this.nt(e);this.Et(e,n)?u.Qe(n,1):u.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),i&&(this.je=this.je.insert(n,i))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new MD,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Vo(oi),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Vo(oi),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Ln("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new MD),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function K1(){return new Ps(Qn.comparator)}function PD(){return new Ps(Qn.comparator)}const rH={asc:"ASCENDING",desc:"DESCENDING"},iH={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},sH={and:"AND",or:"OR"};class oH{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function QC(t,e){return t.useProto3Json||qT(e)?e:{value:e}}function fT(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function S4(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function aH(t,e){return fT(t,e.toTimestamp())}function Cd(t){return qi(!!t,49232),Er.fromTimestamp((function(n){const i=dm(n);return new ms(i.seconds,i.nanos)})(t))}function YI(t,e){return JC(t,e).canonicalString()}function JC(t,e){const n=(function(u){return new hs(["projects",u.projectId,"databases",u.database])})(t).child("documents");return e===void 0?n:n.child(e)}function C4(t){const e=hs.fromString(t);return qi(P4(e),10190,{key:e.toString()}),e}function eA(t,e){return YI(t.databaseId,e.path)}function zS(t,e){const n=C4(e);if(n.get(1)!==t.databaseId.projectId)throw new kn(qt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new kn(qt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Qn(I4(n))}function A4(t,e){return YI(t.databaseId,e)}function lH(t){const e=C4(t);return e.length===4?hs.emptyPath():I4(e)}function tA(t){return new hs(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function I4(t){return qi(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function kD(t,e,n){return{name:eA(t,e),fields:n.value.mapValue.fields}}function cH(t,e){let n;if("targetChange"in e){e.targetChange;const i=(function(S){return S==="NO_CHANGE"?0:S==="ADD"?1:S==="REMOVE"?2:S==="CURRENT"?3:S==="RESET"?4:mr(39313,{state:S})})(e.targetChange.targetChangeType||"NO_CHANGE"),u=e.targetChange.targetIds||[],f=(function(S,M){return S.useProto3Json?(qi(M===void 0||typeof M=="string",58123),ba.fromBase64String(M||"")):(qi(M===void 0||M instanceof Buffer||M instanceof Uint8Array,16193),ba.fromUint8Array(M||new Uint8Array))})(t,e.targetChange.resumeToken),g=e.targetChange.cause,b=g&&(function(S){const M=S.code===void 0?qt.UNKNOWN:w4(S.code);return new kn(M,S.message||"")})(g);n=new E4(i,u,f,b||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const u=zS(t,i.document.name),f=Cd(i.document.updateTime),g=i.document.createTime?Cd(i.document.createTime):Er.min(),b=new cu({mapValue:{fields:i.document.fields}}),o=Ya.newFoundDocument(u,f,g,b),S=i.targetIds||[],M=i.removedTargetIds||[];n=new Dw(S,M,o.key,o)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const u=zS(t,i.document),f=i.readTime?Cd(i.readTime):Er.min(),g=Ya.newNoDocument(u,f),b=i.removedTargetIds||[];n=new Dw([],b,g.key,g)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const u=zS(t,i.document),f=i.removedTargetIds||[];n=new Dw([],f,u,null)}else{if(!("filter"in e))return mr(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:u=0,unchangedNames:f}=i,g=new QG(u,f),b=i.targetId;n=new T4(b,g)}}return n}function uH(t,e){let n;if(e instanceof ab)n={update:kD(t,e.key,e.value)};else if(e instanceof XI)n={delete:eA(t,e.key)};else if(e instanceof Xg)n={update:kD(t,e.key,e.data),updateMask:vH(e.fieldMask)};else{if(!(e instanceof ZG))return mr(16599,{Vt:e.type});n={verify:eA(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((i=>(function(f,g){const b=g.transform;if(b instanceof zx)return{fieldPath:g.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(b instanceof Bx)return{fieldPath:g.field.canonicalString(),appendMissingElements:{values:b.elements}};if(b instanceof Nx)return{fieldPath:g.field.canonicalString(),removeAllFromArray:{values:b.elements}};if(b instanceof dT)return{fieldPath:g.field.canonicalString(),increment:b.Ae};throw mr(20930,{transform:g.transform})})(0,i)))),e.precondition.isNone||(n.currentDocument=(function(u,f){return f.updateTime!==void 0?{updateTime:aH(u,f.updateTime)}:f.exists!==void 0?{exists:f.exists}:mr(27497)})(t,e.precondition)),n}function hH(t,e){return t&&t.length>0?(qi(e!==void 0,14353),t.map((n=>(function(u,f){let g=u.updateTime?Cd(u.updateTime):Cd(f);return g.isEqual(Er.min())&&(g=Cd(f)),new HG(g,u.transformResults||[])})(n,e)))):[]}function dH(t,e){return{documents:[A4(t,e.path)]}}function fH(t,e){const n={structuredQuery:{}},i=e.path;let u;e.collectionGroup!==null?(u=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(u=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=A4(t,u);const f=(function(S){if(S.length!==0)return M4(fh.create(S,"and"))})(e.filters);f&&(n.structuredQuery.where=f);const g=(function(S){if(S.length!==0)return S.map((M=>(function(N){return{field:l_(N.field),direction:gH(N.dir)}})(M)))})(e.orderBy);g&&(n.structuredQuery.orderBy=g);const b=QC(t,e.limit);return b!==null&&(n.structuredQuery.limit=b),e.startAt&&(n.structuredQuery.startAt=(function(S){return{before:S.inclusive,values:S.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(S){return{before:!S.inclusive,values:S.position}})(e.endAt)),{ft:n,parent:u}}function pH(t){let e=lH(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let u=null;if(i>0){qi(i===1,65062);const M=n.from[0];M.allDescendants?u=M.collectionId:e=e.child(M.collectionId)}let f=[];n.where&&(f=(function(O){const N=R4(O);return N instanceof fh&&s4(N)?N.getFilters():[N]})(n.where));let g=[];n.orderBy&&(g=(function(O){return O.map((N=>(function(Z){return new hT(c_(Z.field),(function(Q){switch(Q){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(Z.direction))})(N)))})(n.orderBy));let b=null;n.limit&&(b=(function(O){let N;return N=typeof O=="object"?O.value:O,qT(N)?null:N})(n.limit));let o=null;n.startAt&&(o=(function(O){const N=!!O.before,j=O.values||[];return new uT(j,N)})(n.startAt));let S=null;return n.endAt&&(S=(function(O){const N=!O.before,j=O.values||[];return new uT(j,N)})(n.endAt)),kG(e,u,g,f,b,"F",o,S)}function mH(t,e){const n=(function(u){switch(u){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return mr(28987,{purpose:u})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function R4(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=c_(n.unaryFilter.field);return yo.create(i,"==",{doubleValue:NaN});case"IS_NULL":const u=c_(n.unaryFilter.field);return yo.create(u,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const f=c_(n.unaryFilter.field);return yo.create(f,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const g=c_(n.unaryFilter.field);return yo.create(g,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return mr(61313);default:return mr(60726)}})(t):t.fieldFilter!==void 0?(function(n){return yo.create(c_(n.fieldFilter.field),(function(u){switch(u){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return mr(58110);default:return mr(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return fh.create(n.compositeFilter.filters.map((i=>R4(i))),(function(u){switch(u){case"AND":return"and";case"OR":return"or";default:return mr(1026)}})(n.compositeFilter.op))})(t):mr(30097,{filter:t})}function gH(t){return rH[t]}function yH(t){return iH[t]}function _H(t){return sH[t]}function l_(t){return{fieldPath:t.canonicalString()}}function c_(t){return va.fromServerFormat(t.fieldPath)}function M4(t){return t instanceof yo?(function(n){if(n.op==="=="){if(vD(n.value))return{unaryFilter:{field:l_(n.field),op:"IS_NAN"}};if(_D(n.value))return{unaryFilter:{field:l_(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(vD(n.value))return{unaryFilter:{field:l_(n.field),op:"IS_NOT_NAN"}};if(_D(n.value))return{unaryFilter:{field:l_(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:l_(n.field),op:yH(n.op),value:n.value}}})(t):t instanceof fh?(function(n){const i=n.getFilters().map((u=>M4(u)));return i.length===1?i[0]:{compositeFilter:{op:_H(n.op),filters:i}}})(t):mr(54877,{filter:t})}function vH(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function P4(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Jp{constructor(e,n,i,u,f=Er.min(),g=Er.min(),b=ba.EMPTY_BYTE_STRING,o=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=u,this.snapshotVersion=f,this.lastLimboFreeSnapshotVersion=g,this.resumeToken=b,this.expectedCount=o}withSequenceNumber(e){return new Jp(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Jp(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Jp(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Jp(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class xH{constructor(e){this.yt=e}}function bH(t){const e=pH({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?YC(e,e.limit,"L"):e}class wH{constructor(){this.Cn=new TH}addToCollectionParentIndex(e,n){return this.Cn.add(n),Ht.resolve()}getCollectionParents(e,n){return Ht.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return Ht.resolve()}deleteFieldIndex(e,n){return Ht.resolve()}deleteAllFieldIndexes(e){return Ht.resolve()}createTargetIndexes(e,n){return Ht.resolve()}getDocumentsMatchingTarget(e,n){return Ht.resolve(null)}getIndexType(e,n){return Ht.resolve(0)}getFieldIndexes(e,n){return Ht.resolve([])}getNextCollectionGroupToUpdate(e){return Ht.resolve(null)}getMinOffset(e,n){return Ht.resolve(hm.min())}getMinOffsetFromCollectionGroup(e,n){return Ht.resolve(hm.min())}updateCollectionGroup(e,n,i){return Ht.resolve()}updateIndexEntries(e,n){return Ht.resolve()}}class TH{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),u=this.index[n]||new Vo(hs.comparator),f=!u.has(i);return this.index[n]=u.add(i),f}has(e){const n=e.lastSegment(),i=e.popLast(),u=this.index[n];return u&&u.has(i)}getEntries(e){return(this.index[e]||new Vo(hs.comparator)).toArray()}}const DD={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},k4=41943040;class Fl{static withCacheSize(e){return new Fl(e,Fl.DEFAULT_COLLECTION_PERCENTILE,Fl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}Fl.DEFAULT_COLLECTION_PERCENTILE=10,Fl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Fl.DEFAULT=new Fl(k4,Fl.DEFAULT_COLLECTION_PERCENTILE,Fl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Fl.DISABLED=new Fl(-1,0,0);class O_{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new O_(0)}static cr(){return new O_(-1)}}const LD="LruGarbageCollector",EH=1048576;function OD([t,e],[n,i]){const u=oi(t,n);return u===0?oi(e,i):u}class SH{constructor(e){this.Ir=e,this.buffer=new Vo(OD),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();OD(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class CH{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ln(LD,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){nv(n)?Ln(LD,"Ignoring IndexedDB error during garbage collection: ",n):await tv(n)}await this.Vr(3e5)}))}}class AH{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((i=>Math.floor(n/100*i)))}nthSequenceNumber(e,n){if(n===0)return Ht.resolve($T.ce);const i=new SH(n);return this.mr.forEachTarget(e,(u=>i.Ar(u.sequenceNumber))).next((()=>this.mr.pr(e,(u=>i.Ar(u))))).next((()=>i.maxValue))}removeTargets(e,n,i){return this.mr.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Ln("LruGarbageCollector","Garbage collection skipped; disabled"),Ht.resolve(DD)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Ln("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),DD):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let i,u,f,g,b,o,S;const M=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((O=>(O>this.params.maximumSequenceNumbersToCollect?(Ln("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${O}`),u=this.params.maximumSequenceNumbersToCollect):u=O,g=Date.now(),this.nthSequenceNumber(e,u)))).next((O=>(i=O,b=Date.now(),this.removeTargets(e,i,n)))).next((O=>(f=O,o=Date.now(),this.removeOrphanedDocuments(e,i)))).next((O=>(S=Date.now(),o_()<=si.DEBUG&&Ln("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${g-M}ms
	Determined least recently used ${u} in `+(b-g)+`ms
	Removed ${f} targets in `+(o-b)+`ms
	Removed ${O} documents in `+(S-o)+`ms
Total Duration: ${S-M}ms`),Ht.resolve({didRun:!0,sequenceNumbersCollected:u,targetsRemoved:f,documentsRemoved:O}))))}}function IH(t,e){return new AH(t,e)}class RH{constructor(){this.changes=new Wg((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ya.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?Ht.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class MH{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class PH{constructor(e,n,i,u){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=u}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next((u=>(i=u,this.remoteDocumentCache.getEntry(e,n)))).next((u=>(i!==null&&px(i.mutation,u,hh.empty(),ms.now()),u)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.getLocalViewOfDocuments(e,i,ai()).next((()=>i))))}getLocalViewOfDocuments(e,n,i=ai()){const u=Sg();return this.populateOverlays(e,u,n).next((()=>this.computeViews(e,n,u,i).next((f=>{let g=K0();return f.forEach(((b,o)=>{g=g.insert(b,o.overlayedDocument)})),g}))))}getOverlayedDocuments(e,n){const i=Sg();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,ai())))}populateOverlays(e,n,i){const u=[];return i.forEach((f=>{n.has(f)||u.push(f)})),this.documentOverlayCache.getOverlays(e,u).next((f=>{f.forEach(((g,b)=>{n.set(g,b)}))}))}computeViews(e,n,i,u){let f=qf();const g=fx(),b=(function(){return fx()})();return n.forEach(((o,S)=>{const M=i.get(S.key);u.has(S.key)&&(M===void 0||M.mutation instanceof Xg)?f=f.insert(S.key,S):M!==void 0?(g.set(S.key,M.mutation.getFieldMask()),px(M.mutation,S,M.mutation.getFieldMask(),ms.now())):g.set(S.key,hh.empty())})),this.recalculateAndSaveOverlays(e,f).next((o=>(o.forEach(((S,M)=>g.set(S,M))),n.forEach(((S,M)=>b.set(S,new MH(M,g.get(S)??null)))),b)))}recalculateAndSaveOverlays(e,n){const i=fx();let u=new Ps(((g,b)=>g-b)),f=ai();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((g=>{for(const b of g)b.keys().forEach((o=>{const S=n.get(o);if(S===null)return;let M=i.get(o)||hh.empty();M=b.applyToLocalView(S,M),i.set(o,M);const O=(u.get(b.batchId)||ai()).add(o);u=u.insert(b.batchId,O)}))})).next((()=>{const g=[],b=u.getReverseIterator();for(;b.hasNext();){const o=b.getNext(),S=o.key,M=o.value,O=p4();M.forEach((N=>{if(!f.has(N)){const j=x4(n.get(N),i.get(N));j!==null&&O.set(N,j),f=f.add(N)}})),g.push(this.documentOverlayCache.saveOverlays(e,S,O))}return Ht.waitFor(g)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,n,i,u){return(function(g){return Qn.isDocumentKey(g.path)&&g.collectionGroup===null&&g.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):c4(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,u):this.getDocumentsMatchingCollectionQuery(e,n,i,u)}getNextDocuments(e,n,i,u){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,u).next((f=>{const g=u-f.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,u-f.size):Ht.resolve(Sg());let b=kx,o=f;return g.next((S=>Ht.forEach(S,((M,O)=>(b<O.largestBatchId&&(b=O.largestBatchId),f.get(M)?Ht.resolve():this.remoteDocumentCache.getEntry(e,M).next((N=>{o=o.insert(M,N)}))))).next((()=>this.populateOverlays(e,S,f))).next((()=>this.computeViews(e,o,S,ai()))).next((M=>({batchId:b,changes:f4(M)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Qn(n)).next((i=>{let u=K0();return i.isFoundDocument()&&(u=u.insert(i.key,i)),u}))}getDocumentsMatchingCollectionGroupQuery(e,n,i,u){const f=n.collectionGroup;let g=K0();return this.indexManager.getCollectionParents(e,f).next((b=>Ht.forEach(b,(o=>{const S=(function(O,N){return new ob(N,null,O.explicitOrderBy.slice(),O.filters.slice(),O.limit,O.limitType,O.startAt,O.endAt)})(n,o.child(f));return this.getDocumentsMatchingCollectionQuery(e,S,i,u).next((M=>{M.forEach(((O,N)=>{g=g.insert(O,N)}))}))})).next((()=>g))))}getDocumentsMatchingCollectionQuery(e,n,i,u){let f;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next((g=>(f=g,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,f,u)))).next((g=>{f.forEach(((o,S)=>{const M=S.getKey();g.get(M)===null&&(g=g.insert(M,Ya.newInvalidDocument(M)))}));let b=K0();return g.forEach(((o,S)=>{const M=f.get(o);M!==void 0&&px(M.mutation,S,hh.empty(),ms.now()),WT(n,S)&&(b=b.insert(o,S))})),b}))}}class kH{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return Ht.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(u){return{id:u.id,version:u.version,createTime:Cd(u.createTime)}})(n)),Ht.resolve()}getNamedQuery(e,n){return Ht.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(u){return{name:u.name,query:bH(u.bundledQuery),readTime:Cd(u.readTime)}})(n)),Ht.resolve()}}class DH{constructor(){this.overlays=new Ps(Qn.comparator),this.qr=new Map}getOverlay(e,n){return Ht.resolve(this.overlays.get(n))}getOverlays(e,n){const i=Sg();return Ht.forEach(n,(u=>this.getOverlay(e,u).next((f=>{f!==null&&i.set(u,f)})))).next((()=>i))}saveOverlays(e,n,i){return i.forEach(((u,f)=>{this.St(e,n,f)})),Ht.resolve()}removeOverlaysForBatchId(e,n,i){const u=this.qr.get(i);return u!==void 0&&(u.forEach((f=>this.overlays=this.overlays.remove(f))),this.qr.delete(i)),Ht.resolve()}getOverlaysForCollection(e,n,i){const u=Sg(),f=n.length+1,g=new Qn(n.child("")),b=this.overlays.getIteratorFrom(g);for(;b.hasNext();){const o=b.getNext().value,S=o.getKey();if(!n.isPrefixOf(S.path))break;S.path.length===f&&o.largestBatchId>i&&u.set(o.getKey(),o)}return Ht.resolve(u)}getOverlaysForCollectionGroup(e,n,i,u){let f=new Ps(((S,M)=>S-M));const g=this.overlays.getIterator();for(;g.hasNext();){const S=g.getNext().value;if(S.getKey().getCollectionGroup()===n&&S.largestBatchId>i){let M=f.get(S.largestBatchId);M===null&&(M=Sg(),f=f.insert(S.largestBatchId,M)),M.set(S.getKey(),S)}}const b=Sg(),o=f.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((S,M)=>b.set(S,M))),!(b.size()>=u)););return Ht.resolve(b)}St(e,n,i){const u=this.overlays.get(i.key);if(u!==null){const g=this.qr.get(u.largestBatchId).delete(i.key);this.qr.set(u.largestBatchId,g)}this.overlays=this.overlays.insert(i.key,new YG(n,i));let f=this.qr.get(n);f===void 0&&(f=ai(),this.qr.set(n,f)),this.qr.set(n,f.add(i.key))}}class LH{constructor(){this.sessionToken=ba.EMPTY_BYTE_STRING}getSessionToken(e){return Ht.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Ht.resolve()}}class QI{constructor(){this.Qr=new Vo(Qo.$r),this.Ur=new Vo(Qo.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const i=new Qo(e,n);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,n){e.forEach((i=>this.addReference(i,n)))}removeReference(e,n){this.Gr(new Qo(e,n))}zr(e,n){e.forEach((i=>this.removeReference(i,n)))}jr(e){const n=new Qn(new hs([])),i=new Qo(n,e),u=new Qo(n,e+1),f=[];return this.Ur.forEachInRange([i,u],(g=>{this.Gr(g),f.push(g.key)})),f}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Qn(new hs([])),i=new Qo(n,e),u=new Qo(n,e+1);let f=ai();return this.Ur.forEachInRange([i,u],(g=>{f=f.add(g.key)})),f}containsKey(e){const n=new Qo(e,0),i=this.Qr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class Qo{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Qn.comparator(e.key,n.key)||oi(e.Yr,n.Yr)}static Kr(e,n){return oi(e.Yr,n.Yr)||Qn.comparator(e.key,n.key)}}class OH{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Vo(Qo.$r)}checkEmpty(e){return Ht.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,u){const f=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const g=new KG(f,n,i,u);this.mutationQueue.push(g);for(const b of u)this.Zr=this.Zr.add(new Qo(b.key,f)),this.indexManager.addToCollectionParentIndex(e,b.key.path.popLast());return Ht.resolve(g)}lookupMutationBatch(e,n){return Ht.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,u=this.ei(i),f=u<0?0:u;return Ht.resolve(this.mutationQueue.length>f?this.mutationQueue[f]:null)}getHighestUnacknowledgedBatchId(){return Ht.resolve(this.mutationQueue.length===0?UI:this.tr-1)}getAllMutationBatches(e){return Ht.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new Qo(n,0),u=new Qo(n,Number.POSITIVE_INFINITY),f=[];return this.Zr.forEachInRange([i,u],(g=>{const b=this.Xr(g.Yr);f.push(b)})),Ht.resolve(f)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new Vo(oi);return n.forEach((u=>{const f=new Qo(u,0),g=new Qo(u,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([f,g],(b=>{i=i.add(b.Yr)}))})),Ht.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,u=i.length+1;let f=i;Qn.isDocumentKey(f)||(f=f.child(""));const g=new Qo(new Qn(f),0);let b=new Vo(oi);return this.Zr.forEachWhile((o=>{const S=o.key.path;return!!i.isPrefixOf(S)&&(S.length===u&&(b=b.add(o.Yr)),!0)}),g),Ht.resolve(this.ti(b))}ti(e){const n=[];return e.forEach((i=>{const u=this.Xr(i);u!==null&&n.push(u)})),n}removeMutationBatch(e,n){qi(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return Ht.forEach(n.mutations,(u=>{const f=new Qo(u.key,n.batchId);return i=i.delete(f),this.referenceDelegate.markPotentiallyOrphaned(e,u.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,n){const i=new Qo(n,0),u=this.Zr.firstAfterOrEqual(i);return Ht.resolve(n.isEqual(u&&u.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ht.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class zH{constructor(e){this.ri=e,this.docs=(function(){return new Ps(Qn.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,u=this.docs.get(i),f=u?u.size:0,g=this.ri(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:g}),this.size+=g-f,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return Ht.resolve(i?i.document.mutableCopy():Ya.newInvalidDocument(n))}getEntries(e,n){let i=qf();return n.forEach((u=>{const f=this.docs.get(u);i=i.insert(u,f?f.document.mutableCopy():Ya.newInvalidDocument(u))})),Ht.resolve(i)}getDocumentsMatchingQuery(e,n,i,u){let f=qf();const g=n.path,b=new Qn(g.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(b);for(;o.hasNext();){const{key:S,value:{document:M}}=o.getNext();if(!g.isPrefixOf(S.path))break;S.path.length>g.length+1||uG(cG(M),i)<=0||(u.has(M.key)||WT(n,M))&&(f=f.insert(M.key,M.mutableCopy()))}return Ht.resolve(f)}getAllFromCollectionGroup(e,n,i,u){mr(9500)}ii(e,n){return Ht.forEach(this.docs,(i=>n(i)))}newChangeBuffer(e){return new BH(this)}getSize(e){return Ht.resolve(this.size)}}class BH extends RH{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((i,u)=>{u.isValidDocument()?n.push(this.Nr.addEntry(e,u)):this.Nr.removeEntry(i)})),Ht.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class NH{constructor(e){this.persistence=e,this.si=new Wg((n=>qI(n)),GI),this.lastRemoteSnapshotVersion=Er.min(),this.highestTargetId=0,this.oi=0,this._i=new QI,this.targetCount=0,this.ai=O_.ur()}forEachTarget(e,n){return this.si.forEach(((i,u)=>n(u))),Ht.resolve()}getLastRemoteSnapshotVersion(e){return Ht.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ht.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Ht.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.oi&&(this.oi=n),Ht.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new O_(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,Ht.resolve()}updateTargetData(e,n){return this.Pr(n),Ht.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,Ht.resolve()}removeTargets(e,n,i){let u=0;const f=[];return this.si.forEach(((g,b)=>{b.sequenceNumber<=n&&i.get(b.targetId)===null&&(this.si.delete(g),f.push(this.removeMatchingKeysForTargetId(e,b.targetId)),u++)})),Ht.waitFor(f).next((()=>u))}getTargetCount(e){return Ht.resolve(this.targetCount)}getTargetData(e,n){const i=this.si.get(n)||null;return Ht.resolve(i)}addMatchingKeys(e,n,i){return this._i.Wr(n,i),Ht.resolve()}removeMatchingKeys(e,n,i){this._i.zr(n,i);const u=this.persistence.referenceDelegate,f=[];return u&&n.forEach((g=>{f.push(u.markPotentiallyOrphaned(e,g))})),Ht.waitFor(f)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),Ht.resolve()}getMatchingKeysForTargetId(e,n){const i=this._i.Hr(n);return Ht.resolve(i)}containsKey(e,n){return Ht.resolve(this._i.containsKey(n))}}class D4{constructor(e,n){this.ui={},this.overlays={},this.ci=new $T(0),this.li=!1,this.li=!0,this.hi=new LH,this.referenceDelegate=e(this),this.Pi=new NH(this),this.indexManager=new wH,this.remoteDocumentCache=(function(u){return new zH(u)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new xH(n),this.Ii=new kH(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new DH,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this.ui[e.toKey()];return i||(i=new OH(n,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,i){Ln("MemoryPersistence","Starting transaction:",e);const u=new VH(this.ci.next());return this.referenceDelegate.Ei(),i(u).next((f=>this.referenceDelegate.di(u).next((()=>f)))).toPromise().then((f=>(u.raiseOnCommittedEvent(),f)))}Ai(e,n){return Ht.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,n))))}}class VH extends dG{constructor(e){super(),this.currentSequenceNumber=e}}class JI{constructor(e){this.persistence=e,this.Ri=new QI,this.Vi=null}static mi(e){return new JI(e)}get fi(){if(this.Vi)return this.Vi;throw mr(60996)}addReference(e,n,i){return this.Ri.addReference(i,n),this.fi.delete(i.toString()),Ht.resolve()}removeReference(e,n,i){return this.Ri.removeReference(i,n),this.fi.add(i.toString()),Ht.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),Ht.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((u=>this.fi.add(u.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next((u=>{u.forEach((f=>this.fi.add(f.toString())))})).next((()=>i.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ht.forEach(this.fi,(i=>{const u=Qn.fromPath(i);return this.gi(e,u).next((f=>{f||n.removeEntry(u,Er.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((i=>{i?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return Ht.or([()=>Ht.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class pT{constructor(e,n){this.persistence=e,this.pi=new Wg((i=>mG(i.path)),((i,u)=>i.isEqual(u))),this.garbageCollector=IH(this,n)}static mi(e,n){return new pT(e,n)}Ei(){}di(e){return Ht.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>n.next((u=>i+u))))}wr(e){let n=0;return this.pr(e,(i=>{n++})).next((()=>n))}pr(e,n){return Ht.forEach(this.pi,((i,u)=>this.br(e,i,u).next((f=>f?Ht.resolve():n(u)))))}removeTargets(e,n,i){return this.persistence.getTargetCache().removeTargets(e,n,i)}removeOrphanedDocuments(e,n){let i=0;const u=this.persistence.getRemoteDocumentCache(),f=u.newChangeBuffer();return u.ii(e,(g=>this.br(e,g,n).next((b=>{b||(i++,f.removeEntry(g,Er.min()))})))).next((()=>f.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),Ht.resolve()}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),Ht.resolve()}removeReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),Ht.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),Ht.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Mw(e.data.value)),n}br(e,n,i){return Ht.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const u=this.pi.get(n);return Ht.resolve(u!==void 0&&u>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class eR{constructor(e,n,i,u){this.targetId=e,this.fromCache=n,this.Es=i,this.ds=u}static As(e,n){let i=ai(),u=ai();for(const f of n.docChanges)switch(f.type){case 0:i=i.add(f.doc.key);break;case 1:u=u.add(f.doc.key)}return new eR(e,n.fromCache,i,u)}}class FH{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class UH{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return g9()?8:fG(Ja())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,i,u){const f={result:null};return this.ys(e,n).next((g=>{f.result=g})).next((()=>{if(!f.result)return this.ws(e,n,u,i).next((g=>{f.result=g}))})).next((()=>{if(f.result)return;const g=new FH;return this.Ss(e,n,g).next((b=>{if(f.result=b,this.Vs)return this.bs(e,n,g,b.size)}))})).next((()=>f.result))}bs(e,n,i,u){return i.documentReadCount<this.fs?(o_()<=si.DEBUG&&Ln("QueryEngine","SDK will not create cache indexes for query:",a_(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Ht.resolve()):(o_()<=si.DEBUG&&Ln("QueryEngine","Query:",a_(n),"scans",i.documentReadCount,"local documents and returns",u,"documents as results."),i.documentReadCount>this.gs*u?(o_()<=si.DEBUG&&Ln("QueryEngine","The SDK decides to create cache indexes for query:",a_(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ed(n))):Ht.resolve())}ys(e,n){if(TD(n))return Ht.resolve(null);let i=Ed(n);return this.indexManager.getIndexType(e,i).next((u=>u===0?null:(n.limit!==null&&u===1&&(n=YC(n,null,"F"),i=Ed(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next((f=>{const g=ai(...f);return this.ps.getDocuments(e,g).next((b=>this.indexManager.getMinOffset(e,i).next((o=>{const S=this.Ds(n,b);return this.Cs(n,S,g,o.readTime)?this.ys(e,YC(n,null,"F")):this.vs(e,S,n,o)}))))})))))}ws(e,n,i,u){return TD(n)||u.isEqual(Er.min())?Ht.resolve(null):this.ps.getDocuments(e,i).next((f=>{const g=this.Ds(n,f);return this.Cs(n,g,i,u)?Ht.resolve(null):(o_()<=si.DEBUG&&Ln("QueryEngine","Re-using previous result from %s to execute query: %s",u.toString(),a_(n)),this.vs(e,g,n,lG(u,kx)).next((b=>b)))}))}Ds(e,n){let i=new Vo(h4(e));return n.forEach(((u,f)=>{WT(e,f)&&(i=i.add(f))})),i}Cs(e,n,i,u){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const f=e.limitType==="F"?n.last():n.first();return!!f&&(f.hasPendingWrites||f.version.compareTo(u)>0)}Ss(e,n,i){return o_()<=si.DEBUG&&Ln("QueryEngine","Using full collection scan to execute query:",a_(n)),this.ps.getDocumentsMatchingQuery(e,n,hm.min(),i)}vs(e,n,i,u){return this.ps.getDocumentsMatchingQuery(e,i,u).next((f=>(n.forEach((g=>{f=f.insert(g.key,g)})),f)))}}const tR="LocalStore",jH=3e8;class $H{constructor(e,n,i,u){this.persistence=e,this.Fs=n,this.serializer=u,this.Ms=new Ps(oi),this.xs=new Wg((f=>qI(f)),GI),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new PH(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function qH(t,e,n,i){return new $H(t,e,n,i)}async function L4(t,e){const n=Ir(t);return await n.persistence.runTransaction("Handle user change","readonly",(i=>{let u;return n.mutationQueue.getAllMutationBatches(i).next((f=>(u=f,n.Bs(e),n.mutationQueue.getAllMutationBatches(i)))).next((f=>{const g=[],b=[];let o=ai();for(const S of u){g.push(S.batchId);for(const M of S.mutations)o=o.add(M.key)}for(const S of f){b.push(S.batchId);for(const M of S.mutations)o=o.add(M.key)}return n.localDocuments.getDocuments(i,o).next((S=>({Ls:S,removedBatchIds:g,addedBatchIds:b})))}))}))}function GH(t,e){const n=Ir(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const u=e.batch.keys(),f=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(b,o,S,M){const O=S.batch,N=O.keys();let j=Ht.resolve();return N.forEach((Z=>{j=j.next((()=>M.getEntry(o,Z))).next((K=>{const Q=S.docVersions.get(Z);qi(Q!==null,48541),K.version.compareTo(Q)<0&&(O.applyToRemoteDocument(K,S),K.isValidDocument()&&(K.setReadTime(S.commitVersion),M.addEntry(K)))}))})),j.next((()=>b.mutationQueue.removeMutationBatch(o,O)))})(n,i,e,f).next((()=>f.apply(i))).next((()=>n.mutationQueue.performConsistencyCheck(i))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(i,u,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(b){let o=ai();for(let S=0;S<b.mutationResults.length;++S)b.mutationResults[S].transformResults.length>0&&(o=o.add(b.batch.mutations[S].key));return o})(e)))).next((()=>n.localDocuments.getDocuments(i,u)))}))}function O4(t){const e=Ir(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function HH(t,e){const n=Ir(t),i=e.snapshotVersion;let u=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(f=>{const g=n.Ns.newChangeBuffer({trackRemovals:!0});u=n.Ms;const b=[];e.targetChanges.forEach(((M,O)=>{const N=u.get(O);if(!N)return;b.push(n.Pi.removeMatchingKeys(f,M.removedDocuments,O).next((()=>n.Pi.addMatchingKeys(f,M.addedDocuments,O))));let j=N.withSequenceNumber(f.currentSequenceNumber);e.targetMismatches.get(O)!==null?j=j.withResumeToken(ba.EMPTY_BYTE_STRING,Er.min()).withLastLimboFreeSnapshotVersion(Er.min()):M.resumeToken.approximateByteSize()>0&&(j=j.withResumeToken(M.resumeToken,i)),u=u.insert(O,j),(function(K,Q,ce){return K.resumeToken.approximateByteSize()===0||Q.snapshotVersion.toMicroseconds()-K.snapshotVersion.toMicroseconds()>=jH?!0:ce.addedDocuments.size+ce.modifiedDocuments.size+ce.removedDocuments.size>0})(N,j,M)&&b.push(n.Pi.updateTargetData(f,j))}));let o=qf(),S=ai();if(e.documentUpdates.forEach((M=>{e.resolvedLimboDocuments.has(M)&&b.push(n.persistence.referenceDelegate.updateLimboDocument(f,M))})),b.push(WH(f,g,e.documentUpdates).next((M=>{o=M.ks,S=M.qs}))),!i.isEqual(Er.min())){const M=n.Pi.getLastRemoteSnapshotVersion(f).next((O=>n.Pi.setTargetsMetadata(f,f.currentSequenceNumber,i)));b.push(M)}return Ht.waitFor(b).next((()=>g.apply(f))).next((()=>n.localDocuments.getLocalViewOfDocuments(f,o,S))).next((()=>o))})).then((f=>(n.Ms=u,f)))}function WH(t,e,n){let i=ai(),u=ai();return n.forEach((f=>i=i.add(f))),e.getEntries(t,i).next((f=>{let g=qf();return n.forEach(((b,o)=>{const S=f.get(b);o.isFoundDocument()!==S.isFoundDocument()&&(u=u.add(b)),o.isNoDocument()&&o.version.isEqual(Er.min())?(e.removeEntry(b,o.readTime),g=g.insert(b,o)):!S.isValidDocument()||o.version.compareTo(S.version)>0||o.version.compareTo(S.version)===0&&S.hasPendingWrites?(e.addEntry(o),g=g.insert(b,o)):Ln(tR,"Ignoring outdated watch update for ",b,". Current version:",S.version," Watch version:",o.version)})),{ks:g,qs:u}}))}function XH(t,e){const n=Ir(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=UI),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function ZH(t,e){const n=Ir(t);return n.persistence.runTransaction("Allocate target","readwrite",(i=>{let u;return n.Pi.getTargetData(i,e).next((f=>f?(u=f,Ht.resolve(u)):n.Pi.allocateTargetId(i).next((g=>(u=new Jp(e,g,"TargetPurposeListen",i.currentSequenceNumber),n.Pi.addTargetData(i,u).next((()=>u)))))))})).then((i=>{const u=n.Ms.get(i.targetId);return(u===null||i.snapshotVersion.compareTo(u.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(i.targetId,i),n.xs.set(e,i.targetId)),i}))}async function nA(t,e,n){const i=Ir(t),u=i.Ms.get(e),f=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",f,(g=>i.persistence.referenceDelegate.removeTarget(g,u)))}catch(g){if(!nv(g))throw g;Ln(tR,`Failed to update sequence numbers for target ${e}: ${g}`)}i.Ms=i.Ms.remove(e),i.xs.delete(u.target)}function zD(t,e,n){const i=Ir(t);let u=Er.min(),f=ai();return i.persistence.runTransaction("Execute query","readwrite",(g=>(function(o,S,M){const O=Ir(o),N=O.xs.get(M);return N!==void 0?Ht.resolve(O.Ms.get(N)):O.Pi.getTargetData(S,M)})(i,g,Ed(e)).next((b=>{if(b)return u=b.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(g,b.targetId).next((o=>{f=o}))})).next((()=>i.Fs.getDocumentsMatchingQuery(g,e,n?u:Er.min(),n?f:ai()))).next((b=>(KH(i,LG(e),b),{documents:b,Qs:f})))))}function KH(t,e,n){let i=t.Os.get(e)||Er.min();n.forEach(((u,f)=>{f.readTime.compareTo(i)>0&&(i=f.readTime)})),t.Os.set(e,i)}class BD{constructor(){this.activeTargetIds=FG()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class YH{constructor(){this.Mo=new BD,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,i){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new BD,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class QH{Oo(e){}shutdown(){}}const ND="ConnectivityMonitor";class VD{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ln(ND,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ln(ND,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Y1=null;function rA(){return Y1===null?Y1=(function(){return 268435456+Math.round(2147483648*Math.random())})():Y1++,"0x"+Y1.toString(16)}const BS="RestConnection",JH={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class eW{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),u=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${i}/databases/${u}`,this.Wo=this.databaseId.database===lT?`project_id=${i}`:`project_id=${i}&database_id=${u}`}Go(e,n,i,u,f){const g=rA(),b=this.zo(e,n.toUriEncodedString());Ln(BS,`Sending RPC '${e}' ${g}:`,b,i);const o={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(o,u,f);const{host:S}=new URL(b),M=xm(S);return this.Jo(e,b,o,i,M).then((O=>(Ln(BS,`Received RPC '${e}' ${g}: `,O),O)),(O=>{throw P_(BS,`RPC '${e}' ${g} failed with error: `,O,"url: ",b,"request:",i),O}))}Ho(e,n,i,u,f,g){return this.Go(e,n,i,u,f)}jo(e,n,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ev})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((u,f)=>e[f]=u)),i&&i.headers.forEach(((u,f)=>e[f]=u))}zo(e,n){const i=JH[e];return`${this.Uo}/v1/${n}:${i}`}terminate(){}}class tW{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Xa="WebChannelConnection";class nW extends eW{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,i,u,f){const g=rA();return new Promise(((b,o)=>{const S=new N5;S.setWithCredentials(!0),S.listenOnce(V5.COMPLETE,(()=>{try{switch(S.getLastErrorCode()){case Rw.NO_ERROR:const O=S.getResponseJson();Ln(Xa,`XHR for RPC '${e}' ${g} received:`,JSON.stringify(O)),b(O);break;case Rw.TIMEOUT:Ln(Xa,`RPC '${e}' ${g} timed out`),o(new kn(qt.DEADLINE_EXCEEDED,"Request time out"));break;case Rw.HTTP_ERROR:const N=S.getStatus();if(Ln(Xa,`RPC '${e}' ${g} failed with status:`,N,"response text:",S.getResponseText()),N>0){let j=S.getResponseJson();Array.isArray(j)&&(j=j[0]);const Z=j?.error;if(Z&&Z.status&&Z.message){const K=(function(ce){const ge=ce.toLowerCase().replace(/_/g,"-");return Object.values(qt).indexOf(ge)>=0?ge:qt.UNKNOWN})(Z.status);o(new kn(K,Z.message))}else o(new kn(qt.UNKNOWN,"Server responded with status "+S.getStatus()))}else o(new kn(qt.UNAVAILABLE,"Connection failed."));break;default:mr(9055,{l_:e,streamId:g,h_:S.getLastErrorCode(),P_:S.getLastError()})}}finally{Ln(Xa,`RPC '${e}' ${g} completed.`)}}));const M=JSON.stringify(u);Ln(Xa,`RPC '${e}' ${g} sending request:`,u),S.send(n,"POST",M,i,15)}))}T_(e,n,i){const u=rA(),f=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],g=j5(),b=U5(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},S=this.longPollingOptions.timeoutSeconds;S!==void 0&&(o.longPollingTimeout=Math.round(1e3*S)),this.useFetchStreams&&(o.useFetchStreams=!0),this.jo(o.initMessageHeaders,n,i),o.encodeInitMessageHeaders=!0;const M=f.join("");Ln(Xa,`Creating RPC '${e}' stream ${u}: ${M}`,o);const O=g.createWebChannel(M,o);this.I_(O);let N=!1,j=!1;const Z=new tW({Yo:Q=>{j?Ln(Xa,`Not sending because RPC '${e}' stream ${u} is closed:`,Q):(N||(Ln(Xa,`Opening RPC '${e}' stream ${u} transport.`),O.open(),N=!0),Ln(Xa,`RPC '${e}' stream ${u} sending:`,Q),O.send(Q))},Zo:()=>O.close()}),K=(Q,ce,ge)=>{Q.listen(ce,(ue=>{try{ge(ue)}catch(pe){setTimeout((()=>{throw pe}),0)}}))};return K(O,Z0.EventType.OPEN,(()=>{j||(Ln(Xa,`RPC '${e}' stream ${u} transport opened.`),Z.o_())})),K(O,Z0.EventType.CLOSE,(()=>{j||(j=!0,Ln(Xa,`RPC '${e}' stream ${u} transport closed`),Z.a_(),this.E_(O))})),K(O,Z0.EventType.ERROR,(Q=>{j||(j=!0,P_(Xa,`RPC '${e}' stream ${u} transport errored. Name:`,Q.name,"Message:",Q.message),Z.a_(new kn(qt.UNAVAILABLE,"The operation could not be completed")))})),K(O,Z0.EventType.MESSAGE,(Q=>{if(!j){const ce=Q.data[0];qi(!!ce,16349);const ge=ce,ue=ge?.error||ge[0]?.error;if(ue){Ln(Xa,`RPC '${e}' stream ${u} received error:`,ue);const pe=ue.status;let me=(function(re){const he=po[re];if(he!==void 0)return w4(he)})(pe),Te=ue.message;me===void 0&&(me=qt.INTERNAL,Te="Unknown error status: "+pe+" with message "+ue.message),j=!0,Z.a_(new kn(me,Te)),O.close()}else Ln(Xa,`RPC '${e}' stream ${u} received:`,ce),Z.u_(ce)}})),K(b,F5.STAT_EVENT,(Q=>{Q.stat===qC.PROXY?Ln(Xa,`RPC '${e}' stream ${u} detected buffering proxy`):Q.stat===qC.NOPROXY&&Ln(Xa,`RPC '${e}' stream ${u} detected no buffering proxy`)})),setTimeout((()=>{Z.__()}),0),Z}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function NS(){return typeof document<"u"?document:null}function YT(t){return new oH(t,!0)}class z4{constructor(e,n,i=1e3,u=1.5,f=6e4){this.Mi=e,this.timerId=n,this.d_=i,this.A_=u,this.R_=f,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),u=Math.max(0,n-i);u>0&&Ln("ExponentialBackoff",`Backing off for ${u} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,u,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const FD="PersistentStream";class B4{constructor(e,n,i,u,f,g,b,o){this.Mi=e,this.S_=i,this.b_=u,this.connection=f,this.authCredentialsProvider=g,this.appCheckCredentialsProvider=b,this.listener=o,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new z4(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===qt.RESOURCE_EXHAUSTED?($f(n.toString()),$f("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===qt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,u])=>{this.D_===n&&this.G_(i,u)}),(i=>{e((()=>{const u=new kn(qt.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(u)}))}))}G_(e,n){const i=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((u=>{i((()=>this.z_(u)))})),this.stream.onMessage((u=>{i((()=>++this.F_==1?this.J_(u):this.onNext(u)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ln(FD,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(Ln(FD,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class rW extends B4{constructor(e,n,i,u,f,g){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,u,g),this.serializer=f}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=cH(this.serializer,e),i=(function(f){if(!("targetChange"in f))return Er.min();const g=f.targetChange;return g.targetIds&&g.targetIds.length?Er.min():g.readTime?Cd(g.readTime):Er.min()})(e);return this.listener.H_(n,i)}Y_(e){const n={};n.database=tA(this.serializer),n.addTarget=(function(f,g){let b;const o=g.target;if(b=ZC(o)?{documents:dH(f,o)}:{query:fH(f,o).ft},b.targetId=g.targetId,g.resumeToken.approximateByteSize()>0){b.resumeToken=S4(f,g.resumeToken);const S=QC(f,g.expectedCount);S!==null&&(b.expectedCount=S)}else if(g.snapshotVersion.compareTo(Er.min())>0){b.readTime=fT(f,g.snapshotVersion.toTimestamp());const S=QC(f,g.expectedCount);S!==null&&(b.expectedCount=S)}return b})(this.serializer,e);const i=mH(this.serializer,e);i&&(n.labels=i),this.q_(n)}Z_(e){const n={};n.database=tA(this.serializer),n.removeTarget=e,this.q_(n)}}class iW extends B4{constructor(e,n,i,u,f,g){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,u,g),this.serializer=f}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return qi(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,qi(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){qi(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=hH(e.writeResults,e.commitTime),i=Cd(e.commitTime);return this.listener.na(i,n)}ra(){const e={};e.database=tA(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((i=>uH(this.serializer,i)))};this.q_(n)}}class sW{}class oW extends sW{constructor(e,n,i,u){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=u,this.ia=!1}sa(){if(this.ia)throw new kn(qt.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,i,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([f,g])=>this.connection.Go(e,JC(n,i),u,f,g))).catch((f=>{throw f.name==="FirebaseError"?(f.code===qt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),f):new kn(qt.UNKNOWN,f.toString())}))}Ho(e,n,i,u,f){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([g,b])=>this.connection.Ho(e,JC(n,i),u,g,b,f))).catch((g=>{throw g.name==="FirebaseError"?(g.code===qt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),g):new kn(qt.UNKNOWN,g.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class aW{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?($f(n),this.aa=!1):Ln("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Vg="RemoteStore";class lW{constructor(e,n,i,u,f){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=f,this.Aa.Oo((g=>{i.enqueueAndForget((async()=>{Zg(this)&&(Ln(Vg,"Restarting streams for network reachability change."),await(async function(o){const S=Ir(o);S.Ea.add(4),await cb(S),S.Ra.set("Unknown"),S.Ea.delete(4),await QT(S)})(this))}))})),this.Ra=new aW(i,u)}}async function QT(t){if(Zg(t))for(const e of t.da)await e(!0)}async function cb(t){for(const e of t.da)await e(!1)}function N4(t,e){const n=Ir(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),sR(n)?iR(n):rv(n).O_()&&rR(n,e))}function nR(t,e){const n=Ir(t),i=rv(n);n.Ia.delete(e),i.O_()&&V4(n,e),n.Ia.size===0&&(i.O_()?i.L_():Zg(n)&&n.Ra.set("Unknown"))}function rR(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Er.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}rv(t).Y_(e)}function V4(t,e){t.Va.Ue(e),rv(t).Z_(e)}function iR(t){t.Va=new nH({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),rv(t).start(),t.Ra.ua()}function sR(t){return Zg(t)&&!rv(t).x_()&&t.Ia.size>0}function Zg(t){return Ir(t).Ea.size===0}function F4(t){t.Va=void 0}async function cW(t){t.Ra.set("Online")}async function uW(t){t.Ia.forEach(((e,n)=>{rR(t,e)}))}async function hW(t,e){F4(t),sR(t)?(t.Ra.ha(e),iR(t)):t.Ra.set("Unknown")}async function dW(t,e,n){if(t.Ra.set("Online"),e instanceof E4&&e.state===2&&e.cause)try{await(async function(u,f){const g=f.cause;for(const b of f.targetIds)u.Ia.has(b)&&(await u.remoteSyncer.rejectListen(b,g),u.Ia.delete(b),u.Va.removeTarget(b))})(t,e)}catch(i){Ln(Vg,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await mT(t,i)}else if(e instanceof Dw?t.Va.Ze(e):e instanceof T4?t.Va.st(e):t.Va.tt(e),!n.isEqual(Er.min()))try{const i=await O4(t.localStore);n.compareTo(i)>=0&&await(function(f,g){const b=f.Va.Tt(g);return b.targetChanges.forEach(((o,S)=>{if(o.resumeToken.approximateByteSize()>0){const M=f.Ia.get(S);M&&f.Ia.set(S,M.withResumeToken(o.resumeToken,g))}})),b.targetMismatches.forEach(((o,S)=>{const M=f.Ia.get(o);if(!M)return;f.Ia.set(o,M.withResumeToken(ba.EMPTY_BYTE_STRING,M.snapshotVersion)),V4(f,o);const O=new Jp(M.target,o,S,M.sequenceNumber);rR(f,O)})),f.remoteSyncer.applyRemoteEvent(b)})(t,n)}catch(i){Ln(Vg,"Failed to raise snapshot:",i),await mT(t,i)}}async function mT(t,e,n){if(!nv(e))throw e;t.Ea.add(1),await cb(t),t.Ra.set("Offline"),n||(n=()=>O4(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ln(Vg,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await QT(t)}))}function U4(t,e){return e().catch((n=>mT(t,n,e)))}async function JT(t){const e=Ir(t),n=mm(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:UI;for(;fW(e);)try{const u=await XH(e.localStore,i);if(u===null){e.Ta.length===0&&n.L_();break}i=u.batchId,pW(e,u)}catch(u){await mT(e,u)}j4(e)&&$4(e)}function fW(t){return Zg(t)&&t.Ta.length<10}function pW(t,e){t.Ta.push(e);const n=mm(t);n.O_()&&n.X_&&n.ea(e.mutations)}function j4(t){return Zg(t)&&!mm(t).x_()&&t.Ta.length>0}function $4(t){mm(t).start()}async function mW(t){mm(t).ra()}async function gW(t){const e=mm(t);for(const n of t.Ta)e.ea(n.mutations)}async function yW(t,e,n){const i=t.Ta.shift(),u=ZI.from(i,e,n);await U4(t,(()=>t.remoteSyncer.applySuccessfulWrite(u))),await JT(t)}async function _W(t,e){e&&mm(t).X_&&await(async function(i,u){if((function(g){return JG(g)&&g!==qt.ABORTED})(u.code)){const f=i.Ta.shift();mm(i).B_(),await U4(i,(()=>i.remoteSyncer.rejectFailedWrite(f.batchId,u))),await JT(i)}})(t,e),j4(t)&&$4(t)}async function UD(t,e){const n=Ir(t);n.asyncQueue.verifyOperationInProgress(),Ln(Vg,"RemoteStore received new credentials");const i=Zg(n);n.Ea.add(3),await cb(n),i&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await QT(n)}async function vW(t,e){const n=Ir(t);e?(n.Ea.delete(2),await QT(n)):e||(n.Ea.add(2),await cb(n),n.Ra.set("Unknown"))}function rv(t){return t.ma||(t.ma=(function(n,i,u){const f=Ir(n);return f.sa(),new rW(i,f.connection,f.authCredentials,f.appCheckCredentials,f.serializer,u)})(t.datastore,t.asyncQueue,{Xo:cW.bind(null,t),t_:uW.bind(null,t),r_:hW.bind(null,t),H_:dW.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),sR(t)?iR(t):t.Ra.set("Unknown")):(await t.ma.stop(),F4(t))}))),t.ma}function mm(t){return t.fa||(t.fa=(function(n,i,u){const f=Ir(n);return f.sa(),new iW(i,f.connection,f.authCredentials,f.appCheckCredentials,f.serializer,u)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:mW.bind(null,t),r_:_W.bind(null,t),ta:gW.bind(null,t),na:yW.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await JT(t)):(await t.fa.stop(),t.Ta.length>0&&(Ln(Vg,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class oR{constructor(e,n,i,u,f){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=u,this.removalCallback=f,this.deferred=new Bf,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((g=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,u,f){const g=Date.now()+i,b=new oR(e,n,g,u,f);return b.start(i),b}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new kn(qt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function aR(t,e){if($f("AsyncQueue",`${e}: ${t}`),nv(t))return new kn(qt.UNAVAILABLE,`${e}: ${t}`);throw t}class E_{static emptySet(e){return new E_(e.comparator)}constructor(e){this.comparator=e?(n,i)=>e(n,i)||Qn.comparator(n.key,i.key):(n,i)=>Qn.comparator(n.key,i.key),this.keyedMap=K0(),this.sortedSet=new Ps(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,i)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof E_)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const u=n.getNext().key,f=i.getNext().key;if(!u.isEqual(f))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new E_;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}class jD{constructor(){this.ga=new Ps(Qn.comparator)}track(e){const n=e.doc.key,i=this.ga.get(n);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(n,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(n):e.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):mr(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,i)=>{e.push(i)})),e}}class z_{constructor(e,n,i,u,f,g,b,o,S){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=u,this.mutatedKeys=f,this.fromCache=g,this.syncStateChanged=b,this.excludesMetadataChanges=o,this.hasCachedResults=S}static fromInitialDocuments(e,n,i,u,f){const g=[];return n.forEach((b=>{g.push({type:0,doc:b})})),new z_(e,n,E_.emptySet(n),g,i,u,!0,!1,f)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&HT(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let u=0;u<n.length;u++)if(n[u].type!==i[u].type||!n[u].doc.isEqual(i[u].doc))return!1;return!0}}class xW{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class bW{constructor(){this.queries=$D(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const u=Ir(n),f=u.queries;u.queries=$D(),f.forEach(((g,b)=>{for(const o of b.Sa)o.onError(i)}))})(this,new kn(qt.ABORTED,"Firestore shutting down"))}}function $D(){return new Wg((t=>u4(t)),HT)}async function q4(t,e){const n=Ir(t);let i=3;const u=e.query;let f=n.queries.get(u);f?!f.ba()&&e.Da()&&(i=2):(f=new xW,i=e.Da()?0:1);try{switch(i){case 0:f.wa=await n.onListen(u,!0);break;case 1:f.wa=await n.onListen(u,!1);break;case 2:await n.onFirstRemoteStoreListen(u)}}catch(g){const b=aR(g,`Initialization of query '${a_(e.query)}' failed`);return void e.onError(b)}n.queries.set(u,f),f.Sa.push(e),e.va(n.onlineState),f.wa&&e.Fa(f.wa)&&lR(n)}async function G4(t,e){const n=Ir(t),i=e.query;let u=3;const f=n.queries.get(i);if(f){const g=f.Sa.indexOf(e);g>=0&&(f.Sa.splice(g,1),f.Sa.length===0?u=e.Da()?0:1:!f.ba()&&e.Da()&&(u=2))}switch(u){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function wW(t,e){const n=Ir(t);let i=!1;for(const u of e){const f=u.query,g=n.queries.get(f);if(g){for(const b of g.Sa)b.Fa(u)&&(i=!0);g.wa=u}}i&&lR(n)}function TW(t,e,n){const i=Ir(t),u=i.queries.get(e);if(u)for(const f of u.Sa)f.onError(n);i.queries.delete(e)}function lR(t){t.Ca.forEach((e=>{e.next()}))}var iA,qD;(qD=iA||(iA={})).Ma="default",qD.Cache="cache";class H4{constructor(e,n,i){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const u of e.docChanges)u.type!==3&&i.push(u);e=new z_(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=z_.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==iA.Cache}}class W4{constructor(e){this.key=e}}class X4{constructor(e){this.key=e}}class EW{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ai(),this.mutatedKeys=ai(),this.eu=h4(e),this.tu=new E_(this.eu)}get nu(){return this.Ya}ru(e,n){const i=n?n.iu:new jD,u=n?n.tu:this.tu;let f=n?n.mutatedKeys:this.mutatedKeys,g=u,b=!1;const o=this.query.limitType==="F"&&u.size===this.query.limit?u.last():null,S=this.query.limitType==="L"&&u.size===this.query.limit?u.first():null;if(e.inorderTraversal(((M,O)=>{const N=u.get(M),j=WT(this.query,O)?O:null,Z=!!N&&this.mutatedKeys.has(N.key),K=!!j&&(j.hasLocalMutations||this.mutatedKeys.has(j.key)&&j.hasCommittedMutations);let Q=!1;N&&j?N.data.isEqual(j.data)?Z!==K&&(i.track({type:3,doc:j}),Q=!0):this.su(N,j)||(i.track({type:2,doc:j}),Q=!0,(o&&this.eu(j,o)>0||S&&this.eu(j,S)<0)&&(b=!0)):!N&&j?(i.track({type:0,doc:j}),Q=!0):N&&!j&&(i.track({type:1,doc:N}),Q=!0,(o||S)&&(b=!0)),Q&&(j?(g=g.add(j),f=K?f.add(M):f.delete(M)):(g=g.delete(M),f=f.delete(M)))})),this.query.limit!==null)for(;g.size>this.query.limit;){const M=this.query.limitType==="F"?g.last():g.first();g=g.delete(M.key),f=f.delete(M.key),i.track({type:1,doc:M})}return{tu:g,iu:i,Cs:b,mutatedKeys:f}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,u){const f=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const g=e.iu.ya();g.sort(((M,O)=>(function(j,Z){const K=Q=>{switch(Q){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return mr(20277,{Rt:Q})}};return K(j)-K(Z)})(M.type,O.type)||this.eu(M.doc,O.doc))),this.ou(i),u=u??!1;const b=n&&!u?this._u():[],o=this.Xa.size===0&&this.current&&!u?1:0,S=o!==this.Za;return this.Za=o,g.length!==0||S?{snapshot:new z_(this.query,e.tu,f,g,e.mutatedKeys,o===0,S,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:b}:{au:b}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new jD,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ai(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const n=[];return e.forEach((i=>{this.Xa.has(i)||n.push(new X4(i))})),this.Xa.forEach((i=>{e.has(i)||n.push(new W4(i))})),n}cu(e){this.Ya=e.Qs,this.Xa=ai();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return z_.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const cR="SyncEngine";class SW{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class CW{constructor(e){this.key=e,this.hu=!1}}class AW{constructor(e,n,i,u,f,g){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=u,this.currentUser=f,this.maxConcurrentLimboResolutions=g,this.Pu={},this.Tu=new Wg((b=>u4(b)),HT),this.Iu=new Map,this.Eu=new Set,this.du=new Ps(Qn.comparator),this.Au=new Map,this.Ru=new QI,this.Vu={},this.mu=new Map,this.fu=O_.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function IW(t,e,n=!0){const i=eB(t);let u;const f=i.Tu.get(e);return f?(i.sharedClientState.addLocalQueryTarget(f.targetId),u=f.view.lu()):u=await Z4(i,e,n,!0),u}async function RW(t,e){const n=eB(t);await Z4(n,e,!0,!1)}async function Z4(t,e,n,i){const u=await ZH(t.localStore,Ed(e)),f=u.targetId,g=t.sharedClientState.addLocalQueryTarget(f,n);let b;return i&&(b=await MW(t,e,f,g==="current",u.resumeToken)),t.isPrimaryClient&&n&&N4(t.remoteStore,u),b}async function MW(t,e,n,i,u){t.pu=(O,N,j)=>(async function(K,Q,ce,ge){let ue=Q.view.ru(ce);ue.Cs&&(ue=await zD(K.localStore,Q.query,!1).then((({documents:ae})=>Q.view.ru(ae,ue))));const pe=ge&&ge.targetChanges.get(Q.targetId),me=ge&&ge.targetMismatches.get(Q.targetId)!=null,Te=Q.view.applyChanges(ue,K.isPrimaryClient,pe,me);return HD(K,Q.targetId,Te.au),Te.snapshot})(t,O,N,j);const f=await zD(t.localStore,e,!0),g=new EW(e,f.Qs),b=g.ru(f.documents),o=lb.createSynthesizedTargetChangeForCurrentChange(n,i&&t.onlineState!=="Offline",u),S=g.applyChanges(b,t.isPrimaryClient,o);HD(t,n,S.au);const M=new SW(e,n,g);return t.Tu.set(e,M),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),S.snapshot}async function PW(t,e,n){const i=Ir(t),u=i.Tu.get(e),f=i.Iu.get(u.targetId);if(f.length>1)return i.Iu.set(u.targetId,f.filter((g=>!HT(g,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(u.targetId),i.sharedClientState.isActiveQueryTarget(u.targetId)||await nA(i.localStore,u.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(u.targetId),n&&nR(i.remoteStore,u.targetId),sA(i,u.targetId)})).catch(tv)):(sA(i,u.targetId),await nA(i.localStore,u.targetId,!0))}async function kW(t,e){const n=Ir(t),i=n.Tu.get(e),u=n.Iu.get(i.targetId);n.isPrimaryClient&&u.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),nR(n.remoteStore,i.targetId))}async function DW(t,e,n){const i=FW(t);try{const u=await(function(g,b){const o=Ir(g),S=ms.now(),M=b.reduce(((j,Z)=>j.add(Z.key)),ai());let O,N;return o.persistence.runTransaction("Locally write mutations","readwrite",(j=>{let Z=qf(),K=ai();return o.Ns.getEntries(j,M).next((Q=>{Z=Q,Z.forEach(((ce,ge)=>{ge.isValidDocument()||(K=K.add(ce))}))})).next((()=>o.localDocuments.getOverlayedDocuments(j,Z))).next((Q=>{O=Q;const ce=[];for(const ge of b){const ue=XG(ge,O.get(ge.key).overlayedDocument);ue!=null&&ce.push(new Xg(ge.key,ue,n4(ue.value.mapValue),Sd.exists(!0)))}return o.mutationQueue.addMutationBatch(j,S,ce,b)})).next((Q=>{N=Q;const ce=Q.applyToLocalDocumentSet(O,K);return o.documentOverlayCache.saveOverlays(j,Q.batchId,ce)}))})).then((()=>({batchId:N.batchId,changes:f4(O)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(u.batchId),(function(g,b,o){let S=g.Vu[g.currentUser.toKey()];S||(S=new Ps(oi)),S=S.insert(b,o),g.Vu[g.currentUser.toKey()]=S})(i,u.batchId,n),await ub(i,u.changes),await JT(i.remoteStore)}catch(u){const f=aR(u,"Failed to persist write");n.reject(f)}}async function K4(t,e){const n=Ir(t);try{const i=await HH(n.localStore,e);e.targetChanges.forEach(((u,f)=>{const g=n.Au.get(f);g&&(qi(u.addedDocuments.size+u.modifiedDocuments.size+u.removedDocuments.size<=1,22616),u.addedDocuments.size>0?g.hu=!0:u.modifiedDocuments.size>0?qi(g.hu,14607):u.removedDocuments.size>0&&(qi(g.hu,42227),g.hu=!1))})),await ub(n,i,e)}catch(i){await tv(i)}}function GD(t,e,n){const i=Ir(t);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const u=[];i.Tu.forEach(((f,g)=>{const b=g.view.va(e);b.snapshot&&u.push(b.snapshot)})),(function(g,b){const o=Ir(g);o.onlineState=b;let S=!1;o.queries.forEach(((M,O)=>{for(const N of O.Sa)N.va(b)&&(S=!0)})),S&&lR(o)})(i.eventManager,e),u.length&&i.Pu.H_(u),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function LW(t,e,n){const i=Ir(t);i.sharedClientState.updateQueryState(e,"rejected",n);const u=i.Au.get(e),f=u&&u.key;if(f){let g=new Ps(Qn.comparator);g=g.insert(f,Ya.newNoDocument(f,Er.min()));const b=ai().add(f),o=new KT(Er.min(),new Map,new Ps(oi),g,b);await K4(i,o),i.du=i.du.remove(f),i.Au.delete(e),uR(i)}else await nA(i.localStore,e,!1).then((()=>sA(i,e,n))).catch(tv)}async function OW(t,e){const n=Ir(t),i=e.batch.batchId;try{const u=await GH(n.localStore,e);Q4(n,i,null),Y4(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await ub(n,u)}catch(u){await tv(u)}}async function zW(t,e,n){const i=Ir(t);try{const u=await(function(g,b){const o=Ir(g);return o.persistence.runTransaction("Reject batch","readwrite-primary",(S=>{let M;return o.mutationQueue.lookupMutationBatch(S,b).next((O=>(qi(O!==null,37113),M=O.keys(),o.mutationQueue.removeMutationBatch(S,O)))).next((()=>o.mutationQueue.performConsistencyCheck(S))).next((()=>o.documentOverlayCache.removeOverlaysForBatchId(S,M,b))).next((()=>o.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(S,M))).next((()=>o.localDocuments.getDocuments(S,M)))}))})(i.localStore,e);Q4(i,e,n),Y4(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await ub(i,u)}catch(u){await tv(u)}}function Y4(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function Q4(t,e,n){const i=Ir(t);let u=i.Vu[i.currentUser.toKey()];if(u){const f=u.get(e);f&&(n?f.reject(n):f.resolve(),u=u.remove(e)),i.Vu[i.currentUser.toKey()]=u}}function sA(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Iu.get(e))t.Tu.delete(i),n&&t.Pu.yu(i,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((i=>{t.Ru.containsKey(i)||J4(t,i)}))}function J4(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(nR(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),uR(t))}function HD(t,e,n){for(const i of n)i instanceof W4?(t.Ru.addReference(i.key,e),BW(t,i)):i instanceof X4?(Ln(cR,"Document no longer in limbo: "+i.key),t.Ru.removeReference(i.key,e),t.Ru.containsKey(i.key)||J4(t,i.key)):mr(19791,{wu:i})}function BW(t,e){const n=e.key,i=n.path.canonicalString();t.du.get(n)||t.Eu.has(i)||(Ln(cR,"New document in limbo: "+n),t.Eu.add(i),uR(t))}function uR(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Qn(hs.fromString(e)),i=t.fu.next();t.Au.set(i,new CW(n)),t.du=t.du.insert(n,i),N4(t.remoteStore,new Jp(Ed(HI(n.path)),i,"TargetPurposeLimboResolution",$T.ce))}}async function ub(t,e,n){const i=Ir(t),u=[],f=[],g=[];i.Tu.isEmpty()||(i.Tu.forEach(((b,o)=>{g.push(i.pu(o,e,n).then((S=>{if((S||n)&&i.isPrimaryClient){const M=S?!S.fromCache:n?.targetChanges.get(o.targetId)?.current;i.sharedClientState.updateQueryState(o.targetId,M?"current":"not-current")}if(S){u.push(S);const M=eR.As(o.targetId,S);f.push(M)}})))})),await Promise.all(g),i.Pu.H_(u),await(async function(o,S){const M=Ir(o);try{await M.persistence.runTransaction("notifyLocalViewChanges","readwrite",(O=>Ht.forEach(S,(N=>Ht.forEach(N.Es,(j=>M.persistence.referenceDelegate.addReference(O,N.targetId,j))).next((()=>Ht.forEach(N.ds,(j=>M.persistence.referenceDelegate.removeReference(O,N.targetId,j)))))))))}catch(O){if(!nv(O))throw O;Ln(tR,"Failed to update sequence numbers: "+O)}for(const O of S){const N=O.targetId;if(!O.fromCache){const j=M.Ms.get(N),Z=j.snapshotVersion,K=j.withLastLimboFreeSnapshotVersion(Z);M.Ms=M.Ms.insert(N,K)}}})(i.localStore,f))}async function NW(t,e){const n=Ir(t);if(!n.currentUser.isEqual(e)){Ln(cR,"User change. New user:",e.toKey());const i=await L4(n.localStore,e);n.currentUser=e,(function(f,g){f.mu.forEach((b=>{b.forEach((o=>{o.reject(new kn(qt.CANCELLED,g))}))})),f.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await ub(n,i.Ls)}}function VW(t,e){const n=Ir(t),i=n.Au.get(e);if(i&&i.hu)return ai().add(i.key);{let u=ai();const f=n.Iu.get(e);if(!f)return u;for(const g of f){const b=n.Tu.get(g);u=u.unionWith(b.view.nu)}return u}}function eB(t){const e=Ir(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=K4.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=VW.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=LW.bind(null,e),e.Pu.H_=wW.bind(null,e.eventManager),e.Pu.yu=TW.bind(null,e.eventManager),e}function FW(t){const e=Ir(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=OW.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zW.bind(null,e),e}class gT{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=YT(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return qH(this.persistence,new UH,e.initialUser,this.serializer)}Cu(e){return new D4(JI.mi,this.serializer)}Du(e){return new YH}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}gT.provider={build:()=>new gT};class UW extends gT{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){qi(this.persistence.referenceDelegate instanceof pT,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new CH(i,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Fl.withCacheSize(this.cacheSizeBytes):Fl.DEFAULT;return new D4((i=>pT.mi(i,n)),this.serializer)}}class oA{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>GD(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=NW.bind(null,this.syncEngine),await vW(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new bW})()}createDatastore(e){const n=YT(e.databaseInfo.databaseId),i=(function(f){return new nW(f)})(e.databaseInfo);return(function(f,g,b,o){return new oW(f,g,b,o)})(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return(function(i,u,f,g,b){return new lW(i,u,f,g,b)})(this.localStore,this.datastore,e.asyncQueue,(n=>GD(this.syncEngine,n,0)),(function(){return VD.v()?new VD:new QH})())}createSyncEngine(e,n){return(function(u,f,g,b,o,S,M){const O=new AW(u,f,g,b,o,S);return M&&(O.gu=!0),O})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const i=Ir(n);Ln(Vg,"RemoteStore shutting down."),i.Ea.add(5),await cb(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}oA.provider={build:()=>new oA};class tB{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):$f("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const gm="FirestoreClient";class jW{constructor(e,n,i,u,f){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=u,this.user=Ka.UNAUTHENTICATED,this.clientId=FI.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=f,this.authCredentials.start(i,(async g=>{Ln(gm,"Received user=",g.uid),await this.authCredentialListener(g),this.user=g})),this.appCheckCredentials.start(i,(g=>(Ln(gm,"Received new app check token=",g),this.appCheckCredentialListener(g,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Bf;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=aR(n,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function VS(t,e){t.asyncQueue.verifyOperationInProgress(),Ln(gm,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async u=>{i.isEqual(u)||(await L4(e.localStore,u),i=u)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function WD(t,e){t.asyncQueue.verifyOperationInProgress();const n=await $W(t);Ln(gm,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((i=>UD(e.remoteStore,i))),t.setAppCheckTokenChangeListener(((i,u)=>UD(e.remoteStore,u))),t._onlineComponents=e}async function $W(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ln(gm,"Using user provided OfflineComponentProvider");try{await VS(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(u){return u.name==="FirebaseError"?u.code===qt.FAILED_PRECONDITION||u.code===qt.UNIMPLEMENTED:!(typeof DOMException<"u"&&u instanceof DOMException)||u.code===22||u.code===20||u.code===11})(n))throw n;P_("Error using user provided cache. Falling back to memory cache: "+n),await VS(t,new gT)}}else Ln(gm,"Using default OfflineComponentProvider"),await VS(t,new UW(void 0));return t._offlineComponents}async function nB(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ln(gm,"Using user provided OnlineComponentProvider"),await WD(t,t._uninitializedComponentsProvider._online)):(Ln(gm,"Using default OnlineComponentProvider"),await WD(t,new oA))),t._onlineComponents}function qW(t){return nB(t).then((e=>e.syncEngine))}async function rB(t){const e=await nB(t),n=e.eventManager;return n.onListen=IW.bind(null,e.syncEngine),n.onUnlisten=PW.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=RW.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=kW.bind(null,e.syncEngine),n}function GW(t,e,n={}){const i=new Bf;return t.asyncQueue.enqueueAndForget((async()=>(function(f,g,b,o,S){const M=new tB({next:N=>{M.Nu(),g.enqueueAndForget((()=>G4(f,O)));const j=N.docs.has(b);!j&&N.fromCache?S.reject(new kn(qt.UNAVAILABLE,"Failed to get document because the client is offline.")):j&&N.fromCache&&o&&o.source==="server"?S.reject(new kn(qt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):S.resolve(N)},error:N=>S.reject(N)}),O=new H4(HI(b.path),M,{includeMetadataChanges:!0,qa:!0});return q4(f,O)})(await rB(t),t.asyncQueue,e,n,i))),i.promise}function HW(t,e,n={}){const i=new Bf;return t.asyncQueue.enqueueAndForget((async()=>(function(f,g,b,o,S){const M=new tB({next:N=>{M.Nu(),g.enqueueAndForget((()=>G4(f,O))),N.fromCache&&o.source==="server"?S.reject(new kn(qt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):S.resolve(N)},error:N=>S.reject(N)}),O=new H4(b,M,{includeMetadataChanges:!0,qa:!0});return q4(f,O)})(await rB(t),t.asyncQueue,e,n,i))),i.promise}function iB(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const XD=new Map;const sB="firestore.googleapis.com",ZD=!0;class KD{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new kn(qt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=sB,this.ssl=ZD}else this.host=e.host,this.ssl=e.ssl??ZD;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=k4;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<EH)throw new kn(qt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}aG("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=iB(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new kn(qt.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new kn(qt.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new kn(qt.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,u){return i.timeoutSeconds===u.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class eE{constructor(e,n,i,u){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=u,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new KD({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new kn(qt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new kn(qt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new KD(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new Y7;switch(i.type){case"firstParty":return new tG(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new kn(qt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const i=XD.get(n);i&&(Ln("ComponentProvider","Removing Datastore"),XD.delete(n),i.terminate())})(this),Promise.resolve()}}function WW(t,e,n,i={}){t=um(t,eE);const u=xm(e),f=t._getSettings(),g={...f,emulatorOptions:t._getEmulatorOptions()},b=`${e}:${n}`;u&&(CI(`https://${b}`),AI("Firestore",!0)),f.host!==sB&&f.host!==b&&P_("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const o={...f,host:b,ssl:u,emulatorOptions:i};if(!Lg(o,g)&&(t._setSettings(o),i.mockUserToken)){let S,M;if(typeof i.mockUserToken=="string")S=i.mockUserToken,M=Ka.MOCK_USER;else{S=Kz(i.mockUserToken,t._app?.options.projectId);const O=i.mockUserToken.sub||i.mockUserToken.user_id;if(!O)throw new kn(qt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");M=new Ka(O)}t._authCredentials=new Q7(new q5(S,M))}}class iv{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new iv(this.firestore,e,this._query)}}class xo{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new rm(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new xo(this.firestore,e,this._key)}toJSON(){return{type:xo._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,i){if(sb(n,xo._jsonSchema))return new xo(e,i||null,new Qn(hs.fromString(n.referencePath)))}}xo._jsonSchemaVersion="firestore/documentReference/1.0",xo._jsonSchema={type:vo("string",xo._jsonSchemaVersion),referencePath:vo("string")};class rm extends iv{constructor(e,n,i){super(e,n,HI(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new xo(this.firestore,null,new Qn(e))}withConverter(e){return new rm(this.firestore,e,this._path)}}function sv(t,e,...n){if(t=wo(t),G5("collection","path",e),t instanceof eE){const i=hs.fromString(e,...n);return cD(i),new rm(t,null,i)}{if(!(t instanceof xo||t instanceof rm))throw new kn(qt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(hs.fromString(e,...n));return cD(i),new rm(t.firestore,null,i)}}function Dd(t,e,...n){if(t=wo(t),arguments.length===1&&(e=FI.newId()),G5("doc","path",e),t instanceof eE){const i=hs.fromString(e,...n);return lD(i),new xo(t,null,new Qn(i))}{if(!(t instanceof xo||t instanceof rm))throw new kn(qt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(hs.fromString(e,...n));return lD(i),new xo(t.firestore,t instanceof rm?t.converter:null,new Qn(i))}}const YD="AsyncQueue";class QD{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new z4(this,"async_queue_retry"),this._c=()=>{const i=NS();i&&Ln(YD,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const n=NS();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=NS();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new Bf;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!nv(e))throw e;Ln(YD,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,$f("INTERNAL UNHANDLED ERROR: ",JD(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=n,n}enqueueAfterDelay(e,n,i){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const u=oR.createAndSchedule(this,e,n,i,(f=>this.hc(f)));return this.tc.push(u),u}uc(){this.nc&&mr(47125,{Pc:JD(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,i)=>n.targetTimeMs-i.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function JD(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class hb extends eE{constructor(e,n,i,u){super(e,n,i,u),this.type="firestore",this._queue=new QD,this._persistenceKey=u?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new QD(e),this._firestoreClient=void 0,await e}}}function XW(t,e){const n=typeof t=="object"?t:MI(),i=typeof t=="string"?t:lT,u=NT(n,"firestore").getImmediate({identifier:i});if(!u._initialized){const f=Wz("firestore");f&&WW(u,...f)}return u}function hR(t){if(t._terminated)throw new kn(qt.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||ZW(t),t._firestoreClient}function ZW(t){const e=t._freezeSettings(),n=(function(u,f,g,b){return new _G(u,f,g,b.host,b.ssl,b.experimentalForceLongPolling,b.experimentalAutoDetectLongPolling,iB(b.experimentalLongPollingOptions),b.useFetchStreams,b.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new jW(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(u){const f=u?._online.build();return{_offline:u?._offline.build(f),_online:f}})(t._componentsProvider))}class uu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new uu(ba.fromBase64String(e))}catch(n){throw new kn(qt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new uu(ba.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:uu._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(sb(e,uu._jsonSchema))return uu.fromBase64String(e.bytes)}}uu._jsonSchemaVersion="firestore/bytes/1.0",uu._jsonSchema={type:vo("string",uu._jsonSchemaVersion),bytes:vo("string")};class dR{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new kn(qt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new va(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class fR{constructor(e){this._methodName=e}}class Ad{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new kn(qt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new kn(qt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return oi(this._lat,e._lat)||oi(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ad._jsonSchemaVersion}}static fromJSON(e){if(sb(e,Ad._jsonSchema))return new Ad(e.latitude,e.longitude)}}Ad._jsonSchemaVersion="firestore/geoPoint/1.0",Ad._jsonSchema={type:vo("string",Ad._jsonSchemaVersion),latitude:vo("number"),longitude:vo("number")};class Id{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,u){if(i.length!==u.length)return!1;for(let f=0;f<i.length;++f)if(i[f]!==u[f])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Id._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(sb(e,Id._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new Id(e.vectorValues);throw new kn(qt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Id._jsonSchemaVersion="firestore/vectorValue/1.0",Id._jsonSchema={type:vo("string",Id._jsonSchemaVersion),vectorValues:vo("object")};const KW=/^__.*__$/;class YW{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new Xg(e,this.data,this.fieldMask,n,this.fieldTransforms):new ab(e,this.data,n,this.fieldTransforms)}}function oB(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw mr(40011,{Ac:t})}}class pR{constructor(e,n,i,u,f,g){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=u,f===void 0&&this.Rc(),this.fieldTransforms=f||[],this.fieldMask=g||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new pR({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.gc(e),i}yc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return yT(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(oB(this.Ac)&&KW.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class QW{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||YT(e)}Cc(e,n,i,u=!1){return new pR({Ac:e,methodName:n,Dc:i,path:va.emptyPath(),fc:!1,bc:u},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function aB(t){const e=t._freezeSettings(),n=YT(t._databaseId);return new QW(t._databaseId,!!e.ignoreUndefinedProperties,n)}function JW(t,e,n,i,u,f={}){const g=t.Cc(f.merge||f.mergeFields?2:0,e,n,u);uB("Data must be an object, but it was:",g,i);const b=lB(i,g);let o,S;if(f.merge)o=new hh(g.fieldMask),S=g.fieldTransforms;else if(f.mergeFields){const M=[];for(const O of f.mergeFields){const N=tX(e,O,n);if(!g.contains(N))throw new kn(qt.INVALID_ARGUMENT,`Field '${N}' is specified in your field mask but missing from your input data.`);rX(M,N)||M.push(N)}o=new hh(M),S=g.fieldTransforms.filter((O=>o.covers(O.field)))}else o=null,S=g.fieldTransforms;return new YW(new cu(b),o,S)}class mR extends fR{_toFieldTransform(e){return new qG(e.path,new zx)}isEqual(e){return e instanceof mR}}function eX(t,e,n,i=!1){return gR(n,t.Cc(i?4:3,e))}function gR(t,e){if(cB(t=wo(t)))return uB("Unsupported field value:",e,t),lB(t,e);if(t instanceof fR)return(function(i,u){if(!oB(u.Ac))throw u.Sc(`${i._methodName}() can only be used with update() and set()`);if(!u.path)throw u.Sc(`${i._methodName}() is not currently supported inside arrays`);const f=i._toFieldTransform(u);f&&u.fieldTransforms.push(f)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,u){const f=[];let g=0;for(const b of i){let o=gR(b,u.wc(g));o==null&&(o={nullValue:"NULL_VALUE"}),f.push(o),g++}return{arrayValue:{values:f}}})(t,e)}return(function(i,u){if((i=wo(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return UG(u.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const f=ms.fromDate(i);return{timestampValue:fT(u.serializer,f)}}if(i instanceof ms){const f=new ms(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:fT(u.serializer,f)}}if(i instanceof Ad)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof uu)return{bytesValue:S4(u.serializer,i._byteString)};if(i instanceof xo){const f=u.databaseId,g=i.firestore._databaseId;if(!g.isEqual(f))throw u.Sc(`Document reference is for database ${g.projectId}/${g.database} but should be for database ${f.projectId}/${f.database}`);return{referenceValue:YI(i.firestore._databaseId||u.databaseId,i._key.path)}}if(i instanceof Id)return(function(g,b){return{mapValue:{fields:{[e4]:{stringValue:t4},[cT]:{arrayValue:{values:g.toArray().map((S=>{if(typeof S!="number")throw b.Sc("VectorValues must only contain numeric values.");return WI(b.serializer,S)}))}}}}}})(i,u);throw u.Sc(`Unsupported field value: ${jT(i)}`)})(t,e)}function lB(t,e){const n={};return X5(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Hg(t,((i,u)=>{const f=gR(u,e.mc(i));f!=null&&(n[i]=f)})),{mapValue:{fields:n}}}function cB(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ms||t instanceof Ad||t instanceof uu||t instanceof xo||t instanceof fR||t instanceof Id)}function uB(t,e,n){if(!cB(n)||!H5(n)){const i=jT(n);throw i==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+i)}}function tX(t,e,n){if((e=wo(e))instanceof dR)return e._internalPath;if(typeof e=="string")return hB(t,e);throw yT("Field path arguments must be of type string or ",t,!1,void 0,n)}const nX=new RegExp("[~\\*/\\[\\]]");function hB(t,e,n){if(e.search(nX)>=0)throw yT(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new dR(...e.split("."))._internalPath}catch{throw yT(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function yT(t,e,n,i,u){const f=i&&!i.isEmpty(),g=u!==void 0;let b=`Function ${e}() called with invalid data`;n&&(b+=" (via `toFirestore()`)"),b+=". ";let o="";return(f||g)&&(o+=" (found",f&&(o+=` in field ${i}`),g&&(o+=` in document ${u}`),o+=")"),new kn(qt.INVALID_ARGUMENT,b+t+o)}function rX(t,e){return t.some((n=>n.isEqual(e)))}class dB{constructor(e,n,i,u,f){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=u,this._converter=f}get id(){return this._key.path.lastSegment()}get ref(){return new xo(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new iX(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(yR("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class iX extends dB{data(){return super.data()}}function yR(t,e){return typeof e=="string"?hB(t,e):e instanceof dR?e._internalPath:e._delegate._internalPath}function sX(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new kn(qt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class _R{}class oX extends _R{}function db(t,e,...n){let i=[];e instanceof _R&&i.push(e),i=i.concat(n),(function(f){const g=f.filter((o=>o instanceof vR)).length,b=f.filter((o=>o instanceof tE)).length;if(g>1||g>0&&b>0)throw new kn(qt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const u of i)t=u._apply(t);return t}class tE extends oX{constructor(e,n,i){super(),this._field=e,this._op=n,this._value=i,this.type="where"}static _create(e,n,i){return new tE(e,n,i)}_apply(e){const n=this._parse(e);return fB(e._query,n),new iv(e.firestore,e.converter,KC(e._query,n))}_parse(e){const n=aB(e.firestore);return(function(f,g,b,o,S,M,O){let N;if(S.isKeyField()){if(M==="array-contains"||M==="array-contains-any")throw new kn(qt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${M}' queries on documentId().`);if(M==="in"||M==="not-in"){tL(O,M);const Z=[];for(const K of O)Z.push(eL(o,f,K));N={arrayValue:{values:Z}}}else N=eL(o,f,O)}else M!=="in"&&M!=="not-in"&&M!=="array-contains-any"||tL(O,M),N=eX(b,g,O,M==="in"||M==="not-in");return yo.create(S,M,N)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function B_(t,e,n){const i=e,u=yR("where",t);return tE._create(u,i,n)}class vR extends _R{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new vR(e,n)}_parse(e){const n=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return n.length===1?n[0]:fh.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(u,f){let g=u;const b=f.getFlattenedFilters();for(const o of b)fB(g,o),g=KC(g,o)})(e._query,n),new iv(e.firestore,e.converter,KC(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function eL(t,e,n){if(typeof(n=wo(n))=="string"){if(n==="")throw new kn(qt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!c4(e)&&n.indexOf("/")!==-1)throw new kn(qt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(hs.fromString(n));if(!Qn.isDocumentKey(i))throw new kn(qt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return yD(t,new Qn(i))}if(n instanceof xo)return yD(t,n._key);throw new kn(qt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${jT(n)}.`)}function tL(t,e){if(!Array.isArray(t)||t.length===0)throw new kn(qt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function fB(t,e){const n=(function(u,f){for(const g of u)for(const b of g.getFlattenedFilters())if(f.indexOf(b.op)>=0)return b.op;return null})(t.filters,(function(u){switch(u){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new kn(qt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new kn(qt.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class aX{convertValue(e,n="none"){switch(pm(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(fm(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw mr(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return Hg(e,((u,f)=>{i[u]=this.convertValue(f,n)})),i}convertVectorValue(e){const n=e.fields?.[cT].arrayValue?.values?.map((i=>Qs(i.doubleValue)));return new Id(n)}convertGeoPoint(e){return new Ad(Qs(e.latitude),Qs(e.longitude))}convertArray(e,n){return(e.values||[]).map((i=>this.convertValue(i,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const i=GT(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Dx(e));default:return null}}convertTimestamp(e){const n=dm(e);return new ms(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=hs.fromString(e);qi(P4(i),9688,{name:e});const u=new Lx(i.get(1),i.get(3)),f=new Qn(i.popFirst(5));return u.isEqual(n)||$f(`Document ${f} contains a document reference within a different database (${u.projectId}/${u.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),f}}function lX(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class Q0{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Pg extends dB{constructor(e,n,i,u,f,g){super(e,n,i,u,g),this._firestore=e,this._firestoreImpl=e,this.metadata=f}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Lw(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(yR("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new kn(qt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Pg._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Pg._jsonSchemaVersion="firestore/documentSnapshot/1.0",Pg._jsonSchema={type:vo("string",Pg._jsonSchemaVersion),bundleSource:vo("string","DocumentSnapshot"),bundleName:vo("string"),bundle:vo("string")};class Lw extends Pg{data(e={}){return super.data(e)}}class S_{constructor(e,n,i,u){this._firestore=e,this._userDataWriter=n,this._snapshot=u,this.metadata=new Q0(u.hasPendingWrites,u.fromCache),this.query=i}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((i=>{e.call(n,new Lw(this._firestore,this._userDataWriter,i.key,i,new Q0(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new kn(qt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(u,f){if(u._snapshot.oldDocs.isEmpty()){let g=0;return u._snapshot.docChanges.map((b=>{const o=new Lw(u._firestore,u._userDataWriter,b.doc.key,b.doc,new Q0(u._snapshot.mutatedKeys.has(b.doc.key),u._snapshot.fromCache),u.query.converter);return b.doc,{type:"added",doc:o,oldIndex:-1,newIndex:g++}}))}{let g=u._snapshot.oldDocs;return u._snapshot.docChanges.filter((b=>f||b.type!==3)).map((b=>{const o=new Lw(u._firestore,u._userDataWriter,b.doc.key,b.doc,new Q0(u._snapshot.mutatedKeys.has(b.doc.key),u._snapshot.fromCache),u.query.converter);let S=-1,M=-1;return b.type!==0&&(S=g.indexOf(b.doc.key),g=g.delete(b.doc.key)),b.type!==1&&(g=g.add(b.doc),M=g.indexOf(b.doc.key)),{type:cX(b.type),doc:o,oldIndex:S,newIndex:M}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new kn(qt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=S_._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=FI.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],u=[];return this.docs.forEach((f=>{f._document!==null&&(n.push(f._document),i.push(this._userDataWriter.convertObjectMap(f._document.data.value.mapValue.fields,"previous")),u.push(f.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function cX(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return mr(61501,{type:t})}}function fb(t){t=um(t,xo);const e=um(t.firestore,hb);return GW(hR(e),t._key).then((n=>uX(e,t,n)))}S_._jsonSchemaVersion="firestore/querySnapshot/1.0",S_._jsonSchema={type:vo("string",S_._jsonSchemaVersion),bundleSource:vo("string","QuerySnapshot"),bundleName:vo("string"),bundle:vo("string")};class pB extends aX{constructor(e){super(),this.firestore=e}convertBytes(e){return new uu(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new xo(this.firestore,null,n)}}function ov(t){t=um(t,iv);const e=um(t.firestore,hb),n=hR(e),i=new pB(e);return sX(t._query),HW(n,t._query).then((u=>new S_(e,i,t,u)))}function Vx(t,e,n){t=um(t,xo);const i=um(t.firestore,hb),u=lX(t.converter,e,n);return mB(i,[JW(aB(i),"setDoc",t._key,u,t.converter!==null,n).toMutation(t._key,Sd.none())])}function FS(t){return mB(um(t.firestore,hb),[new XI(t._key,Sd.none())])}function mB(t,e){return(function(i,u){const f=new Bf;return i.asyncQueue.enqueueAndForget((async()=>DW(await qW(i),u,f))),f.promise})(hR(t),e)}function uX(t,e,n){const i=n.docs.get(e._key),u=new pB(t);return new Pg(t,u,e._key,i,new Q0(n.hasPendingWrites,n.fromCache),e.converter)}function Fg(){return new mR("serverTimestamp")}(function(e,n=!0){(function(u){ev=u})(qg),Og(new cm("firestore",((i,{instanceIdentifier:u,options:f})=>{const g=i.getProvider("app").getImmediate(),b=new hb(new J7(i.getProvider("auth-internal")),new nG(g,i.getProvider("app-check-internal")),(function(S,M){if(!Object.prototype.hasOwnProperty.apply(S.options,["projectId"]))throw new kn(qt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Lx(S.options.projectId,M)})(g,u),g);return f={useFetchStreams:n,...f},b._setSettings(f),b}),"PUBLIC").setMultipleInstances(!0)),bd(iD,sD,e),bd(iD,sD,"esm2020")})();const gB="firebasestorage.googleapis.com",yB="storageBucket",hX=120*1e3,dX=600*1e3;class js extends xu{constructor(e,n,i=0){super(US(e),`Firebase Storage: ${n} (${US(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,js.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return US(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Us;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Us||(Us={}));function US(t){return"storage/"+t}function xR(){const t="An unknown error occurred, please check the error payload for server response.";return new js(Us.UNKNOWN,t)}function fX(t){return new js(Us.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function pX(t){return new js(Us.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function mX(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new js(Us.UNAUTHENTICATED,t)}function gX(){return new js(Us.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function yX(t){return new js(Us.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function _X(){return new js(Us.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function vX(){return new js(Us.CANCELED,"User canceled the upload/download.")}function xX(t){return new js(Us.INVALID_URL,"Invalid URL '"+t+"'.")}function bX(t){return new js(Us.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function wX(){return new js(Us.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+yB+"' property when initializing the app?")}function TX(){return new js(Us.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function EX(){return new js(Us.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function SX(t){return new js(Us.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function aA(t){return new js(Us.INVALID_ARGUMENT,t)}function _B(){return new js(Us.APP_DELETED,"The Firebase app was deleted.")}function CX(t){return new js(Us.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function mx(t,e){return new js(Us.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function z0(t){throw new js(Us.INTERNAL_ERROR,"Internal error: "+t)}class bc{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let i;try{i=bc.makeFromUrl(e,n)}catch{return new bc(e,"")}if(i.path==="")return i;throw bX(e)}static makeFromUrl(e,n){let i=null;const u="([A-Za-z0-9.\\-_]+)";function f(pe){pe.path.charAt(pe.path.length-1)==="/"&&(pe.path_=pe.path_.slice(0,-1))}const g="(/(.*))?$",b=new RegExp("^gs://"+u+g,"i"),o={bucket:1,path:3};function S(pe){pe.path_=decodeURIComponent(pe.path)}const M="v[A-Za-z0-9_]+",O=n.replace(/[.]/g,"\\."),N="(/([^?#]*).*)?$",j=new RegExp(`^https?://${O}/${M}/b/${u}/o${N}`,"i"),Z={bucket:1,path:3},K=n===gB?"(?:storage.googleapis.com|storage.cloud.google.com)":n,Q="([^?#]*)",ce=new RegExp(`^https?://${K}/${u}/${Q}`,"i"),ue=[{regex:b,indices:o,postModify:f},{regex:j,indices:Z,postModify:S},{regex:ce,indices:{bucket:1,path:2},postModify:S}];for(let pe=0;pe<ue.length;pe++){const me=ue[pe],Te=me.regex.exec(e);if(Te){const ae=Te[me.indices.bucket];let re=Te[me.indices.path];re||(re=""),i=new bc(ae,re),me.postModify(i);break}}if(i==null)throw xX(e);return i}}class AX{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function IX(t,e,n){let i=1,u=null,f=null,g=!1,b=0;function o(){return b===2}let S=!1;function M(...Q){S||(S=!0,e.apply(null,Q))}function O(Q){u=setTimeout(()=>{u=null,t(j,o())},Q)}function N(){f&&clearTimeout(f)}function j(Q,...ce){if(S){N();return}if(Q){N(),M.call(null,Q,...ce);return}if(o()||g){N(),M.call(null,Q,...ce);return}i<64&&(i*=2);let ue;b===1?(b=2,ue=0):ue=(i+Math.random())*1e3,O(ue)}let Z=!1;function K(Q){Z||(Z=!0,N(),!S&&(u!==null?(Q||(b=2),clearTimeout(u),O(0)):Q||(b=1)))}return O(0),f=setTimeout(()=>{g=!0,K(!0)},n),K}function RX(t){t(!1)}function MX(t){return t!==void 0}function PX(t){return typeof t=="object"&&!Array.isArray(t)}function bR(t){return typeof t=="string"||t instanceof String}function nL(t){return wR()&&t instanceof Blob}function wR(){return typeof Blob<"u"}function rL(t,e,n,i){if(i<e)throw aA(`Invalid value for '${t}'. Expected ${e} or greater.`);if(i>n)throw aA(`Invalid value for '${t}'. Expected ${n} or less.`)}function TR(t,e,n){let i=e;return n==null&&(i=`https://${e}`),`${n}://${i}/v0${t}`}function vB(t){const e=encodeURIComponent;let n="?";for(const i in t)if(t.hasOwnProperty(i)){const u=e(i)+"="+e(t[i]);n=n+u+"&"}return n=n.slice(0,-1),n}var kg;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(kg||(kg={}));function kX(t,e){const n=t>=500&&t<600,u=[408,429].indexOf(t)!==-1,f=e.indexOf(t)!==-1;return n||u||f}class DX{constructor(e,n,i,u,f,g,b,o,S,M,O,N=!0,j=!1){this.url_=e,this.method_=n,this.headers_=i,this.body_=u,this.successCodes_=f,this.additionalRetryCodes_=g,this.callback_=b,this.errorCallback_=o,this.timeout_=S,this.progressCallback_=M,this.connectionFactory_=O,this.retry=N,this.isUsingEmulator=j,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((Z,K)=>{this.resolve_=Z,this.reject_=K,this.start_()})}start_(){const e=(i,u)=>{if(u){i(!1,new Q1(!1,null,!0));return}const f=this.connectionFactory_();this.pendingConnection_=f;const g=b=>{const o=b.loaded,S=b.lengthComputable?b.total:-1;this.progressCallback_!==null&&this.progressCallback_(o,S)};this.progressCallback_!==null&&f.addUploadProgressListener(g),f.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&f.removeUploadProgressListener(g),this.pendingConnection_=null;const b=f.getErrorCode()===kg.NO_ERROR,o=f.getStatus();if(!b||kX(o,this.additionalRetryCodes_)&&this.retry){const M=f.getErrorCode()===kg.ABORT;i(!1,new Q1(!1,null,M));return}const S=this.successCodes_.indexOf(o)!==-1;i(!0,new Q1(S,f))})},n=(i,u)=>{const f=this.resolve_,g=this.reject_,b=u.connection;if(u.wasSuccessCode)try{const o=this.callback_(b,b.getResponse());MX(o)?f(o):f()}catch(o){g(o)}else if(b!==null){const o=xR();o.serverResponse=b.getErrorText(),this.errorCallback_?g(this.errorCallback_(b,o)):g(o)}else if(u.canceled){const o=this.appDelete_?_B():vX();g(o)}else{const o=_X();g(o)}};this.canceled_?n(!1,new Q1(!1,null,!0)):this.backoffId_=IX(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&RX(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Q1{constructor(e,n,i){this.wasSuccessCode=e,this.connection=n,this.canceled=!!i}}function LX(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function OX(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function zX(t,e){e&&(t["X-Firebase-GMPID"]=e)}function BX(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function NX(t,e,n,i,u,f,g=!0,b=!1){const o=vB(t.urlParams),S=t.url+o,M=Object.assign({},t.headers);return zX(M,e),LX(M,n),OX(M,f),BX(M,i),new DX(S,t.method,M,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,u,g,b)}function VX(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function FX(...t){const e=VX();if(e!==void 0){const n=new e;for(let i=0;i<t.length;i++)n.append(t[i]);return n.getBlob()}else{if(wR())return new Blob(t);throw new js(Us.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function UX(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}function jX(t){if(typeof atob>"u")throw SX("base-64");return atob(t)}const _d={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class jS{constructor(e,n){this.data=e,this.contentType=n||null}}function $X(t,e){switch(t){case _d.RAW:return new jS(xB(e));case _d.BASE64:case _d.BASE64URL:return new jS(bB(t,e));case _d.DATA_URL:return new jS(GX(e),HX(e))}throw xR()}function xB(t){const e=[];for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const f=i,g=t.charCodeAt(++n);i=65536|(f&1023)<<10|g&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function qX(t){let e;try{e=decodeURIComponent(t)}catch{throw mx(_d.DATA_URL,"Malformed data URL.")}return xB(e)}function bB(t,e){switch(t){case _d.BASE64:{const u=e.indexOf("-")!==-1,f=e.indexOf("_")!==-1;if(u||f)throw mx(t,"Invalid character '"+(u?"-":"_")+"' found: is it base64url encoded?");break}case _d.BASE64URL:{const u=e.indexOf("+")!==-1,f=e.indexOf("/")!==-1;if(u||f)throw mx(t,"Invalid character '"+(u?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=jX(e)}catch(u){throw u.message.includes("polyfill")?u:mx(t,"Invalid character found")}const i=new Uint8Array(n.length);for(let u=0;u<n.length;u++)i[u]=n.charCodeAt(u);return i}class wB{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw mx(_d.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=n[1]||null;i!=null&&(this.base64=WX(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function GX(t){const e=new wB(t);return e.base64?bB(_d.BASE64,e.rest):qX(e.rest)}function HX(t){return new wB(t).contentType}function WX(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}class Qp{constructor(e,n){let i=0,u="";nL(e)?(this.data_=e,i=e.size,u=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=u}size(){return this.size_}type(){return this.type_}slice(e,n){if(nL(this.data_)){const i=this.data_,u=UX(i,e,n);return u===null?null:new Qp(u)}else{const i=new Uint8Array(this.data_.buffer,e,n-e);return new Qp(i,!0)}}static getBlob(...e){if(wR()){const n=e.map(i=>i instanceof Qp?i.data_:i);return new Qp(FX.apply(null,n))}else{const n=e.map(g=>bR(g)?$X(_d.RAW,g).data:g.data_);let i=0;n.forEach(g=>{i+=g.byteLength});const u=new Uint8Array(i);let f=0;return n.forEach(g=>{for(let b=0;b<g.length;b++)u[f++]=g[b]}),new Qp(u,!0)}}uploadData(){return this.data_}}function TB(t){let e;try{e=JSON.parse(t)}catch{return null}return PX(e)?e:null}function XX(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function ZX(t,e){const n=e.split("/").filter(i=>i.length>0).join("/");return t.length===0?n:t+"/"+n}function EB(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}function KX(t,e){return e}class vl{constructor(e,n,i,u){this.server=e,this.local=n||e,this.writable=!!i,this.xform=u||KX}}let J1=null;function YX(t){return!bR(t)||t.length<2?t:EB(t)}function SB(){if(J1)return J1;const t=[];t.push(new vl("bucket")),t.push(new vl("generation")),t.push(new vl("metageneration")),t.push(new vl("name","fullPath",!0));function e(f,g){return YX(g)}const n=new vl("name");n.xform=e,t.push(n);function i(f,g){return g!==void 0?Number(g):g}const u=new vl("size");return u.xform=i,t.push(u),t.push(new vl("timeCreated")),t.push(new vl("updated")),t.push(new vl("md5Hash",null,!0)),t.push(new vl("cacheControl",null,!0)),t.push(new vl("contentDisposition",null,!0)),t.push(new vl("contentEncoding",null,!0)),t.push(new vl("contentLanguage",null,!0)),t.push(new vl("contentType",null,!0)),t.push(new vl("metadata","customMetadata",!0)),J1=t,J1}function QX(t,e){function n(){const i=t.bucket,u=t.fullPath,f=new bc(i,u);return e._makeStorageReference(f)}Object.defineProperty(t,"ref",{get:n})}function JX(t,e,n){const i={};i.type="file";const u=n.length;for(let f=0;f<u;f++){const g=n[f];i[g.local]=g.xform(i,e[g.server])}return QX(i,t),i}function CB(t,e,n){const i=TB(e);return i===null?null:JX(t,i,n)}function eZ(t,e,n,i){const u=TB(e);if(u===null||!bR(u.downloadTokens))return null;const f=u.downloadTokens;if(f.length===0)return null;const g=encodeURIComponent;return f.split(",").map(S=>{const M=t.bucket,O=t.fullPath,N="/b/"+g(M)+"/o/"+g(O),j=TR(N,n,i),Z=vB({alt:"media",token:S});return j+Z})[0]}function tZ(t,e){const n={},i=e.length;for(let u=0;u<i;u++){const f=e[u];f.writable&&(n[f.server]=t[f.local])}return JSON.stringify(n)}class AB{constructor(e,n,i,u){this.url=e,this.method=n,this.handler=i,this.timeout=u,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function IB(t){if(!t)throw xR()}function nZ(t,e){function n(i,u){const f=CB(t,u,e);return IB(f!==null),f}return n}function rZ(t,e){function n(i,u){const f=CB(t,u,e);return IB(f!==null),eZ(f,u,t.host,t._protocol)}return n}function RB(t){function e(n,i){let u;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?u=gX():u=mX():n.getStatus()===402?u=pX(t.bucket):n.getStatus()===403?u=yX(t.path):u=i,u.status=n.getStatus(),u.serverResponse=i.serverResponse,u}return e}function iZ(t){const e=RB(t);function n(i,u){let f=e(i,u);return i.getStatus()===404&&(f=fX(t.path)),f.serverResponse=u.serverResponse,f}return n}function sZ(t,e,n){const i=e.fullServerUrl(),u=TR(i,t.host,t._protocol),f="GET",g=t.maxOperationRetryTime,b=new AB(u,f,rZ(t,n),g);return b.errorHandler=iZ(e),b}function oZ(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function aZ(t,e,n){const i=Object.assign({},n);return i.fullPath=t.path,i.size=e.size(),i.contentType||(i.contentType=oZ(null,e)),i}function lZ(t,e,n,i,u){const f=e.bucketOnlyServerUrl(),g={"X-Goog-Upload-Protocol":"multipart"};function b(){let ue="";for(let pe=0;pe<2;pe++)ue=ue+Math.random().toString().slice(2);return ue}const o=b();g["Content-Type"]="multipart/related; boundary="+o;const S=aZ(e,i,u),M=tZ(S,n),O="--"+o+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+M+`\r
--`+o+`\r
Content-Type: `+S.contentType+`\r
\r
`,N=`\r
--`+o+"--",j=Qp.getBlob(O,i,N);if(j===null)throw TX();const Z={name:S.fullPath},K=TR(f,t.host,t._protocol),Q="POST",ce=t.maxUploadRetryTime,ge=new AB(K,Q,nZ(t,n),ce);return ge.urlParams=Z,ge.headers=g,ge.body=j.uploadData(),ge.errorHandler=RB(e),ge}class cZ{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=kg.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=kg.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=kg.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,i,u,f){if(this.sent_)throw z0("cannot .send() more than once");if(xm(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),f!==void 0)for(const g in f)f.hasOwnProperty(g)&&this.xhr_.setRequestHeader(g,f[g].toString());return u!==void 0?this.xhr_.send(u):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw z0("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw z0("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw z0("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw z0("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class uZ extends cZ{initXhr(){this.xhr_.responseType="text"}}function MB(){return new uZ}class Ug{constructor(e,n){this._service=e,n instanceof bc?this._location=n:this._location=bc.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ug(e,n)}get root(){const e=new bc(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return EB(this._location.path)}get storage(){return this._service}get parent(){const e=XX(this._location.path);if(e===null)return null;const n=new bc(this._location.bucket,e);return new Ug(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw CX(e)}}function hZ(t,e,n){t._throwIfRoot("uploadBytes");const i=lZ(t.storage,t._location,SB(),new Qp(e,!0),n);return t.storage.makeRequestWithTokens(i,MB).then(u=>({metadata:u,ref:t}))}function dZ(t){t._throwIfRoot("getDownloadURL");const e=sZ(t.storage,t._location,SB());return t.storage.makeRequestWithTokens(e,MB).then(n=>{if(n===null)throw EX();return n})}function fZ(t,e){const n=ZX(t._location.path,e),i=new bc(t._location.bucket,n);return new Ug(t.storage,i)}function pZ(t){return/^[A-Za-z]+:\/\//.test(t)}function mZ(t,e){return new Ug(t,e)}function PB(t,e){if(t instanceof ER){const n=t;if(n._bucket==null)throw wX();const i=new Ug(n,n._bucket);return e!=null?PB(i,e):i}else return e!==void 0?fZ(t,e):t}function gZ(t,e){if(e&&pZ(e)){if(t instanceof ER)return mZ(t,e);throw aA("To use ref(service, url), the first argument must be a Storage instance.")}else return PB(t,e)}function iL(t,e){const n=e?.[yB];return n==null?null:bc.makeFromBucketSpec(n,t)}function yZ(t,e,n,i={}){t.host=`${e}:${n}`;const u=xm(e);u&&(CI(`https://${t.host}/b`),AI("Storage",!0)),t._isUsingEmulator=!0,t._protocol=u?"https":"http";const{mockUserToken:f}=i;f&&(t._overrideAuthToken=typeof f=="string"?f:Kz(f,t.app.options.projectId))}class ER{constructor(e,n,i,u,f,g=!1){this.app=e,this._authProvider=n,this._appCheckProvider=i,this._url=u,this._firebaseVersion=f,this._isUsingEmulator=g,this._bucket=null,this._host=gB,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=hX,this._maxUploadRetryTime=dX,this._requests=new Set,u!=null?this._bucket=bc.makeFromBucketSpec(u,this._host):this._bucket=iL(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=bc.makeFromBucketSpec(this._url,e):this._bucket=iL(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){rL("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){rL("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(_c(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ug(this,e)}_makeRequest(e,n,i,u,f=!0){if(this._deleted)return new AX(_B());{const g=NX(e,this._appId,i,u,n,this._firebaseVersion,f,this._isUsingEmulator);return this._requests.add(g),g.getPromise().then(()=>this._requests.delete(g),()=>this._requests.delete(g)),g}}async makeRequestWithTokens(e,n){const[i,u]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,i,u).getPromise()}}const sL="@firebase/storage",oL="0.14.0";const kB="storage";function _Z(t,e,n){return t=wo(t),hZ(t,e,n)}function vZ(t){return t=wo(t),dZ(t)}function xZ(t,e){return t=wo(t),gZ(t,e)}function bZ(t=MI(),e){t=wo(t);const i=NT(t,kB).getImmediate({identifier:e}),u=Wz("storage");return u&&wZ(i,...u),i}function wZ(t,e,n,i={}){yZ(t,e,n,i)}function TZ(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),u=t.getProvider("app-check-internal");return new ER(n,i,u,e,qg)}function EZ(){Og(new cm(kB,TZ,"PUBLIC").setMultipleInstances(!0)),bd(sL,oL,""),bd(sL,oL,"esm2020")}EZ();const SZ={apiKey:"AIzaSyCw4uyaxTqyqptlRFhIx4_EmaWiW0RNE5A",authDomain:"madhacks-31fc9.firebaseapp.com",projectId:"madhacks-31fc9",storageBucket:"madhacks-31fc9.firebasestorage.app",messagingSenderId:"188144649286",appId:"1:188144649286:web:1fa1eecddf1e2d010bf647"},SR=Jz(SZ),pb=Z7(SR);Oq(pb,I5).catch(console.error);const el=XW(SR),CZ=bZ(SR);function AZ(t,e){return Dq(pb,t,e)}function IZ(t,e){return Lq(pb,t,e)}function RZ(){return Vq(pb)}function MZ(t){return Nq(pb,e=>{const n=e??null;n?document.cookie=`sessionUid=${n.uid};path=/;max-age=604800`:document.cookie="sessionUid=;path=/;max-age=0",t(n)})}const zd=W.createContext({user:null,loading:!0});function PZ({children:t}){const[e,n]=W.useState(null),[i,u]=W.useState(!0);return W.useEffect(()=>{const f=MZ(g=>{n(g),u(!1)});return()=>f()},[]),i?U.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"system-ui, sans-serif"},children:"Loading session"}):U.jsx(zd.Provider,{value:{user:e,loading:i},children:t})}const Fx={black:"#000",white:"#fff"},Yy={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},Qy={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},Jy={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},e_={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},t_={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"},B0={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},kZ={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function Gf(t,...e){const n=new URL(`https://mui.com/production-error/?code=${t}`);return e.forEach(i=>n.searchParams.append("args[]",i)),`Minified MUI error #${t}; visit ${n} for the full message.`}const Rd="$$material";function _T(){return _T=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},_T.apply(null,arguments)}function DZ(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function LZ(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var OZ=(function(){function t(n){var i=this;this._insertTag=function(u){var f;i.tags.length===0?i.insertionPoint?f=i.insertionPoint.nextSibling:i.prepend?f=i.container.firstChild:f=i.before:f=i.tags[i.tags.length-1].nextSibling,i.container.insertBefore(u,f),i.tags.push(u)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(i){i.forEach(this._insertTag)},e.insert=function(i){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(LZ(this));var u=this.tags[this.tags.length-1];if(this.isSpeedy){var f=DZ(u);try{f.insertRule(i,f.cssRules.length)}catch{}}else u.appendChild(document.createTextNode(i));this.ctr++},e.flush=function(){this.tags.forEach(function(i){var u;return(u=i.parentNode)==null?void 0:u.removeChild(i)}),this.tags=[],this.ctr=0},t})(),Za="-ms-",vT="-moz-",Bi="-webkit-",DB="comm",CR="rule",AR="decl",zZ="@import",LB="@keyframes",BZ="@layer",NZ=Math.abs,nE=String.fromCharCode,VZ=Object.assign;function FZ(t,e){return _a(t,0)^45?(((e<<2^_a(t,0))<<2^_a(t,1))<<2^_a(t,2))<<2^_a(t,3):0}function OB(t){return t.trim()}function UZ(t,e){return(t=e.exec(t))?t[0]:t}function Ni(t,e,n){return t.replace(e,n)}function lA(t,e){return t.indexOf(e)}function _a(t,e){return t.charCodeAt(e)|0}function Ux(t,e,n){return t.slice(e,n)}function md(t){return t.length}function IR(t){return t.length}function ew(t,e){return e.push(t),t}function jZ(t,e){return t.map(e).join("")}var rE=1,N_=1,zB=0,ql=0,go=0,av="";function iE(t,e,n,i,u,f,g){return{value:t,root:e,parent:n,type:i,props:u,children:f,line:rE,column:N_,length:g,return:""}}function N0(t,e){return VZ(iE("",null,null,"",null,null,0),t,{length:-t.length},e)}function $Z(){return go}function qZ(){return go=ql>0?_a(av,--ql):0,N_--,go===10&&(N_=1,rE--),go}function wc(){return go=ql<zB?_a(av,ql++):0,N_++,go===10&&(N_=1,rE++),go}function Md(){return _a(av,ql)}function Ow(){return ql}function mb(t,e){return Ux(av,t,e)}function jx(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function BB(t){return rE=N_=1,zB=md(av=t),ql=0,[]}function NB(t){return av="",t}function zw(t){return OB(mb(ql-1,cA(t===91?t+2:t===40?t+1:t)))}function GZ(t){for(;(go=Md())&&go<33;)wc();return jx(t)>2||jx(go)>3?"":" "}function HZ(t,e){for(;--e&&wc()&&!(go<48||go>102||go>57&&go<65||go>70&&go<97););return mb(t,Ow()+(e<6&&Md()==32&&wc()==32))}function cA(t){for(;wc();)switch(go){case t:return ql;case 34:case 39:t!==34&&t!==39&&cA(go);break;case 40:t===41&&cA(t);break;case 92:wc();break}return ql}function WZ(t,e){for(;wc()&&t+go!==57;)if(t+go===84&&Md()===47)break;return"/*"+mb(e,ql-1)+"*"+nE(t===47?t:wc())}function XZ(t){for(;!jx(Md());)wc();return mb(t,ql)}function ZZ(t){return NB(Bw("",null,null,null,[""],t=BB(t),0,[0],t))}function Bw(t,e,n,i,u,f,g,b,o){for(var S=0,M=0,O=g,N=0,j=0,Z=0,K=1,Q=1,ce=1,ge=0,ue="",pe=u,me=f,Te=i,ae=ue;Q;)switch(Z=ge,ge=wc()){case 40:if(Z!=108&&_a(ae,O-1)==58){lA(ae+=Ni(zw(ge),"&","&\f"),"&\f")!=-1&&(ce=-1);break}case 34:case 39:case 91:ae+=zw(ge);break;case 9:case 10:case 13:case 32:ae+=GZ(Z);break;case 92:ae+=HZ(Ow()-1,7);continue;case 47:switch(Md()){case 42:case 47:ew(KZ(WZ(wc(),Ow()),e,n),o);break;default:ae+="/"}break;case 123*K:b[S++]=md(ae)*ce;case 125*K:case 59:case 0:switch(ge){case 0:case 125:Q=0;case 59+M:ce==-1&&(ae=Ni(ae,/\f/g,"")),j>0&&md(ae)-O&&ew(j>32?lL(ae+";",i,n,O-1):lL(Ni(ae," ","")+";",i,n,O-2),o);break;case 59:ae+=";";default:if(ew(Te=aL(ae,e,n,S,M,u,b,ue,pe=[],me=[],O),f),ge===123)if(M===0)Bw(ae,e,Te,Te,pe,f,O,b,me);else switch(N===99&&_a(ae,3)===110?100:N){case 100:case 108:case 109:case 115:Bw(t,Te,Te,i&&ew(aL(t,Te,Te,0,0,u,b,ue,u,pe=[],O),me),u,me,O,b,i?pe:me);break;default:Bw(ae,Te,Te,Te,[""],me,0,b,me)}}S=M=j=0,K=ce=1,ue=ae="",O=g;break;case 58:O=1+md(ae),j=Z;default:if(K<1){if(ge==123)--K;else if(ge==125&&K++==0&&qZ()==125)continue}switch(ae+=nE(ge),ge*K){case 38:ce=M>0?1:(ae+="\f",-1);break;case 44:b[S++]=(md(ae)-1)*ce,ce=1;break;case 64:Md()===45&&(ae+=zw(wc())),N=Md(),M=O=md(ue=ae+=XZ(Ow())),ge++;break;case 45:Z===45&&md(ae)==2&&(K=0)}}return f}function aL(t,e,n,i,u,f,g,b,o,S,M){for(var O=u-1,N=u===0?f:[""],j=IR(N),Z=0,K=0,Q=0;Z<i;++Z)for(var ce=0,ge=Ux(t,O+1,O=NZ(K=g[Z])),ue=t;ce<j;++ce)(ue=OB(K>0?N[ce]+" "+ge:Ni(ge,/&\f/g,N[ce])))&&(o[Q++]=ue);return iE(t,e,n,u===0?CR:b,o,S,M)}function KZ(t,e,n){return iE(t,e,n,DB,nE($Z()),Ux(t,2,-2),0)}function lL(t,e,n,i){return iE(t,e,n,AR,Ux(t,0,i),Ux(t,i+1,-1),i)}function C_(t,e){for(var n="",i=IR(t),u=0;u<i;u++)n+=e(t[u],u,t,e)||"";return n}function YZ(t,e,n,i){switch(t.type){case BZ:if(t.children.length)break;case zZ:case AR:return t.return=t.return||t.value;case DB:return"";case LB:return t.return=t.value+"{"+C_(t.children,i)+"}";case CR:t.value=t.props.join(",")}return md(n=C_(t.children,i))?t.return=t.value+"{"+n+"}":""}function QZ(t){var e=IR(t);return function(n,i,u,f){for(var g="",b=0;b<e;b++)g+=t[b](n,i,u,f)||"";return g}}function JZ(t){return function(e){e.root||(e=e.return)&&t(e)}}function VB(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var eK=function(e,n,i){for(var u=0,f=0;u=f,f=Md(),u===38&&f===12&&(n[i]=1),!jx(f);)wc();return mb(e,ql)},tK=function(e,n){var i=-1,u=44;do switch(jx(u)){case 0:u===38&&Md()===12&&(n[i]=1),e[i]+=eK(ql-1,n,i);break;case 2:e[i]+=zw(u);break;case 4:if(u===44){e[++i]=Md()===58?"&\f":"",n[i]=e[i].length;break}default:e[i]+=nE(u)}while(u=wc());return e},nK=function(e,n){return NB(tK(BB(e),n))},cL=new WeakMap,rK=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,i=e.parent,u=e.column===i.column&&e.line===i.line;i.type!=="rule";)if(i=i.parent,!i)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!cL.get(i))&&!u){cL.set(e,!0);for(var f=[],g=nK(n,f),b=i.props,o=0,S=0;o<g.length;o++)for(var M=0;M<b.length;M++,S++)e.props[S]=f[o]?g[o].replace(/&\f/g,b[M]):b[M]+" "+g[o]}}},iK=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function FB(t,e){switch(FZ(t,e)){case 5103:return Bi+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Bi+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Bi+t+vT+t+Za+t+t;case 6828:case 4268:return Bi+t+Za+t+t;case 6165:return Bi+t+Za+"flex-"+t+t;case 5187:return Bi+t+Ni(t,/(\w+).+(:[^]+)/,Bi+"box-$1$2"+Za+"flex-$1$2")+t;case 5443:return Bi+t+Za+"flex-item-"+Ni(t,/flex-|-self/,"")+t;case 4675:return Bi+t+Za+"flex-line-pack"+Ni(t,/align-content|flex-|-self/,"")+t;case 5548:return Bi+t+Za+Ni(t,"shrink","negative")+t;case 5292:return Bi+t+Za+Ni(t,"basis","preferred-size")+t;case 6060:return Bi+"box-"+Ni(t,"-grow","")+Bi+t+Za+Ni(t,"grow","positive")+t;case 4554:return Bi+Ni(t,/([^-])(transform)/g,"$1"+Bi+"$2")+t;case 6187:return Ni(Ni(Ni(t,/(zoom-|grab)/,Bi+"$1"),/(image-set)/,Bi+"$1"),t,"")+t;case 5495:case 3959:return Ni(t,/(image-set\([^]*)/,Bi+"$1$`$1");case 4968:return Ni(Ni(t,/(.+:)(flex-)?(.*)/,Bi+"box-pack:$3"+Za+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Bi+t+t;case 4095:case 3583:case 4068:case 2532:return Ni(t,/(.+)-inline(.+)/,Bi+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(md(t)-1-e>6)switch(_a(t,e+1)){case 109:if(_a(t,e+4)!==45)break;case 102:return Ni(t,/(.+:)(.+)-([^]+)/,"$1"+Bi+"$2-$3$1"+vT+(_a(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~lA(t,"stretch")?FB(Ni(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(_a(t,e+1)!==115)break;case 6444:switch(_a(t,md(t)-3-(~lA(t,"!important")&&10))){case 107:return Ni(t,":",":"+Bi)+t;case 101:return Ni(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Bi+(_a(t,14)===45?"inline-":"")+"box$3$1"+Bi+"$2$3$1"+Za+"$2box$3")+t}break;case 5936:switch(_a(t,e+11)){case 114:return Bi+t+Za+Ni(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Bi+t+Za+Ni(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Bi+t+Za+Ni(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Bi+t+Za+t+t}return t}var sK=function(e,n,i,u){if(e.length>-1&&!e.return)switch(e.type){case AR:e.return=FB(e.value,e.length);break;case LB:return C_([N0(e,{value:Ni(e.value,"@","@"+Bi)})],u);case CR:if(e.length)return jZ(e.props,function(f){switch(UZ(f,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return C_([N0(e,{props:[Ni(f,/:(read-\w+)/,":"+vT+"$1")]})],u);case"::placeholder":return C_([N0(e,{props:[Ni(f,/:(plac\w+)/,":"+Bi+"input-$1")]}),N0(e,{props:[Ni(f,/:(plac\w+)/,":"+vT+"$1")]}),N0(e,{props:[Ni(f,/:(plac\w+)/,Za+"input-$1")]})],u)}return""})}},oK=[sK],aK=function(e){var n=e.key;if(n==="css"){var i=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(i,function(K){var Q=K.getAttribute("data-emotion");Q.indexOf(" ")!==-1&&(document.head.appendChild(K),K.setAttribute("data-s",""))})}var u=e.stylisPlugins||oK,f={},g,b=[];g=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(K){for(var Q=K.getAttribute("data-emotion").split(" "),ce=1;ce<Q.length;ce++)f[Q[ce]]=!0;b.push(K)});var o,S=[rK,iK];{var M,O=[YZ,JZ(function(K){M.insert(K)})],N=QZ(S.concat(u,O)),j=function(Q){return C_(ZZ(Q),N)};o=function(Q,ce,ge,ue){M=ge,j(Q?Q+"{"+ce.styles+"}":ce.styles),ue&&(Z.inserted[ce.name]=!0)}}var Z={key:n,sheet:new OZ({key:n,container:g,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:f,registered:{},insert:o};return Z.sheet.hydrate(b),Z},$S={exports:{}},$i={};var uL;function lK(){if(uL)return $i;uL=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,n=t?Symbol.for("react.portal"):60106,i=t?Symbol.for("react.fragment"):60107,u=t?Symbol.for("react.strict_mode"):60108,f=t?Symbol.for("react.profiler"):60114,g=t?Symbol.for("react.provider"):60109,b=t?Symbol.for("react.context"):60110,o=t?Symbol.for("react.async_mode"):60111,S=t?Symbol.for("react.concurrent_mode"):60111,M=t?Symbol.for("react.forward_ref"):60112,O=t?Symbol.for("react.suspense"):60113,N=t?Symbol.for("react.suspense_list"):60120,j=t?Symbol.for("react.memo"):60115,Z=t?Symbol.for("react.lazy"):60116,K=t?Symbol.for("react.block"):60121,Q=t?Symbol.for("react.fundamental"):60117,ce=t?Symbol.for("react.responder"):60118,ge=t?Symbol.for("react.scope"):60119;function ue(me){if(typeof me=="object"&&me!==null){var Te=me.$$typeof;switch(Te){case e:switch(me=me.type,me){case o:case S:case i:case f:case u:case O:return me;default:switch(me=me&&me.$$typeof,me){case b:case M:case Z:case j:case g:return me;default:return Te}}case n:return Te}}}function pe(me){return ue(me)===S}return $i.AsyncMode=o,$i.ConcurrentMode=S,$i.ContextConsumer=b,$i.ContextProvider=g,$i.Element=e,$i.ForwardRef=M,$i.Fragment=i,$i.Lazy=Z,$i.Memo=j,$i.Portal=n,$i.Profiler=f,$i.StrictMode=u,$i.Suspense=O,$i.isAsyncMode=function(me){return pe(me)||ue(me)===o},$i.isConcurrentMode=pe,$i.isContextConsumer=function(me){return ue(me)===b},$i.isContextProvider=function(me){return ue(me)===g},$i.isElement=function(me){return typeof me=="object"&&me!==null&&me.$$typeof===e},$i.isForwardRef=function(me){return ue(me)===M},$i.isFragment=function(me){return ue(me)===i},$i.isLazy=function(me){return ue(me)===Z},$i.isMemo=function(me){return ue(me)===j},$i.isPortal=function(me){return ue(me)===n},$i.isProfiler=function(me){return ue(me)===f},$i.isStrictMode=function(me){return ue(me)===u},$i.isSuspense=function(me){return ue(me)===O},$i.isValidElementType=function(me){return typeof me=="string"||typeof me=="function"||me===i||me===S||me===f||me===u||me===O||me===N||typeof me=="object"&&me!==null&&(me.$$typeof===Z||me.$$typeof===j||me.$$typeof===g||me.$$typeof===b||me.$$typeof===M||me.$$typeof===Q||me.$$typeof===ce||me.$$typeof===ge||me.$$typeof===K)},$i.typeOf=ue,$i}var hL;function cK(){return hL||(hL=1,$S.exports=lK()),$S.exports}var qS,dL;function uK(){if(dL)return qS;dL=1;var t=cK(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},u={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},f={};f[t.ForwardRef]=i,f[t.Memo]=u;function g(Z){return t.isMemo(Z)?u:f[Z.$$typeof]||e}var b=Object.defineProperty,o=Object.getOwnPropertyNames,S=Object.getOwnPropertySymbols,M=Object.getOwnPropertyDescriptor,O=Object.getPrototypeOf,N=Object.prototype;function j(Z,K,Q){if(typeof K!="string"){if(N){var ce=O(K);ce&&ce!==N&&j(Z,ce,Q)}var ge=o(K);S&&(ge=ge.concat(S(K)));for(var ue=g(Z),pe=g(K),me=0;me<ge.length;++me){var Te=ge[me];if(!n[Te]&&!(Q&&Q[Te])&&!(pe&&pe[Te])&&!(ue&&ue[Te])){var ae=M(K,Te);try{b(Z,Te,ae)}catch{}}}}return Z}return qS=j,qS}uK();var hK=!0;function UB(t,e,n){var i="";return n.split(" ").forEach(function(u){t[u]!==void 0?e.push(t[u]+";"):u&&(i+=u+" ")}),i}var RR=function(e,n,i){var u=e.key+"-"+n.name;(i===!1||hK===!1)&&e.registered[u]===void 0&&(e.registered[u]=n.styles)},MR=function(e,n,i){RR(e,n,i);var u=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var f=n;do e.insert(n===f?"."+u:"",f,e.sheet,!0),f=f.next;while(f!==void 0)}};function dK(t){for(var e=0,n,i=0,u=t.length;u>=4;++i,u-=4)n=t.charCodeAt(i)&255|(t.charCodeAt(++i)&255)<<8|(t.charCodeAt(++i)&255)<<16|(t.charCodeAt(++i)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(u){case 3:e^=(t.charCodeAt(i+2)&255)<<16;case 2:e^=(t.charCodeAt(i+1)&255)<<8;case 1:e^=t.charCodeAt(i)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var fK={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},pK=/[A-Z]|^ms/g,mK=/_EMO_([^_]+?)_([^]*?)_EMO_/g,jB=function(e){return e.charCodeAt(1)===45},fL=function(e){return e!=null&&typeof e!="boolean"},GS=VB(function(t){return jB(t)?t:t.replace(pK,"-$&").toLowerCase()}),pL=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(mK,function(i,u,f){return gd={name:u,styles:f,next:gd},u})}return fK[e]!==1&&!jB(e)&&typeof n=="number"&&n!==0?n+"px":n};function $x(t,e,n){if(n==null)return"";var i=n;if(i.__emotion_styles!==void 0)return i;switch(typeof n){case"boolean":return"";case"object":{var u=n;if(u.anim===1)return gd={name:u.name,styles:u.styles,next:gd},u.name;var f=n;if(f.styles!==void 0){var g=f.next;if(g!==void 0)for(;g!==void 0;)gd={name:g.name,styles:g.styles,next:gd},g=g.next;var b=f.styles+";";return b}return gK(t,e,n)}case"function":{if(t!==void 0){var o=gd,S=n(t);return gd=o,$x(t,e,S)}break}}var M=n;if(e==null)return M;var O=e[M];return O!==void 0?O:M}function gK(t,e,n){var i="";if(Array.isArray(n))for(var u=0;u<n.length;u++)i+=$x(t,e,n[u])+";";else for(var f in n){var g=n[f];if(typeof g!="object"){var b=g;e!=null&&e[b]!==void 0?i+=f+"{"+e[b]+"}":fL(b)&&(i+=GS(f)+":"+pL(f,b)+";")}else if(Array.isArray(g)&&typeof g[0]=="string"&&(e==null||e[g[0]]===void 0))for(var o=0;o<g.length;o++)fL(g[o])&&(i+=GS(f)+":"+pL(f,g[o])+";");else{var S=$x(t,e,g);switch(f){case"animation":case"animationName":{i+=GS(f)+":"+S+";";break}default:i+=f+"{"+S+"}"}}}return i}var mL=/label:\s*([^\s;{]+)\s*(;|$)/g,gd;function gb(t,e,n){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var i=!0,u="";gd=void 0;var f=t[0];if(f==null||f.raw===void 0)i=!1,u+=$x(n,e,f);else{var g=f;u+=g[0]}for(var b=1;b<t.length;b++)if(u+=$x(n,e,t[b]),i){var o=f;u+=o[b]}mL.lastIndex=0;for(var S="",M;(M=mL.exec(u))!==null;)S+="-"+M[1];var O=dK(u)+S;return{name:O,styles:u,next:gd}}var yK=function(e){return e()},$B=uC.useInsertionEffect?uC.useInsertionEffect:!1,qB=$B||yK,gL=$B||W.useLayoutEffect,GB=W.createContext(typeof HTMLElement<"u"?aK({key:"css"}):null);GB.Provider;var PR=function(e){return W.forwardRef(function(n,i){var u=W.useContext(GB);return e(n,u,i)})},yb=W.createContext({}),kR={}.hasOwnProperty,uA="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",_K=function(e,n){var i={};for(var u in n)kR.call(n,u)&&(i[u]=n[u]);return i[uA]=e,i},vK=function(e){var n=e.cache,i=e.serialized,u=e.isStringTag;return RR(n,i,u),qB(function(){return MR(n,i,u)}),null},xK=PR(function(t,e,n){var i=t.css;typeof i=="string"&&e.registered[i]!==void 0&&(i=e.registered[i]);var u=t[uA],f=[i],g="";typeof t.className=="string"?g=UB(e.registered,f,t.className):t.className!=null&&(g=t.className+" ");var b=gb(f,void 0,W.useContext(yb));g+=e.key+"-"+b.name;var o={};for(var S in t)kR.call(t,S)&&S!=="css"&&S!==uA&&(o[S]=t[S]);return o.className=g,n&&(o.ref=n),W.createElement(W.Fragment,null,W.createElement(vK,{cache:e,serialized:b,isStringTag:typeof u=="string"}),W.createElement(u,o))}),bK=xK,yL=function(e,n){var i=arguments;if(n==null||!kR.call(n,"css"))return W.createElement.apply(void 0,i);var u=i.length,f=new Array(u);f[0]=bK,f[1]=_K(e,n);for(var g=2;g<u;g++)f[g]=i[g];return W.createElement.apply(null,f)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(yL||(yL={}));var wK=PR(function(t,e){var n=t.styles,i=gb([n],void 0,W.useContext(yb)),u=W.useRef();return gL(function(){var f=e.key+"-global",g=new e.sheet.constructor({key:f,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),b=!1,o=document.querySelector('style[data-emotion="'+f+" "+i.name+'"]');return e.sheet.tags.length&&(g.before=e.sheet.tags[0]),o!==null&&(b=!0,o.setAttribute("data-emotion",f),g.hydrate([o])),u.current=[g,b],function(){g.flush()}},[e]),gL(function(){var f=u.current,g=f[0],b=f[1];if(b){f[1]=!1;return}if(i.next!==void 0&&MR(e,i.next,!0),g.tags.length){var o=g.tags[g.tags.length-1].nextElementSibling;g.before=o,g.flush()}e.insert("",i,g,!1)},[e,i.name]),null});function DR(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return gb(e)}function Gl(){var t=DR.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var TK=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,EK=VB(function(t){return TK.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),SK=EK,CK=function(e){return e!=="theme"},_L=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?SK:CK},vL=function(e,n,i){var u;if(n){var f=n.shouldForwardProp;u=e.__emotion_forwardProp&&f?function(g){return e.__emotion_forwardProp(g)&&f(g)}:f}return typeof u!="function"&&i&&(u=e.__emotion_forwardProp),u},AK=function(e){var n=e.cache,i=e.serialized,u=e.isStringTag;return RR(n,i,u),qB(function(){return MR(n,i,u)}),null},IK=function t(e,n){var i=e.__emotion_real===e,u=i&&e.__emotion_base||e,f,g;n!==void 0&&(f=n.label,g=n.target);var b=vL(e,n,i),o=b||_L(u),S=!o("as");return function(){var M=arguments,O=i&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(f!==void 0&&O.push("label:"+f+";"),M[0]==null||M[0].raw===void 0)O.push.apply(O,M);else{var N=M[0];O.push(N[0]);for(var j=M.length,Z=1;Z<j;Z++)O.push(M[Z],N[Z])}var K=PR(function(Q,ce,ge){var ue=S&&Q.as||u,pe="",me=[],Te=Q;if(Q.theme==null){Te={};for(var ae in Q)Te[ae]=Q[ae];Te.theme=W.useContext(yb)}typeof Q.className=="string"?pe=UB(ce.registered,me,Q.className):Q.className!=null&&(pe=Q.className+" ");var re=gb(O.concat(me),ce.registered,Te);pe+=ce.key+"-"+re.name,g!==void 0&&(pe+=" "+g);var he=S&&b===void 0?_L(ue):o,se={};for(var ve in Q)S&&ve==="as"||he(ve)&&(se[ve]=Q[ve]);return se.className=pe,ge&&(se.ref=ge),W.createElement(W.Fragment,null,W.createElement(AK,{cache:ce,serialized:re,isStringTag:typeof ue=="string"}),W.createElement(ue,se))});return K.displayName=f!==void 0?f:"Styled("+(typeof u=="string"?u:u.displayName||u.name||"Component")+")",K.defaultProps=e.defaultProps,K.__emotion_real=K,K.__emotion_base=u,K.__emotion_styles=O,K.__emotion_forwardProp=b,Object.defineProperty(K,"toString",{value:function(){return"."+g}}),K.withComponent=function(Q,ce){var ge=t(Q,_T({},n,ce,{shouldForwardProp:vL(K,ce,!0)}));return ge.apply(void 0,O)},K}},RK=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],hA=IK.bind(null);RK.forEach(function(t){hA[t]=hA(t)});function MK(t){return t==null||Object.keys(t).length===0}function HB(t){const{styles:e,defaultTheme:n={}}=t,i=typeof e=="function"?u=>e(MK(u)?n:u):e;return U.jsx(wK,{styles:i})}function WB(t,e){return hA(t,e)}function PK(t,e){Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))}const xL=[];function im(t){return xL[0]=t,gb(xL)}var HS={exports:{}},es={};var bL;function kK(){if(bL)return es;bL=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),f=Symbol.for("react.consumer"),g=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),o=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),N=Symbol.for("react.view_transition"),j=Symbol.for("react.client.reference");function Z(K){if(typeof K=="object"&&K!==null){var Q=K.$$typeof;switch(Q){case t:switch(K=K.type,K){case n:case u:case i:case o:case S:case N:return K;default:switch(K=K&&K.$$typeof,K){case g:case b:case O:case M:return K;case f:return K;default:return Q}}case e:return Q}}}return es.ContextConsumer=f,es.ContextProvider=g,es.Element=t,es.ForwardRef=b,es.Fragment=n,es.Lazy=O,es.Memo=M,es.Portal=e,es.Profiler=u,es.StrictMode=i,es.Suspense=o,es.SuspenseList=S,es.isContextConsumer=function(K){return Z(K)===f},es.isContextProvider=function(K){return Z(K)===g},es.isElement=function(K){return typeof K=="object"&&K!==null&&K.$$typeof===t},es.isForwardRef=function(K){return Z(K)===b},es.isFragment=function(K){return Z(K)===n},es.isLazy=function(K){return Z(K)===O},es.isMemo=function(K){return Z(K)===M},es.isPortal=function(K){return Z(K)===e},es.isProfiler=function(K){return Z(K)===u},es.isStrictMode=function(K){return Z(K)===i},es.isSuspense=function(K){return Z(K)===o},es.isSuspenseList=function(K){return Z(K)===S},es.isValidElementType=function(K){return typeof K=="string"||typeof K=="function"||K===n||K===u||K===i||K===o||K===S||typeof K=="object"&&K!==null&&(K.$$typeof===O||K.$$typeof===M||K.$$typeof===g||K.$$typeof===f||K.$$typeof===b||K.$$typeof===j||K.getModuleId!==void 0)},es.typeOf=Z,es}var wL;function DK(){return wL||(wL=1,HS.exports=kK()),HS.exports}var XB=DK();function yd(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function ZB(t){if(W.isValidElement(t)||XB.isValidElementType(t)||!yd(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=ZB(t[n])}),e}function Jo(t,e,n={clone:!0}){const i=n.clone?{...t}:t;return yd(t)&&yd(e)&&Object.keys(e).forEach(u=>{W.isValidElement(e[u])||XB.isValidElementType(e[u])?i[u]=e[u]:yd(e[u])&&Object.prototype.hasOwnProperty.call(t,u)&&yd(t[u])?i[u]=Jo(t[u],e[u],n):n.clone?i[u]=yd(e[u])?ZB(e[u]):e[u]:i[u]=e[u]}),i}const LK=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,i)=>n.val-i.val),e.reduce((n,i)=>({...n,[i.key]:i.val}),{})};function OK(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:i=5,...u}=t,f=LK(e),g=Object.keys(f);function b(N){return`@media (min-width:${typeof e[N]=="number"?e[N]:N}${n})`}function o(N){return`@media (max-width:${(typeof e[N]=="number"?e[N]:N)-i/100}${n})`}function S(N,j){const Z=g.indexOf(j);return`@media (min-width:${typeof e[N]=="number"?e[N]:N}${n}) and (max-width:${(Z!==-1&&typeof e[g[Z]]=="number"?e[g[Z]]:j)-i/100}${n})`}function M(N){return g.indexOf(N)+1<g.length?S(N,g[g.indexOf(N)+1]):b(N)}function O(N){const j=g.indexOf(N);return j===0?b(g[1]):j===g.length-1?o(g[j]):S(N,g[g.indexOf(N)+1]).replace("@media","@media not all and")}return{keys:g,values:f,up:b,down:o,between:S,only:M,not:O,unit:n,...u}}function TL(t,e){if(!t.containerQueries)return e;const n=Object.keys(e).filter(i=>i.startsWith("@container")).sort((i,u)=>{const f=/min-width:\s*([0-9.]+)/;return+(i.match(f)?.[1]||0)-+(u.match(f)?.[1]||0)});return n.length?n.reduce((i,u)=>{const f=e[u];return delete i[u],i[u]=f,i},{...e}):e}function zK(t,e){return e==="@"||e.startsWith("@")&&(t.some(n=>e.startsWith(`@${n}`))||!!e.match(/^@\d/))}function BK(t,e){const n=e.match(/^@([^/]+)?\/?(.+)?$/);if(!n)return null;const[,i,u]=n,f=Number.isNaN(+i)?i||0:+i;return t.containerQueries(u).up(f)}function NK(t){const e=(f,g)=>f.replace("@media",g?`@container ${g}`:"@container");function n(f,g){f.up=(...b)=>e(t.breakpoints.up(...b),g),f.down=(...b)=>e(t.breakpoints.down(...b),g),f.between=(...b)=>e(t.breakpoints.between(...b),g),f.only=(...b)=>e(t.breakpoints.only(...b),g),f.not=(...b)=>{const o=e(t.breakpoints.not(...b),g);return o.includes("not all and")?o.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):o}}const i={},u=f=>(n(i,f),i);return n(u),{...t,containerQueries:u}}const VK={borderRadius:4};function gx(t,e){return e?Jo(t,e,{clone:!1}):t}const sE={xs:0,sm:600,md:900,lg:1200,xl:1536},EL={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${sE[t]}px)`},FK={containerQueries:t=>({up:e=>{let n=typeof e=="number"?e:sE[e]||e;return typeof n=="number"&&(n=`${n}px`),t?`@container ${t} (min-width:${n})`:`@container (min-width:${n})`}})};function ph(t,e,n){const i=t.theme||{};if(Array.isArray(e)){const f=i.breakpoints||EL;return e.reduce((g,b,o)=>(g[f.up(f.keys[o])]=n(e[o]),g),{})}if(typeof e=="object"){const f=i.breakpoints||EL;return Object.keys(e).reduce((g,b)=>{if(zK(f.keys,b)){const o=BK(i.containerQueries?i:FK,b);o&&(g[o]=n(e[b],b))}else if(Object.keys(f.values||sE).includes(b)){const o=f.up(b);g[o]=n(e[b],b)}else{const o=b;g[o]=e[o]}return g},{})}return n(e)}function KB(t={}){return t.keys?.reduce((n,i)=>{const u=t.up(i);return n[u]={},n},{})||{}}function dA(t,e){return t.reduce((n,i)=>{const u=n[i];return(!u||Object.keys(u).length===0)&&delete n[i],n},e)}function UK(t,...e){const n=KB(t),i=[n,...e].reduce((u,f)=>Jo(u,f),{});return dA(Object.keys(n),i)}function jK(t,e){if(typeof t!="object")return{};const n={},i=Object.keys(e);return Array.isArray(t)?i.forEach((u,f)=>{f<t.length&&(n[u]=!0)}):i.forEach(u=>{t[u]!=null&&(n[u]=!0)}),n}function WS({values:t,breakpoints:e,base:n}){const i=n||jK(t,e),u=Object.keys(i);if(u.length===0)return t;let f;return u.reduce((g,b,o)=>(Array.isArray(t)?(g[b]=t[o]!=null?t[o]:t[f],f=o):typeof t=="object"?(g[b]=t[b]!=null?t[b]:t[f],f=b):g[b]=t,g),{})}function tn(t){if(typeof t!="string")throw new Error(Gf(7));return t.charAt(0).toUpperCase()+t.slice(1)}function oE(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const i=`vars.${e}`.split(".").reduce((u,f)=>u&&u[f]?u[f]:null,t);if(i!=null)return i}return e.split(".").reduce((i,u)=>i&&i[u]!=null?i[u]:null,t)}function xT(t,e,n,i=n){let u;return typeof t=="function"?u=t(n):Array.isArray(t)?u=t[n]||i:u=oE(t,n)||i,e&&(u=e(u,i,t)),u}function Js(t){const{prop:e,cssProperty:n=t.prop,themeKey:i,transform:u}=t,f=g=>{if(g[e]==null)return null;const b=g[e],o=g.theme,S=oE(o,i)||{};return ph(g,b,O=>{let N=xT(S,u,O);return O===N&&typeof O=="string"&&(N=xT(S,u,`${e}${O==="default"?"":tn(O)}`,O)),n===!1?N:{[n]:N}})};return f.propTypes={},f.filterProps=[e],f}function $K(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const qK={m:"margin",p:"padding"},GK={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},SL={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},HK=$K(t=>{if(t.length>2)if(SL[t])t=SL[t];else return[t];const[e,n]=t.split(""),i=qK[e],u=GK[n]||"";return Array.isArray(u)?u.map(f=>i+f):[i+u]}),LR=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],OR=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...LR,...OR];function _b(t,e,n,i){const u=oE(t,e,!0)??n;return typeof u=="number"||typeof u=="string"?f=>typeof f=="string"?f:typeof u=="string"?u.startsWith("var(")&&f===0?0:u.startsWith("var(")&&f===1?u:`calc(${f} * ${u})`:u*f:Array.isArray(u)?f=>{if(typeof f=="string")return f;const g=Math.abs(f),b=u[g];return f>=0?b:typeof b=="number"?-b:typeof b=="string"&&b.startsWith("var(")?`calc(-1 * ${b})`:`-${b}`}:typeof u=="function"?u:()=>{}}function aE(t){return _b(t,"spacing",8)}function jg(t,e){return typeof e=="string"||e==null?e:t(e)}function WK(t,e){return n=>t.reduce((i,u)=>(i[u]=jg(e,n),i),{})}function XK(t,e,n,i){if(!e.includes(n))return null;const u=HK(n),f=WK(u,i),g=t[n];return ph(t,g,f)}function YB(t,e){const n=aE(t.theme);return Object.keys(t).map(i=>XK(t,e,i,n)).reduce(gx,{})}function Bs(t){return YB(t,LR)}Bs.propTypes={};Bs.filterProps=LR;function Ns(t){return YB(t,OR)}Ns.propTypes={};Ns.filterProps=OR;function QB(t=8,e=aE({spacing:t})){if(t.mui)return t;const n=(...i)=>(i.length===0?[1]:i).map(f=>{const g=e(f);return typeof g=="number"?`${g}px`:g}).join(" ");return n.mui=!0,n}function lE(...t){const e=t.reduce((i,u)=>(u.filterProps.forEach(f=>{i[f]=u}),i),{}),n=i=>Object.keys(i).reduce((u,f)=>e[f]?gx(u,e[f](i)):u,{});return n.propTypes={},n.filterProps=t.reduce((i,u)=>i.concat(u.filterProps),[]),n}function au(t){return typeof t!="number"?t:`${t}px solid`}function bu(t,e){return Js({prop:t,themeKey:"borders",transform:e})}const ZK=bu("border",au),KK=bu("borderTop",au),YK=bu("borderRight",au),QK=bu("borderBottom",au),JK=bu("borderLeft",au),eY=bu("borderColor"),tY=bu("borderTopColor"),nY=bu("borderRightColor"),rY=bu("borderBottomColor"),iY=bu("borderLeftColor"),sY=bu("outline",au),oY=bu("outlineColor"),cE=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=_b(t.theme,"shape.borderRadius",4),n=i=>({borderRadius:jg(e,i)});return ph(t,t.borderRadius,n)}return null};cE.propTypes={};cE.filterProps=["borderRadius"];lE(ZK,KK,YK,QK,JK,eY,tY,nY,rY,iY,cE,sY,oY);const uE=t=>{if(t.gap!==void 0&&t.gap!==null){const e=_b(t.theme,"spacing",8),n=i=>({gap:jg(e,i)});return ph(t,t.gap,n)}return null};uE.propTypes={};uE.filterProps=["gap"];const hE=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=_b(t.theme,"spacing",8),n=i=>({columnGap:jg(e,i)});return ph(t,t.columnGap,n)}return null};hE.propTypes={};hE.filterProps=["columnGap"];const dE=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=_b(t.theme,"spacing",8),n=i=>({rowGap:jg(e,i)});return ph(t,t.rowGap,n)}return null};dE.propTypes={};dE.filterProps=["rowGap"];const aY=Js({prop:"gridColumn"}),lY=Js({prop:"gridRow"}),cY=Js({prop:"gridAutoFlow"}),uY=Js({prop:"gridAutoColumns"}),hY=Js({prop:"gridAutoRows"}),dY=Js({prop:"gridTemplateColumns"}),fY=Js({prop:"gridTemplateRows"}),pY=Js({prop:"gridTemplateAreas"}),mY=Js({prop:"gridArea"});lE(uE,hE,dE,aY,lY,cY,uY,hY,dY,fY,pY,mY);function A_(t,e){return e==="grey"?e:t}const gY=Js({prop:"color",themeKey:"palette",transform:A_}),yY=Js({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:A_}),_Y=Js({prop:"backgroundColor",themeKey:"palette",transform:A_});lE(gY,yY,_Y);function vc(t){return t<=1&&t!==0?`${t*100}%`:t}const vY=Js({prop:"width",transform:vc}),zR=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{const i=t.theme?.breakpoints?.values?.[n]||sE[n];return i?t.theme?.breakpoints?.unit!=="px"?{maxWidth:`${i}${t.theme.breakpoints.unit}`}:{maxWidth:i}:{maxWidth:vc(n)}};return ph(t,t.maxWidth,e)}return null};zR.filterProps=["maxWidth"];const xY=Js({prop:"minWidth",transform:vc}),bY=Js({prop:"height",transform:vc}),wY=Js({prop:"maxHeight",transform:vc}),TY=Js({prop:"minHeight",transform:vc});Js({prop:"size",cssProperty:"width",transform:vc});Js({prop:"size",cssProperty:"height",transform:vc});const EY=Js({prop:"boxSizing"});lE(vY,zR,xY,bY,wY,TY,EY);const vb={border:{themeKey:"borders",transform:au},borderTop:{themeKey:"borders",transform:au},borderRight:{themeKey:"borders",transform:au},borderBottom:{themeKey:"borders",transform:au},borderLeft:{themeKey:"borders",transform:au},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:au},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:cE},color:{themeKey:"palette",transform:A_},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:A_},backgroundColor:{themeKey:"palette",transform:A_},p:{style:Ns},pt:{style:Ns},pr:{style:Ns},pb:{style:Ns},pl:{style:Ns},px:{style:Ns},py:{style:Ns},padding:{style:Ns},paddingTop:{style:Ns},paddingRight:{style:Ns},paddingBottom:{style:Ns},paddingLeft:{style:Ns},paddingX:{style:Ns},paddingY:{style:Ns},paddingInline:{style:Ns},paddingInlineStart:{style:Ns},paddingInlineEnd:{style:Ns},paddingBlock:{style:Ns},paddingBlockStart:{style:Ns},paddingBlockEnd:{style:Ns},m:{style:Bs},mt:{style:Bs},mr:{style:Bs},mb:{style:Bs},ml:{style:Bs},mx:{style:Bs},my:{style:Bs},margin:{style:Bs},marginTop:{style:Bs},marginRight:{style:Bs},marginBottom:{style:Bs},marginLeft:{style:Bs},marginX:{style:Bs},marginY:{style:Bs},marginInline:{style:Bs},marginInlineStart:{style:Bs},marginInlineEnd:{style:Bs},marginBlock:{style:Bs},marginBlockStart:{style:Bs},marginBlockEnd:{style:Bs},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:uE},rowGap:{style:dE},columnGap:{style:hE},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:vc},maxWidth:{style:zR},minWidth:{transform:vc},height:{transform:vc},maxHeight:{transform:vc},minHeight:{transform:vc},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function SY(...t){const e=t.reduce((i,u)=>i.concat(Object.keys(u)),[]),n=new Set(e);return t.every(i=>n.size===Object.keys(i).length)}function CY(t,e){return typeof t=="function"?t(e):t}function AY(){function t(n,i,u,f){const g={[n]:i,theme:u},b=f[n];if(!b)return{[n]:i};const{cssProperty:o=n,themeKey:S,transform:M,style:O}=b;if(i==null)return null;if(S==="typography"&&i==="inherit")return{[n]:i};const N=oE(u,S)||{};return O?O(g):ph(g,i,Z=>{let K=xT(N,M,Z);return Z===K&&typeof Z=="string"&&(K=xT(N,M,`${n}${Z==="default"?"":tn(Z)}`,Z)),o===!1?K:{[o]:K}})}function e(n){const{sx:i,theme:u={},nested:f}=n||{};if(!i)return null;const g=u.unstable_sxConfig??vb;function b(o){let S=o;if(typeof o=="function")S=o(u);else if(typeof o!="object")return o;if(!S)return null;const M=KB(u.breakpoints),O=Object.keys(M);let N=M;return Object.keys(S).forEach(j=>{const Z=CY(S[j],u);if(Z!=null)if(typeof Z=="object")if(g[j])N=gx(N,t(j,Z,u,g));else{const K=ph({theme:u},Z,Q=>({[j]:Q}));SY(K,Z)?N[j]=e({sx:Z,theme:u,nested:!0}):N=gx(N,K)}else N=gx(N,t(j,Z,u,g))}),!f&&u.modularCssLayers?{"@layer sx":TL(u,dA(O,N))}:TL(u,dA(O,N))}return Array.isArray(i)?i.map(b):b(i)}return e}const ym=AY();ym.filterProps=["sx"];function IY(t,e){const n=this;if(n.vars){if(!n.colorSchemes?.[t]||typeof n.getColorSchemeSelector!="function")return{};let i=n.getColorSchemeSelector(t);return i==="&"?e:((i.includes("data-")||i.includes("."))&&(i=`*:where(${i.replace(/\s*&$/,"")}) &`),{[i]:e})}return n.palette.mode===t?e:{}}function xb(t={},...e){const{breakpoints:n={},palette:i={},spacing:u,shape:f={},...g}=t,b=OK(n),o=QB(u);let S=Jo({breakpoints:b,direction:"ltr",components:{},palette:{mode:"light",...i},spacing:o,shape:{...VK,...f}},g);return S=NK(S),S.applyStyles=IY,S=e.reduce((M,O)=>Jo(M,O),S),S.unstable_sxConfig={...vb,...g?.unstable_sxConfig},S.unstable_sx=function(O){return ym({sx:O,theme:this})},S}function RY(t){return Object.keys(t).length===0}function BR(t=null){const e=W.useContext(yb);return!e||RY(e)?t:e}const MY=xb();function fE(t=MY){return BR(t)}function XS(t){const e=im(t);return t!==e&&e.styles?(e.styles.match(/^@layer\s+[^{]*$/)||(e.styles=`@layer global{${e.styles}}`),e):t}function JB({styles:t,themeId:e,defaultTheme:n={}}){const i=fE(n),u=e&&i[e]||i;let f=typeof t=="function"?t(u):t;return u.modularCssLayers&&(Array.isArray(f)?f=f.map(g=>XS(typeof g=="function"?g(u):g)):f=XS(f)),U.jsx(HB,{styles:f})}const PY=t=>{const e={systemProps:{},otherProps:{}},n=t?.theme?.unstable_sxConfig??vb;return Object.keys(t).forEach(i=>{n[i]?e.systemProps[i]=t[i]:e.otherProps[i]=t[i]}),e};function NR(t){const{sx:e,...n}=t,{systemProps:i,otherProps:u}=PY(n);let f;return Array.isArray(e)?f=[i,...e]:typeof e=="function"?f=(...g)=>{const b=e(...g);return yd(b)?{...i,...b}:i}:f={...i,...e},{...u,sx:f}}const CL=t=>t,kY=()=>{let t=CL;return{configure(e){t=e},generate(e){return t(e)},reset(){t=CL}}},eN=kY();function tN(t){var e,n,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var u=t.length;for(e=0;e<u;e++)t[e]&&(n=tN(t[e]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}function Pn(){for(var t,e,n=0,i="",u=arguments.length;n<u;n++)(t=arguments[n])&&(e=tN(t))&&(i&&(i+=" "),i+=e);return i}function DY(t={}){const{themeId:e,defaultTheme:n,defaultClassName:i="MuiBox-root",generateClassName:u}=t,f=WB("div",{shouldForwardProp:b=>b!=="theme"&&b!=="sx"&&b!=="as"})(ym);return W.forwardRef(function(o,S){const M=fE(n),{className:O,component:N="div",...j}=NR(o);return U.jsx(f,{as:N,ref:S,className:Pn(O,u?u(i):i),theme:e&&M[e]||M,...j})})}const LY={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function wr(t,e,n="Mui"){const i=LY[e];return i?`${n}-${i}`:`${eN.generate(t)}-${e}`}function Sr(t,e,n="Mui"){const i={};return e.forEach(u=>{i[u]=wr(t,u,n)}),i}function nN(t){const{variants:e,...n}=t,i={variants:e,style:im(n),isProcessed:!0};return i.style===n||e&&e.forEach(u=>{typeof u.style!="function"&&(u.style=im(u.style))}),i}const OY=xb();function ZS(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function Cg(t,e){return e&&t&&typeof t=="object"&&t.styles&&!t.styles.startsWith("@layer")&&(t.styles=`@layer ${e}{${String(t.styles)}}`),t}function zY(t){return t?(e,n)=>n[t]:null}function BY(t,e,n){t.theme=VY(t.theme)?n:t.theme[e]||t.theme}function Nw(t,e,n){const i=typeof e=="function"?e(t):e;if(Array.isArray(i))return i.flatMap(u=>Nw(t,u,n));if(Array.isArray(i?.variants)){let u;if(i.isProcessed)u=n?Cg(i.style,n):i.style;else{const{variants:f,...g}=i;u=n?Cg(im(g),n):g}return rN(t,i.variants,[u],n)}return i?.isProcessed?n?Cg(im(i.style),n):i.style:n?Cg(im(i),n):i}function rN(t,e,n=[],i=void 0){let u;e:for(let f=0;f<e.length;f+=1){const g=e[f];if(typeof g.props=="function"){if(u??={...t,...t.ownerState,ownerState:t.ownerState},!g.props(u))continue}else for(const b in g.props)if(t[b]!==g.props[b]&&t.ownerState?.[b]!==g.props[b])continue e;typeof g.style=="function"?(u??={...t,...t.ownerState,ownerState:t.ownerState},n.push(i?Cg(im(g.style(u)),i):g.style(u))):n.push(i?Cg(im(g.style),i):g.style)}return n}function iN(t={}){const{themeId:e,defaultTheme:n=OY,rootShouldForwardProp:i=ZS,slotShouldForwardProp:u=ZS}=t;function f(b){BY(b,e,n)}return(b,o={})=>{PK(b,Te=>Te.filter(ae=>ae!==ym));const{name:S,slot:M,skipVariantsResolver:O,skipSx:N,overridesResolver:j=zY(UY(M)),...Z}=o,K=S&&S.startsWith("Mui")||M?"components":"custom",Q=O!==void 0?O:M&&M!=="Root"&&M!=="root"||!1,ce=N||!1;let ge=ZS;M==="Root"||M==="root"?ge=i:M?ge=u:FY(b)&&(ge=void 0);const ue=WB(b,{shouldForwardProp:ge,label:NY(),...Z}),pe=Te=>{if(Te.__emotion_real===Te)return Te;if(typeof Te=="function")return function(re){return Nw(re,Te,re.theme.modularCssLayers?K:void 0)};if(yd(Te)){const ae=nN(Te);return function(he){return ae.variants?Nw(he,ae,he.theme.modularCssLayers?K:void 0):he.theme.modularCssLayers?Cg(ae.style,K):ae.style}}return Te},me=(...Te)=>{const ae=[],re=Te.map(pe),he=[];if(ae.push(f),S&&j&&he.push(function(le){const Ze=le.theme.components?.[S]?.styleOverrides;if(!Ze)return null;const Ie={};for(const Je in Ze)Ie[Je]=Nw(le,Ze[Je],le.theme.modularCssLayers?"theme":void 0);return j(le,Ie)}),S&&!Q&&he.push(function(le){const Ze=le.theme?.components?.[S]?.variants;return Ze?rN(le,Ze,[],le.theme.modularCssLayers?"theme":void 0):null}),ce||he.push(ym),Array.isArray(re[0])){const Y=re.shift(),le=new Array(ae.length).fill(""),Ne=new Array(he.length).fill("");let Ze;Ze=[...le,...Y,...Ne],Ze.raw=[...le,...Y.raw,...Ne],ae.unshift(Ze)}const se=[...ae,...re,...he],ve=ue(...se);return b.muiName&&(ve.muiName=b.muiName),ve};return ue.withConfig&&(me.withConfig=ue.withConfig),me}}function NY(t,e){return void 0}function VY(t){for(const e in t)return!1;return!0}function FY(t){return typeof t=="string"&&t.charCodeAt(0)>96}function UY(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}const sN=iN();function qx(t,e,n=!1){const i={...e};for(const u in t)if(Object.prototype.hasOwnProperty.call(t,u)){const f=u;if(f==="components"||f==="slots")i[f]={...t[f],...i[f]};else if(f==="componentsProps"||f==="slotProps"){const g=t[f],b=e[f];if(!b)i[f]=g||{};else if(!g)i[f]=b;else{i[f]={...b};for(const o in g)if(Object.prototype.hasOwnProperty.call(g,o)){const S=o;i[f][S]=qx(g[S],b[S],n)}}}else f==="className"&&n&&e.className?i.className=Pn(t?.className,e?.className):f==="style"&&n&&e.style?i.style={...t?.style,...e?.style}:i[f]===void 0&&(i[f]=t[f])}return i}function jY(t){const{theme:e,name:n,props:i}=t;return!e||!e.components||!e.components[n]||!e.components[n].defaultProps?i:qx(e.components[n].defaultProps,i)}function oN({props:t,name:e,defaultTheme:n,themeId:i}){let u=fE(n);return i&&(u=u[i]||u),jY({theme:u,name:e,props:t})}const yu=typeof window<"u"?W.useLayoutEffect:W.useEffect;function u_(t,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,n))}function VR(t,e=0,n=1){return u_(t,e,n)}function $Y(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(i=>i+i)),n?`rgb${n.length===4?"a":""}(${n.map((i,u)=>u<3?parseInt(i,16):Math.round(parseInt(i,16)/255*1e3)/1e3).join(", ")})`:""}function _m(t){if(t.type)return t;if(t.charAt(0)==="#")return _m($Y(t));const e=t.indexOf("("),n=t.substring(0,e);if(!["rgb","rgba","hsl","hsla","color"].includes(n))throw new Error(Gf(9,t));let i=t.substring(e+1,t.length-1),u;if(n==="color"){if(i=i.split(" "),u=i.shift(),i.length===4&&i[3].charAt(0)==="/"&&(i[3]=i[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(u))throw new Error(Gf(10,u))}else i=i.split(",");return i=i.map(f=>parseFloat(f)),{type:n,values:i,colorSpace:u}}const qY=t=>{const e=_m(t);return e.values.slice(0,3).map((n,i)=>e.type.includes("hsl")&&i!==0?`${n}%`:n).join(" ")},J0=(t,e)=>{try{return qY(t)}catch{return t}};function pE(t){const{type:e,colorSpace:n}=t;let{values:i}=t;return e.includes("rgb")?i=i.map((u,f)=>f<3?parseInt(u,10):u):e.includes("hsl")&&(i[1]=`${i[1]}%`,i[2]=`${i[2]}%`),e.includes("color")?i=`${n} ${i.join(" ")}`:i=`${i.join(", ")}`,`${e}(${i})`}function aN(t){t=_m(t);const{values:e}=t,n=e[0],i=e[1]/100,u=e[2]/100,f=i*Math.min(u,1-u),g=(S,M=(S+n/30)%12)=>u-f*Math.max(Math.min(M-3,9-M,1),-1);let b="rgb";const o=[Math.round(g(0)*255),Math.round(g(8)*255),Math.round(g(4)*255)];return t.type==="hsla"&&(b+="a",o.push(e[3])),pE({type:b,values:o})}function fA(t){t=_m(t);let e=t.type==="hsl"||t.type==="hsla"?_m(aN(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function GY(t,e){const n=fA(t),i=fA(e);return(Math.max(n,i)+.05)/(Math.min(n,i)+.05)}function bT(t,e){return t=_m(t),e=VR(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,pE(t)}function gg(t,e,n){try{return bT(t,e)}catch{return t}}function mE(t,e){if(t=_m(t),e=VR(e),t.type.includes("hsl"))t.values[2]*=1-e;else if(t.type.includes("rgb")||t.type.includes("color"))for(let n=0;n<3;n+=1)t.values[n]*=1-e;return pE(t)}function Zi(t,e,n){try{return mE(t,e)}catch{return t}}function gE(t,e){if(t=_m(t),e=VR(e),t.type.includes("hsl"))t.values[2]+=(100-t.values[2])*e;else if(t.type.includes("rgb"))for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.includes("color"))for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return pE(t)}function Ki(t,e,n){try{return gE(t,e)}catch{return t}}function HY(t,e=.15){return fA(t)>.5?mE(t,e):gE(t,e)}function tw(t,e,n){try{return HY(t,e)}catch{return t}}const lN=W.createContext(null);function FR(){return W.useContext(lN)}const WY=typeof Symbol=="function"&&Symbol.for,XY=WY?Symbol.for("mui.nested"):"__THEME_NESTED__";function ZY(t,e){return typeof e=="function"?e(t):{...t,...e}}function KY(t){const{children:e,theme:n}=t,i=FR(),u=W.useMemo(()=>{const f=i===null?{...n}:ZY(i,n);return f!=null&&(f[XY]=i!==null),f},[n,i]);return U.jsx(lN.Provider,{value:u,children:e})}const cN=W.createContext();function YY({value:t,...e}){return U.jsx(cN.Provider,{value:t??!0,...e})}const yE=()=>W.useContext(cN)??!1,uN=W.createContext(void 0);function QY({value:t,children:e}){return U.jsx(uN.Provider,{value:t,children:e})}function JY(t){const{theme:e,name:n,props:i}=t;if(!e||!e.components||!e.components[n])return i;const u=e.components[n];return u.defaultProps?qx(u.defaultProps,i,e.components.mergeClassNameAndStyle):!u.styleOverrides&&!u.variants?qx(u,i,e.components.mergeClassNameAndStyle):i}function eQ({props:t,name:e}){const n=W.useContext(uN);return JY({props:t,name:e,theme:{components:n}})}let AL=0;function tQ(t){const[e,n]=W.useState(t),i=t||e;return W.useEffect(()=>{e==null&&(AL+=1,n(`mui-${AL}`))},[e]),i}const nQ={...uC},IL=nQ.useId;function Tm(t){if(IL!==void 0){const e=IL();return t??e}return tQ(t)}function rQ(t){const e=BR(),n=Tm()||"",{modularCssLayers:i}=t;let u="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return!i||e!==null?u="":typeof i=="string"?u=i.replace(/mui(?!\.)/g,u):u=`@layer ${u};`,yu(()=>{const f=document.querySelector("head");if(!f)return;const g=f.firstChild;if(u){if(g&&g.hasAttribute?.("data-mui-layer-order")&&g.getAttribute("data-mui-layer-order")===n)return;const b=document.createElement("style");b.setAttribute("data-mui-layer-order",n),b.textContent=u,f.prepend(b)}else f.querySelector(`style[data-mui-layer-order="${n}"]`)?.remove()},[u,n]),u?U.jsx(JB,{styles:u}):null}const RL={};function ML(t,e,n,i=!1){return W.useMemo(()=>{const u=t&&e[t]||e;if(typeof n=="function"){const f=n(u),g=t?{...e,[t]:f}:f;return i?()=>g:g}return t?{...e,[t]:n}:{...e,...n}},[t,e,n,i])}function hN(t){const{children:e,theme:n,themeId:i}=t,u=BR(RL),f=FR()||RL,g=ML(i,u,n),b=ML(i,f,n,!0),o=(i?g[i]:g).direction==="rtl",S=rQ(g);return U.jsx(KY,{theme:b,children:U.jsx(yb.Provider,{value:g,children:U.jsx(YY,{value:o,children:U.jsxs(QY,{value:i?g[i].components:g.components,children:[S,e]})})})})}const PL={theme:void 0};function iQ(t){let e,n;return function(u){let f=e;return(f===void 0||u.theme!==n)&&(PL.theme=u.theme,f=nN(t(PL)),e=f,n=u.theme),f}}const UR="mode",jR="color-scheme",sQ="data-color-scheme";function oQ(t){const{defaultMode:e="system",defaultLightColorScheme:n="light",defaultDarkColorScheme:i="dark",modeStorageKey:u=UR,colorSchemeStorageKey:f=jR,attribute:g=sQ,colorSchemeNode:b="document.documentElement",nonce:o}=t||{};let S="",M=g;if(g==="class"&&(M=".%s"),g==="data"&&(M="[data-%s]"),M.startsWith(".")){const N=M.substring(1);S+=`${b}.classList.remove('${N}'.replace('%s', light), '${N}'.replace('%s', dark));
      ${b}.classList.add('${N}'.replace('%s', colorScheme));`}const O=M.match(/\[([^[\]]+)\]/);if(O){const[N,j]=O[1].split("=");j||(S+=`${b}.removeAttribute('${N}'.replace('%s', light));
      ${b}.removeAttribute('${N}'.replace('%s', dark));`),S+=`
      ${b}.setAttribute('${N}'.replace('%s', colorScheme), ${j?`${j}.replace('%s', colorScheme)`:'""'});`}else S+=`${b}.setAttribute('${M}', colorScheme);`;return U.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?o:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  let colorScheme = '';
  const mode = localStorage.getItem('${u}') || '${e}';
  const dark = localStorage.getItem('${f}-dark') || '${i}';
  const light = localStorage.getItem('${f}-light') || '${n}';
  if (mode === 'system') {
    // handle system mode
    const mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = dark
    } else {
      colorScheme = light
    }
  }
  if (mode === 'light') {
    colorScheme = light;
  }
  if (mode === 'dark') {
    colorScheme = dark;
  }
  if (colorScheme) {
    ${S}
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function aQ(){}const lQ=({key:t,storageWindow:e})=>(!e&&typeof window<"u"&&(e=window),{get(n){if(typeof window>"u")return;if(!e)return n;let i;try{i=e.localStorage.getItem(t)}catch{}return i||n},set:n=>{if(e)try{e.localStorage.setItem(t,n)}catch{}},subscribe:n=>{if(!e)return aQ;const i=u=>{const f=u.newValue;u.key===t&&n(f)};return e.addEventListener("storage",i),()=>{e.removeEventListener("storage",i)}}});function KS(){}function kL(t){if(typeof window<"u"&&typeof window.matchMedia=="function"&&t==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function dN(t,e){if(t.mode==="light"||t.mode==="system"&&t.systemMode==="light")return e("light");if(t.mode==="dark"||t.mode==="system"&&t.systemMode==="dark")return e("dark")}function cQ(t){return dN(t,e=>{if(e==="light")return t.lightColorScheme;if(e==="dark")return t.darkColorScheme})}function uQ(t){const{defaultMode:e="light",defaultLightColorScheme:n,defaultDarkColorScheme:i,supportedColorSchemes:u=[],modeStorageKey:f=UR,colorSchemeStorageKey:g=jR,storageWindow:b=typeof window>"u"?void 0:window,storageManager:o=lQ,noSsr:S=!1}=t,M=u.join(","),O=u.length>1,N=W.useMemo(()=>o?.({key:f,storageWindow:b}),[o,f,b]),j=W.useMemo(()=>o?.({key:`${g}-light`,storageWindow:b}),[o,g,b]),Z=W.useMemo(()=>o?.({key:`${g}-dark`,storageWindow:b}),[o,g,b]),[K,Q]=W.useState(()=>{const re=N?.get(e)||e,he=j?.get(n)||n,se=Z?.get(i)||i;return{mode:re,systemMode:kL(re),lightColorScheme:he,darkColorScheme:se}}),[ce,ge]=W.useState(S||!O);W.useEffect(()=>{ge(!0)},[]);const ue=cQ(K),pe=W.useCallback(re=>{Q(he=>{if(re===he.mode)return he;const se=re??e;return N?.set(se),{...he,mode:se,systemMode:kL(se)}})},[N,e]),me=W.useCallback(re=>{re?typeof re=="string"?re&&!M.includes(re)?console.error(`\`${re}\` does not exist in \`theme.colorSchemes\`.`):Q(he=>{const se={...he};return dN(he,ve=>{ve==="light"&&(j?.set(re),se.lightColorScheme=re),ve==="dark"&&(Z?.set(re),se.darkColorScheme=re)}),se}):Q(he=>{const se={...he},ve=re.light===null?n:re.light,Y=re.dark===null?i:re.dark;return ve&&(M.includes(ve)?(se.lightColorScheme=ve,j?.set(ve)):console.error(`\`${ve}\` does not exist in \`theme.colorSchemes\`.`)),Y&&(M.includes(Y)?(se.darkColorScheme=Y,Z?.set(Y)):console.error(`\`${Y}\` does not exist in \`theme.colorSchemes\`.`)),se}):Q(he=>(j?.set(n),Z?.set(i),{...he,lightColorScheme:n,darkColorScheme:i}))},[M,j,Z,n,i]),Te=W.useCallback(re=>{K.mode==="system"&&Q(he=>{const se=re?.matches?"dark":"light";return he.systemMode===se?he:{...he,systemMode:se}})},[K.mode]),ae=W.useRef(Te);return ae.current=Te,W.useEffect(()=>{if(typeof window.matchMedia!="function"||!O)return;const re=(...se)=>ae.current(...se),he=window.matchMedia("(prefers-color-scheme: dark)");return he.addListener(re),re(he),()=>{he.removeListener(re)}},[O]),W.useEffect(()=>{if(O){const re=N?.subscribe(ve=>{(!ve||["light","dark","system"].includes(ve))&&pe(ve||e)})||KS,he=j?.subscribe(ve=>{(!ve||M.match(ve))&&me({light:ve})})||KS,se=Z?.subscribe(ve=>{(!ve||M.match(ve))&&me({dark:ve})})||KS;return()=>{re(),he(),se()}}},[me,pe,M,e,b,O,N,j,Z]),{...K,mode:ce?K.mode:void 0,systemMode:ce?K.systemMode:void 0,colorScheme:ce?ue:void 0,setMode:pe,setColorScheme:me}}const hQ="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function dQ(t){const{themeId:e,theme:n={},modeStorageKey:i=UR,colorSchemeStorageKey:u=jR,disableTransitionOnChange:f=!1,defaultColorScheme:g,resolveTheme:b}=t,o={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},S=W.createContext(void 0),M=()=>W.useContext(S)||o,O={},N={};function j(ce){const{children:ge,theme:ue,modeStorageKey:pe=i,colorSchemeStorageKey:me=u,disableTransitionOnChange:Te=f,storageManager:ae,storageWindow:re=typeof window>"u"?void 0:window,documentNode:he=typeof document>"u"?void 0:document,colorSchemeNode:se=typeof document>"u"?void 0:document.documentElement,disableNestedContext:ve=!1,disableStyleSheetGeneration:Y=!1,defaultMode:le="system",forceThemeRerender:Ne=!1,noSsr:Ze}=ce,Ie=W.useRef(!1),Je=FR(),dt=W.useContext(S),et=!!dt&&!ve,Kt=W.useMemo(()=>ue||(typeof n=="function"?n():n),[ue]),De=Kt[e],tt=De||Kt,{colorSchemes:Et=O,components:wt=N,cssVarPrefix:Lt}=tt,Ut=Object.keys(Et).filter(Jt=>!!Et[Jt]).join(","),an=W.useMemo(()=>Ut.split(","),[Ut]),At=typeof g=="string"?g:g.light,Qt=typeof g=="string"?g:g.dark,Wt=Et[At]&&Et[Qt]?le:Et[tt.defaultColorScheme]?.palette?.mode||tt.palette?.mode,{mode:vn,setMode:Gt,systemMode:Cn,lightColorScheme:ln,darkColorScheme:qn,colorScheme:Rn,setColorScheme:An}=uQ({supportedColorSchemes:an,defaultLightColorScheme:At,defaultDarkColorScheme:Qt,modeStorageKey:pe,colorSchemeStorageKey:me,defaultMode:Wt,storageManager:ae,storageWindow:re,noSsr:Ze});let rr=vn,En=Rn;et&&(rr=dt.mode,En=dt.colorScheme);let bn=En||tt.defaultColorScheme;tt.vars&&!Ne&&(bn=tt.defaultColorScheme);const zn=W.useMemo(()=>{const Jt=tt.generateThemeVars?.()||tt.vars,yn={...tt,components:wt,colorSchemes:Et,cssVarPrefix:Lt,vars:Jt};if(typeof yn.generateSpacing=="function"&&(yn.spacing=yn.generateSpacing()),bn){const _n=Et[bn];_n&&typeof _n=="object"&&Object.keys(_n).forEach(In=>{_n[In]&&typeof _n[In]=="object"?yn[In]={...yn[In],..._n[In]}:yn[In]=_n[In]})}return b?b(yn):yn},[tt,bn,wt,Et,Lt]),mn=tt.colorSchemeSelector;yu(()=>{if(En&&se&&mn&&mn!=="media"){const Jt=mn;let yn=mn;if(Jt==="class"&&(yn=".%s"),Jt==="data"&&(yn="[data-%s]"),Jt?.startsWith("data-")&&!Jt.includes("%s")&&(yn=`[${Jt}="%s"]`),yn.startsWith("."))se.classList.remove(...an.map(_n=>yn.substring(1).replace("%s",_n))),se.classList.add(yn.substring(1).replace("%s",En));else{const _n=yn.replace("%s",En).match(/\[([^\]]+)\]/);if(_n){const[In,Bn]=_n[1].split("=");Bn||an.forEach(Nn=>{se.removeAttribute(In.replace(En,Nn))}),se.setAttribute(In,Bn?Bn.replace(/"|'/g,""):"")}else se.setAttribute(yn,En)}}},[En,mn,se,an]),W.useEffect(()=>{let Jt;if(Te&&Ie.current&&he){const yn=he.createElement("style");yn.appendChild(he.createTextNode(hQ)),he.head.appendChild(yn),window.getComputedStyle(he.body),Jt=setTimeout(()=>{he.head.removeChild(yn)},1)}return()=>{clearTimeout(Jt)}},[En,Te,he]),W.useEffect(()=>(Ie.current=!0,()=>{Ie.current=!1}),[]);const ti=W.useMemo(()=>({allColorSchemes:an,colorScheme:En,darkColorScheme:qn,lightColorScheme:ln,mode:rr,setColorScheme:An,setMode:Gt,systemMode:Cn}),[an,En,qn,ln,rr,An,Gt,Cn,zn.colorSchemeSelector]);let Xn=!0;(Y||tt.cssVariables===!1||et&&Je?.cssVarPrefix===Lt)&&(Xn=!1);const on=U.jsxs(W.Fragment,{children:[U.jsx(hN,{themeId:De?e:void 0,theme:zn,children:ge}),Xn&&U.jsx(HB,{styles:zn.generateStyleSheets?.()||[]})]});return et?on:U.jsx(S.Provider,{value:ti,children:on})}const Z=typeof g=="string"?g:g.light,K=typeof g=="string"?g:g.dark;return{CssVarsProvider:j,useColorScheme:M,getInitColorSchemeScript:ce=>oQ({colorSchemeStorageKey:u,defaultLightColorScheme:Z,defaultDarkColorScheme:K,modeStorageKey:i,...ce})}}function fQ(t=""){function e(...i){if(!i.length)return"";const u=i[0];return typeof u=="string"&&!u.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${t?`${t}-`:""}${u}${e(...i.slice(1))})`:`, ${u}`}return(i,...u)=>`var(--${t?`${t}-`:""}${i}${e(...u)})`}const DL=(t,e,n,i=[])=>{let u=t;e.forEach((f,g)=>{g===e.length-1?Array.isArray(u)?u[Number(f)]=n:u&&typeof u=="object"&&(u[f]=n):u&&typeof u=="object"&&(u[f]||(u[f]=i.includes(f)?[]:{}),u=u[f])})},pQ=(t,e,n)=>{function i(u,f=[],g=[]){Object.entries(u).forEach(([b,o])=>{(!n||n&&!n([...f,b]))&&o!=null&&(typeof o=="object"&&Object.keys(o).length>0?i(o,[...f,b],Array.isArray(o)?[...g,b]:g):e([...f,b],o,g))})}i(t)},mQ=(t,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(i=>t.includes(i))||t[t.length-1].toLowerCase().includes("opacity")?e:`${e}px`:e;function YS(t,e){const{prefix:n,shouldSkipGeneratingVar:i}=e||{},u={},f={},g={};return pQ(t,(b,o,S)=>{if((typeof o=="string"||typeof o=="number")&&(!i||!i(b,o))){const M=`--${n?`${n}-`:""}${b.join("-")}`,O=mQ(b,o);Object.assign(u,{[M]:O}),DL(f,b,`var(${M})`,S),DL(g,b,`var(${M}, ${O})`,S)}},b=>b[0]==="vars"),{css:u,vars:f,varsWithDefaults:g}}function gQ(t,e={}){const{getSelector:n=ce,disableCssColorScheme:i,colorSchemeSelector:u,enableContrastVars:f}=e,{colorSchemes:g={},components:b,defaultColorScheme:o="light",...S}=t,{vars:M,css:O,varsWithDefaults:N}=YS(S,e);let j=N;const Z={},{[o]:K,...Q}=g;if(Object.entries(Q||{}).forEach(([pe,me])=>{const{vars:Te,css:ae,varsWithDefaults:re}=YS(me,e);j=Jo(j,re),Z[pe]={css:ae,vars:Te}}),K){const{css:pe,vars:me,varsWithDefaults:Te}=YS(K,e);j=Jo(j,Te),Z[o]={css:pe,vars:me}}function ce(pe,me){let Te=u;if(u==="class"&&(Te=".%s"),u==="data"&&(Te="[data-%s]"),u?.startsWith("data-")&&!u.includes("%s")&&(Te=`[${u}="%s"]`),pe){if(Te==="media")return t.defaultColorScheme===pe?":root":{[`@media (prefers-color-scheme: ${g[pe]?.palette?.mode||pe})`]:{":root":me}};if(Te)return t.defaultColorScheme===pe?`:root, ${Te.replace("%s",String(pe))}`:Te.replace("%s",String(pe))}return":root"}return{vars:j,generateThemeVars:()=>{let pe={...M};return Object.entries(Z).forEach(([,{vars:me}])=>{pe=Jo(pe,me)}),pe},generateStyleSheets:()=>{const pe=[],me=t.defaultColorScheme||"light";function Te(he,se){Object.keys(se).length&&pe.push(typeof he=="string"?{[he]:{...se}}:he)}Te(n(void 0,{...O}),O);const{[me]:ae,...re}=Z;if(ae){const{css:he}=ae,se=g[me]?.palette?.mode,ve=!i&&se?{colorScheme:se,...he}:{...he};Te(n(me,{...ve}),ve)}return Object.entries(re).forEach(([he,{css:se}])=>{const ve=g[he]?.palette?.mode,Y=!i&&ve?{colorScheme:ve,...se}:{...se};Te(n(he,{...Y}),Y)}),f&&pe.push({":root":{"--__l-threshold":"0.7","--__l":"clamp(0, (l / var(--__l-threshold) - 1) * -infinity, 1)","--__a":"clamp(0.87, (l / var(--__l-threshold) - 1) * -infinity, 1)"}}),pe}}}function yQ(t){return function(n){return t==="media"?`@media (prefers-color-scheme: ${n})`:t?t.startsWith("data-")&&!t.includes("%s")?`[${t}="${n}"] &`:t==="class"?`.${n} &`:t==="data"?`[data-${n}] &`:`${t.replace("%s",n)} &`:"&"}}function Tr(t,e,n=void 0){const i={};for(const u in t){const f=t[u];let g="",b=!0;for(let o=0;o<f.length;o+=1){const S=f[o];S&&(g+=(b===!0?"":" ")+e(S),b=!1,n&&n[S]&&(g+=" "+n[S]))}i[u]=g}return i}const _Q=xb(),vQ=sN("div",{name:"MuiContainer",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`maxWidth${tn(String(n.maxWidth))}`],n.fixed&&e.fixed,n.disableGutters&&e.disableGutters]}}),xQ=t=>oN({props:t,name:"MuiContainer",defaultTheme:_Q}),bQ=(t,e)=>{const n=o=>wr(e,o),{classes:i,fixed:u,disableGutters:f,maxWidth:g}=t,b={root:["root",g&&`maxWidth${tn(String(g))}`,u&&"fixed",f&&"disableGutters"]};return Tr(b,n,i)};function wQ(t={}){const{createStyledComponent:e=vQ,useThemeProps:n=xQ,componentName:i="MuiContainer"}=t,u=e(({theme:g,ownerState:b})=>({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",...!b.disableGutters&&{paddingLeft:g.spacing(2),paddingRight:g.spacing(2),[g.breakpoints.up("sm")]:{paddingLeft:g.spacing(3),paddingRight:g.spacing(3)}}}),({theme:g,ownerState:b})=>b.fixed&&Object.keys(g.breakpoints.values).reduce((o,S)=>{const M=S,O=g.breakpoints.values[M];return O!==0&&(o[g.breakpoints.up(M)]={maxWidth:`${O}${g.breakpoints.unit}`}),o},{}),({theme:g,ownerState:b})=>({...b.maxWidth==="xs"&&{[g.breakpoints.up("xs")]:{maxWidth:Math.max(g.breakpoints.values.xs,444)}},...b.maxWidth&&b.maxWidth!=="xs"&&{[g.breakpoints.up(b.maxWidth)]:{maxWidth:`${g.breakpoints.values[b.maxWidth]}${g.breakpoints.unit}`}}}));return W.forwardRef(function(b,o){const S=n(b),{className:M,component:O="div",disableGutters:N=!1,fixed:j=!1,maxWidth:Z="lg",classes:K,...Q}=S,ce={...S,component:O,disableGutters:N,fixed:j,maxWidth:Z},ge=bQ(ce,i);return U.jsx(u,{as:O,ownerState:ce,className:Pn(ge.root,M),ref:o,...Q})})}function QS(t,e){return W.isValidElement(t)&&e.indexOf(t.type.muiName??t.type?._payload?.value?.muiName)!==-1}const TQ=xb(),EQ=sN("div",{name:"MuiStack",slot:"Root"});function SQ(t){return oN({props:t,name:"MuiStack",defaultTheme:TQ})}function CQ(t,e){const n=W.Children.toArray(t).filter(Boolean);return n.reduce((i,u,f)=>(i.push(u),f<n.length-1&&i.push(W.cloneElement(e,{key:`separator-${f}`})),i),[])}const AQ=t=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[t],IQ=({ownerState:t,theme:e})=>{let n={display:"flex",flexDirection:"column",...ph({theme:e},WS({values:t.direction,breakpoints:e.breakpoints.values}),i=>({flexDirection:i}))};if(t.spacing){const i=aE(e),u=Object.keys(e.breakpoints.values).reduce((o,S)=>((typeof t.spacing=="object"&&t.spacing[S]!=null||typeof t.direction=="object"&&t.direction[S]!=null)&&(o[S]=!0),o),{}),f=WS({values:t.direction,base:u}),g=WS({values:t.spacing,base:u});typeof f=="object"&&Object.keys(f).forEach((o,S,M)=>{if(!f[o]){const N=S>0?f[M[S-1]]:"column";f[o]=N}}),n=Jo(n,ph({theme:e},g,(o,S)=>t.useFlexGap?{gap:jg(i,o)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${AQ(S?f[S]:t.direction)}`]:jg(i,o)}}))}return n=UK(e.breakpoints,n),n};function RQ(t={}){const{createStyledComponent:e=EQ,useThemeProps:n=SQ,componentName:i="MuiStack"}=t,u=()=>Tr({root:["root"]},o=>wr(i,o),{}),f=e(IQ);return W.forwardRef(function(o,S){const M=n(o),O=NR(M),{component:N="div",direction:j="column",spacing:Z=0,divider:K,children:Q,className:ce,useFlexGap:ge=!1,...ue}=O,pe={direction:j,spacing:Z,useFlexGap:ge},me=u();return U.jsx(f,{as:N,ownerState:pe,ref:S,className:Pn(me.root,ce),...ue,children:K?CQ(Q,K):Q})})}function fN(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Fx.white,default:Fx.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const pN=fN();function mN(){return{text:{primary:Fx.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Fx.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const pA=mN();function LL(t,e,n,i){const u=i.light||i,f=i.dark||i*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=gE(t.main,u):e==="dark"&&(t.dark=mE(t.main,f)))}function OL(t,e,n,i,u){const f=u.light||u,g=u.dark||u*1.5;e[n]||(e.hasOwnProperty(i)?e[n]=e[i]:n==="light"?e.light=`color-mix(in ${t}, ${e.main}, #fff ${(f*100).toFixed(0)}%)`:n==="dark"&&(e.dark=`color-mix(in ${t}, ${e.main}, #000 ${(g*100).toFixed(0)}%)`))}function MQ(t="light"){return t==="dark"?{main:Jy[200],light:Jy[50],dark:Jy[400]}:{main:Jy[700],light:Jy[400],dark:Jy[800]}}function PQ(t="light"){return t==="dark"?{main:Qy[200],light:Qy[50],dark:Qy[400]}:{main:Qy[500],light:Qy[300],dark:Qy[700]}}function kQ(t="light"){return t==="dark"?{main:Yy[500],light:Yy[300],dark:Yy[700]}:{main:Yy[700],light:Yy[400],dark:Yy[800]}}function DQ(t="light"){return t==="dark"?{main:e_[400],light:e_[300],dark:e_[700]}:{main:e_[700],light:e_[500],dark:e_[900]}}function LQ(t="light"){return t==="dark"?{main:t_[400],light:t_[300],dark:t_[700]}:{main:t_[800],light:t_[500],dark:t_[900]}}function OQ(t="light"){return t==="dark"?{main:B0[400],light:B0[300],dark:B0[700]}:{main:"#ed6c02",light:B0[500],dark:B0[900]}}function zQ(t){return`oklch(from ${t} var(--__l) 0 h / var(--__a))`}function $R(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:i=.2,colorSpace:u,...f}=t,g=t.primary||MQ(e),b=t.secondary||PQ(e),o=t.error||kQ(e),S=t.info||DQ(e),M=t.success||LQ(e),O=t.warning||OQ(e);function N(Q){return u?zQ(Q):GY(Q,pA.text.primary)>=n?pA.text.primary:pN.text.primary}const j=({color:Q,name:ce,mainShade:ge=500,lightShade:ue=300,darkShade:pe=700})=>{if(Q={...Q},!Q.main&&Q[ge]&&(Q.main=Q[ge]),!Q.hasOwnProperty("main"))throw new Error(Gf(11,ce?` (${ce})`:"",ge));if(typeof Q.main!="string")throw new Error(Gf(12,ce?` (${ce})`:"",JSON.stringify(Q.main)));return u?(OL(u,Q,"light",ue,i),OL(u,Q,"dark",pe,i)):(LL(Q,"light",ue,i),LL(Q,"dark",pe,i)),Q.contrastText||(Q.contrastText=N(Q.main)),Q};let Z;return e==="light"?Z=fN():e==="dark"&&(Z=mN()),Jo({common:{...Fx},mode:e,primary:j({color:g,name:"primary"}),secondary:j({color:b,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:j({color:o,name:"error"}),warning:j({color:O,name:"warning"}),info:j({color:S,name:"info"}),success:j({color:M,name:"success"}),grey:kZ,contrastThreshold:n,getContrastText:N,augmentColor:j,tonalOffset:i,...Z},f)}function BQ(t){const e={};return Object.entries(t).forEach(i=>{const[u,f]=i;typeof f=="object"&&(e[u]=`${f.fontStyle?`${f.fontStyle} `:""}${f.fontVariant?`${f.fontVariant} `:""}${f.fontWeight?`${f.fontWeight} `:""}${f.fontStretch?`${f.fontStretch} `:""}${f.fontSize||""}${f.lineHeight?`/${f.lineHeight} `:""}${f.fontFamily||""}`)}),e}function NQ(t,e){return{toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}},...e}}function VQ(t){return Math.round(t*1e5)/1e5}const zL={textTransform:"uppercase"},BL='"Roboto", "Helvetica", "Arial", sans-serif';function gN(t,e){const{fontFamily:n=BL,fontSize:i=14,fontWeightLight:u=300,fontWeightRegular:f=400,fontWeightMedium:g=500,fontWeightBold:b=700,htmlFontSize:o=16,allVariants:S,pxToRem:M,...O}=typeof e=="function"?e(t):e,N=i/14,j=M||(Q=>`${Q/o*N}rem`),Z=(Q,ce,ge,ue,pe)=>({fontFamily:n,fontWeight:Q,fontSize:j(ce),lineHeight:ge,...n===BL?{letterSpacing:`${VQ(ue/ce)}em`}:{},...pe,...S}),K={h1:Z(u,96,1.167,-1.5),h2:Z(u,60,1.2,-.5),h3:Z(f,48,1.167,0),h4:Z(f,34,1.235,.25),h5:Z(f,24,1.334,0),h6:Z(g,20,1.6,.15),subtitle1:Z(f,16,1.75,.15),subtitle2:Z(g,14,1.57,.1),body1:Z(f,16,1.5,.15),body2:Z(f,14,1.43,.15),button:Z(g,14,1.75,.4,zL),caption:Z(f,12,1.66,.4),overline:Z(f,12,2.66,1,zL),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Jo({htmlFontSize:o,pxToRem:j,fontFamily:n,fontSize:i,fontWeightLight:u,fontWeightRegular:f,fontWeightMedium:g,fontWeightBold:b,...K},O,{clone:!1})}const FQ=.2,UQ=.14,jQ=.12;function bs(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${FQ})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${UQ})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${jQ})`].join(",")}const $Q=["none",bs(0,2,1,-1,0,1,1,0,0,1,3,0),bs(0,3,1,-2,0,2,2,0,0,1,5,0),bs(0,3,3,-2,0,3,4,0,0,1,8,0),bs(0,2,4,-1,0,4,5,0,0,1,10,0),bs(0,3,5,-1,0,5,8,0,0,1,14,0),bs(0,3,5,-1,0,6,10,0,0,1,18,0),bs(0,4,5,-2,0,7,10,1,0,2,16,1),bs(0,5,5,-3,0,8,10,1,0,3,14,2),bs(0,5,6,-3,0,9,12,1,0,3,16,2),bs(0,6,6,-3,0,10,14,1,0,4,18,3),bs(0,6,7,-4,0,11,15,1,0,4,20,3),bs(0,7,8,-4,0,12,17,2,0,5,22,4),bs(0,7,8,-4,0,13,19,2,0,5,24,4),bs(0,7,9,-4,0,14,21,2,0,5,26,4),bs(0,8,9,-5,0,15,22,2,0,6,28,5),bs(0,8,10,-5,0,16,24,2,0,6,30,5),bs(0,8,11,-5,0,17,26,2,0,6,32,5),bs(0,9,11,-5,0,18,28,2,0,7,34,6),bs(0,9,12,-6,0,19,29,2,0,7,36,6),bs(0,10,13,-6,0,20,31,3,0,8,38,7),bs(0,10,13,-6,0,21,33,3,0,8,40,7),bs(0,10,14,-6,0,22,35,3,0,8,42,7),bs(0,11,14,-7,0,23,36,3,0,9,44,8),bs(0,11,15,-7,0,24,38,3,0,9,46,8)],qQ={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},GQ={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function NL(t){return`${Math.round(t)}ms`}function HQ(t){if(!t)return 0;const e=t/36;return Math.min(Math.round((4+15*e**.25+e/5)*10),3e3)}function WQ(t){const e={...qQ,...t.easing},n={...GQ,...t.duration};return{getAutoHeightDuration:HQ,create:(u=["all"],f={})=>{const{duration:g=n.standard,easing:b=e.easeInOut,delay:o=0,...S}=f;return(Array.isArray(u)?u:[u]).map(M=>`${M} ${typeof g=="string"?g:NL(g)} ${b} ${typeof o=="string"?o:NL(o)}`).join(",")},...t,easing:e,duration:n}}const XQ={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function ZQ(t){return yd(t)||typeof t>"u"||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||Array.isArray(t)}function yN(t={}){const e={...t};function n(i){const u=Object.entries(i);for(let f=0;f<u.length;f++){const[g,b]=u[f];!ZQ(b)||g.startsWith("unstable_")?delete i[g]:yd(b)&&(i[g]={...b},n(i[g]))}}return n(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(e,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function VL(t){return typeof t=="number"?`${(t*100).toFixed(0)}%`:`calc((${t}) * 100%)`}const KQ=t=>{if(!Number.isNaN(+t))return+t;const e=t.match(/\d*\.?\d+/g);if(!e)return 0;let n=0;for(let i=0;i<e.length;i+=1)n+=+e[i];return n};function YQ(t){Object.assign(t,{alpha(e,n){const i=this||t;return i.colorSpace?`oklch(from ${e} l c h / ${typeof n=="string"?`calc(${n})`:n})`:i.vars?`rgba(${e.replace(/var\(--([^,\s)]+)(?:,[^)]+)?\)+/g,"var(--$1Channel)")} / ${typeof n=="string"?`calc(${n})`:n})`:bT(e,KQ(n))},lighten(e,n){const i=this||t;return i.colorSpace?`color-mix(in ${i.colorSpace}, ${e}, #fff ${VL(n)})`:gE(e,n)},darken(e,n){const i=this||t;return i.colorSpace?`color-mix(in ${i.colorSpace}, ${e}, #000 ${VL(n)})`:mE(e,n)}})}function mA(t={},...e){const{breakpoints:n,mixins:i={},spacing:u,palette:f={},transitions:g={},typography:b={},shape:o,colorSpace:S,...M}=t;if(t.vars&&t.generateThemeVars===void 0)throw new Error(Gf(20));const O=$R({...f,colorSpace:S}),N=xb(t);let j=Jo(N,{mixins:NQ(N.breakpoints,i),palette:O,shadows:$Q.slice(),typography:gN(O,b),transitions:WQ(g),zIndex:{...XQ}});return j=Jo(j,M),j=e.reduce((Z,K)=>Jo(Z,K),j),j.unstable_sxConfig={...vb,...M?.unstable_sxConfig},j.unstable_sx=function(K){return ym({sx:K,theme:this})},j.toRuntimeSource=yN,YQ(j),j}function gA(t){let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,Math.round(e*10)/1e3}const QQ=[...Array(25)].map((t,e)=>{if(e===0)return"none";const n=gA(e);return`linear-gradient(rgba(255 255 255 / ${n}), rgba(255 255 255 / ${n}))`});function _N(t){return{inputPlaceholder:t==="dark"?.5:.42,inputUnderline:t==="dark"?.7:.42,switchTrackDisabled:t==="dark"?.2:.12,switchTrack:t==="dark"?.3:.38}}function vN(t){return t==="dark"?QQ:[]}function JQ(t){const{palette:e={mode:"light"},opacity:n,overlays:i,colorSpace:u,...f}=t,g=$R({...e,colorSpace:u});return{palette:g,opacity:{..._N(g.mode),...n},overlays:i||vN(g.mode),...f}}function eJ(t){return!!t[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!t[0].match(/sxConfig$/)||t[0]==="palette"&&!!t[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}const tJ=t=>[...[...Array(25)].map((e,n)=>`--${t?`${t}-`:""}overlays-${n}`),`--${t?`${t}-`:""}palette-AppBar-darkBg`,`--${t?`${t}-`:""}palette-AppBar-darkColor`],nJ=t=>(e,n)=>{const i=t.rootSelector||":root",u=t.colorSchemeSelector;let f=u;if(u==="class"&&(f=".%s"),u==="data"&&(f="[data-%s]"),u?.startsWith("data-")&&!u.includes("%s")&&(f=`[${u}="%s"]`),t.defaultColorScheme===e){if(e==="dark"){const g={};return tJ(t.cssVarPrefix).forEach(b=>{g[b]=n[b],delete n[b]}),f==="media"?{[i]:n,"@media (prefers-color-scheme: dark)":{[i]:g}}:f?{[f.replace("%s",e)]:g,[`${i}, ${f.replace("%s",e)}`]:n}:{[i]:{...n,...g}}}if(f&&f!=="media")return`${i}, ${f.replace("%s",String(e))}`}else if(e){if(f==="media")return{[`@media (prefers-color-scheme: ${String(e)})`]:{[i]:n}};if(f)return f.replace("%s",String(e))}return i};function rJ(t,e){e.forEach(n=>{t[n]||(t[n]={})})}function Dt(t,e,n){!t[e]&&n&&(t[e]=n)}function ex(t){return typeof t!="string"||!t.startsWith("hsl")?t:aN(t)}function Pf(t,e){`${e}Channel`in t||(t[`${e}Channel`]=J0(ex(t[e])))}function iJ(t){return typeof t=="number"?`${t}px`:typeof t=="string"||typeof t=="function"||Array.isArray(t)?t:"8px"}const hd=t=>{try{return t()}catch{}},sJ=(t="mui")=>fQ(t);function JS(t,e,n,i,u){if(!n)return;n=n===!0?{}:n;const f=u==="dark"?"dark":"light";if(!i){e[u]=JQ({...n,palette:{mode:f,...n?.palette},colorSpace:t});return}const{palette:g,...b}=mA({...i,palette:{mode:f,...n?.palette},colorSpace:t});return e[u]={...n,palette:g,opacity:{..._N(f),...n?.opacity},overlays:n?.overlays||vN(f)},b}function oJ(t={},...e){const{colorSchemes:n={light:!0},defaultColorScheme:i,disableCssColorScheme:u=!1,cssVarPrefix:f="mui",nativeColor:g=!1,shouldSkipGeneratingVar:b=eJ,colorSchemeSelector:o=n.light&&n.dark?"media":void 0,rootSelector:S=":root",...M}=t,O=Object.keys(n)[0],N=i||(n.light&&O!=="light"?"light":O),j=sJ(f),{[N]:Z,light:K,dark:Q,...ce}=n,ge={...ce};let ue=Z;if((N==="dark"&&!("dark"in n)||N==="light"&&!("light"in n))&&(ue=!0),!ue)throw new Error(Gf(21,N));let pe;g&&(pe="oklch");const me=JS(pe,ge,ue,M,N);K&&!ge.light&&JS(pe,ge,K,void 0,"light"),Q&&!ge.dark&&JS(pe,ge,Q,void 0,"dark");let Te={defaultColorScheme:N,...me,cssVarPrefix:f,colorSchemeSelector:o,rootSelector:S,getCssVar:j,colorSchemes:ge,font:{...BQ(me.typography),...me.font},spacing:iJ(M.spacing)};Object.keys(Te.colorSchemes).forEach(ve=>{const Y=Te.colorSchemes[ve].palette,le=Ze=>{const Ie=Ze.split("-"),Je=Ie[1],dt=Ie[2];return j(Ze,Y[Je][dt])};Y.mode==="light"&&(Dt(Y.common,"background","#fff"),Dt(Y.common,"onBackground","#000")),Y.mode==="dark"&&(Dt(Y.common,"background","#000"),Dt(Y.common,"onBackground","#fff"));function Ne(Ze,Ie,Je){if(pe){let dt;return Ze===gg&&(dt=`transparent ${((1-Je)*100).toFixed(0)}%`),Ze===Zi&&(dt=`#000 ${(Je*100).toFixed(0)}%`),Ze===Ki&&(dt=`#fff ${(Je*100).toFixed(0)}%`),`color-mix(in ${pe}, ${Ie}, ${dt})`}return Ze(Ie,Je)}if(rJ(Y,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),Y.mode==="light"){Dt(Y.Alert,"errorColor",Ne(Zi,Y.error.light,.6)),Dt(Y.Alert,"infoColor",Ne(Zi,Y.info.light,.6)),Dt(Y.Alert,"successColor",Ne(Zi,Y.success.light,.6)),Dt(Y.Alert,"warningColor",Ne(Zi,Y.warning.light,.6)),Dt(Y.Alert,"errorFilledBg",le("palette-error-main")),Dt(Y.Alert,"infoFilledBg",le("palette-info-main")),Dt(Y.Alert,"successFilledBg",le("palette-success-main")),Dt(Y.Alert,"warningFilledBg",le("palette-warning-main")),Dt(Y.Alert,"errorFilledColor",hd(()=>Y.getContrastText(Y.error.main))),Dt(Y.Alert,"infoFilledColor",hd(()=>Y.getContrastText(Y.info.main))),Dt(Y.Alert,"successFilledColor",hd(()=>Y.getContrastText(Y.success.main))),Dt(Y.Alert,"warningFilledColor",hd(()=>Y.getContrastText(Y.warning.main))),Dt(Y.Alert,"errorStandardBg",Ne(Ki,Y.error.light,.9)),Dt(Y.Alert,"infoStandardBg",Ne(Ki,Y.info.light,.9)),Dt(Y.Alert,"successStandardBg",Ne(Ki,Y.success.light,.9)),Dt(Y.Alert,"warningStandardBg",Ne(Ki,Y.warning.light,.9)),Dt(Y.Alert,"errorIconColor",le("palette-error-main")),Dt(Y.Alert,"infoIconColor",le("palette-info-main")),Dt(Y.Alert,"successIconColor",le("palette-success-main")),Dt(Y.Alert,"warningIconColor",le("palette-warning-main")),Dt(Y.AppBar,"defaultBg",le("palette-grey-100")),Dt(Y.Avatar,"defaultBg",le("palette-grey-400")),Dt(Y.Button,"inheritContainedBg",le("palette-grey-300")),Dt(Y.Button,"inheritContainedHoverBg",le("palette-grey-A100")),Dt(Y.Chip,"defaultBorder",le("palette-grey-400")),Dt(Y.Chip,"defaultAvatarColor",le("palette-grey-700")),Dt(Y.Chip,"defaultIconColor",le("palette-grey-700")),Dt(Y.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Dt(Y.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Dt(Y.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Dt(Y.LinearProgress,"primaryBg",Ne(Ki,Y.primary.main,.62)),Dt(Y.LinearProgress,"secondaryBg",Ne(Ki,Y.secondary.main,.62)),Dt(Y.LinearProgress,"errorBg",Ne(Ki,Y.error.main,.62)),Dt(Y.LinearProgress,"infoBg",Ne(Ki,Y.info.main,.62)),Dt(Y.LinearProgress,"successBg",Ne(Ki,Y.success.main,.62)),Dt(Y.LinearProgress,"warningBg",Ne(Ki,Y.warning.main,.62)),Dt(Y.Skeleton,"bg",pe?Ne(gg,Y.text.primary,.11):`rgba(${le("palette-text-primaryChannel")} / 0.11)`),Dt(Y.Slider,"primaryTrack",Ne(Ki,Y.primary.main,.62)),Dt(Y.Slider,"secondaryTrack",Ne(Ki,Y.secondary.main,.62)),Dt(Y.Slider,"errorTrack",Ne(Ki,Y.error.main,.62)),Dt(Y.Slider,"infoTrack",Ne(Ki,Y.info.main,.62)),Dt(Y.Slider,"successTrack",Ne(Ki,Y.success.main,.62)),Dt(Y.Slider,"warningTrack",Ne(Ki,Y.warning.main,.62));const Ze=pe?Ne(Zi,Y.background.default,.6825):tw(Y.background.default,.8);Dt(Y.SnackbarContent,"bg",Ze),Dt(Y.SnackbarContent,"color",hd(()=>pe?pA.text.primary:Y.getContrastText(Ze))),Dt(Y.SpeedDialAction,"fabHoverBg",tw(Y.background.paper,.15)),Dt(Y.StepConnector,"border",le("palette-grey-400")),Dt(Y.StepContent,"border",le("palette-grey-400")),Dt(Y.Switch,"defaultColor",le("palette-common-white")),Dt(Y.Switch,"defaultDisabledColor",le("palette-grey-100")),Dt(Y.Switch,"primaryDisabledColor",Ne(Ki,Y.primary.main,.62)),Dt(Y.Switch,"secondaryDisabledColor",Ne(Ki,Y.secondary.main,.62)),Dt(Y.Switch,"errorDisabledColor",Ne(Ki,Y.error.main,.62)),Dt(Y.Switch,"infoDisabledColor",Ne(Ki,Y.info.main,.62)),Dt(Y.Switch,"successDisabledColor",Ne(Ki,Y.success.main,.62)),Dt(Y.Switch,"warningDisabledColor",Ne(Ki,Y.warning.main,.62)),Dt(Y.TableCell,"border",Ne(Ki,Ne(gg,Y.divider,1),.88)),Dt(Y.Tooltip,"bg",Ne(gg,Y.grey[700],.92))}if(Y.mode==="dark"){Dt(Y.Alert,"errorColor",Ne(Ki,Y.error.light,.6)),Dt(Y.Alert,"infoColor",Ne(Ki,Y.info.light,.6)),Dt(Y.Alert,"successColor",Ne(Ki,Y.success.light,.6)),Dt(Y.Alert,"warningColor",Ne(Ki,Y.warning.light,.6)),Dt(Y.Alert,"errorFilledBg",le("palette-error-dark")),Dt(Y.Alert,"infoFilledBg",le("palette-info-dark")),Dt(Y.Alert,"successFilledBg",le("palette-success-dark")),Dt(Y.Alert,"warningFilledBg",le("palette-warning-dark")),Dt(Y.Alert,"errorFilledColor",hd(()=>Y.getContrastText(Y.error.dark))),Dt(Y.Alert,"infoFilledColor",hd(()=>Y.getContrastText(Y.info.dark))),Dt(Y.Alert,"successFilledColor",hd(()=>Y.getContrastText(Y.success.dark))),Dt(Y.Alert,"warningFilledColor",hd(()=>Y.getContrastText(Y.warning.dark))),Dt(Y.Alert,"errorStandardBg",Ne(Zi,Y.error.light,.9)),Dt(Y.Alert,"infoStandardBg",Ne(Zi,Y.info.light,.9)),Dt(Y.Alert,"successStandardBg",Ne(Zi,Y.success.light,.9)),Dt(Y.Alert,"warningStandardBg",Ne(Zi,Y.warning.light,.9)),Dt(Y.Alert,"errorIconColor",le("palette-error-main")),Dt(Y.Alert,"infoIconColor",le("palette-info-main")),Dt(Y.Alert,"successIconColor",le("palette-success-main")),Dt(Y.Alert,"warningIconColor",le("palette-warning-main")),Dt(Y.AppBar,"defaultBg",le("palette-grey-900")),Dt(Y.AppBar,"darkBg",le("palette-background-paper")),Dt(Y.AppBar,"darkColor",le("palette-text-primary")),Dt(Y.Avatar,"defaultBg",le("palette-grey-600")),Dt(Y.Button,"inheritContainedBg",le("palette-grey-800")),Dt(Y.Button,"inheritContainedHoverBg",le("palette-grey-700")),Dt(Y.Chip,"defaultBorder",le("palette-grey-700")),Dt(Y.Chip,"defaultAvatarColor",le("palette-grey-300")),Dt(Y.Chip,"defaultIconColor",le("palette-grey-300")),Dt(Y.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Dt(Y.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Dt(Y.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Dt(Y.LinearProgress,"primaryBg",Ne(Zi,Y.primary.main,.5)),Dt(Y.LinearProgress,"secondaryBg",Ne(Zi,Y.secondary.main,.5)),Dt(Y.LinearProgress,"errorBg",Ne(Zi,Y.error.main,.5)),Dt(Y.LinearProgress,"infoBg",Ne(Zi,Y.info.main,.5)),Dt(Y.LinearProgress,"successBg",Ne(Zi,Y.success.main,.5)),Dt(Y.LinearProgress,"warningBg",Ne(Zi,Y.warning.main,.5)),Dt(Y.Skeleton,"bg",pe?Ne(gg,Y.text.primary,.13):`rgba(${le("palette-text-primaryChannel")} / 0.13)`),Dt(Y.Slider,"primaryTrack",Ne(Zi,Y.primary.main,.5)),Dt(Y.Slider,"secondaryTrack",Ne(Zi,Y.secondary.main,.5)),Dt(Y.Slider,"errorTrack",Ne(Zi,Y.error.main,.5)),Dt(Y.Slider,"infoTrack",Ne(Zi,Y.info.main,.5)),Dt(Y.Slider,"successTrack",Ne(Zi,Y.success.main,.5)),Dt(Y.Slider,"warningTrack",Ne(Zi,Y.warning.main,.5));const Ze=pe?Ne(Ki,Y.background.default,.985):tw(Y.background.default,.98);Dt(Y.SnackbarContent,"bg",Ze),Dt(Y.SnackbarContent,"color",hd(()=>pe?pN.text.primary:Y.getContrastText(Ze))),Dt(Y.SpeedDialAction,"fabHoverBg",tw(Y.background.paper,.15)),Dt(Y.StepConnector,"border",le("palette-grey-600")),Dt(Y.StepContent,"border",le("palette-grey-600")),Dt(Y.Switch,"defaultColor",le("palette-grey-300")),Dt(Y.Switch,"defaultDisabledColor",le("palette-grey-600")),Dt(Y.Switch,"primaryDisabledColor",Ne(Zi,Y.primary.main,.55)),Dt(Y.Switch,"secondaryDisabledColor",Ne(Zi,Y.secondary.main,.55)),Dt(Y.Switch,"errorDisabledColor",Ne(Zi,Y.error.main,.55)),Dt(Y.Switch,"infoDisabledColor",Ne(Zi,Y.info.main,.55)),Dt(Y.Switch,"successDisabledColor",Ne(Zi,Y.success.main,.55)),Dt(Y.Switch,"warningDisabledColor",Ne(Zi,Y.warning.main,.55)),Dt(Y.TableCell,"border",Ne(Zi,Ne(gg,Y.divider,1),.68)),Dt(Y.Tooltip,"bg",Ne(gg,Y.grey[700],.92))}Pf(Y.background,"default"),Pf(Y.background,"paper"),Pf(Y.common,"background"),Pf(Y.common,"onBackground"),Pf(Y,"divider"),Object.keys(Y).forEach(Ze=>{const Ie=Y[Ze];Ze!=="tonalOffset"&&Ie&&typeof Ie=="object"&&(Ie.main&&Dt(Y[Ze],"mainChannel",J0(ex(Ie.main))),Ie.light&&Dt(Y[Ze],"lightChannel",J0(ex(Ie.light))),Ie.dark&&Dt(Y[Ze],"darkChannel",J0(ex(Ie.dark))),Ie.contrastText&&Dt(Y[Ze],"contrastTextChannel",J0(ex(Ie.contrastText))),Ze==="text"&&(Pf(Y[Ze],"primary"),Pf(Y[Ze],"secondary")),Ze==="action"&&(Ie.active&&Pf(Y[Ze],"active"),Ie.selected&&Pf(Y[Ze],"selected")))})}),Te=e.reduce((ve,Y)=>Jo(ve,Y),Te);const ae={prefix:f,disableCssColorScheme:u,shouldSkipGeneratingVar:b,getSelector:nJ(Te),enableContrastVars:g},{vars:re,generateThemeVars:he,generateStyleSheets:se}=gQ(Te,ae);return Te.vars=re,Object.entries(Te.colorSchemes[Te.defaultColorScheme]).forEach(([ve,Y])=>{Te[ve]=Y}),Te.generateThemeVars=he,Te.generateStyleSheets=se,Te.generateSpacing=function(){return QB(M.spacing,aE(this))},Te.getColorSchemeSelector=yQ(o),Te.spacing=Te.generateSpacing(),Te.shouldSkipGeneratingVar=b,Te.unstable_sxConfig={...vb,...M?.unstable_sxConfig},Te.unstable_sx=function(Y){return ym({sx:Y,theme:this})},Te.toRuntimeSource=yN,Te}function FL(t,e,n){t.colorSchemes&&n&&(t.colorSchemes[e]={...n!==!0&&n,palette:$R({...n===!0?{}:n.palette,mode:e})})}function _E(t={},...e){const{palette:n,cssVariables:i=!1,colorSchemes:u=n?void 0:{light:!0},defaultColorScheme:f=n?.mode,...g}=t,b=f||"light",o=u?.[b],S={...u,...n?{[b]:{...typeof o!="boolean"&&o,palette:n}}:void 0};if(i===!1){if(!("colorSchemes"in t))return mA(t,...e);let M=n;"palette"in t||S[b]&&(S[b]!==!0?M=S[b].palette:b==="dark"&&(M={mode:"dark"}));const O=mA({...t,palette:M},...e);return O.defaultColorScheme=b,O.colorSchemes=S,O.palette.mode==="light"&&(O.colorSchemes.light={...S.light!==!0&&S.light,palette:O.palette},FL(O,"dark",S.dark)),O.palette.mode==="dark"&&(O.colorSchemes.dark={...S.dark!==!0&&S.dark,palette:O.palette},FL(O,"light",S.light)),O}return!n&&!("light"in S)&&b==="light"&&(S.light=!0),oJ({...g,colorSchemes:S,defaultColorScheme:b,...typeof i!="boolean"&&i},...e)}const qR=_E();function Em(){const t=fE(qR);return t[Rd]||t}function vE(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const bl=t=>vE(t)&&t!=="classes",cn=iN({themeId:Rd,defaultTheme:qR,rootShouldForwardProp:bl});function aJ({theme:t,...e}){const n=Rd in t?t[Rd]:void 0;return U.jsx(hN,{...e,themeId:n?Rd:void 0,theme:n||t})}const nw={colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:lJ}=dQ({themeId:Rd,theme:()=>_E({cssVariables:!0}),colorSchemeStorageKey:nw.colorSchemeStorageKey,modeStorageKey:nw.modeStorageKey,defaultColorScheme:{light:nw.defaultLightColorScheme,dark:nw.defaultDarkColorScheme},resolveTheme:t=>{const e={...t,typography:gN(t.palette,t.typography)};return e.unstable_sx=function(i){return ym({sx:i,theme:this})},e}}),cJ=lJ;function uJ({theme:t,...e}){const n=W.useMemo(()=>{if(typeof t=="function")return t;const i=Rd in t?t[Rd]:t;return"colorSchemes"in i?null:"vars"in i?t:{...t,vars:null}},[t]);return n?U.jsx(aJ,{theme:n,...e}):U.jsx(cJ,{theme:t,...e})}function yA(...t){return t.reduce((e,n)=>n==null?e:function(...u){e.apply(this,u),n.apply(this,u)},()=>{})}function hJ(t){return U.jsx(JB,{...t,defaultTheme:qR,themeId:Rd})}function GR(t){return function(n){return U.jsx(hJ,{styles:typeof t=="function"?i=>t({theme:i,...n}):t})}}function dJ(){return NR}const br=iQ;function Rr(t){return eQ(t)}function fJ(t){return wr("MuiSvgIcon",t)}Sr("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const pJ=t=>{const{color:e,fontSize:n,classes:i}=t,u={root:["root",e!=="inherit"&&`color${tn(e)}`,`fontSize${tn(n)}`]};return Tr(u,fJ,i)},mJ=cn("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="inherit"&&e[`color${tn(n.color)}`],e[`fontSize${tn(n.fontSize)}`]]}})(br(({theme:t})=>({userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:t.transitions?.create?.("fill",{duration:(t.vars??t).transitions?.duration?.shorter}),variants:[{props:e=>!e.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:t.typography?.pxToRem?.(20)||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:t.typography?.pxToRem?.(24)||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:t.typography?.pxToRem?.(35)||"2.1875rem"}},...Object.entries((t.vars??t).palette).filter(([,e])=>e&&e.main).map(([e])=>({props:{color:e},style:{color:(t.vars??t).palette?.[e]?.main}})),{props:{color:"action"},style:{color:(t.vars??t).palette?.action?.active}},{props:{color:"disabled"},style:{color:(t.vars??t).palette?.action?.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}))),_A=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiSvgIcon"}),{children:u,className:f,color:g="inherit",component:b="svg",fontSize:o="medium",htmlColor:S,inheritViewBox:M=!1,titleAccess:O,viewBox:N="0 0 24 24",...j}=i,Z=W.isValidElement(u)&&u.type==="svg",K={...i,color:g,component:b,fontSize:o,instanceFontSize:e.fontSize,inheritViewBox:M,viewBox:N,hasSvgAsChild:Z},Q={};M||(Q.viewBox=N);const ce=pJ(K);return U.jsxs(mJ,{as:b,className:Pn(ce.root,f),focusable:"false",color:S,"aria-hidden":O?void 0:!0,role:O?"img":void 0,ref:n,...Q,...j,...Z&&u.props,ownerState:K,children:[Z?u.props.children:u,O?U.jsx("title",{children:O}):null]})});_A.muiName="SvgIcon";function Fo(t,e){function n(i,u){return U.jsx(_A,{"data-testid":void 0,ref:u,...i,children:t})}return n.muiName=_A.muiName,W.memo(W.forwardRef(n))}function xN(t,e=166){let n;function i(...u){const f=()=>{t.apply(this,u)};clearTimeout(n),n=setTimeout(f,e)}return i.clear=()=>{clearTimeout(n)},i}function xa(t){return t&&t.ownerDocument||document}function Hf(t){return xa(t).defaultView||window}function UL(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function V_(t){const{controlled:e,default:n,name:i,state:u="value"}=t,{current:f}=W.useRef(e!==void 0),[g,b]=W.useState(n),o=f?e:g,S=W.useCallback(M=>{f||b(M)},[]);return[o,S]}function mu(t){const e=W.useRef(t);return yu(()=>{e.current=t}),W.useRef((...n)=>(0,e.current)(...n)).current}function To(...t){const e=W.useRef(void 0),n=W.useCallback(i=>{const u=t.map(f=>{if(f==null)return null;if(typeof f=="function"){const g=f,b=g(i);return typeof b=="function"?b:()=>{g(null)}}return f.current=i,()=>{f.current=null}});return()=>{u.forEach(f=>f?.())}},t);return W.useMemo(()=>t.every(i=>i==null)?null:i=>{e.current&&(e.current(),e.current=void 0),i!=null&&(e.current=n(i))},t)}function gJ(t,e){const n=t.charCodeAt(2);return t[0]==="o"&&t[1]==="n"&&n>=65&&n<=90&&typeof e=="function"}function yJ(t,e){if(!t)return e;function n(g,b){const o={};return Object.keys(b).forEach(S=>{gJ(S,b[S])&&typeof g[S]=="function"&&(o[S]=(...M)=>{g[S](...M),b[S](...M)})}),o}if(typeof t=="function"||typeof e=="function")return g=>{const b=typeof e=="function"?e(g):e,o=typeof t=="function"?t({...g,...b}):t,S=Pn(g?.className,b?.className,o?.className),M=n(o,b);return{...b,...o,...M,...!!S&&{className:S},...b?.style&&o?.style&&{style:{...b.style,...o.style}},...b?.sx&&o?.sx&&{sx:[...Array.isArray(b.sx)?b.sx:[b.sx],...Array.isArray(o.sx)?o.sx:[o.sx]]}}};const i=e,u=n(t,i),f=Pn(i?.className,t?.className);return{...e,...t,...u,...!!f&&{className:f},...i?.style&&t?.style&&{style:{...i.style,...t.style}},...i?.sx&&t?.sx&&{sx:[...Array.isArray(i.sx)?i.sx:[i.sx],...Array.isArray(t.sx)?t.sx:[t.sx]]}}}function bN(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function vA(t,e){return vA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vA(t,e)}function wN(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,vA(t,e)}const jL={disabled:!1},wT=hu.createContext(null);var _J=function(e){return e.scrollTop},tx="unmounted",bg="exited",wg="entering",h_="entered",xA="exiting",Bd=(function(t){wN(e,t);function e(i,u){var f;f=t.call(this,i,u)||this;var g=u,b=g&&!g.isMounting?i.enter:i.appear,o;return f.appearStatus=null,i.in?b?(o=bg,f.appearStatus=wg):o=h_:i.unmountOnExit||i.mountOnEnter?o=tx:o=bg,f.state={status:o},f.nextCallback=null,f}e.getDerivedStateFromProps=function(u,f){var g=u.in;return g&&f.status===tx?{status:bg}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(u){var f=null;if(u!==this.props){var g=this.state.status;this.props.in?g!==wg&&g!==h_&&(f=wg):(g===wg||g===h_)&&(f=xA)}this.updateStatus(!1,f)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var u=this.props.timeout,f,g,b;return f=g=b=u,u!=null&&typeof u!="number"&&(f=u.exit,g=u.enter,b=u.appear!==void 0?u.appear:g),{exit:f,enter:g,appear:b}},n.updateStatus=function(u,f){if(u===void 0&&(u=!1),f!==null)if(this.cancelNextCallback(),f===wg){if(this.props.unmountOnExit||this.props.mountOnEnter){var g=this.props.nodeRef?this.props.nodeRef.current:U1.findDOMNode(this);g&&_J(g)}this.performEnter(u)}else this.performExit();else this.props.unmountOnExit&&this.state.status===bg&&this.setState({status:tx})},n.performEnter=function(u){var f=this,g=this.props.enter,b=this.context?this.context.isMounting:u,o=this.props.nodeRef?[b]:[U1.findDOMNode(this),b],S=o[0],M=o[1],O=this.getTimeouts(),N=b?O.appear:O.enter;if(!u&&!g||jL.disabled){this.safeSetState({status:h_},function(){f.props.onEntered(S)});return}this.props.onEnter(S,M),this.safeSetState({status:wg},function(){f.props.onEntering(S,M),f.onTransitionEnd(N,function(){f.safeSetState({status:h_},function(){f.props.onEntered(S,M)})})})},n.performExit=function(){var u=this,f=this.props.exit,g=this.getTimeouts(),b=this.props.nodeRef?void 0:U1.findDOMNode(this);if(!f||jL.disabled){this.safeSetState({status:bg},function(){u.props.onExited(b)});return}this.props.onExit(b),this.safeSetState({status:xA},function(){u.props.onExiting(b),u.onTransitionEnd(g.exit,function(){u.safeSetState({status:bg},function(){u.props.onExited(b)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(u,f){f=this.setNextCallback(f),this.setState(u,f)},n.setNextCallback=function(u){var f=this,g=!0;return this.nextCallback=function(b){g&&(g=!1,f.nextCallback=null,u(b))},this.nextCallback.cancel=function(){g=!1},this.nextCallback},n.onTransitionEnd=function(u,f){this.setNextCallback(f);var g=this.props.nodeRef?this.props.nodeRef.current:U1.findDOMNode(this),b=u==null&&!this.props.addEndListener;if(!g||b){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var o=this.props.nodeRef?[this.nextCallback]:[g,this.nextCallback],S=o[0],M=o[1];this.props.addEndListener(S,M)}u!=null&&setTimeout(this.nextCallback,u)},n.render=function(){var u=this.state.status;if(u===tx)return null;var f=this.props,g=f.children;f.in,f.mountOnEnter,f.unmountOnExit,f.appear,f.enter,f.exit,f.timeout,f.addEndListener,f.onEnter,f.onEntering,f.onEntered,f.onExit,f.onExiting,f.onExited,f.nodeRef;var b=bN(f,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return hu.createElement(wT.Provider,{value:null},typeof g=="function"?g(u,b):hu.cloneElement(hu.Children.only(g),b))},e})(hu.Component);Bd.contextType=wT;Bd.propTypes={};function n_(){}Bd.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:n_,onEntering:n_,onEntered:n_,onExit:n_,onExiting:n_,onExited:n_};Bd.UNMOUNTED=tx;Bd.EXITED=bg;Bd.ENTERING=wg;Bd.ENTERED=h_;Bd.EXITING=xA;function vJ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function HR(t,e){var n=function(f){return e&&W.isValidElement(f)?e(f):f},i=Object.create(null);return t&&W.Children.map(t,function(u){return u}).forEach(function(u){i[u.key]=n(u)}),i}function xJ(t,e){t=t||{},e=e||{};function n(M){return M in e?e[M]:t[M]}var i=Object.create(null),u=[];for(var f in t)f in e?u.length&&(i[f]=u,u=[]):u.push(f);var g,b={};for(var o in e){if(i[o])for(g=0;g<i[o].length;g++){var S=i[o][g];b[i[o][g]]=n(S)}b[o]=n(o)}for(g=0;g<u.length;g++)b[u[g]]=n(u[g]);return b}function Ag(t,e,n){return n[e]!=null?n[e]:t.props[e]}function bJ(t,e){return HR(t.children,function(n){return W.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:Ag(n,"appear",t),enter:Ag(n,"enter",t),exit:Ag(n,"exit",t)})})}function wJ(t,e,n){var i=HR(t.children),u=xJ(e,i);return Object.keys(u).forEach(function(f){var g=u[f];if(W.isValidElement(g)){var b=f in e,o=f in i,S=e[f],M=W.isValidElement(S)&&!S.props.in;o&&(!b||M)?u[f]=W.cloneElement(g,{onExited:n.bind(null,g),in:!0,exit:Ag(g,"exit",t),enter:Ag(g,"enter",t)}):!o&&b&&!M?u[f]=W.cloneElement(g,{in:!1}):o&&b&&W.isValidElement(S)&&(u[f]=W.cloneElement(g,{onExited:n.bind(null,g),in:S.props.in,exit:Ag(g,"exit",t),enter:Ag(g,"enter",t)}))}}),u}var TJ=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},EJ={component:"div",childFactory:function(e){return e}},WR=(function(t){wN(e,t);function e(i,u){var f;f=t.call(this,i,u)||this;var g=f.handleExited.bind(vJ(f));return f.state={contextValue:{isMounting:!0},handleExited:g,firstRender:!0},f}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(u,f){var g=f.children,b=f.handleExited,o=f.firstRender;return{children:o?bJ(u,b):wJ(u,g,b),firstRender:!1}},n.handleExited=function(u,f){var g=HR(this.props.children);u.key in g||(u.props.onExited&&u.props.onExited(f),this.mounted&&this.setState(function(b){var o=_T({},b.children);return delete o[u.key],{children:o}}))},n.render=function(){var u=this.props,f=u.component,g=u.childFactory,b=bN(u,["component","childFactory"]),o=this.state.contextValue,S=TJ(this.state.children).map(g);return delete b.appear,delete b.enter,delete b.exit,f===null?hu.createElement(wT.Provider,{value:o},S):hu.createElement(wT.Provider,{value:o},hu.createElement(f,b,S))},e})(hu.Component);WR.propTypes={};WR.defaultProps=EJ;const $L={};function TN(t,e){const n=W.useRef($L);return n.current===$L&&(n.current=t(e)),n}const SJ=[];function CJ(t){W.useEffect(t,SJ)}class xE{static create(){return new xE}currentId=null;start(e,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},e)}clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)};disposeEffect=()=>this.clear}function __(){const t=TN(xE.create).current;return CJ(t.disposeEffect),t}const EN=t=>t.scrollTop;function TT(t,e){const{timeout:n,easing:i,style:u={}}=t;return{duration:u.transitionDuration??(typeof n=="number"?n:n[e.mode]||0),easing:u.transitionTimingFunction??(typeof i=="object"?i[e.mode]:i),delay:u.transitionDelay}}function sm(t){return typeof t=="string"}function SN(t,e,n){return t===void 0||sm(t)?e:{...e,ownerState:{...e.ownerState,...n}}}function CN(t,e,n){return typeof t=="function"?t(e,n):t}function yx(t,e=[]){if(t===void 0)return{};const n={};return Object.keys(t).filter(i=>i.match(/^on[A-Z]/)&&typeof t[i]=="function"&&!e.includes(i)).forEach(i=>{n[i]=t[i]}),n}function qL(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(n=>!(n.match(/^on[A-Z]/)&&typeof t[n]=="function")).forEach(n=>{e[n]=t[n]}),e}function AN(t){const{getSlotProps:e,additionalProps:n,externalSlotProps:i,externalForwardedProps:u,className:f}=t;if(!e){const j=Pn(n?.className,f,u?.className,i?.className),Z={...n?.style,...u?.style,...i?.style},K={...n,...u,...i};return j.length>0&&(K.className=j),Object.keys(Z).length>0&&(K.style=Z),{props:K,internalRef:void 0}}const g=yx({...u,...i}),b=qL(i),o=qL(u),S=e(g),M=Pn(S?.className,n?.className,f,u?.className,i?.className),O={...S?.style,...n?.style,...u?.style,...i?.style},N={...S,...n,...o,...b};return M.length>0&&(N.className=M),Object.keys(O).length>0&&(N.style=O),{props:N,internalRef:S.ref}}function pi(t,e){const{className:n,elementType:i,ownerState:u,externalForwardedProps:f,internalForwardedProps:g,shouldForwardComponentProp:b=!1,...o}=e,{component:S,slots:M={[t]:void 0},slotProps:O={[t]:void 0},...N}=f,j=M[t]||i,Z=CN(O[t],u),{props:{component:K,...Q},internalRef:ce}=AN({className:n,...o,externalForwardedProps:t==="root"?N:void 0,externalSlotProps:Z}),ge=To(ce,Z?.ref,e.ref),ue=t==="root"?K||S:K,pe=SN(j,{...t==="root"&&!S&&!M[t]&&g,...t!=="root"&&!M[t]&&g,...Q,...ue&&!b&&{as:ue},...ue&&b&&{component:ue},ref:ge},u);return[j,pe]}function AJ(t){return wr("MuiPaper",t)}Sr("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const IJ=t=>{const{square:e,elevation:n,variant:i,classes:u}=t,f={root:["root",i,!e&&"rounded",i==="elevation"&&`elevation${n}`]};return Tr(f,AJ,u)},RJ=cn("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],!n.square&&e.rounded,n.variant==="elevation"&&e[`elevation${n.elevation}`]]}})(br(({theme:t})=>({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow"),variants:[{props:({ownerState:e})=>!e.square,style:{borderRadius:t.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(t.vars||t).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),Ec=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiPaper"}),u=Em(),{className:f,component:g="div",elevation:b=1,square:o=!1,variant:S="elevation",...M}=i,O={...i,component:g,elevation:b,square:o,variant:S},N=IJ(O);return U.jsx(RJ,{as:g,ownerState:O,className:Pn(N.root,f),ref:n,...M,style:{...S==="elevation"&&{"--Paper-shadow":(u.vars||u).shadows[b],...u.vars&&{"--Paper-overlay":u.vars.overlays?.[b]},...!u.vars&&u.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${bT("#fff",gA(b))}, ${bT("#fff",gA(b))})`}},...M.style}})});function F_(t){try{return t.matches(":focus-visible")}catch{}return!1}class ET{static create(){return new ET}static use(){const e=TN(ET.create).current,[n,i]=W.useState(!1);return e.shouldMount=n,e.setShouldMount=i,W.useEffect(e.mountEffect,[n]),e}constructor(){this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}mount(){return this.mounted||(this.mounted=PJ(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}mountEffect=()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())};start(...e){this.mount().then(()=>this.ref.current?.start(...e))}stop(...e){this.mount().then(()=>this.ref.current?.stop(...e))}pulsate(...e){this.mount().then(()=>this.ref.current?.pulsate(...e))}}function MJ(){return ET.use()}function PJ(){let t,e;const n=new Promise((i,u)=>{t=i,e=u});return n.resolve=t,n.reject=e,n}function kJ(t){const{className:e,classes:n,pulsate:i=!1,rippleX:u,rippleY:f,rippleSize:g,in:b,onExited:o,timeout:S}=t,[M,O]=W.useState(!1),N=Pn(e,n.ripple,n.rippleVisible,i&&n.ripplePulsate),j={width:g,height:g,top:-(g/2)+f,left:-(g/2)+u},Z=Pn(n.child,M&&n.childLeaving,i&&n.childPulsate);return!b&&!M&&O(!0),W.useEffect(()=>{if(!b&&o!=null){const K=setTimeout(o,S);return()=>{clearTimeout(K)}}},[o,b,S]),U.jsx("span",{className:N,style:j,children:U.jsx("span",{className:Z})})}const ou=Sr("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),bA=550,DJ=80,LJ=Gl`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,OJ=Gl`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,zJ=Gl`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,BJ=cn("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),NJ=cn(kJ,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${ou.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${LJ};
    animation-duration: ${bA}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  &.${ou.ripplePulsate} {
    animation-duration: ${({theme:t})=>t.transitions.duration.shorter}ms;
  }

  & .${ou.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${ou.childLeaving} {
    opacity: 0;
    animation-name: ${OJ};
    animation-duration: ${bA}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  & .${ou.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${zJ};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,VJ=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiTouchRipple"}),{center:u=!1,classes:f={},className:g,...b}=i,[o,S]=W.useState([]),M=W.useRef(0),O=W.useRef(null);W.useEffect(()=>{O.current&&(O.current(),O.current=null)},[o]);const N=W.useRef(!1),j=__(),Z=W.useRef(null),K=W.useRef(null),Q=W.useCallback(pe=>{const{pulsate:me,rippleX:Te,rippleY:ae,rippleSize:re,cb:he}=pe;S(se=>[...se,U.jsx(NJ,{classes:{ripple:Pn(f.ripple,ou.ripple),rippleVisible:Pn(f.rippleVisible,ou.rippleVisible),ripplePulsate:Pn(f.ripplePulsate,ou.ripplePulsate),child:Pn(f.child,ou.child),childLeaving:Pn(f.childLeaving,ou.childLeaving),childPulsate:Pn(f.childPulsate,ou.childPulsate)},timeout:bA,pulsate:me,rippleX:Te,rippleY:ae,rippleSize:re},M.current)]),M.current+=1,O.current=he},[f]),ce=W.useCallback((pe={},me={},Te=()=>{})=>{const{pulsate:ae=!1,center:re=u||me.pulsate,fakeElement:he=!1}=me;if(pe?.type==="mousedown"&&N.current){N.current=!1;return}pe?.type==="touchstart"&&(N.current=!0);const se=he?null:K.current,ve=se?se.getBoundingClientRect():{width:0,height:0,left:0,top:0};let Y,le,Ne;if(re||pe===void 0||pe.clientX===0&&pe.clientY===0||!pe.clientX&&!pe.touches)Y=Math.round(ve.width/2),le=Math.round(ve.height/2);else{const{clientX:Ze,clientY:Ie}=pe.touches&&pe.touches.length>0?pe.touches[0]:pe;Y=Math.round(Ze-ve.left),le=Math.round(Ie-ve.top)}if(re)Ne=Math.sqrt((2*ve.width**2+ve.height**2)/3),Ne%2===0&&(Ne+=1);else{const Ze=Math.max(Math.abs((se?se.clientWidth:0)-Y),Y)*2+2,Ie=Math.max(Math.abs((se?se.clientHeight:0)-le),le)*2+2;Ne=Math.sqrt(Ze**2+Ie**2)}pe?.touches?Z.current===null&&(Z.current=()=>{Q({pulsate:ae,rippleX:Y,rippleY:le,rippleSize:Ne,cb:Te})},j.start(DJ,()=>{Z.current&&(Z.current(),Z.current=null)})):Q({pulsate:ae,rippleX:Y,rippleY:le,rippleSize:Ne,cb:Te})},[u,Q,j]),ge=W.useCallback(()=>{ce({},{pulsate:!0})},[ce]),ue=W.useCallback((pe,me)=>{if(j.clear(),pe?.type==="touchend"&&Z.current){Z.current(),Z.current=null,j.start(0,()=>{ue(pe,me)});return}Z.current=null,S(Te=>Te.length>0?Te.slice(1):Te),O.current=me},[j]);return W.useImperativeHandle(n,()=>({pulsate:ge,start:ce,stop:ue}),[ge,ce,ue]),U.jsx(BJ,{className:Pn(ou.root,f.root,g),ref:K,...b,children:U.jsx(WR,{component:null,exit:!0,children:o})})});function FJ(t){return wr("MuiButtonBase",t)}const UJ=Sr("MuiButtonBase",["root","disabled","focusVisible"]),jJ=t=>{const{disabled:e,focusVisible:n,focusVisibleClassName:i,classes:u}=t,g=Tr({root:["root",e&&"disabled",n&&"focusVisible"]},FJ,u);return n&&i&&(g.root+=` ${i}`),g},$J=cn("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${UJ.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),U_=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiButtonBase"}),{action:u,centerRipple:f=!1,children:g,className:b,component:o="button",disabled:S=!1,disableRipple:M=!1,disableTouchRipple:O=!1,focusRipple:N=!1,focusVisibleClassName:j,LinkComponent:Z="a",onBlur:K,onClick:Q,onContextMenu:ce,onDragLeave:ge,onFocus:ue,onFocusVisible:pe,onKeyDown:me,onKeyUp:Te,onMouseDown:ae,onMouseLeave:re,onMouseUp:he,onTouchEnd:se,onTouchMove:ve,onTouchStart:Y,tabIndex:le=0,TouchRippleProps:Ne,touchRippleRef:Ze,type:Ie,...Je}=i,dt=W.useRef(null),et=MJ(),Kt=To(et.ref,Ze),[De,tt]=W.useState(!1);S&&De&&tt(!1),W.useImperativeHandle(u,()=>({focusVisible:()=>{tt(!0),dt.current.focus()}}),[]);const Et=et.shouldMount&&!M&&!S;W.useEffect(()=>{De&&N&&!M&&et.pulsate()},[M,N,De,et]);const wt=kf(et,"start",ae,O),Lt=kf(et,"stop",ce,O),Ut=kf(et,"stop",ge,O),an=kf(et,"stop",he,O),At=kf(et,"stop",mn=>{De&&mn.preventDefault(),re&&re(mn)},O),Qt=kf(et,"start",Y,O),Wt=kf(et,"stop",se,O),vn=kf(et,"stop",ve,O),Gt=kf(et,"stop",mn=>{F_(mn.target)||tt(!1),K&&K(mn)},!1),Cn=mu(mn=>{dt.current||(dt.current=mn.currentTarget),F_(mn.target)&&(tt(!0),pe&&pe(mn)),ue&&ue(mn)}),ln=()=>{const mn=dt.current;return o&&o!=="button"&&!(mn.tagName==="A"&&mn.href)},qn=mu(mn=>{N&&!mn.repeat&&De&&mn.key===" "&&et.stop(mn,()=>{et.start(mn)}),mn.target===mn.currentTarget&&ln()&&mn.key===" "&&mn.preventDefault(),me&&me(mn),mn.target===mn.currentTarget&&ln()&&mn.key==="Enter"&&!S&&(mn.preventDefault(),Q&&Q(mn))}),Rn=mu(mn=>{N&&mn.key===" "&&De&&!mn.defaultPrevented&&et.stop(mn,()=>{et.pulsate(mn)}),Te&&Te(mn),Q&&mn.target===mn.currentTarget&&ln()&&mn.key===" "&&!mn.defaultPrevented&&Q(mn)});let An=o;An==="button"&&(Je.href||Je.to)&&(An=Z);const rr={};An==="button"?(rr.type=Ie===void 0?"button":Ie,rr.disabled=S):(!Je.href&&!Je.to&&(rr.role="button"),S&&(rr["aria-disabled"]=S));const En=To(n,dt),bn={...i,centerRipple:f,component:o,disabled:S,disableRipple:M,disableTouchRipple:O,focusRipple:N,tabIndex:le,focusVisible:De},zn=jJ(bn);return U.jsxs($J,{as:An,className:Pn(zn.root,b),ownerState:bn,onBlur:Gt,onClick:Q,onContextMenu:Lt,onFocus:Cn,onKeyDown:qn,onKeyUp:Rn,onMouseDown:wt,onMouseLeave:At,onMouseUp:an,onDragLeave:Ut,onTouchEnd:Wt,onTouchMove:vn,onTouchStart:Qt,ref:En,tabIndex:S?-1:le,type:Ie,...rr,...Je,children:[g,Et?U.jsx(VJ,{ref:Kt,center:f,...Ne}):null]})});function kf(t,e,n,i=!1){return mu(u=>(n&&n(u),i||t[e](u),!0))}function qJ(t){return typeof t.main=="string"}function GJ(t,e=[]){if(!qJ(t))return!1;for(const n of e)if(!t.hasOwnProperty(n)||typeof t[n]!="string")return!1;return!0}function No(t=[]){return([,e])=>e&&GJ(e,t)}function HJ(t){return wr("MuiCircularProgress",t)}Sr("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","track","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const ah=44,wA=Gl`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,TA=Gl`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,WJ=typeof wA!="string"?DR`
        animation: ${wA} 1.4s linear infinite;
      `:null,XJ=typeof TA!="string"?DR`
        animation: ${TA} 1.4s ease-in-out infinite;
      `:null,ZJ=t=>{const{classes:e,variant:n,color:i,disableShrink:u}=t,f={root:["root",n,`color${tn(i)}`],svg:["svg"],track:["track"],circle:["circle",`circle${tn(n)}`,u&&"circleDisableShrink"]};return Tr(f,HJ,e)},KJ=cn("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`color${tn(n.color)}`]]}})(br(({theme:t})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("transform")}},{props:{variant:"indeterminate"},style:WJ||{animation:`${wA} 1.4s linear infinite`}},...Object.entries(t.palette).filter(No()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}}))]}))),YJ=cn("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),QJ=cn("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.circle,e[`circle${tn(n.variant)}`],n.disableShrink&&e.circleDisableShrink]}})(br(({theme:t})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink,style:XJ||{animation:`${TA} 1.4s ease-in-out infinite`}}]}))),JJ=cn("circle",{name:"MuiCircularProgress",slot:"Track"})(br(({theme:t})=>({stroke:"currentColor",opacity:(t.vars||t).palette.action.activatedOpacity}))),IN=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiCircularProgress"}),{className:u,color:f="primary",disableShrink:g=!1,enableTrackSlot:b=!1,size:o=40,style:S,thickness:M=3.6,value:O=0,variant:N="indeterminate",...j}=i,Z={...i,color:f,disableShrink:g,size:o,thickness:M,value:O,variant:N,enableTrackSlot:b},K=ZJ(Z),Q={},ce={},ge={};if(N==="determinate"){const ue=2*Math.PI*((ah-M)/2);Q.strokeDasharray=ue.toFixed(3),ge["aria-valuenow"]=Math.round(O),Q.strokeDashoffset=`${((100-O)/100*ue).toFixed(3)}px`,ce.transform="rotate(-90deg)"}return U.jsx(KJ,{className:Pn(K.root,u),style:{width:o,height:o,...ce,...S},ownerState:Z,ref:n,role:"progressbar",...ge,...j,children:U.jsxs(YJ,{className:K.svg,ownerState:Z,viewBox:`${ah/2} ${ah/2} ${ah} ${ah}`,children:[b?U.jsx(JJ,{className:K.track,ownerState:Z,cx:ah,cy:ah,r:(ah-M)/2,fill:"none",strokeWidth:M,"aria-hidden":"true"}):null,U.jsx(QJ,{className:K.circle,style:Q,ownerState:Z,cx:ah,cy:ah,r:(ah-M)/2,fill:"none",strokeWidth:M})]})})});function eee(t){return wr("MuiIconButton",t)}const GL=Sr("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),tee=t=>{const{classes:e,disabled:n,color:i,edge:u,size:f,loading:g}=t,b={root:["root",g&&"loading",n&&"disabled",i!=="default"&&`color${tn(i)}`,u&&`edge${tn(u)}`,`size${tn(f)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return Tr(b,eee,e)},nee=cn(U_,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.loading&&e.loading,n.color!=="default"&&e[`color${tn(n.color)}`],n.edge&&e[`edge${tn(n.edge)}`],e[`size${tn(n.size)}`]]}})(br(({theme:t})=>({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),variants:[{props:e=>!e.disableRipple,style:{"--IconButton-hoverBg":t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),br(({theme:t})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(t.palette).filter(No()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),...Object.entries(t.palette).filter(No()).map(([e])=>({props:{color:e},style:{"--IconButton-hoverBg":t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:t.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:t.typography.pxToRem(28)}}],[`&.${GL.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled},[`&.${GL.loading}`]:{color:"transparent"}}))),ree=cn("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(t.vars||t).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),Ig=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiIconButton"}),{edge:u=!1,children:f,className:g,color:b="default",disabled:o=!1,disableFocusRipple:S=!1,size:M="medium",id:O,loading:N=null,loadingIndicator:j,...Z}=i,K=Tm(O),Q=j??U.jsx(IN,{"aria-labelledby":K,color:"inherit",size:16}),ce={...i,edge:u,color:b,disabled:o,disableFocusRipple:S,loading:N,loadingIndicator:Q,size:M},ge=tee(ce);return U.jsxs(nee,{id:N?K:O,className:Pn(ge.root,g),centerRipple:!0,focusRipple:!S,disabled:o||N,ref:n,...Z,ownerState:ce,children:[typeof N=="boolean"&&U.jsx("span",{className:ge.loadingWrapper,style:{display:"contents"},children:U.jsx(ree,{className:ge.loadingIndicator,ownerState:ce,children:N&&Q})}),f]})});function iee(t){return wr("MuiTypography",t)}Sr("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const see={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},oee=dJ(),aee=t=>{const{align:e,gutterBottom:n,noWrap:i,paragraph:u,variant:f,classes:g}=t,b={root:["root",f,t.align!=="inherit"&&`align${tn(e)}`,n&&"gutterBottom",i&&"noWrap",u&&"paragraph"]};return Tr(b,iee,g)},lee=cn("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.variant&&e[n.variant],n.align!=="inherit"&&e[`align${tn(n.align)}`],n.noWrap&&e.noWrap,n.gutterBottom&&e.gutterBottom,n.paragraph&&e.paragraph]}})(br(({theme:t})=>({margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(t.typography).filter(([e,n])=>e!=="inherit"&&n&&typeof n=="object").map(([e,n])=>({props:{variant:e},style:n})),...Object.entries(t.palette).filter(No()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),...Object.entries(t.palette?.text||{}).filter(([,e])=>typeof e=="string").map(([e])=>({props:{color:`text${tn(e)}`},style:{color:(t.vars||t).palette.text[e]}})),{props:({ownerState:e})=>e.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:e})=>e.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:e})=>e.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:e})=>e.paragraph,style:{marginBottom:16}}]}))),HL={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},sn=W.forwardRef(function(e,n){const{color:i,...u}=Rr({props:e,name:"MuiTypography"}),f=!see[i],g=oee({...u,...f&&{color:i}}),{align:b="inherit",className:o,component:S,gutterBottom:M=!1,noWrap:O=!1,paragraph:N=!1,variant:j="body1",variantMapping:Z=HL,...K}=g,Q={...g,align:b,color:i,className:o,component:S,gutterBottom:M,noWrap:O,paragraph:N,variant:j,variantMapping:Z},ce=S||(N?"p":Z[j]||HL[j])||"span",ge=aee(Q);return U.jsx(lee,{as:ce,ref:n,className:Pn(ge.root,o),...K,ownerState:Q,style:{...b!=="inherit"&&{"--Typography-textAlign":b},...K.style}})});var jl="top",_u="bottom",vu="right",$l="left",XR="auto",bb=[jl,_u,vu,$l],j_="start",Gx="end",cee="clippingParents",RN="viewport",V0="popper",uee="reference",WL=bb.reduce(function(t,e){return t.concat([e+"-"+j_,e+"-"+Gx])},[]),MN=[].concat(bb,[XR]).reduce(function(t,e){return t.concat([e,e+"-"+j_,e+"-"+Gx])},[]),hee="beforeRead",dee="read",fee="afterRead",pee="beforeMain",mee="main",gee="afterMain",yee="beforeWrite",_ee="write",vee="afterWrite",xee=[hee,dee,fee,pee,mee,gee,yee,_ee,vee];function Ld(t){return t?(t.nodeName||"").toLowerCase():null}function Sc(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function $g(t){var e=Sc(t).Element;return t instanceof e||t instanceof Element}function gu(t){var e=Sc(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function ZR(t){if(typeof ShadowRoot>"u")return!1;var e=Sc(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function bee(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var i=e.styles[n]||{},u=e.attributes[n]||{},f=e.elements[n];!gu(f)||!Ld(f)||(Object.assign(f.style,i),Object.keys(u).forEach(function(g){var b=u[g];b===!1?f.removeAttribute(g):f.setAttribute(g,b===!0?"":b)}))})}function wee(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(i){var u=e.elements[i],f=e.attributes[i]||{},g=Object.keys(e.styles.hasOwnProperty(i)?e.styles[i]:n[i]),b=g.reduce(function(o,S){return o[S]="",o},{});!gu(u)||!Ld(u)||(Object.assign(u.style,b),Object.keys(f).forEach(function(o){u.removeAttribute(o)}))})}}const Tee={name:"applyStyles",enabled:!0,phase:"write",fn:bee,effect:wee,requires:["computeStyles"]};function Pd(t){return t.split("-")[0]}var Dg=Math.max,ST=Math.min,$_=Math.round;function EA(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function PN(){return!/^((?!chrome|android).)*safari/i.test(EA())}function q_(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var i=t.getBoundingClientRect(),u=1,f=1;e&&gu(t)&&(u=t.offsetWidth>0&&$_(i.width)/t.offsetWidth||1,f=t.offsetHeight>0&&$_(i.height)/t.offsetHeight||1);var g=$g(t)?Sc(t):window,b=g.visualViewport,o=!PN()&&n,S=(i.left+(o&&b?b.offsetLeft:0))/u,M=(i.top+(o&&b?b.offsetTop:0))/f,O=i.width/u,N=i.height/f;return{width:O,height:N,top:M,right:S+O,bottom:M+N,left:S,x:S,y:M}}function KR(t){var e=q_(t),n=t.offsetWidth,i=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-i)<=1&&(i=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:i}}function kN(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&ZR(n)){var i=e;do{if(i&&t.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function Wf(t){return Sc(t).getComputedStyle(t)}function Eee(t){return["table","td","th"].indexOf(Ld(t))>=0}function Sm(t){return(($g(t)?t.ownerDocument:t.document)||window.document).documentElement}function bE(t){return Ld(t)==="html"?t:t.assignedSlot||t.parentNode||(ZR(t)?t.host:null)||Sm(t)}function XL(t){return!gu(t)||Wf(t).position==="fixed"?null:t.offsetParent}function See(t){var e=/firefox/i.test(EA()),n=/Trident/i.test(EA());if(n&&gu(t)){var i=Wf(t);if(i.position==="fixed")return null}var u=bE(t);for(ZR(u)&&(u=u.host);gu(u)&&["html","body"].indexOf(Ld(u))<0;){var f=Wf(u);if(f.transform!=="none"||f.perspective!=="none"||f.contain==="paint"||["transform","perspective"].indexOf(f.willChange)!==-1||e&&f.willChange==="filter"||e&&f.filter&&f.filter!=="none")return u;u=u.parentNode}return null}function wb(t){for(var e=Sc(t),n=XL(t);n&&Eee(n)&&Wf(n).position==="static";)n=XL(n);return n&&(Ld(n)==="html"||Ld(n)==="body"&&Wf(n).position==="static")?e:n||See(t)||e}function YR(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function _x(t,e,n){return Dg(t,ST(e,n))}function Cee(t,e,n){var i=_x(t,e,n);return i>n?n:i}function DN(){return{top:0,right:0,bottom:0,left:0}}function LN(t){return Object.assign({},DN(),t)}function ON(t,e){return e.reduce(function(n,i){return n[i]=t,n},{})}var Aee=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,LN(typeof e!="number"?e:ON(e,bb))};function Iee(t){var e,n=t.state,i=t.name,u=t.options,f=n.elements.arrow,g=n.modifiersData.popperOffsets,b=Pd(n.placement),o=YR(b),S=[$l,vu].indexOf(b)>=0,M=S?"height":"width";if(!(!f||!g)){var O=Aee(u.padding,n),N=KR(f),j=o==="y"?jl:$l,Z=o==="y"?_u:vu,K=n.rects.reference[M]+n.rects.reference[o]-g[o]-n.rects.popper[M],Q=g[o]-n.rects.reference[o],ce=wb(f),ge=ce?o==="y"?ce.clientHeight||0:ce.clientWidth||0:0,ue=K/2-Q/2,pe=O[j],me=ge-N[M]-O[Z],Te=ge/2-N[M]/2+ue,ae=_x(pe,Te,me),re=o;n.modifiersData[i]=(e={},e[re]=ae,e.centerOffset=ae-Te,e)}}function Ree(t){var e=t.state,n=t.options,i=n.element,u=i===void 0?"[data-popper-arrow]":i;u!=null&&(typeof u=="string"&&(u=e.elements.popper.querySelector(u),!u)||kN(e.elements.popper,u)&&(e.elements.arrow=u))}const Mee={name:"arrow",enabled:!0,phase:"main",fn:Iee,effect:Ree,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function G_(t){return t.split("-")[1]}var Pee={top:"auto",right:"auto",bottom:"auto",left:"auto"};function kee(t,e){var n=t.x,i=t.y,u=e.devicePixelRatio||1;return{x:$_(n*u)/u||0,y:$_(i*u)/u||0}}function ZL(t){var e,n=t.popper,i=t.popperRect,u=t.placement,f=t.variation,g=t.offsets,b=t.position,o=t.gpuAcceleration,S=t.adaptive,M=t.roundOffsets,O=t.isFixed,N=g.x,j=N===void 0?0:N,Z=g.y,K=Z===void 0?0:Z,Q=typeof M=="function"?M({x:j,y:K}):{x:j,y:K};j=Q.x,K=Q.y;var ce=g.hasOwnProperty("x"),ge=g.hasOwnProperty("y"),ue=$l,pe=jl,me=window;if(S){var Te=wb(n),ae="clientHeight",re="clientWidth";if(Te===Sc(n)&&(Te=Sm(n),Wf(Te).position!=="static"&&b==="absolute"&&(ae="scrollHeight",re="scrollWidth")),Te=Te,u===jl||(u===$l||u===vu)&&f===Gx){pe=_u;var he=O&&Te===me&&me.visualViewport?me.visualViewport.height:Te[ae];K-=he-i.height,K*=o?1:-1}if(u===$l||(u===jl||u===_u)&&f===Gx){ue=vu;var se=O&&Te===me&&me.visualViewport?me.visualViewport.width:Te[re];j-=se-i.width,j*=o?1:-1}}var ve=Object.assign({position:b},S&&Pee),Y=M===!0?kee({x:j,y:K},Sc(n)):{x:j,y:K};if(j=Y.x,K=Y.y,o){var le;return Object.assign({},ve,(le={},le[pe]=ge?"0":"",le[ue]=ce?"0":"",le.transform=(me.devicePixelRatio||1)<=1?"translate("+j+"px, "+K+"px)":"translate3d("+j+"px, "+K+"px, 0)",le))}return Object.assign({},ve,(e={},e[pe]=ge?K+"px":"",e[ue]=ce?j+"px":"",e.transform="",e))}function Dee(t){var e=t.state,n=t.options,i=n.gpuAcceleration,u=i===void 0?!0:i,f=n.adaptive,g=f===void 0?!0:f,b=n.roundOffsets,o=b===void 0?!0:b,S={placement:Pd(e.placement),variation:G_(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:u,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,ZL(Object.assign({},S,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:g,roundOffsets:o})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,ZL(Object.assign({},S,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:o})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Lee={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Dee,data:{}};var rw={passive:!0};function Oee(t){var e=t.state,n=t.instance,i=t.options,u=i.scroll,f=u===void 0?!0:u,g=i.resize,b=g===void 0?!0:g,o=Sc(e.elements.popper),S=[].concat(e.scrollParents.reference,e.scrollParents.popper);return f&&S.forEach(function(M){M.addEventListener("scroll",n.update,rw)}),b&&o.addEventListener("resize",n.update,rw),function(){f&&S.forEach(function(M){M.removeEventListener("scroll",n.update,rw)}),b&&o.removeEventListener("resize",n.update,rw)}}const zee={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Oee,data:{}};var Bee={left:"right",right:"left",bottom:"top",top:"bottom"};function Vw(t){return t.replace(/left|right|bottom|top/g,function(e){return Bee[e]})}var Nee={start:"end",end:"start"};function KL(t){return t.replace(/start|end/g,function(e){return Nee[e]})}function QR(t){var e=Sc(t),n=e.pageXOffset,i=e.pageYOffset;return{scrollLeft:n,scrollTop:i}}function JR(t){return q_(Sm(t)).left+QR(t).scrollLeft}function Vee(t,e){var n=Sc(t),i=Sm(t),u=n.visualViewport,f=i.clientWidth,g=i.clientHeight,b=0,o=0;if(u){f=u.width,g=u.height;var S=PN();(S||!S&&e==="fixed")&&(b=u.offsetLeft,o=u.offsetTop)}return{width:f,height:g,x:b+JR(t),y:o}}function Fee(t){var e,n=Sm(t),i=QR(t),u=(e=t.ownerDocument)==null?void 0:e.body,f=Dg(n.scrollWidth,n.clientWidth,u?u.scrollWidth:0,u?u.clientWidth:0),g=Dg(n.scrollHeight,n.clientHeight,u?u.scrollHeight:0,u?u.clientHeight:0),b=-i.scrollLeft+JR(t),o=-i.scrollTop;return Wf(u||n).direction==="rtl"&&(b+=Dg(n.clientWidth,u?u.clientWidth:0)-f),{width:f,height:g,x:b,y:o}}function eM(t){var e=Wf(t),n=e.overflow,i=e.overflowX,u=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+u+i)}function zN(t){return["html","body","#document"].indexOf(Ld(t))>=0?t.ownerDocument.body:gu(t)&&eM(t)?t:zN(bE(t))}function vx(t,e){var n;e===void 0&&(e=[]);var i=zN(t),u=i===((n=t.ownerDocument)==null?void 0:n.body),f=Sc(i),g=u?[f].concat(f.visualViewport||[],eM(i)?i:[]):i,b=e.concat(g);return u?b:b.concat(vx(bE(g)))}function SA(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function Uee(t,e){var n=q_(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function YL(t,e,n){return e===RN?SA(Vee(t,n)):$g(e)?Uee(e,n):SA(Fee(Sm(t)))}function jee(t){var e=vx(bE(t)),n=["absolute","fixed"].indexOf(Wf(t).position)>=0,i=n&&gu(t)?wb(t):t;return $g(i)?e.filter(function(u){return $g(u)&&kN(u,i)&&Ld(u)!=="body"}):[]}function $ee(t,e,n,i){var u=e==="clippingParents"?jee(t):[].concat(e),f=[].concat(u,[n]),g=f[0],b=f.reduce(function(o,S){var M=YL(t,S,i);return o.top=Dg(M.top,o.top),o.right=ST(M.right,o.right),o.bottom=ST(M.bottom,o.bottom),o.left=Dg(M.left,o.left),o},YL(t,g,i));return b.width=b.right-b.left,b.height=b.bottom-b.top,b.x=b.left,b.y=b.top,b}function BN(t){var e=t.reference,n=t.element,i=t.placement,u=i?Pd(i):null,f=i?G_(i):null,g=e.x+e.width/2-n.width/2,b=e.y+e.height/2-n.height/2,o;switch(u){case jl:o={x:g,y:e.y-n.height};break;case _u:o={x:g,y:e.y+e.height};break;case vu:o={x:e.x+e.width,y:b};break;case $l:o={x:e.x-n.width,y:b};break;default:o={x:e.x,y:e.y}}var S=u?YR(u):null;if(S!=null){var M=S==="y"?"height":"width";switch(f){case j_:o[S]=o[S]-(e[M]/2-n[M]/2);break;case Gx:o[S]=o[S]+(e[M]/2-n[M]/2);break}}return o}function Hx(t,e){e===void 0&&(e={});var n=e,i=n.placement,u=i===void 0?t.placement:i,f=n.strategy,g=f===void 0?t.strategy:f,b=n.boundary,o=b===void 0?cee:b,S=n.rootBoundary,M=S===void 0?RN:S,O=n.elementContext,N=O===void 0?V0:O,j=n.altBoundary,Z=j===void 0?!1:j,K=n.padding,Q=K===void 0?0:K,ce=LN(typeof Q!="number"?Q:ON(Q,bb)),ge=N===V0?uee:V0,ue=t.rects.popper,pe=t.elements[Z?ge:N],me=$ee($g(pe)?pe:pe.contextElement||Sm(t.elements.popper),o,M,g),Te=q_(t.elements.reference),ae=BN({reference:Te,element:ue,placement:u}),re=SA(Object.assign({},ue,ae)),he=N===V0?re:Te,se={top:me.top-he.top+ce.top,bottom:he.bottom-me.bottom+ce.bottom,left:me.left-he.left+ce.left,right:he.right-me.right+ce.right},ve=t.modifiersData.offset;if(N===V0&&ve){var Y=ve[u];Object.keys(se).forEach(function(le){var Ne=[vu,_u].indexOf(le)>=0?1:-1,Ze=[jl,_u].indexOf(le)>=0?"y":"x";se[le]+=Y[Ze]*Ne})}return se}function qee(t,e){e===void 0&&(e={});var n=e,i=n.placement,u=n.boundary,f=n.rootBoundary,g=n.padding,b=n.flipVariations,o=n.allowedAutoPlacements,S=o===void 0?MN:o,M=G_(i),O=M?b?WL:WL.filter(function(Z){return G_(Z)===M}):bb,N=O.filter(function(Z){return S.indexOf(Z)>=0});N.length===0&&(N=O);var j=N.reduce(function(Z,K){return Z[K]=Hx(t,{placement:K,boundary:u,rootBoundary:f,padding:g})[Pd(K)],Z},{});return Object.keys(j).sort(function(Z,K){return j[Z]-j[K]})}function Gee(t){if(Pd(t)===XR)return[];var e=Vw(t);return[KL(t),e,KL(e)]}function Hee(t){var e=t.state,n=t.options,i=t.name;if(!e.modifiersData[i]._skip){for(var u=n.mainAxis,f=u===void 0?!0:u,g=n.altAxis,b=g===void 0?!0:g,o=n.fallbackPlacements,S=n.padding,M=n.boundary,O=n.rootBoundary,N=n.altBoundary,j=n.flipVariations,Z=j===void 0?!0:j,K=n.allowedAutoPlacements,Q=e.options.placement,ce=Pd(Q),ge=ce===Q,ue=o||(ge||!Z?[Vw(Q)]:Gee(Q)),pe=[Q].concat(ue).reduce(function(wt,Lt){return wt.concat(Pd(Lt)===XR?qee(e,{placement:Lt,boundary:M,rootBoundary:O,padding:S,flipVariations:Z,allowedAutoPlacements:K}):Lt)},[]),me=e.rects.reference,Te=e.rects.popper,ae=new Map,re=!0,he=pe[0],se=0;se<pe.length;se++){var ve=pe[se],Y=Pd(ve),le=G_(ve)===j_,Ne=[jl,_u].indexOf(Y)>=0,Ze=Ne?"width":"height",Ie=Hx(e,{placement:ve,boundary:M,rootBoundary:O,altBoundary:N,padding:S}),Je=Ne?le?vu:$l:le?_u:jl;me[Ze]>Te[Ze]&&(Je=Vw(Je));var dt=Vw(Je),et=[];if(f&&et.push(Ie[Y]<=0),b&&et.push(Ie[Je]<=0,Ie[dt]<=0),et.every(function(wt){return wt})){he=ve,re=!1;break}ae.set(ve,et)}if(re)for(var Kt=Z?3:1,De=function(Lt){var Ut=pe.find(function(an){var At=ae.get(an);if(At)return At.slice(0,Lt).every(function(Qt){return Qt})});if(Ut)return he=Ut,"break"},tt=Kt;tt>0;tt--){var Et=De(tt);if(Et==="break")break}e.placement!==he&&(e.modifiersData[i]._skip=!0,e.placement=he,e.reset=!0)}}const Wee={name:"flip",enabled:!0,phase:"main",fn:Hee,requiresIfExists:["offset"],data:{_skip:!1}};function QL(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function JL(t){return[jl,vu,_u,$l].some(function(e){return t[e]>=0})}function Xee(t){var e=t.state,n=t.name,i=e.rects.reference,u=e.rects.popper,f=e.modifiersData.preventOverflow,g=Hx(e,{elementContext:"reference"}),b=Hx(e,{altBoundary:!0}),o=QL(g,i),S=QL(b,u,f),M=JL(o),O=JL(S);e.modifiersData[n]={referenceClippingOffsets:o,popperEscapeOffsets:S,isReferenceHidden:M,hasPopperEscaped:O},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":M,"data-popper-escaped":O})}const Zee={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Xee};function Kee(t,e,n){var i=Pd(t),u=[$l,jl].indexOf(i)>=0?-1:1,f=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,g=f[0],b=f[1];return g=g||0,b=(b||0)*u,[$l,vu].indexOf(i)>=0?{x:b,y:g}:{x:g,y:b}}function Yee(t){var e=t.state,n=t.options,i=t.name,u=n.offset,f=u===void 0?[0,0]:u,g=MN.reduce(function(M,O){return M[O]=Kee(O,e.rects,f),M},{}),b=g[e.placement],o=b.x,S=b.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=o,e.modifiersData.popperOffsets.y+=S),e.modifiersData[i]=g}const Qee={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Yee};function Jee(t){var e=t.state,n=t.name;e.modifiersData[n]=BN({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const ete={name:"popperOffsets",enabled:!0,phase:"read",fn:Jee,data:{}};function tte(t){return t==="x"?"y":"x"}function nte(t){var e=t.state,n=t.options,i=t.name,u=n.mainAxis,f=u===void 0?!0:u,g=n.altAxis,b=g===void 0?!1:g,o=n.boundary,S=n.rootBoundary,M=n.altBoundary,O=n.padding,N=n.tether,j=N===void 0?!0:N,Z=n.tetherOffset,K=Z===void 0?0:Z,Q=Hx(e,{boundary:o,rootBoundary:S,padding:O,altBoundary:M}),ce=Pd(e.placement),ge=G_(e.placement),ue=!ge,pe=YR(ce),me=tte(pe),Te=e.modifiersData.popperOffsets,ae=e.rects.reference,re=e.rects.popper,he=typeof K=="function"?K(Object.assign({},e.rects,{placement:e.placement})):K,se=typeof he=="number"?{mainAxis:he,altAxis:he}:Object.assign({mainAxis:0,altAxis:0},he),ve=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,Y={x:0,y:0};if(Te){if(f){var le,Ne=pe==="y"?jl:$l,Ze=pe==="y"?_u:vu,Ie=pe==="y"?"height":"width",Je=Te[pe],dt=Je+Q[Ne],et=Je-Q[Ze],Kt=j?-re[Ie]/2:0,De=ge===j_?ae[Ie]:re[Ie],tt=ge===j_?-re[Ie]:-ae[Ie],Et=e.elements.arrow,wt=j&&Et?KR(Et):{width:0,height:0},Lt=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:DN(),Ut=Lt[Ne],an=Lt[Ze],At=_x(0,ae[Ie],wt[Ie]),Qt=ue?ae[Ie]/2-Kt-At-Ut-se.mainAxis:De-At-Ut-se.mainAxis,Wt=ue?-ae[Ie]/2+Kt+At+an+se.mainAxis:tt+At+an+se.mainAxis,vn=e.elements.arrow&&wb(e.elements.arrow),Gt=vn?pe==="y"?vn.clientTop||0:vn.clientLeft||0:0,Cn=(le=ve?.[pe])!=null?le:0,ln=Je+Qt-Cn-Gt,qn=Je+Wt-Cn,Rn=_x(j?ST(dt,ln):dt,Je,j?Dg(et,qn):et);Te[pe]=Rn,Y[pe]=Rn-Je}if(b){var An,rr=pe==="x"?jl:$l,En=pe==="x"?_u:vu,bn=Te[me],zn=me==="y"?"height":"width",mn=bn+Q[rr],ti=bn-Q[En],Xn=[jl,$l].indexOf(ce)!==-1,on=(An=ve?.[me])!=null?An:0,Jt=Xn?mn:bn-ae[zn]-re[zn]-on+se.altAxis,yn=Xn?bn+ae[zn]+re[zn]-on-se.altAxis:ti,_n=j&&Xn?Cee(Jt,bn,yn):_x(j?Jt:mn,bn,j?yn:ti);Te[me]=_n,Y[me]=_n-bn}e.modifiersData[i]=Y}}const rte={name:"preventOverflow",enabled:!0,phase:"main",fn:nte,requiresIfExists:["offset"]};function ite(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function ste(t){return t===Sc(t)||!gu(t)?QR(t):ite(t)}function ote(t){var e=t.getBoundingClientRect(),n=$_(e.width)/t.offsetWidth||1,i=$_(e.height)/t.offsetHeight||1;return n!==1||i!==1}function ate(t,e,n){n===void 0&&(n=!1);var i=gu(e),u=gu(e)&&ote(e),f=Sm(e),g=q_(t,u,n),b={scrollLeft:0,scrollTop:0},o={x:0,y:0};return(i||!i&&!n)&&((Ld(e)!=="body"||eM(f))&&(b=ste(e)),gu(e)?(o=q_(e,!0),o.x+=e.clientLeft,o.y+=e.clientTop):f&&(o.x=JR(f))),{x:g.left+b.scrollLeft-o.x,y:g.top+b.scrollTop-o.y,width:g.width,height:g.height}}function lte(t){var e=new Map,n=new Set,i=[];t.forEach(function(f){e.set(f.name,f)});function u(f){n.add(f.name);var g=[].concat(f.requires||[],f.requiresIfExists||[]);g.forEach(function(b){if(!n.has(b)){var o=e.get(b);o&&u(o)}}),i.push(f)}return t.forEach(function(f){n.has(f.name)||u(f)}),i}function cte(t){var e=lte(t);return xee.reduce(function(n,i){return n.concat(e.filter(function(u){return u.phase===i}))},[])}function ute(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function hte(t){var e=t.reduce(function(n,i){var u=n[i.name];return n[i.name]=u?Object.assign({},u,i,{options:Object.assign({},u.options,i.options),data:Object.assign({},u.data,i.data)}):i,n},{});return Object.keys(e).map(function(n){return e[n]})}var eO={placement:"bottom",modifiers:[],strategy:"absolute"};function tO(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function dte(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,i=n===void 0?[]:n,u=e.defaultOptions,f=u===void 0?eO:u;return function(b,o,S){S===void 0&&(S=f);var M={placement:"bottom",orderedModifiers:[],options:Object.assign({},eO,f),modifiersData:{},elements:{reference:b,popper:o},attributes:{},styles:{}},O=[],N=!1,j={state:M,setOptions:function(ce){var ge=typeof ce=="function"?ce(M.options):ce;K(),M.options=Object.assign({},f,M.options,ge),M.scrollParents={reference:$g(b)?vx(b):b.contextElement?vx(b.contextElement):[],popper:vx(o)};var ue=cte(hte([].concat(i,M.options.modifiers)));return M.orderedModifiers=ue.filter(function(pe){return pe.enabled}),Z(),j.update()},forceUpdate:function(){if(!N){var ce=M.elements,ge=ce.reference,ue=ce.popper;if(tO(ge,ue)){M.rects={reference:ate(ge,wb(ue),M.options.strategy==="fixed"),popper:KR(ue)},M.reset=!1,M.placement=M.options.placement,M.orderedModifiers.forEach(function(se){return M.modifiersData[se.name]=Object.assign({},se.data)});for(var pe=0;pe<M.orderedModifiers.length;pe++){if(M.reset===!0){M.reset=!1,pe=-1;continue}var me=M.orderedModifiers[pe],Te=me.fn,ae=me.options,re=ae===void 0?{}:ae,he=me.name;typeof Te=="function"&&(M=Te({state:M,options:re,name:he,instance:j})||M)}}}},update:ute(function(){return new Promise(function(Q){j.forceUpdate(),Q(M)})}),destroy:function(){K(),N=!0}};if(!tO(b,o))return j;j.setOptions(S).then(function(Q){!N&&S.onFirstUpdate&&S.onFirstUpdate(Q)});function Z(){M.orderedModifiers.forEach(function(Q){var ce=Q.name,ge=Q.options,ue=ge===void 0?{}:ge,pe=Q.effect;if(typeof pe=="function"){var me=pe({state:M,name:ce,instance:j,options:ue}),Te=function(){};O.push(me||Te)}})}function K(){O.forEach(function(Q){return Q()}),O=[]}return j}}var fte=[zee,ete,Lee,Tee,Qee,Wee,rte,Mee,Zee],pte=dte({defaultModifiers:fte});function fd(t){const{elementType:e,externalSlotProps:n,ownerState:i,skipResolvingSlotProps:u=!1,...f}=t,g=u?{}:CN(n,i),{props:b,internalRef:o}=AN({...f,externalSlotProps:g}),S=To(o,g?.ref,t.additionalProps?.ref);return SN(e,{...b,ref:S},i)}function lv(t){return parseInt(W.version,10)>=19?t?.props?.ref||null:t?.ref||null}function mte(t){return typeof t=="function"?t():t}const NN=W.forwardRef(function(e,n){const{children:i,container:u,disablePortal:f=!1}=e,[g,b]=W.useState(null),o=To(W.isValidElement(i)?lv(i):null,n);if(yu(()=>{f||b(mte(u)||document.body)},[u,f]),yu(()=>{if(g&&!f)return UL(n,g),()=>{UL(n,null)}},[n,g,f]),f){if(W.isValidElement(i)){const S={ref:o};return W.cloneElement(i,S)}return i}return g&&u3.createPortal(i,g)});function gte(t){return wr("MuiPopper",t)}Sr("MuiPopper",["root"]);function yte(t,e){if(e==="ltr")return t;switch(t){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return t}}function CA(t){return typeof t=="function"?t():t}function _te(t){return t.nodeType!==void 0}const vte=t=>{const{classes:e}=t;return Tr({root:["root"]},gte,e)},xte={},bte=W.forwardRef(function(e,n){const{anchorEl:i,children:u,direction:f,disablePortal:g,modifiers:b,open:o,placement:S,popperOptions:M,popperRef:O,slotProps:N={},slots:j={},TransitionProps:Z,ownerState:K,...Q}=e,ce=W.useRef(null),ge=To(ce,n),ue=W.useRef(null),pe=To(ue,O),me=W.useRef(pe);yu(()=>{me.current=pe},[pe]),W.useImperativeHandle(O,()=>ue.current,[]);const Te=yte(S,f),[ae,re]=W.useState(Te),[he,se]=W.useState(CA(i));W.useEffect(()=>{ue.current&&ue.current.forceUpdate()}),W.useEffect(()=>{i&&se(CA(i))},[i]),yu(()=>{if(!he||!o)return;const Ze=dt=>{re(dt.placement)};let Ie=[{name:"preventOverflow",options:{altBoundary:g}},{name:"flip",options:{altBoundary:g}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:dt})=>{Ze(dt)}}];b!=null&&(Ie=Ie.concat(b)),M&&M.modifiers!=null&&(Ie=Ie.concat(M.modifiers));const Je=pte(he,ce.current,{placement:Te,...M,modifiers:Ie});return me.current(Je),()=>{Je.destroy(),me.current(null)}},[he,g,b,o,M,Te]);const ve={placement:ae};Z!==null&&(ve.TransitionProps=Z);const Y=vte(e),le=j.root??"div",Ne=fd({elementType:le,externalSlotProps:N.root,externalForwardedProps:Q,additionalProps:{role:"tooltip",ref:ge},ownerState:e,className:Y.root});return U.jsx(le,{...Ne,children:typeof u=="function"?u(ve):u})}),wte=W.forwardRef(function(e,n){const{anchorEl:i,children:u,container:f,direction:g="ltr",disablePortal:b=!1,keepMounted:o=!1,modifiers:S,open:M,placement:O="bottom",popperOptions:N=xte,popperRef:j,style:Z,transition:K=!1,slotProps:Q={},slots:ce={},...ge}=e,[ue,pe]=W.useState(!0),me=()=>{pe(!1)},Te=()=>{pe(!0)};if(!o&&!M&&(!K||ue))return null;let ae;if(f)ae=f;else if(i){const se=CA(i);ae=se&&_te(se)?xa(se).body:xa(null).body}const re=!M&&o&&(!K||ue)?"none":void 0,he=K?{in:M,onEnter:me,onExited:Te}:void 0;return U.jsx(NN,{disablePortal:b,container:ae,children:U.jsx(bte,{anchorEl:i,direction:g,disablePortal:b,modifiers:S,ref:n,open:K?!ue:M,placement:O,popperOptions:N,popperRef:j,slotProps:Q,slots:ce,...ge,style:{position:"fixed",top:0,left:0,display:re,...Z},TransitionProps:he,children:u})})}),Tte=cn(wte,{name:"MuiPopper",slot:"Root"})({}),VN=W.forwardRef(function(e,n){const i=yE(),u=Rr({props:e,name:"MuiPopper"}),{anchorEl:f,component:g,components:b,componentsProps:o,container:S,disablePortal:M,keepMounted:O,modifiers:N,open:j,placement:Z,popperOptions:K,popperRef:Q,transition:ce,slots:ge,slotProps:ue,...pe}=u,me=ge?.root??b?.Root,Te={anchorEl:f,container:S,disablePortal:M,keepMounted:O,modifiers:N,open:j,placement:Z,popperOptions:K,popperRef:Q,transition:ce,...pe};return U.jsx(Tte,{as:g,direction:i?"rtl":"ltr",slots:{root:me},slotProps:ue??o,...Te,ref:n})}),Ete=Fo(U.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}));function Ste(t){return wr("MuiChip",t)}const ei=Sr("MuiChip",["root","sizeSmall","sizeMedium","colorDefault","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),Cte=t=>{const{classes:e,disabled:n,size:i,color:u,iconColor:f,onDelete:g,clickable:b,variant:o}=t,S={root:["root",o,n&&"disabled",`size${tn(i)}`,`color${tn(u)}`,b&&"clickable",b&&`clickableColor${tn(u)}`,g&&"deletable",g&&`deletableColor${tn(u)}`,`${o}${tn(u)}`],label:["label",`label${tn(i)}`],avatar:["avatar",`avatar${tn(i)}`,`avatarColor${tn(u)}`],icon:["icon",`icon${tn(i)}`,`iconColor${tn(f)}`],deleteIcon:["deleteIcon",`deleteIcon${tn(i)}`,`deleteIconColor${tn(u)}`,`deleteIcon${tn(o)}Color${tn(u)}`]};return Tr(S,Ste,e)},Ate=cn("div",{name:"MuiChip",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t,{color:i,iconColor:u,clickable:f,onDelete:g,size:b,variant:o}=n;return[{[`& .${ei.avatar}`]:e.avatar},{[`& .${ei.avatar}`]:e[`avatar${tn(b)}`]},{[`& .${ei.avatar}`]:e[`avatarColor${tn(i)}`]},{[`& .${ei.icon}`]:e.icon},{[`& .${ei.icon}`]:e[`icon${tn(b)}`]},{[`& .${ei.icon}`]:e[`iconColor${tn(u)}`]},{[`& .${ei.deleteIcon}`]:e.deleteIcon},{[`& .${ei.deleteIcon}`]:e[`deleteIcon${tn(b)}`]},{[`& .${ei.deleteIcon}`]:e[`deleteIconColor${tn(i)}`]},{[`& .${ei.deleteIcon}`]:e[`deleteIcon${tn(o)}Color${tn(i)}`]},e.root,e[`size${tn(b)}`],e[`color${tn(i)}`],f&&e.clickable,f&&i!=="default"&&e[`clickableColor${tn(i)})`],g&&e.deletable,g&&i!=="default"&&e[`deletableColor${tn(i)}`],e[o],e[`${o}${tn(i)}`]]}})(br(({theme:t})=>{const e=t.palette.mode==="light"?t.palette.grey[700]:t.palette.grey[300];return{maxWidth:"100%",fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,lineHeight:1.5,color:(t.vars||t).palette.text.primary,backgroundColor:(t.vars||t).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:t.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${ei.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${ei.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:t.vars?t.vars.palette.Chip.defaultAvatarColor:e,fontSize:t.typography.pxToRem(12)},[`& .${ei.avatarColorPrimary}`]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.dark},[`& .${ei.avatarColorSecondary}`]:{color:(t.vars||t).palette.secondary.contrastText,backgroundColor:(t.vars||t).palette.secondary.dark},[`& .${ei.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:t.typography.pxToRem(10)},[`& .${ei.icon}`]:{marginLeft:5,marginRight:-6},[`& .${ei.deleteIcon}`]:{WebkitTapHighlightColor:"transparent",color:t.alpha((t.vars||t).palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:t.alpha((t.vars||t).palette.text.primary,.4)}},variants:[{props:{size:"small"},style:{height:24,[`& .${ei.icon}`]:{fontSize:18,marginLeft:4,marginRight:-4},[`& .${ei.deleteIcon}`]:{fontSize:16,marginRight:4,marginLeft:-4}}},...Object.entries(t.palette).filter(No(["contrastText"])).map(([n])=>({props:{color:n},style:{backgroundColor:(t.vars||t).palette[n].main,color:(t.vars||t).palette[n].contrastText,[`& .${ei.deleteIcon}`]:{color:t.alpha((t.vars||t).palette[n].contrastText,.7),"&:hover, &:active":{color:(t.vars||t).palette[n].contrastText}}}})),{props:n=>n.iconColor===n.color,style:{[`& .${ei.icon}`]:{color:t.vars?t.vars.palette.Chip.defaultIconColor:e}}},{props:n=>n.iconColor===n.color&&n.color!=="default",style:{[`& .${ei.icon}`]:{color:"inherit"}}},{props:{onDelete:!0},style:{[`&.${ei.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette.action.selected,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.focusOpacity}`)}}},...Object.entries(t.palette).filter(No(["dark"])).map(([n])=>({props:{color:n,onDelete:!0},style:{[`&.${ei.focusVisible}`]:{background:(t.vars||t).palette[n].dark}}})),{props:{clickable:!0},style:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.selected,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.hoverOpacity}`)},[`&.${ei.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette.action.selected,`${(t.vars||t).palette.action.selectedOpacity} + ${(t.vars||t).palette.action.focusOpacity}`)},"&:active":{boxShadow:(t.vars||t).shadows[1]}}},...Object.entries(t.palette).filter(No(["dark"])).map(([n])=>({props:{color:n,clickable:!0},style:{[`&:hover, &.${ei.focusVisible}`]:{backgroundColor:(t.vars||t).palette[n].dark}}})),{props:{variant:"outlined"},style:{backgroundColor:"transparent",border:t.vars?`1px solid ${t.vars.palette.Chip.defaultBorder}`:`1px solid ${t.palette.mode==="light"?t.palette.grey[400]:t.palette.grey[700]}`,[`&.${ei.clickable}:hover`]:{backgroundColor:(t.vars||t).palette.action.hover},[`&.${ei.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`& .${ei.avatar}`]:{marginLeft:4},[`& .${ei.avatarSmall}`]:{marginLeft:2},[`& .${ei.icon}`]:{marginLeft:4},[`& .${ei.iconSmall}`]:{marginLeft:2},[`& .${ei.deleteIcon}`]:{marginRight:5},[`& .${ei.deleteIconSmall}`]:{marginRight:3}}},...Object.entries(t.palette).filter(No()).map(([n])=>({props:{variant:"outlined",color:n},style:{color:(t.vars||t).palette[n].main,border:`1px solid ${t.alpha((t.vars||t).palette[n].main,.7)}`,[`&.${ei.clickable}:hover`]:{backgroundColor:t.alpha((t.vars||t).palette[n].main,(t.vars||t).palette.action.hoverOpacity)},[`&.${ei.focusVisible}`]:{backgroundColor:t.alpha((t.vars||t).palette[n].main,(t.vars||t).palette.action.focusOpacity)},[`& .${ei.deleteIcon}`]:{color:t.alpha((t.vars||t).palette[n].main,.7),"&:hover, &:active":{color:(t.vars||t).palette[n].main}}}}))]}})),Ite=cn("span",{name:"MuiChip",slot:"Label",overridesResolver:(t,e)=>{const{ownerState:n}=t,{size:i}=n;return[e.label,e[`label${tn(i)}`]]}})({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",variants:[{props:{variant:"outlined"},style:{paddingLeft:11,paddingRight:11}},{props:{size:"small"},style:{paddingLeft:8,paddingRight:8}},{props:{size:"small",variant:"outlined"},style:{paddingLeft:7,paddingRight:7}}]});function nO(t){return t.key==="Backspace"||t.key==="Delete"}const Tb=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiChip"}),{avatar:u,className:f,clickable:g,color:b="default",component:o,deleteIcon:S,disabled:M=!1,icon:O,label:N,onClick:j,onDelete:Z,onKeyDown:K,onKeyUp:Q,size:ce="medium",variant:ge="filled",tabIndex:ue,skipFocusWhenDisabled:pe=!1,slots:me={},slotProps:Te={},...ae}=i,re=W.useRef(null),he=To(re,n),se=Ut=>{Ut.stopPropagation(),Z&&Z(Ut)},ve=Ut=>{Ut.currentTarget===Ut.target&&nO(Ut)&&Ut.preventDefault(),K&&K(Ut)},Y=Ut=>{Ut.currentTarget===Ut.target&&Z&&nO(Ut)&&Z(Ut),Q&&Q(Ut)},le=g!==!1&&j?!0:g,Ne=le||Z?U_:o||"div",Ze={...i,component:Ne,disabled:M,size:ce,color:b,iconColor:W.isValidElement(O)&&O.props.color||b,onDelete:!!Z,clickable:le,variant:ge},Ie=Cte(Ze),Je=Ne===U_?{component:o||"div",focusVisibleClassName:Ie.focusVisible,...Z&&{disableRipple:!0}}:{};let dt=null;Z&&(dt=S&&W.isValidElement(S)?W.cloneElement(S,{className:Pn(S.props.className,Ie.deleteIcon),onClick:se}):U.jsx(Ete,{className:Ie.deleteIcon,onClick:se}));let et=null;u&&W.isValidElement(u)&&(et=W.cloneElement(u,{className:Pn(Ie.avatar,u.props.className)}));let Kt=null;O&&W.isValidElement(O)&&(Kt=W.cloneElement(O,{className:Pn(Ie.icon,O.props.className)}));const De={slots:me,slotProps:Te},[tt,Et]=pi("root",{elementType:Ate,externalForwardedProps:{...De,...ae},ownerState:Ze,shouldForwardComponentProp:!0,ref:he,className:Pn(Ie.root,f),additionalProps:{disabled:le&&M?!0:void 0,tabIndex:pe&&M?-1:ue,...Je},getSlotProps:Ut=>({...Ut,onClick:an=>{Ut.onClick?.(an),j?.(an)},onKeyDown:an=>{Ut.onKeyDown?.(an),ve(an)},onKeyUp:an=>{Ut.onKeyUp?.(an),Y(an)}})}),[wt,Lt]=pi("label",{elementType:Ite,externalForwardedProps:De,ownerState:Ze,className:Ie.label});return U.jsxs(tt,{as:Ne,...Et,children:[et||Kt,U.jsx(wt,{...Lt,children:N}),dt]})});function iw(t){return parseInt(t,10)||0}const Rte={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function Mte(t){for(const e in t)return!1;return!0}function rO(t){return Mte(t)||t.outerHeightStyle===0&&!t.overflowing}const Pte=W.forwardRef(function(e,n){const{onChange:i,maxRows:u,minRows:f=1,style:g,value:b,...o}=e,{current:S}=W.useRef(b!=null),M=W.useRef(null),O=To(n,M),N=W.useRef(null),j=W.useRef(null),Z=W.useCallback(()=>{const ue=M.current,pe=j.current;if(!ue||!pe)return;const Te=Hf(ue).getComputedStyle(ue);if(Te.width==="0px")return{outerHeightStyle:0,overflowing:!1};pe.style.width=Te.width,pe.value=ue.value||e.placeholder||"x",pe.value.slice(-1)===`
`&&(pe.value+=" ");const ae=Te.boxSizing,re=iw(Te.paddingBottom)+iw(Te.paddingTop),he=iw(Te.borderBottomWidth)+iw(Te.borderTopWidth),se=pe.scrollHeight;pe.value="x";const ve=pe.scrollHeight;let Y=se;f&&(Y=Math.max(Number(f)*ve,Y)),u&&(Y=Math.min(Number(u)*ve,Y)),Y=Math.max(Y,ve);const le=Y+(ae==="border-box"?re+he:0),Ne=Math.abs(Y-se)<=1;return{outerHeightStyle:le,overflowing:Ne}},[u,f,e.placeholder]),K=mu(()=>{const ue=M.current,pe=Z();if(!ue||!pe||rO(pe))return!1;const me=pe.outerHeightStyle;return N.current!=null&&N.current!==me}),Q=W.useCallback(()=>{const ue=M.current,pe=Z();if(!ue||!pe||rO(pe))return;const me=pe.outerHeightStyle;N.current!==me&&(N.current=me,ue.style.height=`${me}px`),ue.style.overflow=pe.overflowing?"hidden":""},[Z]),ce=W.useRef(-1);yu(()=>{const ue=xN(Q),pe=M?.current;if(!pe)return;const me=Hf(pe);me.addEventListener("resize",ue);let Te;return typeof ResizeObserver<"u"&&(Te=new ResizeObserver(()=>{K()&&(Te.unobserve(pe),cancelAnimationFrame(ce.current),Q(),ce.current=requestAnimationFrame(()=>{Te.observe(pe)}))}),Te.observe(pe)),()=>{ue.clear(),cancelAnimationFrame(ce.current),me.removeEventListener("resize",ue),Te&&Te.disconnect()}},[Z,Q,K]),yu(()=>{Q()});const ge=ue=>{S||Q();const pe=ue.target,me=pe.value.length,Te=pe.value.endsWith(`
`),ae=pe.selectionStart===me;Te&&ae&&pe.setSelectionRange(me,me),i&&i(ue)};return U.jsxs(W.Fragment,{children:[U.jsx("textarea",{value:b,onChange:ge,ref:O,rows:f,style:g,...o}),U.jsx("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:j,tabIndex:-1,style:{...Rte.shadow,...g,paddingTop:0,paddingBottom:0}})]})});function Cm({props:t,states:e,muiFormControl:n}){return e.reduce((i,u)=>(i[u]=t[u],n&&typeof t[u]>"u"&&(i[u]=n[u]),i),{})}const tM=W.createContext(void 0);function Nd(){return W.useContext(tM)}function iO(t){return t!=null&&!(Array.isArray(t)&&t.length===0)}function CT(t,e=!1){return t&&(iO(t.value)&&t.value!==""||e&&iO(t.defaultValue)&&t.defaultValue!=="")}function kte(t){return t.startAdornment}function Dte(t){return wr("MuiInputBase",t)}const H_=Sr("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]);var sO;const wE=(t,e)=>{const{ownerState:n}=t;return[e.root,n.formControl&&e.formControl,n.startAdornment&&e.adornedStart,n.endAdornment&&e.adornedEnd,n.error&&e.error,n.size==="small"&&e.sizeSmall,n.multiline&&e.multiline,n.color&&e[`color${tn(n.color)}`],n.fullWidth&&e.fullWidth,n.hiddenLabel&&e.hiddenLabel]},TE=(t,e)=>{const{ownerState:n}=t;return[e.input,n.size==="small"&&e.inputSizeSmall,n.multiline&&e.inputMultiline,n.type==="search"&&e.inputTypeSearch,n.startAdornment&&e.inputAdornedStart,n.endAdornment&&e.inputAdornedEnd,n.hiddenLabel&&e.inputHiddenLabel]},Lte=t=>{const{classes:e,color:n,disabled:i,error:u,endAdornment:f,focused:g,formControl:b,fullWidth:o,hiddenLabel:S,multiline:M,readOnly:O,size:N,startAdornment:j,type:Z}=t,K={root:["root",`color${tn(n)}`,i&&"disabled",u&&"error",o&&"fullWidth",g&&"focused",b&&"formControl",N&&N!=="medium"&&`size${tn(N)}`,M&&"multiline",j&&"adornedStart",f&&"adornedEnd",S&&"hiddenLabel",O&&"readOnly"],input:["input",i&&"disabled",Z==="search"&&"inputTypeSearch",M&&"inputMultiline",N==="small"&&"inputSizeSmall",S&&"inputHiddenLabel",j&&"inputAdornedStart",f&&"inputAdornedEnd",O&&"readOnly"]};return Tr(K,Dte,e)},EE=cn("div",{name:"MuiInputBase",slot:"Root",overridesResolver:wE})(br(({theme:t})=>({...t.typography.body1,color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${H_.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"},variants:[{props:({ownerState:e})=>e.multiline,style:{padding:"4px 0 5px"}},{props:({ownerState:e,size:n})=>e.multiline&&n==="small",style:{paddingTop:1}},{props:({ownerState:e})=>e.fullWidth,style:{width:"100%"}}]}))),SE=cn("input",{name:"MuiInputBase",slot:"Input",overridesResolver:TE})(br(({theme:t})=>{const e=t.palette.mode==="light",n={color:"currentColor",...t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:e?.42:.5},transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})},i={opacity:"0 !important"},u=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:e?.42:.5};return{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":n,"&::-moz-placeholder":n,"&::-ms-input-placeholder":n,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${H_.formControl} &`]:{"&::-webkit-input-placeholder":i,"&::-moz-placeholder":i,"&::-ms-input-placeholder":i,"&:focus::-webkit-input-placeholder":u,"&:focus::-moz-placeholder":u,"&:focus::-ms-input-placeholder":u},[`&.${H_.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},variants:[{props:({ownerState:f})=>!f.disableInjectingGlobalStyles,style:{animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}}},{props:{size:"small"},style:{paddingTop:1}},{props:({ownerState:f})=>f.multiline,style:{height:"auto",resize:"none",padding:0,paddingTop:0}},{props:{type:"search"},style:{MozAppearance:"textfield"}}]}})),oO=GR({"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}),nM=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiInputBase"}),{"aria-describedby":u,autoComplete:f,autoFocus:g,className:b,color:o,components:S={},componentsProps:M={},defaultValue:O,disabled:N,disableInjectingGlobalStyles:j,endAdornment:Z,error:K,fullWidth:Q=!1,id:ce,inputComponent:ge="input",inputProps:ue={},inputRef:pe,margin:me,maxRows:Te,minRows:ae,multiline:re=!1,name:he,onBlur:se,onChange:ve,onClick:Y,onFocus:le,onKeyDown:Ne,onKeyUp:Ze,placeholder:Ie,readOnly:Je,renderSuffix:dt,rows:et,size:Kt,slotProps:De={},slots:tt={},startAdornment:Et,type:wt="text",value:Lt,...Ut}=i,an=ue.value!=null?ue.value:Lt,{current:At}=W.useRef(an!=null),Qt=W.useRef(),Wt=W.useCallback(Nn=>{},[]),vn=To(Qt,pe,ue.ref,Wt),[Gt,Cn]=W.useState(!1),ln=Nd(),qn=Cm({props:i,muiFormControl:ln,states:["color","disabled","error","hiddenLabel","size","required","filled"]});qn.focused=ln?ln.focused:Gt,W.useEffect(()=>{!ln&&N&&Gt&&(Cn(!1),se&&se())},[ln,N,Gt,se]);const Rn=ln&&ln.onFilled,An=ln&&ln.onEmpty,rr=W.useCallback(Nn=>{CT(Nn)?Rn&&Rn():An&&An()},[Rn,An]);yu(()=>{At&&rr({value:an})},[an,rr,At]);const En=Nn=>{le&&le(Nn),ue.onFocus&&ue.onFocus(Nn),ln&&ln.onFocus?ln.onFocus(Nn):Cn(!0)},bn=Nn=>{se&&se(Nn),ue.onBlur&&ue.onBlur(Nn),ln&&ln.onBlur?ln.onBlur(Nn):Cn(!1)},zn=(Nn,...Br)=>{if(!At){const tr=Nn.target||Qt.current;if(tr==null)throw new Error(Gf(1));rr({value:tr.value})}ue.onChange&&ue.onChange(Nn,...Br),ve&&ve(Nn,...Br)};W.useEffect(()=>{rr(Qt.current)},[]);const mn=Nn=>{Qt.current&&Nn.currentTarget===Nn.target&&Qt.current.focus(),Y&&Y(Nn)};let ti=ge,Xn=ue;re&&ti==="input"&&(et?Xn={type:void 0,minRows:et,maxRows:et,...Xn}:Xn={type:void 0,maxRows:Te,minRows:ae,...Xn},ti=Pte);const on=Nn=>{rr(Nn.animationName==="mui-auto-fill-cancel"?Qt.current:{value:"x"})};W.useEffect(()=>{ln&&ln.setAdornedStart(!!Et)},[ln,Et]);const Jt={...i,color:qn.color||"primary",disabled:qn.disabled,endAdornment:Z,error:qn.error,focused:qn.focused,formControl:ln,fullWidth:Q,hiddenLabel:qn.hiddenLabel,multiline:re,size:qn.size,startAdornment:Et,type:wt},yn=Lte(Jt),_n=tt.root||S.Root||EE,In=De.root||M.root||{},Bn=tt.input||S.Input||SE;return Xn={...Xn,...De.input??M.input},U.jsxs(W.Fragment,{children:[!j&&typeof oO=="function"&&(sO||(sO=U.jsx(oO,{}))),U.jsxs(_n,{...In,ref:n,onClick:mn,...Ut,...!sm(_n)&&{ownerState:{...Jt,...In.ownerState}},className:Pn(yn.root,In.className,b,Je&&"MuiInputBase-readOnly"),children:[Et,U.jsx(tM.Provider,{value:null,children:U.jsx(Bn,{"aria-invalid":qn.error,"aria-describedby":u,autoComplete:f,autoFocus:g,defaultValue:O,disabled:qn.disabled,id:ce,onAnimationStart:on,name:he,placeholder:Ie,readOnly:Je,required:qn.required,rows:et,value:an,onKeyDown:Ne,onKeyUp:Ze,type:wt,...Xn,...!sm(Bn)&&{as:ti,ownerState:{...Jt,...Xn.ownerState}},ref:vn,className:Pn(yn.input,Xn.className,Je&&"MuiInputBase-readOnly"),onBlur:bn,onChange:zn,onFocus:En})}),Z,dt?dt({...qn,startAdornment:Et}):null]})]})});function Ote(t){return wr("MuiInput",t)}const F0={...H_,...Sr("MuiInput",["root","underline","input"])};function zte(t){return wr("MuiOutlinedInput",t)}const dd={...H_,...Sr("MuiOutlinedInput",["root","notchedOutline","input"])};function Bte(t){return wr("MuiFilledInput",t)}const yg={...H_,...Sr("MuiFilledInput",["root","underline","input","adornedStart","adornedEnd","sizeSmall","multiline","hiddenLabel"])},Nte=Fo(U.jsx("path",{d:"M7 10l5 5 5-5z"})),Vte=Fo(U.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}));function Fte(t){return wr("MuiAvatar",t)}Sr("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const Ute=t=>{const{classes:e,variant:n,colorDefault:i}=t;return Tr({root:["root",n,i&&"colorDefault"],img:["img"],fallback:["fallback"]},Fte,e)},jte=cn("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],n.colorDefault&&e.colorDefault]}})(br(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:{color:(t.vars||t).palette.background.default,...t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:{backgroundColor:t.palette.grey[400],...t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})}}}]}))),$te=cn("img",{name:"MuiAvatar",slot:"Img"})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),qte=cn(Vte,{name:"MuiAvatar",slot:"Fallback"})({width:"75%",height:"75%"});function Gte({crossOrigin:t,referrerPolicy:e,src:n,srcSet:i}){const[u,f]=W.useState(!1);return W.useEffect(()=>{if(!n&&!i)return;f(!1);let g=!0;const b=new Image;return b.onload=()=>{g&&f("loaded")},b.onerror=()=>{g&&f("error")},b.crossOrigin=t,b.referrerPolicy=e,b.src=n,i&&(b.srcset=i),()=>{g=!1}},[t,e,n,i]),u}const Eb=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiAvatar"}),{alt:u,children:f,className:g,component:b="div",slots:o={},slotProps:S={},imgProps:M,sizes:O,src:N,srcSet:j,variant:Z="circular",...K}=i;let Q=null;const ce={...i,component:b,variant:Z},ge=Gte({...M,...typeof S.img=="function"?S.img(ce):S.img,src:N,srcSet:j}),ue=N||j,pe=ue&&ge!=="error";ce.colorDefault=!pe,delete ce.ownerState;const me=Ute(ce),[Te,ae]=pi("root",{ref:n,className:Pn(me.root,g),elementType:jte,externalForwardedProps:{slots:o,slotProps:S,component:b,...K},ownerState:ce}),[re,he]=pi("img",{className:me.img,elementType:$te,externalForwardedProps:{slots:o,slotProps:{img:{...M,...S.img}}},additionalProps:{alt:u,src:N,srcSet:j,sizes:O},ownerState:ce}),[se,ve]=pi("fallback",{className:me.fallback,elementType:qte,externalForwardedProps:{slots:o,slotProps:S},shouldForwardComponentProp:!0,ownerState:ce});return pe?Q=U.jsx(re,{...he}):f||f===0?Q=f:ue&&u?Q=u[0]:Q=U.jsx(se,{...ve}),U.jsx(Te,{...ae,children:Q})}),Hte={entering:{opacity:1},entered:{opacity:1}},AA=W.forwardRef(function(e,n){const i=Em(),u={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{addEndListener:f,appear:g=!0,children:b,easing:o,in:S,onEnter:M,onEntered:O,onEntering:N,onExit:j,onExited:Z,onExiting:K,style:Q,timeout:ce=u,TransitionComponent:ge=Bd,...ue}=e,pe=W.useRef(null),me=To(pe,lv(b),n),Te=Ne=>Ze=>{if(Ne){const Ie=pe.current;Ze===void 0?Ne(Ie):Ne(Ie,Ze)}},ae=Te(N),re=Te((Ne,Ze)=>{EN(Ne);const Ie=TT({style:Q,timeout:ce,easing:o},{mode:"enter"});Ne.style.webkitTransition=i.transitions.create("opacity",Ie),Ne.style.transition=i.transitions.create("opacity",Ie),M&&M(Ne,Ze)}),he=Te(O),se=Te(K),ve=Te(Ne=>{const Ze=TT({style:Q,timeout:ce,easing:o},{mode:"exit"});Ne.style.webkitTransition=i.transitions.create("opacity",Ze),Ne.style.transition=i.transitions.create("opacity",Ze),j&&j(Ne)}),Y=Te(Z),le=Ne=>{f&&f(pe.current,Ne)};return U.jsx(ge,{appear:g,in:S,nodeRef:pe,onEnter:re,onEntered:he,onEntering:ae,onExit:ve,onExited:Y,onExiting:se,addEndListener:le,timeout:ce,...ue,children:(Ne,{ownerState:Ze,...Ie})=>W.cloneElement(b,{style:{opacity:0,visibility:Ne==="exited"&&!S?"hidden":void 0,...Hte[Ne],...Q,...b.props.style},ref:me,...Ie})})});function Wte(t){return wr("MuiBackdrop",t)}Sr("MuiBackdrop",["root","invisible"]);const Xte=t=>{const{classes:e,invisible:n}=t;return Tr({root:["root",n&&"invisible"]},Wte,e)},Zte=cn("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.invisible&&e.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),FN=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiBackdrop"}),{children:u,className:f,component:g="div",invisible:b=!1,open:o,components:S={},componentsProps:M={},slotProps:O={},slots:N={},TransitionComponent:j,transitionDuration:Z,...K}=i,Q={...i,component:g,invisible:b},ce=Xte(Q),ge={transition:j,root:S.Root,...N},ue={...M,...O},pe={component:g,slots:ge,slotProps:ue},[me,Te]=pi("root",{elementType:Zte,externalForwardedProps:pe,className:Pn(ce.root,f),ownerState:Q}),[ae,re]=pi("transition",{elementType:AA,externalForwardedProps:pe,ownerState:Q});return U.jsx(ae,{in:o,timeout:Z,...K,...re,children:U.jsx(me,{"aria-hidden":!0,...Te,classes:ce,ref:n,children:u})})}),Kte=Sr("MuiBox",["root"]),Yte=_E(),On=DY({themeId:Rd,defaultTheme:Yte,defaultClassName:Kte.root,generateClassName:eN.generate});function Qte(t){return wr("MuiButton",t)}const _g=Sr("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),Jte=W.createContext({}),ene=W.createContext(void 0),tne=t=>{const{color:e,disableElevation:n,fullWidth:i,size:u,variant:f,loading:g,loadingPosition:b,classes:o}=t,S={root:["root",g&&"loading",f,`${f}${tn(e)}`,`size${tn(u)}`,`${f}Size${tn(u)}`,`color${tn(e)}`,n&&"disableElevation",i&&"fullWidth",g&&`loadingPosition${tn(b)}`],startIcon:["icon","startIcon",`iconSize${tn(u)}`],endIcon:["icon","endIcon",`iconSize${tn(u)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},M=Tr(S,Qte,o);return{...o,...M}},UN=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],nne=cn(U_,{shouldForwardProp:t=>bl(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`${n.variant}${tn(n.color)}`],e[`size${tn(n.size)}`],e[`${n.variant}Size${tn(n.size)}`],n.color==="inherit"&&e.colorInherit,n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth,n.loading&&e.loading]}})(br(({theme:t})=>{const e=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],n=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return{...t.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${_g.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(t.vars||t).shadows[2],"&:hover":{boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2]}},"&:active":{boxShadow:(t.vars||t).shadows[8]},[`&.${_g.focusVisible}`]:{boxShadow:(t.vars||t).shadows[6]},[`&.${_g.disabled}`]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${_g.disabled}`]:{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(t.palette).filter(No()).map(([i])=>({props:{color:i},style:{"--variant-textColor":(t.vars||t).palette[i].main,"--variant-outlinedColor":(t.vars||t).palette[i].main,"--variant-outlinedBorder":t.alpha((t.vars||t).palette[i].main,.5),"--variant-containedColor":(t.vars||t).palette[i].contrastText,"--variant-containedBg":(t.vars||t).palette[i].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(t.vars||t).palette[i].dark,"--variant-textBg":t.alpha((t.vars||t).palette[i].main,(t.vars||t).palette.action.hoverOpacity),"--variant-outlinedBorder":(t.vars||t).palette[i].main,"--variant-outlinedBg":t.alpha((t.vars||t).palette[i].main,(t.vars||t).palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedBg:e,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedHoverBg:n,"--variant-textBg":t.alpha((t.vars||t).palette.text.primary,(t.vars||t).palette.action.hoverOpacity),"--variant-outlinedBg":t.alpha((t.vars||t).palette.text.primary,(t.vars||t).palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:t.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${_g.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${_g.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),[`&.${_g.loading}`]:{color:"transparent"}}}]}})),rne=cn("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.startIcon,n.loading&&e.startIconLoadingStart,e[`iconSize${tn(n.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...UN]})),ine=cn("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.endIcon,n.loading&&e.endIconLoadingEnd,e[`iconSize${tn(n.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...UN]})),sne=cn("span",{name:"MuiButton",slot:"LoadingIndicator"})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(t.vars||t).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),aO=cn("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"}),cs=W.forwardRef(function(e,n){const i=W.useContext(Jte),u=W.useContext(ene),f=qx(i,e),g=Rr({props:f,name:"MuiButton"}),{children:b,color:o="primary",component:S="button",className:M,disabled:O=!1,disableElevation:N=!1,disableFocusRipple:j=!1,endIcon:Z,focusVisibleClassName:K,fullWidth:Q=!1,id:ce,loading:ge=null,loadingIndicator:ue,loadingPosition:pe="center",size:me="medium",startIcon:Te,type:ae,variant:re="text",...he}=g,se=Tm(ce),ve=ue??U.jsx(IN,{"aria-labelledby":se,color:"inherit",size:16}),Y={...g,color:o,component:S,disabled:O,disableElevation:N,disableFocusRipple:j,fullWidth:Q,loading:ge,loadingIndicator:ve,loadingPosition:pe,size:me,type:ae,variant:re},le=tne(Y),Ne=(Te||ge&&pe==="start")&&U.jsx(rne,{className:le.startIcon,ownerState:Y,children:Te||U.jsx(aO,{className:le.loadingIconPlaceholder,ownerState:Y})}),Ze=(Z||ge&&pe==="end")&&U.jsx(ine,{className:le.endIcon,ownerState:Y,children:Z||U.jsx(aO,{className:le.loadingIconPlaceholder,ownerState:Y})}),Ie=u||"",Je=typeof ge=="boolean"?U.jsx("span",{className:le.loadingWrapper,style:{display:"contents"},children:ge&&U.jsx(sne,{className:le.loadingIndicator,ownerState:Y,children:ve})}):null;return U.jsxs(nne,{ownerState:Y,className:Pn(i.className,le.root,M,Ie),component:S,disabled:O||ge,focusRipple:!j,focusVisibleClassName:Pn(le.focusVisible,K),ref:n,type:ae,id:ge?se:ce,...he,classes:le,children:[Ne,pe!=="end"&&Je,b,pe==="end"&&Je,Ze]})});function one(t){return wr("MuiCard",t)}Sr("MuiCard",["root"]);const ane=t=>{const{classes:e}=t;return Tr({root:["root"]},one,e)},lne=cn(Ec,{name:"MuiCard",slot:"Root"})({overflow:"hidden"}),rM=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiCard"}),{className:u,raised:f=!1,...g}=i,b={...i,raised:f},o=ane(b);return U.jsx(lne,{className:Pn(o.root,u),elevation:f?8:void 0,ref:n,ownerState:b,...g})});function cne(t){return wr("MuiCardActions",t)}Sr("MuiCardActions",["root","spacing"]);const une=t=>{const{classes:e,disableSpacing:n}=t;return Tr({root:["root",!n&&"spacing"]},cne,e)},hne=cn("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.disableSpacing&&e.spacing]}})({display:"flex",alignItems:"center",padding:8,variants:[{props:{disableSpacing:!1},style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),iM=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiCardActions"}),{disableSpacing:u=!1,className:f,...g}=i,b={...i,disableSpacing:u},o=une(b);return U.jsx(hne,{className:Pn(o.root,f),ownerState:b,ref:n,...g})});function dne(t){return wr("MuiCardContent",t)}Sr("MuiCardContent",["root"]);const fne=t=>{const{classes:e}=t;return Tr({root:["root"]},dne,e)},pne=cn("div",{name:"MuiCardContent",slot:"Root"})({padding:16,"&:last-child":{paddingBottom:24}}),sM=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiCardContent"}),{className:u,component:f="div",...g}=i,b={...i,component:f},o=fne(b);return U.jsx(pne,{as:f,className:Pn(o.root,u),ownerState:b,ref:n,...g})});function mne(t){return wr("PrivateSwitchBase",t)}Sr("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const gne=t=>{const{classes:e,checked:n,disabled:i,edge:u}=t,f={root:["root",n&&"checked",i&&"disabled",u&&`edge${tn(u)}`],input:["input"]};return Tr(f,mne,e)},yne=cn(U_,{name:"MuiSwitchBase"})({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:t,ownerState:e})=>t==="start"&&e.size!=="small",style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:t,ownerState:e})=>t==="end"&&e.size!=="small",style:{marginRight:-12}}]}),_ne=cn("input",{name:"MuiSwitchBase",shouldForwardProp:bl})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),vne=W.forwardRef(function(e,n){const{autoFocus:i,checked:u,checkedIcon:f,defaultChecked:g,disabled:b,disableFocusRipple:o=!1,edge:S=!1,icon:M,id:O,inputProps:N,inputRef:j,name:Z,onBlur:K,onChange:Q,onFocus:ce,readOnly:ge,required:ue=!1,tabIndex:pe,type:me,value:Te,slots:ae={},slotProps:re={},...he}=e,[se,ve]=V_({controlled:u,default:!!g,name:"SwitchBase",state:"checked"}),Y=Nd(),le=Lt=>{ce&&ce(Lt),Y&&Y.onFocus&&Y.onFocus(Lt)},Ne=Lt=>{K&&K(Lt),Y&&Y.onBlur&&Y.onBlur(Lt)},Ze=Lt=>{if(Lt.nativeEvent.defaultPrevented)return;const Ut=Lt.target.checked;ve(Ut),Q&&Q(Lt,Ut)};let Ie=b;Y&&typeof Ie>"u"&&(Ie=Y.disabled);const Je=me==="checkbox"||me==="radio",dt={...e,checked:se,disabled:Ie,disableFocusRipple:o,edge:S},et=gne(dt),Kt={slots:ae,slotProps:{input:N,...re}},[De,tt]=pi("root",{ref:n,elementType:yne,className:et.root,shouldForwardComponentProp:!0,externalForwardedProps:{...Kt,component:"span",...he},getSlotProps:Lt=>({...Lt,onFocus:Ut=>{Lt.onFocus?.(Ut),le(Ut)},onBlur:Ut=>{Lt.onBlur?.(Ut),Ne(Ut)}}),ownerState:dt,additionalProps:{centerRipple:!0,focusRipple:!o,disabled:Ie,role:void 0,tabIndex:null}}),[Et,wt]=pi("input",{ref:j,elementType:_ne,className:et.input,externalForwardedProps:Kt,getSlotProps:Lt=>({...Lt,onChange:Ut=>{Lt.onChange?.(Ut),Ze(Ut)}}),ownerState:dt,additionalProps:{autoFocus:i,checked:u,defaultChecked:g,disabled:Ie,id:Je?O:void 0,name:Z,readOnly:ge,required:ue,tabIndex:pe,type:me,...me==="checkbox"&&Te===void 0?{}:{value:Te}}});return U.jsxs(De,{...tt,children:[U.jsx(Et,{...wt}),se?f:M]})}),_h=wQ({createStyledComponent:cn("div",{name:"MuiContainer",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`maxWidth${tn(String(n.maxWidth))}`],n.fixed&&e.fixed,n.disableGutters&&e.disableGutters]}}),useThemeProps:t=>Rr({props:t,name:"MuiContainer"})}),IA=typeof GR({})=="function",xne=(t,e)=>({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%",...e&&!t.vars&&{colorScheme:t.palette.mode}}),bne=t=>({color:(t.vars||t).palette.text.primary,...t.typography.body1,backgroundColor:(t.vars||t).palette.background.default,"@media print":{backgroundColor:(t.vars||t).palette.common.white}}),jN=(t,e=!1)=>{const n={};e&&t.colorSchemes&&typeof t.getColorSchemeSelector=="function"&&Object.entries(t.colorSchemes).forEach(([f,g])=>{const b=t.getColorSchemeSelector(f);b.startsWith("@")?n[b]={":root":{colorScheme:g.palette?.mode}}:n[b.replace(/\s*&/,"")]={colorScheme:g.palette?.mode}});let i={html:xne(t,e),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:t.typography.fontWeightBold},body:{margin:0,...bne(t),"&::backdrop":{backgroundColor:(t.vars||t).palette.background.default}},...n};const u=t.components?.MuiCssBaseline?.styleOverrides;return u&&(i=[i,u]),i},Fw="mui-ecs",wne=t=>{const e=jN(t,!1),n=Array.isArray(e)?e[0]:e;return!t.vars&&n&&(n.html[`:root:has(${Fw})`]={colorScheme:t.palette.mode}),t.colorSchemes&&Object.entries(t.colorSchemes).forEach(([i,u])=>{const f=t.getColorSchemeSelector(i);f.startsWith("@")?n[f]={[`:root:not(:has(.${Fw}))`]:{colorScheme:u.palette?.mode}}:n[f.replace(/\s*&/,"")]={[`&:not(:has(.${Fw}))`]:{colorScheme:u.palette?.mode}}}),e},Tne=GR(IA?({theme:t,enableColorScheme:e})=>jN(t,e):({theme:t})=>wne(t));function Ene(t){const e=Rr({props:t,name:"MuiCssBaseline"}),{children:n,enableColorScheme:i=!1}=e;return U.jsxs(W.Fragment,{children:[IA&&U.jsx(Tne,{enableColorScheme:i}),!IA&&!i&&U.jsx("span",{className:Fw,style:{display:"none"}}),n]})}function $N(t=window){const e=t.document.documentElement.clientWidth;return t.innerWidth-e}function Sne(t){const e=xa(t);return e.body===t?Hf(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function xx(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function lO(t){return parseInt(Hf(t).getComputedStyle(t).paddingRight,10)||0}function Cne(t){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(t.tagName),i=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return n||i}function cO(t,e,n,i,u){const f=[e,n,...i];[].forEach.call(t.children,g=>{const b=!f.includes(g),o=!Cne(g);b&&o&&xx(g,u)})}function eC(t,e){let n=-1;return t.some((i,u)=>e(i)?(n=u,!0):!1),n}function Ane(t,e){const n=[],i=t.container;if(!e.disableScrollLock){if(Sne(i)){const g=$N(Hf(i));n.push({value:i.style.paddingRight,property:"padding-right",el:i}),i.style.paddingRight=`${lO(i)+g}px`;const b=xa(i).querySelectorAll(".mui-fixed");[].forEach.call(b,o=>{n.push({value:o.style.paddingRight,property:"padding-right",el:o}),o.style.paddingRight=`${lO(o)+g}px`})}let f;if(i.parentNode instanceof DocumentFragment)f=xa(i).body;else{const g=i.parentElement,b=Hf(i);f=g?.nodeName==="HTML"&&b.getComputedStyle(g).overflowY==="scroll"?g:i}n.push({value:f.style.overflow,property:"overflow",el:f},{value:f.style.overflowX,property:"overflow-x",el:f},{value:f.style.overflowY,property:"overflow-y",el:f}),f.style.overflow="hidden"}return()=>{n.forEach(({value:f,el:g,property:b})=>{f?g.style.setProperty(b,f):g.style.removeProperty(b)})}}function Ine(t){const e=[];return[].forEach.call(t.children,n=>{n.getAttribute("aria-hidden")==="true"&&e.push(n)}),e}class Rne{constructor(){this.modals=[],this.containers=[]}add(e,n){let i=this.modals.indexOf(e);if(i!==-1)return i;i=this.modals.length,this.modals.push(e),e.modalRef&&xx(e.modalRef,!1);const u=Ine(n);cO(n,e.mount,e.modalRef,u,!0);const f=eC(this.containers,g=>g.container===n);return f!==-1?(this.containers[f].modals.push(e),i):(this.containers.push({modals:[e],container:n,restore:null,hiddenSiblings:u}),i)}mount(e,n){const i=eC(this.containers,f=>f.modals.includes(e)),u=this.containers[i];u.restore||(u.restore=Ane(u,n))}remove(e,n=!0){const i=this.modals.indexOf(e);if(i===-1)return i;const u=eC(this.containers,g=>g.modals.includes(e)),f=this.containers[u];if(f.modals.splice(f.modals.indexOf(e),1),this.modals.splice(i,1),f.modals.length===0)f.restore&&f.restore(),e.modalRef&&xx(e.modalRef,n),cO(f.container,e.mount,e.modalRef,f.hiddenSiblings,!1),this.containers.splice(u,1);else{const g=f.modals[f.modals.length-1];g.modalRef&&xx(g.modalRef,!1)}return i}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}const Mne=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function Pne(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function kne(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=i=>t.ownerDocument.querySelector(`input[type="radio"]${i}`);let n=e(`[name="${t.name}"]:checked`);return n||(n=e(`[name="${t.name}"]`)),n!==t}function Dne(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||kne(t))}function Lne(t){const e=[],n=[];return Array.from(t.querySelectorAll(Mne)).forEach((i,u)=>{const f=Pne(i);f===-1||!Dne(i)||(f===0?e.push(i):n.push({documentOrder:u,tabIndex:f,node:i}))}),n.sort((i,u)=>i.tabIndex===u.tabIndex?i.documentOrder-u.documentOrder:i.tabIndex-u.tabIndex).map(i=>i.node).concat(e)}function One(){return!0}function zne(t){const{children:e,disableAutoFocus:n=!1,disableEnforceFocus:i=!1,disableRestoreFocus:u=!1,getTabbable:f=Lne,isEnabled:g=One,open:b}=t,o=W.useRef(!1),S=W.useRef(null),M=W.useRef(null),O=W.useRef(null),N=W.useRef(null),j=W.useRef(!1),Z=W.useRef(null),K=To(lv(e),Z),Q=W.useRef(null);W.useEffect(()=>{!b||!Z.current||(j.current=!n)},[n,b]),W.useEffect(()=>{if(!b||!Z.current)return;const ue=xa(Z.current);return Z.current.contains(ue.activeElement)||(Z.current.hasAttribute("tabIndex")||Z.current.setAttribute("tabIndex","-1"),j.current&&Z.current.focus()),()=>{u||(O.current&&O.current.focus&&(o.current=!0,O.current.focus()),O.current=null)}},[b]),W.useEffect(()=>{if(!b||!Z.current)return;const ue=xa(Z.current),pe=ae=>{Q.current=ae,!(i||!g()||ae.key!=="Tab")&&ue.activeElement===Z.current&&ae.shiftKey&&(o.current=!0,M.current&&M.current.focus())},me=()=>{const ae=Z.current;if(ae===null)return;if(!ue.hasFocus()||!g()||o.current){o.current=!1;return}if(ae.contains(ue.activeElement)||i&&ue.activeElement!==S.current&&ue.activeElement!==M.current)return;if(ue.activeElement!==N.current)N.current=null;else if(N.current!==null)return;if(!j.current)return;let re=[];if((ue.activeElement===S.current||ue.activeElement===M.current)&&(re=f(Z.current)),re.length>0){const he=!!(Q.current?.shiftKey&&Q.current?.key==="Tab"),se=re[0],ve=re[re.length-1];typeof se!="string"&&typeof ve!="string"&&(he?ve.focus():se.focus())}else ae.focus()};ue.addEventListener("focusin",me),ue.addEventListener("keydown",pe,!0);const Te=setInterval(()=>{ue.activeElement&&ue.activeElement.tagName==="BODY"&&me()},50);return()=>{clearInterval(Te),ue.removeEventListener("focusin",me),ue.removeEventListener("keydown",pe,!0)}},[n,i,u,g,b,f]);const ce=ue=>{O.current===null&&(O.current=ue.relatedTarget),j.current=!0,N.current=ue.target;const pe=e.props.onFocus;pe&&pe(ue)},ge=ue=>{O.current===null&&(O.current=ue.relatedTarget),j.current=!0};return U.jsxs(W.Fragment,{children:[U.jsx("div",{tabIndex:b?0:-1,onFocus:ge,ref:S,"data-testid":"sentinelStart"}),W.cloneElement(e,{ref:K,onFocus:ce}),U.jsx("div",{tabIndex:b?0:-1,onFocus:ge,ref:M,"data-testid":"sentinelEnd"})]})}function Bne(t){return typeof t=="function"?t():t}function Nne(t){return t?t.props.hasOwnProperty("in"):!1}const uO=()=>{},sw=new Rne;function Vne(t){const{container:e,disableEscapeKeyDown:n=!1,disableScrollLock:i=!1,closeAfterTransition:u=!1,onTransitionEnter:f,onTransitionExited:g,children:b,onClose:o,open:S,rootRef:M}=t,O=W.useRef({}),N=W.useRef(null),j=W.useRef(null),Z=To(j,M),[K,Q]=W.useState(!S),ce=Nne(b);let ge=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(ge=!1);const ue=()=>xa(N.current),pe=()=>(O.current.modalRef=j.current,O.current.mount=N.current,O.current),me=()=>{sw.mount(pe(),{disableScrollLock:i}),j.current&&(j.current.scrollTop=0)},Te=mu(()=>{const Ze=Bne(e)||ue().body;sw.add(pe(),Ze),j.current&&me()}),ae=()=>sw.isTopModal(pe()),re=mu(Ze=>{N.current=Ze,Ze&&(S&&ae()?me():j.current&&xx(j.current,ge))}),he=W.useCallback(()=>{sw.remove(pe(),ge)},[ge]);W.useEffect(()=>()=>{he()},[he]),W.useEffect(()=>{S?Te():(!ce||!u)&&he()},[S,he,ce,u,Te]);const se=Ze=>Ie=>{Ze.onKeyDown?.(Ie),!(Ie.key!=="Escape"||Ie.which===229||!ae())&&(n||(Ie.stopPropagation(),o&&o(Ie,"escapeKeyDown")))},ve=Ze=>Ie=>{Ze.onClick?.(Ie),Ie.target===Ie.currentTarget&&o&&o(Ie,"backdropClick")};return{getRootProps:(Ze={})=>{const Ie=yx(t);delete Ie.onTransitionEnter,delete Ie.onTransitionExited;const Je={...Ie,...Ze};return{role:"presentation",...Je,onKeyDown:se(Je),ref:Z}},getBackdropProps:(Ze={})=>{const Ie=Ze;return{"aria-hidden":!0,...Ie,onClick:ve(Ie),open:S}},getTransitionProps:()=>{const Ze=()=>{Q(!1),f&&f()},Ie=()=>{Q(!0),g&&g(),u&&he()};return{onEnter:yA(Ze,b?.props.onEnter??uO),onExited:yA(Ie,b?.props.onExited??uO)}},rootRef:Z,portalRef:re,isTopModal:ae,exited:K,hasTransition:ce}}function Fne(t){return wr("MuiModal",t)}Sr("MuiModal",["root","hidden","backdrop"]);const Une=t=>{const{open:e,exited:n,classes:i}=t;return Tr({root:["root",!e&&n&&"hidden"],backdrop:["backdrop"]},Fne,i)},jne=cn("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.open&&n.exited&&e.hidden]}})(br(({theme:t})=>({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:e})=>!e.open&&e.exited,style:{visibility:"hidden"}}]}))),$ne=cn(FN,{name:"MuiModal",slot:"Backdrop"})({zIndex:-1}),qN=W.forwardRef(function(e,n){const i=Rr({name:"MuiModal",props:e}),{BackdropComponent:u=$ne,BackdropProps:f,classes:g,className:b,closeAfterTransition:o=!1,children:S,container:M,component:O,components:N={},componentsProps:j={},disableAutoFocus:Z=!1,disableEnforceFocus:K=!1,disableEscapeKeyDown:Q=!1,disablePortal:ce=!1,disableRestoreFocus:ge=!1,disableScrollLock:ue=!1,hideBackdrop:pe=!1,keepMounted:me=!1,onClose:Te,onTransitionEnter:ae,onTransitionExited:re,open:he,slotProps:se={},slots:ve={},theme:Y,...le}=i,Ne={...i,closeAfterTransition:o,disableAutoFocus:Z,disableEnforceFocus:K,disableEscapeKeyDown:Q,disablePortal:ce,disableRestoreFocus:ge,disableScrollLock:ue,hideBackdrop:pe,keepMounted:me},{getRootProps:Ze,getBackdropProps:Ie,getTransitionProps:Je,portalRef:dt,isTopModal:et,exited:Kt,hasTransition:De}=Vne({...Ne,rootRef:n}),tt={...Ne,exited:Kt},Et=Une(tt),wt={};if(S.props.tabIndex===void 0&&(wt.tabIndex="-1"),De){const{onEnter:Wt,onExited:vn}=Je();wt.onEnter=Wt,wt.onExited=vn}const Lt={slots:{root:N.Root,backdrop:N.Backdrop,...ve},slotProps:{...j,...se}},[Ut,an]=pi("root",{ref:n,elementType:jne,externalForwardedProps:{...Lt,...le,component:O},getSlotProps:Ze,ownerState:tt,className:Pn(b,Et?.root,!tt.open&&tt.exited&&Et?.hidden)}),[At,Qt]=pi("backdrop",{ref:f?.ref,elementType:u,externalForwardedProps:Lt,shouldForwardComponentProp:!0,additionalProps:f,getSlotProps:Wt=>Ie({...Wt,onClick:vn=>{Wt?.onClick&&Wt.onClick(vn)}}),className:Pn(f?.className,Et?.backdrop),ownerState:tt});return!me&&!he&&(!De||Kt)?null:U.jsx(NN,{ref:dt,container:M,disablePortal:ce,children:U.jsxs(Ut,{...an,children:[!pe&&u?U.jsx(At,{...Qt}):null,U.jsx(zne,{disableEnforceFocus:K,disableAutoFocus:Z,disableRestoreFocus:ge,isEnabled:et,open:he,children:W.cloneElement(S,wt)})]})})});function qne(t){return wr("MuiDialog",t)}const tC=Sr("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),GN=W.createContext({}),Gne=cn(FN,{name:"MuiDialog",slot:"Backdrop",overrides:(t,e)=>e.backdrop})({zIndex:-1}),Hne=t=>{const{classes:e,scroll:n,maxWidth:i,fullWidth:u,fullScreen:f}=t,g={root:["root"],container:["container",`scroll${tn(n)}`],paper:["paper",`paperScroll${tn(n)}`,`paperWidth${tn(String(i))}`,u&&"paperFullWidth",f&&"paperFullScreen"]};return Tr(g,qne,e)},Wne=cn(qN,{name:"MuiDialog",slot:"Root"})({"@media print":{position:"absolute !important"}}),Xne=cn("div",{name:"MuiDialog",slot:"Container",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.container,e[`scroll${tn(n.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),Zne=cn(Ec,{name:"MuiDialog",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.paper,e[`scrollPaper${tn(n.scroll)}`],e[`paperWidth${tn(String(n.maxWidth))}`],n.fullWidth&&e.paperFullWidth,n.fullScreen&&e.paperFullScreen]}})(br(({theme:t})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:e})=>!e.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:t.breakpoints.unit==="px"?Math.max(t.breakpoints.values.xs,444):`max(${t.breakpoints.values.xs}${t.breakpoints.unit}, 444px)`,[`&.${tC.paperScrollBody}`]:{[t.breakpoints.down(Math.max(t.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(t.breakpoints.values).filter(e=>e!=="xs").map(e=>({props:{maxWidth:e},style:{maxWidth:`${t.breakpoints.values[e]}${t.breakpoints.unit}`,[`&.${tC.paperScrollBody}`]:{[t.breakpoints.down(t.breakpoints.values[e]+64)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:e})=>e.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:e})=>e.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${tC.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),hO=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiDialog"}),u=Em(),f={enter:u.transitions.duration.enteringScreen,exit:u.transitions.duration.leavingScreen},{"aria-describedby":g,"aria-labelledby":b,"aria-modal":o=!0,BackdropComponent:S,BackdropProps:M,children:O,className:N,disableEscapeKeyDown:j=!1,fullScreen:Z=!1,fullWidth:K=!1,maxWidth:Q="sm",onClick:ce,onClose:ge,open:ue,PaperComponent:pe=Ec,PaperProps:me={},scroll:Te="paper",slots:ae={},slotProps:re={},TransitionComponent:he=AA,transitionDuration:se=f,TransitionProps:ve,...Y}=i,le={...i,disableEscapeKeyDown:j,fullScreen:Z,fullWidth:K,maxWidth:Q,scroll:Te},Ne=Hne(le),Ze=W.useRef(),Ie=Cn=>{Ze.current=Cn.target===Cn.currentTarget},Je=Cn=>{ce&&ce(Cn),Ze.current&&(Ze.current=null,ge&&ge(Cn,"backdropClick"))},dt=Tm(b),et=W.useMemo(()=>({titleId:dt}),[dt]),Kt={transition:he,...ae},De={transition:ve,paper:me,backdrop:M,...re},tt={slots:Kt,slotProps:De},[Et,wt]=pi("root",{elementType:Wne,shouldForwardComponentProp:!0,externalForwardedProps:tt,ownerState:le,className:Pn(Ne.root,N),ref:n}),[Lt,Ut]=pi("backdrop",{elementType:Gne,shouldForwardComponentProp:!0,externalForwardedProps:tt,ownerState:le}),[an,At]=pi("paper",{elementType:Zne,shouldForwardComponentProp:!0,externalForwardedProps:tt,ownerState:le,className:Pn(Ne.paper,me.className)}),[Qt,Wt]=pi("container",{elementType:Xne,externalForwardedProps:tt,ownerState:le,className:Ne.container}),[vn,Gt]=pi("transition",{elementType:AA,externalForwardedProps:tt,ownerState:le,additionalProps:{appear:!0,in:ue,timeout:se,role:"presentation"}});return U.jsx(Et,{closeAfterTransition:!0,slots:{backdrop:Lt},slotProps:{backdrop:{transitionDuration:se,as:S,...Ut}},disableEscapeKeyDown:j,onClose:ge,open:ue,onClick:Je,...wt,...Y,children:U.jsx(vn,{...Gt,children:U.jsx(Qt,{onMouseDown:Ie,...Wt,children:U.jsx(an,{as:pe,elevation:24,role:"dialog","aria-describedby":g,"aria-labelledby":dt,"aria-modal":o,...At,children:U.jsx(GN.Provider,{value:et,children:O})})})})})});function Kne(t){return wr("MuiDialogActions",t)}Sr("MuiDialogActions",["root","spacing"]);const Yne=t=>{const{classes:e,disableSpacing:n}=t;return Tr({root:["root",!n&&"spacing"]},Kne,e)},Qne=cn("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.disableSpacing&&e.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:t})=>!t.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),dO=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiDialogActions"}),{className:u,disableSpacing:f=!1,...g}=i,b={...i,disableSpacing:f},o=Yne(b);return U.jsx(Qne,{className:Pn(o.root,u),ownerState:b,ref:n,...g})});function Jne(t){return wr("MuiDialogContent",t)}Sr("MuiDialogContent",["root","dividers"]);function ere(t){return wr("MuiDialogTitle",t)}const tre=Sr("MuiDialogTitle",["root"]),nre=t=>{const{classes:e,dividers:n}=t;return Tr({root:["root",n&&"dividers"]},Jne,e)},rre=cn("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.dividers&&e.dividers]}})(br(({theme:t})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:e})=>e.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(t.vars||t).palette.divider}`,borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:e})=>!e.dividers,style:{[`.${tre.root} + &`]:{paddingTop:0}}}]}))),fO=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiDialogContent"}),{className:u,dividers:f=!1,...g}=i,b={...i,dividers:f},o=nre(b);return U.jsx(rre,{className:Pn(o.root,u),ownerState:b,ref:n,...g})}),ire=t=>{const{classes:e}=t;return Tr({root:["root"]},ere,e)},sre=cn(sn,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),pO=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiDialogTitle"}),{className:u,id:f,...g}=i,b=i,o=ire(b),{titleId:S=f}=W.useContext(GN);return U.jsx(sre,{component:"h2",className:Pn(o.root,u),ownerState:b,ref:n,variant:"h6",id:f??S,...g})});function ore(t){return wr("MuiDivider",t)}Sr("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]);const are=t=>{const{absolute:e,children:n,classes:i,flexItem:u,light:f,orientation:g,textAlign:b,variant:o}=t;return Tr({root:["root",e&&"absolute",o,f&&"light",g==="vertical"&&"vertical",u&&"flexItem",n&&"withChildren",n&&g==="vertical"&&"withChildrenVertical",b==="right"&&g!=="vertical"&&"textAlignRight",b==="left"&&g!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",g==="vertical"&&"wrapperVertical"]},ore,i)},lre=cn("div",{name:"MuiDivider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.absolute&&e.absolute,e[n.variant],n.light&&e.light,n.orientation==="vertical"&&e.vertical,n.flexItem&&e.flexItem,n.children&&e.withChildren,n.children&&n.orientation==="vertical"&&e.withChildrenVertical,n.textAlign==="right"&&n.orientation!=="vertical"&&e.textAlignRight,n.textAlign==="left"&&n.orientation!=="vertical"&&e.textAlignLeft]}})(br(({theme:t})=>({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(t.vars||t).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:t.alpha((t.vars||t).palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:t.spacing(2),marginRight:t.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:t.spacing(1),marginBottom:t.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:({ownerState:e})=>!!e.children,style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:({ownerState:e})=>e.children&&e.orientation!=="vertical",style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(t.vars||t).palette.divider}`,borderTopStyle:"inherit"}}},{props:({ownerState:e})=>e.orientation==="vertical"&&e.children,style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(t.vars||t).palette.divider}`,borderLeftStyle:"inherit"}}},{props:({ownerState:e})=>e.textAlign==="right"&&e.orientation!=="vertical",style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:({ownerState:e})=>e.textAlign==="left"&&e.orientation!=="vertical",style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}))),cre=cn("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.wrapper,n.orientation==="vertical"&&e.wrapperVertical]}})(br(({theme:t})=>({display:"inline-block",paddingLeft:`calc(${t.spacing(1)} * 1.2)`,paddingRight:`calc(${t.spacing(1)} * 1.2)`,whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${t.spacing(1)} * 1.2)`,paddingBottom:`calc(${t.spacing(1)} * 1.2)`}}]}))),_o=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiDivider"}),{absolute:u=!1,children:f,className:g,orientation:b="horizontal",component:o=f||b==="vertical"?"div":"hr",flexItem:S=!1,light:M=!1,role:O=o!=="hr"?"separator":void 0,textAlign:N="center",variant:j="fullWidth",...Z}=i,K={...i,absolute:u,component:o,flexItem:S,light:M,orientation:b,role:O,textAlign:N,variant:j},Q=are(K);return U.jsx(lre,{as:o,className:Pn(Q.root,g),role:O,ref:n,ownerState:K,"aria-orientation":O==="separator"&&(o!=="hr"||b==="vertical")?b:void 0,...Z,children:f?U.jsx(cre,{className:Q.wrapper,ownerState:K,children:f}):null})});_o&&(_o.muiSkipListHighlight=!0);function ure(t){return wr("MuiFab",t)}const mO=Sr("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]),hre=t=>{const{color:e,variant:n,classes:i,size:u}=t,f={root:["root",n,`size${tn(u)}`,e==="inherit"?"colorInherit":e]},g=Tr(f,ure,i);return{...i,...g}},dre=cn(U_,{name:"MuiFab",slot:"Root",shouldForwardProp:t=>bl(t)||t==="classes",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`size${tn(n.size)}`],n.color==="inherit"&&e.colorInherit,e[tn(n.size)],e[n.color]]}})(br(({theme:t})=>({...t.typography.button,minHeight:36,transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(t.vars||t).zIndex.fab,boxShadow:(t.vars||t).shadows[6],"&:active":{boxShadow:(t.vars||t).shadows[12]},color:t.vars?t.vars.palette.grey[900]:t.palette.getContrastText?.(t.palette.grey[300]),backgroundColor:(t.vars||t).palette.grey[300],"&:hover":{backgroundColor:(t.vars||t).palette.grey.A100,"@media (hover: none)":{backgroundColor:(t.vars||t).palette.grey[300]},textDecoration:"none"},[`&.${mO.focusVisible}`]:{boxShadow:(t.vars||t).shadows[6]},variants:[{props:{size:"small"},style:{width:40,height:40}},{props:{size:"medium"},style:{width:48,height:48}},{props:{variant:"extended"},style:{borderRadius:48/2,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48}},{props:{variant:"extended",size:"small"},style:{width:"auto",padding:"0 8px",borderRadius:34/2,minWidth:34,height:34}},{props:{variant:"extended",size:"medium"},style:{width:"auto",padding:"0 16px",borderRadius:40/2,minWidth:40,height:40}},{props:{color:"inherit"},style:{color:"inherit"}}]})),br(({theme:t})=>({variants:[...Object.entries(t.palette).filter(No(["dark","contrastText"])).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].contrastText,backgroundColor:(t.vars||t).palette[e].main,"&:hover":{backgroundColor:(t.vars||t).palette[e].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[e].main}}}}))]})),br(({theme:t})=>({[`&.${mO.disabled}`]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}))),HN=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiFab"}),{children:u,className:f,color:g="default",component:b="button",disabled:o=!1,disableFocusRipple:S=!1,focusVisibleClassName:M,size:O="large",variant:N="circular",...j}=i,Z={...i,color:g,component:b,disabled:o,disableFocusRipple:S,size:O,variant:N},K=hre(Z);return U.jsx(dre,{className:Pn(K.root,f),component:b,disabled:o,focusRipple:!S,focusVisibleClassName:Pn(K.focusVisible,M),ownerState:Z,ref:n,...j,classes:K,children:u})}),fre=t=>{const{classes:e,disableUnderline:n,startAdornment:i,endAdornment:u,size:f,hiddenLabel:g,multiline:b}=t,o={root:["root",!n&&"underline",i&&"adornedStart",u&&"adornedEnd",f==="small"&&`size${tn(f)}`,g&&"hiddenLabel",b&&"multiline"],input:["input"]},S=Tr(o,Bte,e);return{...e,...S}},pre=cn(EE,{shouldForwardProp:t=>bl(t)||t==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...wE(t,e),!n.disableUnderline&&e.underline]}})(br(({theme:t})=>{const e=t.palette.mode==="light",n=e?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",i=e?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",u=e?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",f=e?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:i,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:u,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:i}},[`&.${yg.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:i},[`&.${yg.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:f},variants:[{props:({ownerState:g})=>!g.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${yg.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${yg.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?t.alpha(t.vars.palette.common.onBackground,t.vars.opacity.inputUnderline):n}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${yg.disabled}, .${yg.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${yg.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(t.palette).filter(No()).map(([g])=>({props:{disableUnderline:!1,color:g},style:{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[g]?.main}`}}})),{props:({ownerState:g})=>g.startAdornment,style:{paddingLeft:12}},{props:({ownerState:g})=>g.endAdornment,style:{paddingRight:12}},{props:({ownerState:g})=>g.multiline,style:{padding:"25px 12px 8px"}},{props:({ownerState:g,size:b})=>g.multiline&&b==="small",style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:g})=>g.multiline&&g.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:g})=>g.multiline&&g.hiddenLabel&&g.size==="small",style:{paddingTop:8,paddingBottom:9}}]}})),mre=cn(SE,{name:"MuiFilledInput",slot:"Input",overridesResolver:TE})(br(({theme:t})=>({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,...!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},...t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:e})=>e.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:0}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:0}},{props:({ownerState:e})=>e.hiddenLabel&&e.size==="small",style:{paddingTop:8,paddingBottom:9}},{props:({ownerState:e})=>e.multiline,style:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}}]}))),oM=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiFilledInput"}),{disableUnderline:u=!1,components:f={},componentsProps:g,fullWidth:b=!1,hiddenLabel:o,inputComponent:S="input",multiline:M=!1,slotProps:O,slots:N={},type:j="text",...Z}=i,K={...i,disableUnderline:u,fullWidth:b,inputComponent:S,multiline:M,type:j},Q=fre(i),ce={root:{ownerState:K},input:{ownerState:K}},ge=O??g?Jo(ce,O??g):ce,ue=N.root??f.Root??pre,pe=N.input??f.Input??mre;return U.jsx(nM,{slots:{root:ue,input:pe},slotProps:ge,fullWidth:b,inputComponent:S,multiline:M,ref:n,type:j,...Z,classes:Q})});oM.muiName="Input";function gre(t){return wr("MuiFormControl",t)}Sr("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const yre=t=>{const{classes:e,margin:n,fullWidth:i}=t,u={root:["root",n!=="none"&&`margin${tn(n)}`,i&&"fullWidth"]};return Tr(u,gre,e)},_re=cn("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`margin${tn(n.margin)}`],n.fullWidth&&e.fullWidth]}})({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top",variants:[{props:{margin:"normal"},style:{marginTop:16,marginBottom:8}},{props:{margin:"dense"},style:{marginTop:8,marginBottom:4}},{props:{fullWidth:!0},style:{width:"100%"}}]}),RA=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiFormControl"}),{children:u,className:f,color:g="primary",component:b="div",disabled:o=!1,error:S=!1,focused:M,fullWidth:O=!1,hiddenLabel:N=!1,margin:j="none",required:Z=!1,size:K="medium",variant:Q="outlined",...ce}=i,ge={...i,color:g,component:b,disabled:o,error:S,fullWidth:O,hiddenLabel:N,margin:j,required:Z,size:K,variant:Q},ue=yre(ge),[pe,me]=W.useState(()=>{let Ze=!1;return u&&W.Children.forEach(u,Ie=>{if(!QS(Ie,["Input","Select"]))return;const Je=QS(Ie,["Select"])?Ie.props.input:Ie;Je&&kte(Je.props)&&(Ze=!0)}),Ze}),[Te,ae]=W.useState(()=>{let Ze=!1;return u&&W.Children.forEach(u,Ie=>{QS(Ie,["Input","Select"])&&(CT(Ie.props,!0)||CT(Ie.props.inputProps,!0))&&(Ze=!0)}),Ze}),[re,he]=W.useState(!1);o&&re&&he(!1);const se=M!==void 0&&!o?M:re;let ve;W.useRef(!1);const Y=W.useCallback(()=>{ae(!0)},[]),le=W.useCallback(()=>{ae(!1)},[]),Ne=W.useMemo(()=>({adornedStart:pe,setAdornedStart:me,color:g,disabled:o,error:S,filled:Te,focused:se,fullWidth:O,hiddenLabel:N,size:K,onBlur:()=>{he(!1)},onFocus:()=>{he(!0)},onEmpty:le,onFilled:Y,registerEffect:ve,required:Z,variant:Q}),[pe,g,o,S,Te,se,O,N,ve,le,Y,Z,K,Q]);return U.jsx(tM.Provider,{value:Ne,children:U.jsx(_re,{as:b,ownerState:ge,className:Pn(ue.root,f),ref:n,...ce,children:u})})});function vre(t){return wr("MuiFormControlLabel",t)}const nx=Sr("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),xre=t=>{const{classes:e,disabled:n,labelPlacement:i,error:u,required:f}=t,g={root:["root",n&&"disabled",`labelPlacement${tn(i)}`,u&&"error",f&&"required"],label:["label",n&&"disabled"],asterisk:["asterisk",u&&"error"]};return Tr(g,vre,e)},bre=cn("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`& .${nx.label}`]:e.label},e.root,e[`labelPlacement${tn(n.labelPlacement)}`]]}})(br(({theme:t})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${nx.disabled}`]:{cursor:"default"},[`& .${nx.label}`]:{[`&.${nx.disabled}`]:{color:(t.vars||t).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:e})=>e==="start"||e==="top"||e==="bottom",style:{marginLeft:16}}]}))),wre=cn("span",{name:"MuiFormControlLabel",slot:"Asterisk"})(br(({theme:t})=>({[`&.${nx.error}`]:{color:(t.vars||t).palette.error.main}}))),ow=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiFormControlLabel"}),{checked:u,className:f,componentsProps:g={},control:b,disabled:o,disableTypography:S,inputRef:M,label:O,labelPlacement:N="end",name:j,onChange:Z,required:K,slots:Q={},slotProps:ce={},value:ge,...ue}=i,pe=Nd(),me=o??b.props.disabled??pe?.disabled,Te=K??b.props.required,ae={disabled:me,required:Te};["checked","name","onChange","value","inputRef"].forEach(Ze=>{typeof b.props[Ze]>"u"&&typeof i[Ze]<"u"&&(ae[Ze]=i[Ze])});const re=Cm({props:i,muiFormControl:pe,states:["error"]}),he={...i,disabled:me,labelPlacement:N,required:Te,error:re.error},se=xre(he),ve={slots:Q,slotProps:{...g,...ce}},[Y,le]=pi("typography",{elementType:sn,externalForwardedProps:ve,ownerState:he});let Ne=O;return Ne!=null&&Ne.type!==sn&&!S&&(Ne=U.jsx(Y,{component:"span",...le,className:Pn(se.label,le?.className),children:Ne})),U.jsxs(bre,{className:Pn(se.root,f),ownerState:he,ref:n,...ue,children:[W.cloneElement(b,ae),Te?U.jsxs("div",{children:[Ne,U.jsxs(wre,{ownerState:he,"aria-hidden":!0,className:se.asterisk,children:["","*"]})]}):Ne]})});function Tre(t){return wr("MuiFormGroup",t)}Sr("MuiFormGroup",["root","row","error"]);const Ere=t=>{const{classes:e,row:n,error:i}=t;return Tr({root:["root",n&&"row",i&&"error"]},Tre,e)},Sre=cn("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.row&&e.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),Cre=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiFormGroup"}),{className:u,row:f=!1,...g}=i,b=Nd(),o=Cm({props:i,muiFormControl:b,states:["error"]}),S={...i,row:f,error:o.error},M=Ere(S);return U.jsx(Sre,{className:Pn(M.root,u),ownerState:S,ref:n,...g})});function Are(t){return wr("MuiFormHelperText",t)}const gO=Sr("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var yO;const Ire=t=>{const{classes:e,contained:n,size:i,disabled:u,error:f,filled:g,focused:b,required:o}=t,S={root:["root",u&&"disabled",f&&"error",i&&`size${tn(i)}`,n&&"contained",b&&"focused",g&&"filled",o&&"required"]};return Tr(S,Are,e)},Rre=cn("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.size&&e[`size${tn(n.size)}`],n.contained&&e.contained,n.filled&&e.filled]}})(br(({theme:t})=>({color:(t.vars||t).palette.text.secondary,...t.typography.caption,textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${gO.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${gO.error}`]:{color:(t.vars||t).palette.error.main},variants:[{props:{size:"small"},style:{marginTop:4}},{props:({ownerState:e})=>e.contained,style:{marginLeft:14,marginRight:14}}]}))),Mre=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiFormHelperText"}),{children:u,className:f,component:g="p",disabled:b,error:o,filled:S,focused:M,margin:O,required:N,variant:j,...Z}=i,K=Nd(),Q=Cm({props:i,muiFormControl:K,states:["variant","size","disabled","error","filled","focused","required"]}),ce={...i,component:g,contained:Q.variant==="filled"||Q.variant==="outlined",variant:Q.variant,size:Q.size,disabled:Q.disabled,error:Q.error,filled:Q.filled,focused:Q.focused,required:Q.required};delete ce.ownerState;const ge=Ire(ce);return U.jsx(Rre,{as:g,className:Pn(ge.root,f),ref:n,...Z,ownerState:ce,children:u===" "?yO||(yO=U.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):u})});function Pre(t){return wr("MuiFormLabel",t)}const bx=Sr("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),kre=t=>{const{classes:e,color:n,focused:i,disabled:u,error:f,filled:g,required:b}=t,o={root:["root",`color${tn(n)}`,u&&"disabled",f&&"error",g&&"filled",i&&"focused",b&&"required"],asterisk:["asterisk",f&&"error"]};return Tr(o,Pre,e)},Dre=cn("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color==="secondary"&&e.colorSecondary,n.filled&&e.filled]}})(br(({theme:t})=>({color:(t.vars||t).palette.text.secondary,...t.typography.body1,lineHeight:"1.4375em",padding:0,position:"relative",variants:[...Object.entries(t.palette).filter(No()).map(([e])=>({props:{color:e},style:{[`&.${bx.focused}`]:{color:(t.vars||t).palette[e].main}}})),{props:{},style:{[`&.${bx.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${bx.error}`]:{color:(t.vars||t).palette.error.main}}}]}))),Lre=cn("span",{name:"MuiFormLabel",slot:"Asterisk"})(br(({theme:t})=>({[`&.${bx.error}`]:{color:(t.vars||t).palette.error.main}}))),MA=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiFormLabel"}),{children:u,className:f,color:g,component:b="label",disabled:o,error:S,filled:M,focused:O,required:N,...j}=i,Z=Nd(),K=Cm({props:i,muiFormControl:Z,states:["color","required","focused","disabled","error","filled"]}),Q={...i,color:K.color||"primary",component:b,disabled:K.disabled,error:K.error,filled:K.filled,focused:K.focused,required:K.required},ce=kre(Q);return U.jsxs(Dre,{as:b,ownerState:Q,className:Pn(ce.root,f),ref:n,...j,children:[u,K.required&&U.jsxs(Lre,{ownerState:Q,"aria-hidden":!0,className:ce.asterisk,children:["","*"]})]})});function PA(t){return`scale(${t}, ${t**2})`}const Ore={entering:{opacity:1,transform:PA(1)},entered:{opacity:1,transform:"none"}},nC=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),AT=W.forwardRef(function(e,n){const{addEndListener:i,appear:u=!0,children:f,easing:g,in:b,onEnter:o,onEntered:S,onEntering:M,onExit:O,onExited:N,onExiting:j,style:Z,timeout:K="auto",TransitionComponent:Q=Bd,...ce}=e,ge=__(),ue=W.useRef(),pe=Em(),me=W.useRef(null),Te=To(me,lv(f),n),ae=Ze=>Ie=>{if(Ze){const Je=me.current;Ie===void 0?Ze(Je):Ze(Je,Ie)}},re=ae(M),he=ae((Ze,Ie)=>{EN(Ze);const{duration:Je,delay:dt,easing:et}=TT({style:Z,timeout:K,easing:g},{mode:"enter"});let Kt;K==="auto"?(Kt=pe.transitions.getAutoHeightDuration(Ze.clientHeight),ue.current=Kt):Kt=Je,Ze.style.transition=[pe.transitions.create("opacity",{duration:Kt,delay:dt}),pe.transitions.create("transform",{duration:nC?Kt:Kt*.666,delay:dt,easing:et})].join(","),o&&o(Ze,Ie)}),se=ae(S),ve=ae(j),Y=ae(Ze=>{const{duration:Ie,delay:Je,easing:dt}=TT({style:Z,timeout:K,easing:g},{mode:"exit"});let et;K==="auto"?(et=pe.transitions.getAutoHeightDuration(Ze.clientHeight),ue.current=et):et=Ie,Ze.style.transition=[pe.transitions.create("opacity",{duration:et,delay:Je}),pe.transitions.create("transform",{duration:nC?et:et*.666,delay:nC?Je:Je||et*.333,easing:dt})].join(","),Ze.style.opacity=0,Ze.style.transform=PA(.75),O&&O(Ze)}),le=ae(N),Ne=Ze=>{K==="auto"&&ge.start(ue.current||0,Ze),i&&i(me.current,Ze)};return U.jsx(Q,{appear:u,in:b,nodeRef:me,onEnter:he,onEntered:se,onEntering:re,onExit:Y,onExited:le,onExiting:ve,addEndListener:Ne,timeout:K==="auto"?null:K,...ce,children:(Ze,{ownerState:Ie,...Je})=>W.cloneElement(f,{style:{opacity:0,transform:PA(.75),visibility:Ze==="exited"&&!b?"hidden":void 0,...Ore[Ze],...Z,...f.props.style},ref:Te,...Je})})});AT&&(AT.muiSupportAuto=!0);const zre=t=>{const{classes:e,disableUnderline:n}=t,u=Tr({root:["root",!n&&"underline"],input:["input"]},Ote,e);return{...e,...u}},Bre=cn(EE,{shouldForwardProp:t=>bl(t)||t==="classes",name:"MuiInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...wE(t,e),!n.disableUnderline&&e.underline]}})(br(({theme:t})=>{let n=t.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(n=t.alpha(t.vars.palette.common.onBackground,t.vars.opacity.inputUnderline)),{position:"relative",variants:[{props:({ownerState:i})=>i.formControl,style:{"label + &":{marginTop:16}}},{props:({ownerState:i})=>!i.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${F0.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${F0.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${n}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${F0.disabled}, .${F0.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${n}`}},[`&.${F0.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(t.palette).filter(No()).map(([i])=>({props:{color:i,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[i].main}`}}}))]}})),Nre=cn(SE,{name:"MuiInput",slot:"Input",overridesResolver:TE})({}),aM=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiInput"}),{disableUnderline:u=!1,components:f={},componentsProps:g,fullWidth:b=!1,inputComponent:o="input",multiline:S=!1,slotProps:M,slots:O={},type:N="text",...j}=i,Z=zre(i),Q={root:{ownerState:{disableUnderline:u}}},ce=M??g?Jo(M??g,Q):Q,ge=O.root??f.Root??Bre,ue=O.input??f.Input??Nre;return U.jsx(nM,{slots:{root:ge,input:ue},slotProps:ce,fullWidth:b,inputComponent:o,multiline:S,ref:n,type:N,...j,classes:Z})});aM.muiName="Input";function Vre(t){return wr("MuiInputLabel",t)}Sr("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const Fre=t=>{const{classes:e,formControl:n,size:i,shrink:u,disableAnimation:f,variant:g,required:b}=t,o={root:["root",n&&"formControl",!f&&"animated",u&&"shrink",i&&i!=="medium"&&`size${tn(i)}`,g],asterisk:[b&&"asterisk"]},S=Tr(o,Vre,e);return{...e,...S}},Ure=cn(MA,{shouldForwardProp:t=>bl(t)||t==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`& .${bx.asterisk}`]:e.asterisk},e.root,n.formControl&&e.formControl,n.size==="small"&&e.sizeSmall,n.shrink&&e.shrink,!n.disableAnimation&&e.animated,n.focused&&e.focused,e[n.variant]]}})(br(({theme:t})=>({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",variants:[{props:({ownerState:e})=>e.formControl,style:{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"}},{props:{size:"small"},style:{transform:"translate(0, 17px) scale(1)"}},{props:({ownerState:e})=>e.shrink,style:{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"}},{props:({ownerState:e})=>!e.disableAnimation,style:{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})}},{props:{variant:"filled"},style:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"filled",size:"small"},style:{transform:"translate(12px, 13px) scale(1)"}},{props:({variant:e,ownerState:n})=>e==="filled"&&n.shrink,style:{userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"}},{props:({variant:e,ownerState:n,size:i})=>e==="filled"&&n.shrink&&i==="small",style:{transform:"translate(12px, 4px) scale(0.75)"}},{props:{variant:"outlined"},style:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"outlined",size:"small"},style:{transform:"translate(14px, 9px) scale(1)"}},{props:({variant:e,ownerState:n})=>e==="outlined"&&n.shrink,style:{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}}]}))),jre=W.forwardRef(function(e,n){const i=Rr({name:"MuiInputLabel",props:e}),{disableAnimation:u=!1,margin:f,shrink:g,variant:b,className:o,...S}=i,M=Nd();let O=g;typeof O>"u"&&M&&(O=M.filled||M.focused||M.adornedStart);const N=Cm({props:i,muiFormControl:M,states:["size","variant","required","focused"]}),j={...i,disableAnimation:u,formControl:M,shrink:O,size:N.size,variant:N.variant,required:N.required,focused:N.focused},Z=Fre(j);return U.jsx(Ure,{"data-shrink":O,ref:n,className:Pn(Z.root,o),...S,ownerState:j,classes:Z})}),$re=W.createContext({});function qre(t){return wr("MuiList",t)}Sr("MuiList",["root","padding","dense","subheader"]);const Gre=t=>{const{classes:e,disablePadding:n,dense:i,subheader:u}=t;return Tr({root:["root",!n&&"padding",i&&"dense",u&&"subheader"]},qre,e)},Hre=cn("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.disablePadding&&e.padding,n.dense&&e.dense,n.subheader&&e.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:({ownerState:t})=>!t.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:t})=>t.subheader,style:{paddingTop:0}}]}),Wre=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiList"}),{children:u,className:f,component:g="ul",dense:b=!1,disablePadding:o=!1,subheader:S,...M}=i,O=W.useMemo(()=>({dense:b}),[b]),N={...i,component:g,dense:b,disablePadding:o},j=Gre(N);return U.jsx($re.Provider,{value:O,children:U.jsxs(Hre,{as:g,className:Pn(j.root,f),ref:n,ownerState:N,...M,children:[S,u]})})});function rC(t,e,n){return t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:n?null:t.firstChild}function _O(t,e,n){return t===e?n?t.firstChild:t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:n?null:t.lastChild}function WN(t,e){if(e===void 0)return!0;let n=t.innerText;return n===void 0&&(n=t.textContent),n=n.trim().toLowerCase(),n.length===0?!1:e.repeating?n[0]===e.keys[0]:n.startsWith(e.keys.join(""))}function U0(t,e,n,i,u,f){let g=!1,b=u(t,e,e?n:!1);for(;b;){if(b===t.firstChild){if(g)return!1;g=!0}const o=i?!1:b.disabled||b.getAttribute("aria-disabled")==="true";if(!b.hasAttribute("tabindex")||!WN(b,f)||o)b=u(t,b,n);else return b.focus(),!0}return!1}const Xre=W.forwardRef(function(e,n){const{actions:i,autoFocus:u=!1,autoFocusItem:f=!1,children:g,className:b,disabledItemsFocusable:o=!1,disableListWrap:S=!1,onKeyDown:M,variant:O="selectedMenu",...N}=e,j=W.useRef(null),Z=W.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});yu(()=>{u&&j.current.focus()},[u]),W.useImperativeHandle(i,()=>({adjustStyleForScrollbar:(ue,{direction:pe})=>{const me=!j.current.style.width;if(ue.clientHeight<j.current.clientHeight&&me){const Te=`${$N(Hf(ue))}px`;j.current.style[pe==="rtl"?"paddingLeft":"paddingRight"]=Te,j.current.style.width=`calc(100% + ${Te})`}return j.current}}),[]);const K=ue=>{const pe=j.current,me=ue.key;if(ue.ctrlKey||ue.metaKey||ue.altKey){M&&M(ue);return}const ae=xa(pe).activeElement;if(me==="ArrowDown")ue.preventDefault(),U0(pe,ae,S,o,rC);else if(me==="ArrowUp")ue.preventDefault(),U0(pe,ae,S,o,_O);else if(me==="Home")ue.preventDefault(),U0(pe,null,S,o,rC);else if(me==="End")ue.preventDefault(),U0(pe,null,S,o,_O);else if(me.length===1){const re=Z.current,he=me.toLowerCase(),se=performance.now();re.keys.length>0&&(se-re.lastTime>500?(re.keys=[],re.repeating=!0,re.previousKeyMatched=!0):re.repeating&&he!==re.keys[0]&&(re.repeating=!1)),re.lastTime=se,re.keys.push(he);const ve=ae&&!re.repeating&&WN(ae,re);re.previousKeyMatched&&(ve||U0(pe,ae,!1,o,rC,re))?ue.preventDefault():re.previousKeyMatched=!1}M&&M(ue)},Q=To(j,n);let ce=-1;W.Children.forEach(g,(ue,pe)=>{if(!W.isValidElement(ue)){ce===pe&&(ce+=1,ce>=g.length&&(ce=-1));return}ue.props.disabled||(O==="selectedMenu"&&ue.props.selected||ce===-1)&&(ce=pe),ce===pe&&(ue.props.disabled||ue.props.muiSkipListHighlight||ue.type.muiSkipListHighlight)&&(ce+=1,ce>=g.length&&(ce=-1))});const ge=W.Children.map(g,(ue,pe)=>{if(pe===ce){const me={};return f&&(me.autoFocus=!0),ue.props.tabIndex===void 0&&O==="selectedMenu"&&(me.tabIndex=0),W.cloneElement(ue,me)}return ue});return U.jsx(Wre,{role:"menu",ref:Q,className:b,onKeyDown:K,tabIndex:u?0:-1,...N,children:ge})});function Zre(t){return wr("MuiPopover",t)}Sr("MuiPopover",["root","paper"]);function vO(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.height/2:e==="bottom"&&(n=t.height),n}function xO(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.width/2:e==="right"&&(n=t.width),n}function bO(t){return[t.horizontal,t.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function aw(t){return typeof t=="function"?t():t}const Kre=t=>{const{classes:e}=t;return Tr({root:["root"],paper:["paper"]},Zre,e)},Yre=cn(qN,{name:"MuiPopover",slot:"Root"})({}),XN=cn(Ec,{name:"MuiPopover",slot:"Paper"})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Qre=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiPopover"}),{action:u,anchorEl:f,anchorOrigin:g={vertical:"top",horizontal:"left"},anchorPosition:b,anchorReference:o="anchorEl",children:S,className:M,container:O,elevation:N=8,marginThreshold:j=16,open:Z,PaperProps:K={},slots:Q={},slotProps:ce={},transformOrigin:ge={vertical:"top",horizontal:"left"},TransitionComponent:ue,transitionDuration:pe="auto",TransitionProps:me={},disableScrollLock:Te=!1,...ae}=i,re=W.useRef(),he={...i,anchorOrigin:g,anchorReference:o,elevation:N,marginThreshold:j,transformOrigin:ge,TransitionComponent:ue,transitionDuration:pe,TransitionProps:me},se=Kre(he),ve=W.useCallback(()=>{if(o==="anchorPosition")return b;const Wt=aw(f),Gt=(Wt&&Wt.nodeType===1?Wt:xa(re.current).body).getBoundingClientRect();return{top:Gt.top+vO(Gt,g.vertical),left:Gt.left+xO(Gt,g.horizontal)}},[f,g.horizontal,g.vertical,b,o]),Y=W.useCallback(Wt=>({vertical:vO(Wt,ge.vertical),horizontal:xO(Wt,ge.horizontal)}),[ge.horizontal,ge.vertical]),le=W.useCallback(Wt=>{const vn={width:Wt.offsetWidth,height:Wt.offsetHeight},Gt=Y(vn);if(o==="none")return{top:null,left:null,transformOrigin:bO(Gt)};const Cn=ve();let ln=Cn.top-Gt.vertical,qn=Cn.left-Gt.horizontal;const Rn=ln+vn.height,An=qn+vn.width,rr=Hf(aw(f)),En=rr.innerHeight-j,bn=rr.innerWidth-j;if(j!==null&&ln<j){const zn=ln-j;ln-=zn,Gt.vertical+=zn}else if(j!==null&&Rn>En){const zn=Rn-En;ln-=zn,Gt.vertical+=zn}if(j!==null&&qn<j){const zn=qn-j;qn-=zn,Gt.horizontal+=zn}else if(An>bn){const zn=An-bn;qn-=zn,Gt.horizontal+=zn}return{top:`${Math.round(ln)}px`,left:`${Math.round(qn)}px`,transformOrigin:bO(Gt)}},[f,o,ve,Y,j]),[Ne,Ze]=W.useState(Z),Ie=W.useCallback(()=>{const Wt=re.current;if(!Wt)return;const vn=le(Wt);vn.top!==null&&Wt.style.setProperty("top",vn.top),vn.left!==null&&(Wt.style.left=vn.left),Wt.style.transformOrigin=vn.transformOrigin,Ze(!0)},[le]);W.useEffect(()=>(Te&&window.addEventListener("scroll",Ie),()=>window.removeEventListener("scroll",Ie)),[f,Te,Ie]);const Je=()=>{Ie()},dt=()=>{Ze(!1)};W.useEffect(()=>{Z&&Ie()}),W.useImperativeHandle(u,()=>Z?{updatePosition:()=>{Ie()}}:null,[Z,Ie]),W.useEffect(()=>{if(!Z)return;const Wt=xN(()=>{Ie()}),vn=Hf(aw(f));return vn.addEventListener("resize",Wt),()=>{Wt.clear(),vn.removeEventListener("resize",Wt)}},[f,Z,Ie]);let et=pe;const Kt={slots:{transition:ue,...Q},slotProps:{transition:me,paper:K,...ce}},[De,tt]=pi("transition",{elementType:AT,externalForwardedProps:Kt,ownerState:he,getSlotProps:Wt=>({...Wt,onEntering:(vn,Gt)=>{Wt.onEntering?.(vn,Gt),Je()},onExited:vn=>{Wt.onExited?.(vn),dt()}}),additionalProps:{appear:!0,in:Z}});pe==="auto"&&!De.muiSupportAuto&&(et=void 0);const Et=O||(f?xa(aw(f)).body:void 0),[wt,{slots:Lt,slotProps:Ut,...an}]=pi("root",{ref:n,elementType:Yre,externalForwardedProps:{...Kt,...ae},shouldForwardComponentProp:!0,additionalProps:{slots:{backdrop:Q.backdrop},slotProps:{backdrop:yJ(typeof ce.backdrop=="function"?ce.backdrop(he):ce.backdrop,{invisible:!0})},container:Et,open:Z},ownerState:he,className:Pn(se.root,M)}),[At,Qt]=pi("paper",{ref:re,className:se.paper,elementType:XN,externalForwardedProps:Kt,shouldForwardComponentProp:!0,additionalProps:{elevation:N,style:Ne?void 0:{opacity:0}},ownerState:he});return U.jsx(wt,{...an,...!sm(wt)&&{slots:Lt,slotProps:Ut,disableScrollLock:Te},children:U.jsx(De,{...tt,timeout:et,children:U.jsx(At,{...Qt,children:S})})})});function Jre(t){return wr("MuiMenu",t)}Sr("MuiMenu",["root","paper","list"]);const eie={vertical:"top",horizontal:"right"},tie={vertical:"top",horizontal:"left"},nie=t=>{const{classes:e}=t;return Tr({root:["root"],paper:["paper"],list:["list"]},Jre,e)},rie=cn(Qre,{shouldForwardProp:t=>bl(t)||t==="classes",name:"MuiMenu",slot:"Root"})({}),iie=cn(XN,{name:"MuiMenu",slot:"Paper"})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),sie=cn(Xre,{name:"MuiMenu",slot:"List"})({outline:0}),oie=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiMenu"}),{autoFocus:u=!0,children:f,className:g,disableAutoFocusItem:b=!1,MenuListProps:o={},onClose:S,open:M,PaperProps:O={},PopoverClasses:N,transitionDuration:j="auto",TransitionProps:{onEntering:Z,...K}={},variant:Q="selectedMenu",slots:ce={},slotProps:ge={},...ue}=i,pe=yE(),me={...i,autoFocus:u,disableAutoFocusItem:b,MenuListProps:o,onEntering:Z,PaperProps:O,transitionDuration:j,TransitionProps:K,variant:Q},Te=nie(me),ae=u&&!b&&M,re=W.useRef(null),he=(et,Kt)=>{re.current&&re.current.adjustStyleForScrollbar(et,{direction:pe?"rtl":"ltr"}),Z&&Z(et,Kt)},se=et=>{et.key==="Tab"&&(et.preventDefault(),S&&S(et,"tabKeyDown"))};let ve=-1;W.Children.map(f,(et,Kt)=>{W.isValidElement(et)&&(et.props.disabled||(Q==="selectedMenu"&&et.props.selected||ve===-1)&&(ve=Kt))});const Y={slots:ce,slotProps:{list:o,transition:K,paper:O,...ge}},le=fd({elementType:ce.root,externalSlotProps:ge.root,ownerState:me,className:[Te.root,g]}),[Ne,Ze]=pi("paper",{className:Te.paper,elementType:iie,externalForwardedProps:Y,shouldForwardComponentProp:!0,ownerState:me}),[Ie,Je]=pi("list",{className:Pn(Te.list,o.className),elementType:sie,shouldForwardComponentProp:!0,externalForwardedProps:Y,getSlotProps:et=>({...et,onKeyDown:Kt=>{se(Kt),et.onKeyDown?.(Kt)}}),ownerState:me}),dt=typeof Y.slotProps.transition=="function"?Y.slotProps.transition(me):Y.slotProps.transition;return U.jsx(rie,{onClose:S,anchorOrigin:{vertical:"bottom",horizontal:pe?"right":"left"},transformOrigin:pe?eie:tie,slots:{root:ce.root,paper:Ne,backdrop:ce.backdrop,...ce.transition&&{transition:ce.transition}},slotProps:{root:le,paper:Ze,backdrop:typeof ge.backdrop=="function"?ge.backdrop(me):ge.backdrop,transition:{...dt,onEntering:(...et)=>{he(...et),dt?.onEntering?.(...et)}}},open:M,ref:n,transitionDuration:j,ownerState:me,...ue,classes:N,children:U.jsx(Ie,{actions:re,autoFocus:u&&(ve===-1||b),autoFocusItem:ae,variant:Q,...Je,children:f})})});function aie(t){return wr("MuiNativeSelect",t)}const lM=Sr("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),lie=t=>{const{classes:e,variant:n,disabled:i,multiple:u,open:f,error:g}=t,b={select:["select",n,i&&"disabled",u&&"multiple",g&&"error"],icon:["icon",`icon${tn(n)}`,f&&"iconOpen",i&&"disabled"]};return Tr(b,aie,e)},ZN=cn("select",{name:"MuiNativeSelect"})(({theme:t})=>({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":{borderRadius:0},[`&.${lM.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(t.vars||t).palette.background.paper},variants:[{props:({ownerState:e})=>e.variant!=="filled"&&e.variant!=="outlined",style:{"&&&":{paddingRight:24,minWidth:16}}},{props:{variant:"filled"},style:{"&&&":{paddingRight:32}}},{props:{variant:"outlined"},style:{borderRadius:(t.vars||t).shape.borderRadius,"&:focus":{borderRadius:(t.vars||t).shape.borderRadius},"&&&":{paddingRight:32}}}]})),cie=cn(ZN,{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:bl,overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.select,e[n.variant],n.error&&e.error,{[`&.${lM.multiple}`]:e.multiple}]}})({}),KN=cn("svg",{name:"MuiNativeSelect"})(({theme:t})=>({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(t.vars||t).palette.action.active,[`&.${lM.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:({ownerState:e})=>e.open,style:{transform:"rotate(180deg)"}},{props:{variant:"filled"},style:{right:7}},{props:{variant:"outlined"},style:{right:7}}]})),uie=cn(KN,{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${tn(n.variant)}`],n.open&&e.iconOpen]}})({}),hie=W.forwardRef(function(e,n){const{className:i,disabled:u,error:f,IconComponent:g,inputRef:b,variant:o="standard",...S}=e,M={...e,disabled:u,variant:o,error:f},O=lie(M);return U.jsxs(W.Fragment,{children:[U.jsx(cie,{ownerState:M,className:Pn(O.select,i),disabled:u,ref:b||n,...S}),e.multiple?null:U.jsx(uie,{as:g,ownerState:M,className:O.icon})]})});var wO;const die=cn("fieldset",{name:"MuiNotchedOutlined",shouldForwardProp:bl})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),fie=cn("legend",{name:"MuiNotchedOutlined",shouldForwardProp:bl})(br(({theme:t})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:({ownerState:e})=>!e.withLabel,style:{padding:0,lineHeight:"11px",transition:t.transitions.create("width",{duration:150,easing:t.transitions.easing.easeOut})}},{props:({ownerState:e})=>e.withLabel,style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:t.transitions.create("max-width",{duration:50,easing:t.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:({ownerState:e})=>e.withLabel&&e.notched,style:{maxWidth:"100%",transition:t.transitions.create("max-width",{duration:100,easing:t.transitions.easing.easeOut,delay:50})}}]})));function pie(t){const{children:e,classes:n,className:i,label:u,notched:f,...g}=t,b=u!=null&&u!=="",o={...t,notched:f,withLabel:b};return U.jsx(die,{"aria-hidden":!0,className:i,ownerState:o,...g,children:U.jsx(fie,{ownerState:o,children:b?U.jsx("span",{children:u}):wO||(wO=U.jsx("span",{className:"notranslate","aria-hidden":!0,children:""}))})})}const mie=t=>{const{classes:e}=t,i=Tr({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},zte,e);return{...e,...i}},gie=cn(EE,{shouldForwardProp:t=>bl(t)||t==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:wE})(br(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${dd.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${dd.notchedOutline}`]:{borderColor:t.vars?t.alpha(t.vars.palette.common.onBackground,.23):e}},[`&.${dd.focused} .${dd.notchedOutline}`]:{borderWidth:2},variants:[...Object.entries(t.palette).filter(No()).map(([n])=>({props:{color:n},style:{[`&.${dd.focused} .${dd.notchedOutline}`]:{borderColor:(t.vars||t).palette[n].main}}})),{props:{},style:{[`&.${dd.error} .${dd.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${dd.disabled} .${dd.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}}},{props:({ownerState:n})=>n.startAdornment,style:{paddingLeft:14}},{props:({ownerState:n})=>n.endAdornment,style:{paddingRight:14}},{props:({ownerState:n})=>n.multiline,style:{padding:"16.5px 14px"}},{props:({ownerState:n,size:i})=>n.multiline&&i==="small",style:{padding:"8.5px 14px"}}]}})),yie=cn(pie,{name:"MuiOutlinedInput",slot:"NotchedOutline"})(br(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?t.alpha(t.vars.palette.common.onBackground,.23):e}})),_ie=cn(SE,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:TE})(br(({theme:t})=>({padding:"16.5px 14px",...!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},...t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{padding:"8.5px 14px"}},{props:({ownerState:e})=>e.multiline,style:{padding:0}},{props:({ownerState:e})=>e.startAdornment,style:{paddingLeft:0}},{props:({ownerState:e})=>e.endAdornment,style:{paddingRight:0}}]}))),cM=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiOutlinedInput"}),{components:u={},fullWidth:f=!1,inputComponent:g="input",label:b,multiline:o=!1,notched:S,slots:M={},slotProps:O={},type:N="text",...j}=i,Z=mie(i),K=Nd(),Q=Cm({props:i,muiFormControl:K,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),ce={...i,color:Q.color||"primary",disabled:Q.disabled,error:Q.error,focused:Q.focused,formControl:K,fullWidth:f,hiddenLabel:Q.hiddenLabel,multiline:o,size:Q.size,type:N},ge=M.root??u.Root??gie,ue=M.input??u.Input??_ie,[pe,me]=pi("notchedOutline",{elementType:yie,className:Z.notchedOutline,shouldForwardComponentProp:!0,ownerState:ce,externalForwardedProps:{slots:M,slotProps:O},additionalProps:{label:b!=null&&b!==""&&Q.required?U.jsxs(W.Fragment,{children:[b,"","*"]}):b}});return U.jsx(nM,{slots:{root:ge,input:ue},slotProps:O,renderSuffix:Te=>U.jsx(pe,{...me,notched:typeof S<"u"?S:!!(Te.startAdornment||Te.filled||Te.focused)}),fullWidth:f,inputComponent:g,multiline:o,ref:n,type:N,...j,classes:{...Z,notchedOutline:null}})});cM.muiName="Input";const vie=Fo(U.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),xie=Fo(U.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"})),bie=cn("span",{name:"MuiRadioButtonIcon",shouldForwardProp:bl})({position:"relative",display:"flex"}),wie=cn(vie,{name:"MuiRadioButtonIcon"})({transform:"scale(1)"}),Tie=cn(xie,{name:"MuiRadioButtonIcon"})(br(({theme:t})=>({left:0,position:"absolute",transform:"scale(0)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeIn,duration:t.transitions.duration.shortest}),variants:[{props:{checked:!0},style:{transform:"scale(1)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.shortest})}}]})));function YN(t){const{checked:e=!1,classes:n={},fontSize:i}=t,u={...t,checked:e};return U.jsxs(bie,{className:n.root,ownerState:u,children:[U.jsx(wie,{fontSize:i,className:n.background,ownerState:u}),U.jsx(Tie,{fontSize:i,className:n.dot,ownerState:u})]})}const QN=W.createContext(void 0);function Eie(){return W.useContext(QN)}function Sie(t){return wr("MuiRadio",t)}const TO=Sr("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]),Cie=t=>{const{classes:e,color:n,size:i}=t,u={root:["root",`color${tn(n)}`,i!=="medium"&&`size${tn(i)}`]};return{...e,...Tr(u,Sie,e)}},Aie=cn(vne,{shouldForwardProp:t=>bl(t)||t==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.size!=="medium"&&e[`size${tn(n.size)}`],e[`color${tn(n.color)}`]]}})(br(({theme:t})=>({color:(t.vars||t).palette.text.secondary,[`&.${TO.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{color:"default",disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity)}}},...Object.entries(t.palette).filter(No()).map(([e])=>({props:{color:e,disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:t.alpha((t.vars||t).palette[e].main,(t.vars||t).palette.action.hoverOpacity)}}})),...Object.entries(t.palette).filter(No()).map(([e])=>({props:{color:e,disabled:!1},style:{[`&.${TO.checked}`]:{color:(t.vars||t).palette[e].main}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]})));function Iie(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}const Rie=U.jsx(YN,{checked:!0}),Mie=U.jsx(YN,{}),lw=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiRadio"}),{checked:u,checkedIcon:f=Rie,color:g="primary",icon:b=Mie,name:o,onChange:S,size:M="medium",className:O,disabled:N,disableRipple:j=!1,slots:Z={},slotProps:K={},inputProps:Q,...ce}=i,ge=Nd();let ue=N;ge&&typeof ue>"u"&&(ue=ge.disabled),ue??=!1;const pe={...i,disabled:ue,disableRipple:j,color:g,size:M},me=Cie(pe),Te=Eie();let ae=u;const re=yA(S,Te&&Te.onChange);let he=o;Te&&(typeof ae>"u"&&(ae=Iie(Te.value,i.value)),typeof he>"u"&&(he=Te.name));const se=K.input??Q,[ve,Y]=pi("root",{ref:n,elementType:Aie,className:Pn(me.root,O),shouldForwardComponentProp:!0,externalForwardedProps:{slots:Z,slotProps:K,...ce},getSlotProps:le=>({...le,onChange:(Ne,...Ze)=>{le.onChange?.(Ne,...Ze),re(Ne,...Ze)}}),ownerState:pe,additionalProps:{type:"radio",icon:W.cloneElement(b,{fontSize:b.props.fontSize??M}),checkedIcon:W.cloneElement(f,{fontSize:f.props.fontSize??M}),disabled:ue,name:he,checked:ae,slots:Z,slotProps:{input:typeof se=="function"?se(pe):se}}});return U.jsx(ve,{...Y,classes:me})});function Pie(t){return wr("MuiRadioGroup",t)}Sr("MuiRadioGroup",["root","row","error"]);const kie=t=>{const{classes:e,row:n,error:i}=t;return Tr({root:["root",n&&"row",i&&"error"]},Pie,e)},EO=W.forwardRef(function(e,n){const{actions:i,children:u,className:f,defaultValue:g,name:b,onChange:o,value:S,...M}=e,O=W.useRef(null),N=kie(e),[j,Z]=V_({controlled:S,default:g,name:"RadioGroup"});W.useImperativeHandle(i,()=>({focus:()=>{let ge=O.current.querySelector("input:not(:disabled):checked");ge||(ge=O.current.querySelector("input:not(:disabled)")),ge&&ge.focus()}}),[]);const K=To(n,O),Q=Tm(b),ce=W.useMemo(()=>({name:Q,onChange(ge){Z(ge.target.value),o&&o(ge,ge.target.value)},value:j}),[Q,o,Z,j]);return U.jsx(QN.Provider,{value:ce,children:U.jsx(Cre,{role:"radiogroup",ref:K,className:Pn(N.root,f),...M,children:u})})}),Die={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};function JN(t){return wr("MuiSelect",t)}const j0=Sr("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var SO;const Lie=cn(ZN,{name:"MuiSelect",slot:"Select",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`&.${j0.select}`]:e.select},{[`&.${j0.select}`]:e[n.variant]},{[`&.${j0.error}`]:e.error},{[`&.${j0.multiple}`]:e.multiple}]}})({[`&.${j0.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),Oie=cn(KN,{name:"MuiSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${tn(n.variant)}`],n.open&&e.iconOpen]}})({}),zie=cn("input",{shouldForwardProp:t=>vE(t)&&t!=="classes",name:"MuiSelect",slot:"NativeInput"})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function CO(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}function Bie(t){return t==null||typeof t=="string"&&!t.trim()}const Nie=t=>{const{classes:e,variant:n,disabled:i,multiple:u,open:f,error:g}=t,b={select:["select",n,i&&"disabled",u&&"multiple",g&&"error"],icon:["icon",`icon${tn(n)}`,f&&"iconOpen",i&&"disabled"],nativeInput:["nativeInput"]};return Tr(b,JN,e)},Vie=W.forwardRef(function(e,n){const{"aria-describedby":i,"aria-label":u,autoFocus:f,autoWidth:g,children:b,className:o,defaultOpen:S,defaultValue:M,disabled:O,displayEmpty:N,error:j=!1,IconComponent:Z,inputRef:K,labelId:Q,MenuProps:ce={},multiple:ge,name:ue,onBlur:pe,onChange:me,onClose:Te,onFocus:ae,onOpen:re,open:he,readOnly:se,renderValue:ve,required:Y,SelectDisplayProps:le={},tabIndex:Ne,type:Ze,value:Ie,variant:Je="standard",...dt}=e,[et,Kt]=V_({controlled:Ie,default:M,name:"Select"}),[De,tt]=V_({controlled:he,default:S,name:"Select"}),Et=W.useRef(null),wt=W.useRef(null),[Lt,Ut]=W.useState(null),{current:an}=W.useRef(he!=null),[At,Qt]=W.useState(),Wt=To(n,K),vn=W.useCallback(xn=>{wt.current=xn,xn&&Ut(xn)},[]),Gt=Lt?.parentNode;W.useImperativeHandle(Wt,()=>({focus:()=>{wt.current.focus()},node:Et.current,value:et}),[et]),W.useEffect(()=>{S&&De&&Lt&&!an&&(Qt(g?null:Gt.clientWidth),wt.current.focus())},[Lt,g]),W.useEffect(()=>{f&&wt.current.focus()},[f]),W.useEffect(()=>{if(!Q)return;const xn=xa(wt.current).getElementById(Q);if(xn){const $n=()=>{getSelection().isCollapsed&&wt.current.focus()};return xn.addEventListener("click",$n),()=>{xn.removeEventListener("click",$n)}}},[Q]);const Cn=(xn,$n)=>{xn?re&&re($n):Te&&Te($n),an||(Qt(g?null:Gt.clientWidth),tt(xn))},ln=xn=>{xn.button===0&&(xn.preventDefault(),wt.current.focus(),Cn(!0,xn))},qn=xn=>{Cn(!1,xn)},Rn=W.Children.toArray(b),An=xn=>{const $n=Rn.find(jr=>jr.props.value===xn.target.value);$n!==void 0&&(Kt($n.props.value),me&&me(xn,$n))},rr=xn=>$n=>{let jr;if($n.currentTarget.hasAttribute("tabindex")){if(ge){jr=Array.isArray(et)?et.slice():[];const Gi=et.indexOf(xn.props.value);Gi===-1?jr.push(xn.props.value):jr.splice(Gi,1)}else jr=xn.props.value;if(xn.props.onClick&&xn.props.onClick($n),et!==jr&&(Kt(jr),me)){const Gi=$n.nativeEvent||$n,eo=new Gi.constructor(Gi.type,Gi);Object.defineProperty(eo,"target",{writable:!0,value:{value:jr,name:ue}}),me(eo,xn)}ge||Cn(!1,$n)}},En=xn=>{se||[" ","ArrowUp","ArrowDown","Enter"].includes(xn.key)&&(xn.preventDefault(),Cn(!0,xn))},bn=Lt!==null&&De,zn=xn=>{!bn&&pe&&(Object.defineProperty(xn,"target",{writable:!0,value:{value:et,name:ue}}),pe(xn))};delete dt["aria-invalid"];let mn,ti;const Xn=[];let on=!1;(CT({value:et})||N)&&(ve?mn=ve(et):on=!0);const Jt=Rn.map(xn=>{if(!W.isValidElement(xn))return null;let $n;if(ge){if(!Array.isArray(et))throw new Error(Gf(2));$n=et.some(jr=>CO(jr,xn.props.value)),$n&&on&&Xn.push(xn.props.children)}else $n=CO(et,xn.props.value),$n&&on&&(ti=xn.props.children);return W.cloneElement(xn,{"aria-selected":$n?"true":"false",onClick:rr(xn),onKeyUp:jr=>{jr.key===" "&&jr.preventDefault(),xn.props.onKeyUp&&xn.props.onKeyUp(jr)},role:"option",selected:$n,value:void 0,"data-value":xn.props.value})});on&&(ge?Xn.length===0?mn=null:mn=Xn.reduce((xn,$n,jr)=>(xn.push($n),jr<Xn.length-1&&xn.push(", "),xn),[]):mn=ti);let yn=At;!g&&an&&Lt&&(yn=Gt.clientWidth);let _n;typeof Ne<"u"?_n=Ne:_n=O?null:0;const In=le.id||(ue?`mui-component-select-${ue}`:void 0),Bn={...e,variant:Je,value:et,open:bn,error:j},Nn=Nie(Bn),Br={...ce.PaperProps,...typeof ce.slotProps?.paper=="function"?ce.slotProps.paper(Bn):ce.slotProps?.paper},tr={...ce.MenuListProps,...typeof ce.slotProps?.list=="function"?ce.slotProps.list(Bn):ce.slotProps?.list},_r=Tm();return U.jsxs(W.Fragment,{children:[U.jsx(Lie,{as:"div",ref:vn,tabIndex:_n,role:"combobox","aria-controls":bn?_r:void 0,"aria-disabled":O?"true":void 0,"aria-expanded":bn?"true":"false","aria-haspopup":"listbox","aria-label":u,"aria-labelledby":[Q,In].filter(Boolean).join(" ")||void 0,"aria-describedby":i,"aria-required":Y?"true":void 0,"aria-invalid":j?"true":void 0,onKeyDown:En,onMouseDown:O||se?null:ln,onBlur:zn,onFocus:ae,...le,ownerState:Bn,className:Pn(le.className,Nn.select,o),id:In,children:Bie(mn)?SO||(SO=U.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):mn}),U.jsx(zie,{"aria-invalid":j,value:Array.isArray(et)?et.join(","):et,name:ue,ref:Et,"aria-hidden":!0,onChange:An,tabIndex:-1,disabled:O,className:Nn.nativeInput,autoFocus:f,required:Y,...dt,ownerState:Bn}),U.jsx(Oie,{as:Z,className:Nn.icon,ownerState:Bn}),U.jsx(oie,{id:`menu-${ue||""}`,anchorEl:Gt,open:bn,onClose:qn,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},...ce,slotProps:{...ce.slotProps,list:{"aria-labelledby":Q,role:"listbox","aria-multiselectable":ge?"true":void 0,disableListWrap:!0,id:_r,...tr},paper:{...Br,style:{minWidth:yn,...Br!=null?Br.style:null}}},children:Jt})]})}),Fie=t=>{const{classes:e}=t,i=Tr({root:["root"]},JN,e);return{...e,...i}},uM={name:"MuiSelect",slot:"Root",shouldForwardProp:t=>bl(t)&&t!=="variant"},Uie=cn(aM,uM)(""),jie=cn(cM,uM)(""),$ie=cn(oM,uM)(""),eV=W.forwardRef(function(e,n){const i=Rr({name:"MuiSelect",props:e}),{autoWidth:u=!1,children:f,classes:g={},className:b,defaultOpen:o=!1,displayEmpty:S=!1,IconComponent:M=Nte,id:O,input:N,inputProps:j,label:Z,labelId:K,MenuProps:Q,multiple:ce=!1,native:ge=!1,onClose:ue,onOpen:pe,open:me,renderValue:Te,SelectDisplayProps:ae,variant:re="outlined",...he}=i,se=ge?hie:Vie,ve=Nd(),Y=Cm({props:i,muiFormControl:ve,states:["variant","error"]}),le=Y.variant||re,Ne={...i,variant:le,classes:g},Ze=Fie(Ne),{root:Ie,...Je}=Ze,dt=N||{standard:U.jsx(Uie,{ownerState:Ne}),outlined:U.jsx(jie,{label:Z,ownerState:Ne}),filled:U.jsx($ie,{ownerState:Ne})}[le],et=To(n,lv(dt));return U.jsx(W.Fragment,{children:W.cloneElement(dt,{inputComponent:se,inputProps:{children:f,error:Y.error,IconComponent:M,variant:le,type:void 0,multiple:ce,...ge?{id:O}:{autoWidth:u,defaultOpen:o,displayEmpty:S,labelId:K,MenuProps:Q,onClose:ue,onOpen:pe,open:me,renderValue:Te,SelectDisplayProps:{id:O,...ae}},...j,classes:j?Jo(Je,j.classes):Je,...N?N.props.inputProps:{}},...(ce&&ge||S)&&le==="outlined"?{notched:!0}:{},ref:et,className:Pn(dt.props.className,b,Ze.root),...!N&&{variant:le},...he})})});eV.muiName="Select";function qie(t,e,n=(i,u)=>i===u){return t.length===e.length&&t.every((i,u)=>n(i,e[u]))}const Gie=2;function r_(t,e,n,i,u){return n===1?Math.min(t+e,u):Math.max(t-e,i)}function tV(t,e){return t-e}function AO(t,e){const{index:n}=t.reduce((i,u,f)=>{const g=Math.abs(e-u);return i===null||g<i.distance||g===i.distance?{distance:g,index:f}:i},null)??{};return n}function cw(t,e){if(e.current!==void 0&&t.changedTouches){const n=t;for(let i=0;i<n.changedTouches.length;i+=1){const u=n.changedTouches[i];if(u.identifier===e.current)return{x:u.clientX,y:u.clientY}}return!1}return{x:t.clientX,y:t.clientY}}function IT(t,e,n){return(t-e)*100/(n-e)}function Hie(t,e,n){return(n-e)*t+e}function Wie(t){if(Math.abs(t)<1){const n=t.toExponential().split("e-"),i=n[0].split(".")[1];return(i?i.length:0)+parseInt(n[1],10)}const e=t.toString().split(".")[1];return e?e.length:0}function Xie(t,e,n){const i=Math.round((t-n)/e)*e+n;return Number(i.toFixed(Wie(e)))}function IO({values:t,newValue:e,index:n}){const i=t.slice();return i[n]=e,i.sort(tV)}function uw({sliderRef:t,activeIndex:e,setActive:n}){const i=xa(t.current);(!t.current?.contains(i.activeElement)||Number(i?.activeElement?.getAttribute("data-index"))!==e)&&t.current?.querySelector(`[type="range"][data-index="${e}"]`).focus(),n&&n(e)}function hw(t,e){return typeof t=="number"&&typeof e=="number"?t===e:typeof t=="object"&&typeof e=="object"?qie(t,e):!1}const Zie={horizontal:{offset:t=>({left:`${t}%`}),leap:t=>({width:`${t}%`})},"horizontal-reverse":{offset:t=>({right:`${t}%`}),leap:t=>({width:`${t}%`})},vertical:{offset:t=>({bottom:`${t}%`}),leap:t=>({height:`${t}%`})}},Kie=t=>t;let dw;function RO(){return dw===void 0&&(typeof CSS<"u"&&typeof CSS.supports=="function"?dw=CSS.supports("touch-action","none"):dw=!0),dw}function Yie(t){const{"aria-labelledby":e,defaultValue:n,disabled:i=!1,disableSwap:u=!1,isRtl:f=!1,marks:g=!1,max:b=100,min:o=0,name:S,onChange:M,onChangeCommitted:O,orientation:N="horizontal",rootRef:j,scale:Z=Kie,step:K=1,shiftStep:Q=10,tabIndex:ce,value:ge}=t,ue=W.useRef(void 0),[pe,me]=W.useState(-1),[Te,ae]=W.useState(-1),[re,he]=W.useState(!1),se=W.useRef(0),ve=W.useRef(null),[Y,le]=V_({controlled:ge,default:n??o,name:"Slider"}),Ne=M&&((on,Jt,yn)=>{const _n=on.nativeEvent||on,In=new _n.constructor(_n.type,_n);Object.defineProperty(In,"target",{writable:!0,value:{value:Jt,name:S}}),ve.current=Jt,M(In,Jt,yn)}),Ze=Array.isArray(Y);let Ie=Ze?Y.slice().sort(tV):[Y];Ie=Ie.map(on=>on==null?o:u_(on,o,b));const Je=g===!0&&K!==null?[...Array(Math.floor((b-o)/K)+1)].map((on,Jt)=>({value:o+K*Jt})):g||[],dt=Je.map(on=>on.value),[et,Kt]=W.useState(-1),De=W.useRef(null),tt=To(j,De),Et=on=>Jt=>{const yn=Number(Jt.currentTarget.getAttribute("data-index"));F_(Jt.target)&&Kt(yn),ae(yn),on?.onFocus?.(Jt)},wt=on=>Jt=>{F_(Jt.target)||Kt(-1),ae(-1),on?.onBlur?.(Jt)},Lt=(on,Jt)=>{const yn=Number(on.currentTarget.getAttribute("data-index")),_n=Ie[yn],In=dt.indexOf(_n);let Bn=Jt;if(Je&&K==null){const Nn=dt[dt.length-1];Bn>=Nn?Bn=Nn:Bn<=dt[0]?Bn=dt[0]:Bn=Bn<_n?dt[In-1]:dt[In+1]}if(Bn=u_(Bn,o,b),Ze){u&&(Bn=u_(Bn,Ie[yn-1]||-1/0,Ie[yn+1]||1/0));const Nn=Bn;Bn=IO({values:Ie,newValue:Bn,index:yn});let Br=yn;u||(Br=Bn.indexOf(Nn)),uw({sliderRef:De,activeIndex:Br})}le(Bn),Kt(yn),Ne&&!hw(Bn,Y)&&Ne(on,Bn,yn),O&&O(on,ve.current??Bn)},Ut=on=>Jt=>{if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Home","End"].includes(Jt.key)){Jt.preventDefault();const yn=Number(Jt.currentTarget.getAttribute("data-index")),_n=Ie[yn];let In=null;if(K!=null){const Bn=Jt.shiftKey?Q:K;switch(Jt.key){case"ArrowUp":In=r_(_n,Bn,1,o,b);break;case"ArrowRight":In=r_(_n,Bn,f?-1:1,o,b);break;case"ArrowDown":In=r_(_n,Bn,-1,o,b);break;case"ArrowLeft":In=r_(_n,Bn,f?1:-1,o,b);break;case"PageUp":In=r_(_n,Q,1,o,b);break;case"PageDown":In=r_(_n,Q,-1,o,b);break;case"Home":In=o;break;case"End":In=b;break}}else if(Je){const Bn=dt[dt.length-1],Nn=dt.indexOf(_n),Br=[f?"ArrowRight":"ArrowLeft","ArrowDown","PageDown","Home"],tr=[f?"ArrowLeft":"ArrowRight","ArrowUp","PageUp","End"];Br.includes(Jt.key)?Nn===0?In=dt[0]:In=dt[Nn-1]:tr.includes(Jt.key)&&(Nn===dt.length-1?In=Bn:In=dt[Nn+1])}In!=null&&Lt(Jt,In)}on?.onKeyDown?.(Jt)};yu(()=>{i&&De.current.contains(document.activeElement)&&document.activeElement?.blur()},[i]),i&&pe!==-1&&me(-1),i&&et!==-1&&Kt(-1);const an=on=>Jt=>{on.onChange?.(Jt),Lt(Jt,Jt.target.valueAsNumber)},At=W.useRef(void 0);let Qt=N;f&&N==="horizontal"&&(Qt+="-reverse");const Wt=({finger:on,move:Jt=!1})=>{const{current:yn}=De,{width:_n,height:In,bottom:Bn,left:Nn}=yn.getBoundingClientRect();let Br;Qt.startsWith("vertical")?Br=(Bn-on.y)/In:Br=(on.x-Nn)/_n,Qt.includes("-reverse")&&(Br=1-Br);let tr;if(tr=Hie(Br,o,b),K)tr=Xie(tr,K,o);else{const xn=AO(dt,tr);tr=dt[xn]}tr=u_(tr,o,b);let _r=0;if(Ze){Jt?_r=At.current:_r=AO(Ie,tr),u&&(tr=u_(tr,Ie[_r-1]||-1/0,Ie[_r+1]||1/0));const xn=tr;tr=IO({values:Ie,newValue:tr,index:_r}),u&&Jt||(_r=tr.indexOf(xn),At.current=_r)}return{newValue:tr,activeIndex:_r}},vn=mu(on=>{const Jt=cw(on,ue);if(!Jt)return;if(se.current+=1,on.type==="mousemove"&&on.buttons===0){Gt(on);return}const{newValue:yn,activeIndex:_n}=Wt({finger:Jt,move:!0});uw({sliderRef:De,activeIndex:_n,setActive:me}),le(yn),!re&&se.current>Gie&&he(!0),Ne&&!hw(yn,Y)&&Ne(on,yn,_n)}),Gt=mu(on=>{const Jt=cw(on,ue);if(he(!1),!Jt)return;const{newValue:yn}=Wt({finger:Jt,move:!0});me(-1),on.type==="touchend"&&ae(-1),O&&O(on,ve.current??yn),ue.current=void 0,ln()}),Cn=mu(on=>{if(i)return;RO()||on.preventDefault();const Jt=on.changedTouches[0];Jt!=null&&(ue.current=Jt.identifier);const yn=cw(on,ue);if(yn!==!1){const{newValue:In,activeIndex:Bn}=Wt({finger:yn});uw({sliderRef:De,activeIndex:Bn,setActive:me}),le(In),Ne&&!hw(In,Y)&&Ne(on,In,Bn)}se.current=0;const _n=xa(De.current);_n.addEventListener("touchmove",vn,{passive:!0}),_n.addEventListener("touchend",Gt,{passive:!0})}),ln=W.useCallback(()=>{const on=xa(De.current);on.removeEventListener("mousemove",vn),on.removeEventListener("mouseup",Gt),on.removeEventListener("touchmove",vn),on.removeEventListener("touchend",Gt)},[Gt,vn]);W.useEffect(()=>{const{current:on}=De;return on.addEventListener("touchstart",Cn,{passive:RO()}),()=>{on.removeEventListener("touchstart",Cn),ln()}},[ln,Cn]),W.useEffect(()=>{i&&ln()},[i,ln]);const qn=on=>Jt=>{if(on.onMouseDown?.(Jt),i||Jt.defaultPrevented||Jt.button!==0)return;Jt.preventDefault();const yn=cw(Jt,ue);if(yn!==!1){const{newValue:In,activeIndex:Bn}=Wt({finger:yn});uw({sliderRef:De,activeIndex:Bn,setActive:me}),le(In),Ne&&!hw(In,Y)&&Ne(Jt,In,Bn)}se.current=0;const _n=xa(De.current);_n.addEventListener("mousemove",vn,{passive:!0}),_n.addEventListener("mouseup",Gt)},Rn=IT(Ze?Ie[0]:o,o,b),An=IT(Ie[Ie.length-1],o,b)-Rn,rr=(on={})=>{const Jt=yx(on),yn={onMouseDown:qn(Jt||{})},_n={...Jt,...yn};return{...on,ref:tt,..._n}},En=on=>Jt=>{on.onMouseOver?.(Jt);const yn=Number(Jt.currentTarget.getAttribute("data-index"));ae(yn)},bn=on=>Jt=>{on.onMouseLeave?.(Jt),ae(-1)},zn=(on={})=>{const Jt=yx(on),yn={onMouseOver:En(Jt||{}),onMouseLeave:bn(Jt||{})};return{...on,...Jt,...yn}},mn=on=>({pointerEvents:pe!==-1&&pe!==on?"none":void 0});let ti;return N==="vertical"&&(ti=f?"vertical-rl":"vertical-lr"),{active:pe,axis:Qt,axisProps:Zie,dragging:re,focusedThumbIndex:et,getHiddenInputProps:(on={})=>{const Jt=yx(on),yn={onChange:an(Jt||{}),onFocus:Et(Jt||{}),onBlur:wt(Jt||{}),onKeyDown:Ut(Jt||{})},_n={...Jt,...yn};return{tabIndex:ce,"aria-labelledby":e,"aria-orientation":N,"aria-valuemax":Z(b),"aria-valuemin":Z(o),name:S,type:"range",min:t.min,max:t.max,step:t.step===null&&t.marks?"any":t.step??void 0,disabled:i,...on,..._n,style:{...Die,direction:f?"rtl":"ltr",width:"100%",height:"100%",writingMode:ti}}},getRootProps:rr,getThumbProps:zn,marks:Je,open:Te,range:Ze,rootRef:tt,trackLeap:An,trackOffset:Rn,values:Ie,getThumbStyle:mn}}const Qie=t=>!t||!sm(t);function Jie(t){return wr("MuiSlider",t)}const fu=Sr("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]),ese=t=>{const{open:e}=t;return{offset:Pn(e&&fu.valueLabelOpen),circle:fu.valueLabelCircle,label:fu.valueLabelLabel}};function tse(t){const{children:e,className:n,value:i}=t,u=ese(t);return e?W.cloneElement(e,{className:e.props.className},U.jsxs(W.Fragment,{children:[e.props.children,U.jsx("span",{className:Pn(u.offset,n),"aria-hidden":!0,children:U.jsx("span",{className:u.circle,children:U.jsx("span",{className:u.label,children:i})})})]})):null}function MO(t){return t}const nse=cn("span",{name:"MuiSlider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`color${tn(n.color)}`],n.size!=="medium"&&e[`size${tn(n.size)}`],n.marked&&e.marked,n.orientation==="vertical"&&e.vertical,n.track==="inverted"&&e.trackInverted,n.track===!1&&e.trackFalse]}})(br(({theme:t})=>({borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},[`&.${fu.disabled}`]:{pointerEvents:"none",cursor:"default",color:(t.vars||t).palette.grey[400]},[`&.${fu.dragging}`]:{[`& .${fu.thumb}, & .${fu.track}`]:{transition:"none"}},variants:[...Object.entries(t.palette).filter(No()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}))),rse=cn("span",{name:"MuiSlider",slot:"Rail"})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),ise=cn("span",{name:"MuiSlider",slot:"Track"})(br(({theme:t})=>({display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:t.transitions.create(["left","width","bottom","height"],{duration:t.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.entries(t.palette).filter(No()).map(([e])=>({props:{color:e,track:"inverted"},style:{...t.vars?{backgroundColor:t.vars.palette.Slider[`${e}Track`],borderColor:t.vars.palette.Slider[`${e}Track`]}:{backgroundColor:t.lighten(t.palette[e].main,.62),borderColor:t.lighten(t.palette[e].main,.62),...t.applyStyles("dark",{backgroundColor:t.darken(t.palette[e].main,.5)}),...t.applyStyles("dark",{borderColor:t.darken(t.palette[e].main,.5)})}}}))]}))),sse=cn("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.thumb,e[`thumbColor${tn(n.color)}`],n.size!=="medium"&&e[`thumbSize${tn(n.size)}`]]}})(br(({theme:t})=>({position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:t.transitions.create(["box-shadow","left","bottom"],{duration:t.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(t.vars||t).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&.${fu.disabled}`]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.entries(t.palette).filter(No()).map(([e])=>({props:{color:e},style:{[`&:hover, &.${fu.focusVisible}`]:{boxShadow:`0px 0px 0px 8px ${t.alpha((t.vars||t).palette[e].main,.16)}`,"@media (hover: none)":{boxShadow:"none"}},[`&.${fu.active}`]:{boxShadow:`0px 0px 0px 14px ${t.alpha((t.vars||t).palette[e].main,.16)}`}}}))]}))),ose=cn(tse,{name:"MuiSlider",slot:"ValueLabel"})(br(({theme:t})=>({zIndex:1,whiteSpace:"nowrap",...t.typography.body2,fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},[`&.${fu.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},[`&.${fu.valueLabelOpen}`]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]}))),ase=cn("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:t=>vE(t)&&t!=="markActive",overridesResolver:(t,e)=>{const{markActive:n}=t;return[e.mark,n&&e.markActive]}})(br(({theme:t})=>({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8}}]}))),lse=cn("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:t=>vE(t)&&t!=="markLabelActive"})(br(({theme:t})=>({...t.typography.body2,color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(t.vars||t).palette.text.primary}}]}))),cse=t=>{const{disabled:e,dragging:n,marked:i,orientation:u,track:f,classes:g,color:b,size:o}=t,S={root:["root",e&&"disabled",n&&"dragging",i&&"marked",u==="vertical"&&"vertical",f==="inverted"&&"trackInverted",f===!1&&"trackFalse",b&&`color${tn(b)}`,o&&`size${tn(o)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",e&&"disabled",o&&`thumbSize${tn(o)}`,b&&`thumbColor${tn(b)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return Tr(S,Jie,g)},use=({children:t})=>t,hse=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiSlider"}),u=yE(),{"aria-label":f,"aria-valuetext":g,"aria-labelledby":b,component:o="span",components:S={},componentsProps:M={},color:O="primary",classes:N,className:j,disableSwap:Z=!1,disabled:K=!1,getAriaLabel:Q,getAriaValueText:ce,marks:ge=!1,max:ue=100,min:pe=0,name:me,onChange:Te,onChangeCommitted:ae,orientation:re="horizontal",shiftStep:he=10,size:se="medium",step:ve=1,scale:Y=MO,slotProps:le,slots:Ne,tabIndex:Ze,track:Ie="normal",value:Je,valueLabelDisplay:dt="off",valueLabelFormat:et=MO,...Kt}=i,De={...i,isRtl:u,max:ue,min:pe,classes:N,disabled:K,disableSwap:Z,orientation:re,marks:ge,color:O,size:se,step:ve,shiftStep:he,scale:Y,track:Ie,valueLabelDisplay:dt,valueLabelFormat:et},{axisProps:tt,getRootProps:Et,getHiddenInputProps:wt,getThumbProps:Lt,open:Ut,active:an,axis:At,focusedThumbIndex:Qt,range:Wt,dragging:vn,marks:Gt,values:Cn,trackOffset:ln,trackLeap:qn,getThumbStyle:Rn}=Yie({...De,rootRef:n});De.marked=Gt.length>0&&Gt.some(de=>de.label),De.dragging=vn,De.focusedThumbIndex=Qt;const An=cse(De),rr=Ne?.root??S.Root??nse,En=Ne?.rail??S.Rail??rse,bn=Ne?.track??S.Track??ise,zn=Ne?.thumb??S.Thumb??sse,mn=Ne?.valueLabel??S.ValueLabel??ose,ti=Ne?.mark??S.Mark??ase,Xn=Ne?.markLabel??S.MarkLabel??lse,on=Ne?.input??S.Input??"input",Jt=le?.root??M.root,yn=le?.rail??M.rail,_n=le?.track??M.track,In=le?.thumb??M.thumb,Bn=le?.valueLabel??M.valueLabel,Nn=le?.mark??M.mark,Br=le?.markLabel??M.markLabel,tr=le?.input??M.input,_r=fd({elementType:rr,getSlotProps:Et,externalSlotProps:Jt,externalForwardedProps:Kt,additionalProps:{...Qie(rr)&&{as:o}},ownerState:{...De,...Jt?.ownerState},className:[An.root,j]}),xn=fd({elementType:En,externalSlotProps:yn,ownerState:De,className:An.rail}),$n=fd({elementType:bn,externalSlotProps:_n,additionalProps:{style:{...tt[At].offset(ln),...tt[At].leap(qn)}},ownerState:{...De,..._n?.ownerState},className:An.track}),jr=fd({elementType:zn,getSlotProps:Lt,externalSlotProps:In,ownerState:{...De,...In?.ownerState},className:An.thumb}),Gi=fd({elementType:mn,externalSlotProps:Bn,ownerState:{...De,...Bn?.ownerState},className:An.valueLabel}),eo=fd({elementType:ti,externalSlotProps:Nn,ownerState:De,className:An.mark}),Oe=fd({elementType:Xn,externalSlotProps:Br,ownerState:De,className:An.markLabel}),fe=fd({elementType:on,getSlotProps:wt,externalSlotProps:tr,ownerState:De});return U.jsxs(rr,{..._r,children:[U.jsx(En,{...xn}),U.jsx(bn,{...$n}),Gt.filter(de=>de.value>=pe&&de.value<=ue).map((de,Me)=>{const Ve=IT(de.value,pe,ue),Ge=tt[At].offset(Ve);let nt;return Ie===!1?nt=Cn.includes(de.value):nt=Ie==="normal"&&(Wt?de.value>=Cn[0]&&de.value<=Cn[Cn.length-1]:de.value<=Cn[0])||Ie==="inverted"&&(Wt?de.value<=Cn[0]||de.value>=Cn[Cn.length-1]:de.value>=Cn[0]),U.jsxs(W.Fragment,{children:[U.jsx(ti,{"data-index":Me,...eo,...!sm(ti)&&{markActive:nt},style:{...Ge,...eo.style},className:Pn(eo.className,nt&&An.markActive)}),de.label!=null?U.jsx(Xn,{"aria-hidden":!0,"data-index":Me,...Oe,...!sm(Xn)&&{markLabelActive:nt},style:{...Ge,...Oe.style},className:Pn(An.markLabel,Oe.className,nt&&An.markLabelActive),children:de.label}):null]},Me)}),Cn.map((de,Me)=>{const Ve=IT(de,pe,ue),Ge=tt[At].offset(Ve),nt=dt==="off"?use:mn;return U.jsx(nt,{...!sm(nt)&&{valueLabelFormat:et,valueLabelDisplay:dt,value:typeof et=="function"?et(Y(de),Me):et,index:Me,open:Ut===Me||an===Me||dt==="on",disabled:K},...Gi,children:U.jsx(zn,{"data-index":Me,...jr,className:Pn(An.thumb,jr.className,an===Me&&An.active,Qt===Me&&An.focusVisible),style:{...Ge,...Rn(Me),...jr.style},children:U.jsx(on,{"data-index":Me,"aria-label":Q?Q(Me):f,"aria-valuenow":Y(de),"aria-labelledby":b,"aria-valuetext":ce?ce(Y(de),Me):g,value:Cn[Me],...fe})})},Me)})]})});function dse(t){return wr("MuiTooltip",t)}const Vs=Sr("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function fse(t){return Math.round(t*1e5)/1e5}const pse=t=>{const{classes:e,disableInteractive:n,arrow:i,touch:u,placement:f}=t,g={popper:["popper",!n&&"popperInteractive",i&&"popperArrow"],tooltip:["tooltip",i&&"tooltipArrow",u&&"touch",`tooltipPlacement${tn(f.split("-")[0])}`],arrow:["arrow"]};return Tr(g,dse,e)},mse=cn(VN,{name:"MuiTooltip",slot:"Popper",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.popper,!n.disableInteractive&&e.popperInteractive,n.arrow&&e.popperArrow,!n.open&&e.popperClose]}})(br(({theme:t})=>({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:e})=>!e.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:e})=>!e,style:{pointerEvents:"none"}},{props:({ownerState:e})=>e.arrow,style:{[`&[data-popper-placement*="bottom"] .${Vs.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${Vs.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${Vs.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${Vs.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="right"] .${Vs.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="right"] .${Vs.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="left"] .${Vs.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="left"] .${Vs.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),gse=cn("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.tooltip,n.touch&&e.touch,n.arrow&&e.tooltipArrow,e[`tooltipPlacement${tn(n.placement.split("-")[0])}`]]}})(br(({theme:t})=>({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:t.alpha(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium,[`.${Vs.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${Vs.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${Vs.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${Vs.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:e})=>e.arrow,style:{position:"relative",margin:0}},{props:({ownerState:e})=>e.touch,style:{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:`${fse(16/14)}em`,fontWeight:t.typography.fontWeightRegular}},{props:({ownerState:e})=>!e.isRtl,style:{[`.${Vs.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${Vs.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:e})=>!e.isRtl&&e.touch,style:{[`.${Vs.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${Vs.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:e})=>!!e.isRtl,style:{[`.${Vs.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${Vs.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:e})=>!!e.isRtl&&e.touch,style:{[`.${Vs.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${Vs.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${Vs.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${Vs.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),yse=cn("span",{name:"MuiTooltip",slot:"Arrow"})(br(({theme:t})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:t.alpha(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let fw=!1;const PO=new xE;let $0={x:0,y:0};function pw(t,e){return(n,...i)=>{e&&e(n,...i),t(n,...i)}}const _se=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiTooltip"}),{arrow:u=!1,children:f,classes:g,components:b={},componentsProps:o={},describeChild:S=!1,disableFocusListener:M=!1,disableHoverListener:O=!1,disableInteractive:N=!1,disableTouchListener:j=!1,enterDelay:Z=100,enterNextDelay:K=0,enterTouchDelay:Q=700,followCursor:ce=!1,id:ge,leaveDelay:ue=0,leaveTouchDelay:pe=1500,onClose:me,onOpen:Te,open:ae,placement:re="bottom",PopperComponent:he,PopperProps:se={},slotProps:ve={},slots:Y={},title:le,TransitionComponent:Ne,TransitionProps:Ze,...Ie}=i,Je=W.isValidElement(f)?f:U.jsx("span",{children:f}),dt=Em(),et=yE(),[Kt,De]=W.useState(),[tt,Et]=W.useState(null),wt=W.useRef(!1),Lt=N||ce,Ut=__(),an=__(),At=__(),Qt=__(),[Wt,vn]=V_({controlled:ae,default:!1,name:"Tooltip",state:"open"});let Gt=Wt;const Cn=Tm(ge),ln=W.useRef(),qn=mu(()=>{ln.current!==void 0&&(document.body.style.WebkitUserSelect=ln.current,ln.current=void 0),Qt.clear()});W.useEffect(()=>qn,[qn]);const Rn=Xe=>{PO.clear(),fw=!0,vn(!0),Te&&!Gt&&Te(Xe)},An=mu(Xe=>{PO.start(800+ue,()=>{fw=!1}),vn(!1),me&&Gt&&me(Xe),Ut.start(dt.transitions.duration.shortest,()=>{wt.current=!1})}),rr=Xe=>{wt.current&&Xe.type!=="touchstart"||(Kt&&Kt.removeAttribute("title"),an.clear(),At.clear(),Z||fw&&K?an.start(fw?K:Z,()=>{Rn(Xe)}):Rn(Xe))},En=Xe=>{an.clear(),At.start(ue,()=>{An(Xe)})},[,bn]=W.useState(!1),zn=Xe=>{F_(Xe.target)||(bn(!1),En(Xe))},mn=Xe=>{Kt||De(Xe.currentTarget),F_(Xe.target)&&(bn(!0),rr(Xe))},ti=Xe=>{wt.current=!0;const $e=Je.props;$e.onTouchStart&&$e.onTouchStart(Xe)},Xn=Xe=>{ti(Xe),At.clear(),Ut.clear(),qn(),ln.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",Qt.start(Q,()=>{document.body.style.WebkitUserSelect=ln.current,rr(Xe)})},on=Xe=>{Je.props.onTouchEnd&&Je.props.onTouchEnd(Xe),qn(),At.start(pe,()=>{An(Xe)})};W.useEffect(()=>{if(!Gt)return;function Xe($e){$e.key==="Escape"&&An($e)}return document.addEventListener("keydown",Xe),()=>{document.removeEventListener("keydown",Xe)}},[An,Gt]);const Jt=To(lv(Je),De,n);!le&&le!==0&&(Gt=!1);const yn=W.useRef(),_n=Xe=>{const $e=Je.props;$e.onMouseMove&&$e.onMouseMove(Xe),$0={x:Xe.clientX,y:Xe.clientY},yn.current&&yn.current.update()},In={},Bn=typeof le=="string";S?(In.title=!Gt&&Bn&&!O?le:null,In["aria-describedby"]=Gt?Cn:null):(In["aria-label"]=Bn?le:null,In["aria-labelledby"]=Gt&&!Bn?Cn:null);const Nn={...In,...Ie,...Je.props,className:Pn(Ie.className,Je.props.className),onTouchStart:ti,ref:Jt,...ce?{onMouseMove:_n}:{}},Br={};j||(Nn.onTouchStart=Xn,Nn.onTouchEnd=on),O||(Nn.onMouseOver=pw(rr,Nn.onMouseOver),Nn.onMouseLeave=pw(En,Nn.onMouseLeave),Lt||(Br.onMouseOver=rr,Br.onMouseLeave=En)),M||(Nn.onFocus=pw(mn,Nn.onFocus),Nn.onBlur=pw(zn,Nn.onBlur),Lt||(Br.onFocus=mn,Br.onBlur=zn));const tr={...i,isRtl:et,arrow:u,disableInteractive:Lt,placement:re,PopperComponentProp:he,touch:wt.current},_r=typeof ve.popper=="function"?ve.popper(tr):ve.popper,xn=W.useMemo(()=>{let Xe=[{name:"arrow",enabled:!!tt,options:{element:tt,padding:4}}];return se.popperOptions?.modifiers&&(Xe=Xe.concat(se.popperOptions.modifiers)),_r?.popperOptions?.modifiers&&(Xe=Xe.concat(_r.popperOptions.modifiers)),{...se.popperOptions,..._r?.popperOptions,modifiers:Xe}},[tt,se.popperOptions,_r?.popperOptions]),$n=pse(tr),jr=typeof ve.transition=="function"?ve.transition(tr):ve.transition,Gi={slots:{popper:b.Popper,transition:b.Transition??Ne,tooltip:b.Tooltip,arrow:b.Arrow,...Y},slotProps:{arrow:ve.arrow??o.arrow,popper:{...se,..._r??o.popper},tooltip:ve.tooltip??o.tooltip,transition:{...Ze,...jr??o.transition}}},[eo,Oe]=pi("popper",{elementType:mse,externalForwardedProps:Gi,ownerState:tr,className:Pn($n.popper,se?.className)}),[fe,de]=pi("transition",{elementType:AT,externalForwardedProps:Gi,ownerState:tr}),[Me,Ve]=pi("tooltip",{elementType:gse,className:$n.tooltip,externalForwardedProps:Gi,ownerState:tr}),[Ge,nt]=pi("arrow",{elementType:yse,className:$n.arrow,externalForwardedProps:Gi,ownerState:tr,ref:Et});return U.jsxs(W.Fragment,{children:[W.cloneElement(Je,Nn),U.jsx(eo,{as:he??VN,placement:re,anchorEl:ce?{getBoundingClientRect:()=>({top:$0.y,left:$0.x,right:$0.x,bottom:$0.y,width:0,height:0})}:Kt,popperRef:yn,open:Kt?Gt:!1,id:Cn,transition:!0,...Br,...Oe,popperOptions:xn,children:({TransitionProps:Xe})=>U.jsx(fe,{timeout:dt.transitions.duration.shorter,...Xe,...de,children:U.jsxs(Me,{...Ve,children:[le,u?U.jsx(Ge,{...nt}):null]})})})]})}),hr=RQ({createStyledComponent:cn("div",{name:"MuiStack",slot:"Root"}),useThemeProps:t=>Rr({props:t,name:"MuiStack"})});function vse(t){return wr("MuiToolbar",t)}Sr("MuiToolbar",["root","gutters","regular","dense"]);const xse=t=>{const{classes:e,disableGutters:n,variant:i}=t;return Tr({root:["root",!n&&"gutters",i]},vse,e)},bse=cn("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.disableGutters&&e.gutters,e[n.variant]]}})(br(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",variants:[{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}}},{props:{variant:"dense"},style:{minHeight:48}},{props:{variant:"regular"},style:t.mixins.toolbar}]}))),wse=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiToolbar"}),{className:u,component:f="div",disableGutters:g=!1,variant:b="regular",...o}=i,S={...i,component:f,disableGutters:g,variant:b},M=xse(S);return U.jsx(bse,{as:f,className:Pn(M.root,u),ref:n,ownerState:S,...o})});function Tse(t){return wr("MuiTextField",t)}Sr("MuiTextField",["root"]);const Ese={standard:aM,filled:oM,outlined:cM},Sse=t=>{const{classes:e}=t;return Tr({root:["root"]},Tse,e)},Cse=cn(RA,{name:"MuiTextField",slot:"Root"})({}),Ys=W.forwardRef(function(e,n){const i=Rr({props:e,name:"MuiTextField"}),{autoComplete:u,autoFocus:f=!1,children:g,className:b,color:o="primary",defaultValue:S,disabled:M=!1,error:O=!1,FormHelperTextProps:N,fullWidth:j=!1,helperText:Z,id:K,InputLabelProps:Q,inputProps:ce,InputProps:ge,inputRef:ue,label:pe,maxRows:me,minRows:Te,multiline:ae=!1,name:re,onBlur:he,onChange:se,onFocus:ve,placeholder:Y,required:le=!1,rows:Ne,select:Ze=!1,SelectProps:Ie,slots:Je={},slotProps:dt={},type:et,value:Kt,variant:De="outlined",...tt}=i,Et={...i,autoFocus:f,color:o,disabled:M,error:O,fullWidth:j,multiline:ae,required:le,select:Ze,variant:De},wt=Sse(Et),Lt=Tm(K),Ut=Z&&Lt?`${Lt}-helper-text`:void 0,an=pe&&Lt?`${Lt}-label`:void 0,At=Ese[De],Qt={slots:Je,slotProps:{input:ge,inputLabel:Q,htmlInput:ce,formHelperText:N,select:Ie,...dt}},Wt={},vn=Qt.slotProps.inputLabel;De==="outlined"&&(vn&&typeof vn.shrink<"u"&&(Wt.notched=vn.shrink),Wt.label=pe),Ze&&((!Ie||!Ie.native)&&(Wt.id=void 0),Wt["aria-describedby"]=void 0);const[Gt,Cn]=pi("root",{elementType:Cse,shouldForwardComponentProp:!0,externalForwardedProps:{...Qt,...tt},ownerState:Et,className:Pn(wt.root,b),ref:n,additionalProps:{disabled:M,error:O,fullWidth:j,required:le,color:o,variant:De}}),[ln,qn]=pi("input",{elementType:At,externalForwardedProps:Qt,additionalProps:Wt,ownerState:Et}),[Rn,An]=pi("inputLabel",{elementType:jre,externalForwardedProps:Qt,ownerState:Et}),[rr,En]=pi("htmlInput",{elementType:"input",externalForwardedProps:Qt,ownerState:Et}),[bn,zn]=pi("formHelperText",{elementType:Mre,externalForwardedProps:Qt,ownerState:Et}),[mn,ti]=pi("select",{elementType:eV,externalForwardedProps:Qt,ownerState:Et}),Xn=U.jsx(ln,{"aria-describedby":Ut,autoComplete:u,autoFocus:f,defaultValue:S,fullWidth:j,multiline:ae,name:re,rows:Ne,maxRows:me,minRows:Te,type:et,value:Kt,id:Lt,inputRef:ue,onBlur:he,onChange:se,onFocus:ve,placeholder:Y,inputProps:En,slots:{input:Je.htmlInput?rr:void 0},...qn});return U.jsxs(Gt,{...Cn,children:[pe!=null&&pe!==""&&U.jsx(Rn,{htmlFor:Lt,id:an,...An,children:pe}),Ze?U.jsx(mn,{"aria-describedby":Ut,id:Lt,labelId:an,value:Kt,input:Xn,...ti,children:g}):Xn,Z&&U.jsx(bn,{id:Ut,...zn,children:Z})]})}),kO=Xf(On),DO=Xf(sn),LO=Xf("div");function Ase(){const t=Em();return U.jsx(On,{sx:{minHeight:"100vh",display:"flex",bgcolor:t.palette.mode==="dark"?"radial-gradient(circle at top, #1e293b, #020617)":"radial-gradient(circle at top, #e0f2fe, #eff6ff)"},children:U.jsx(_h,{maxWidth:"md",sx:{display:"flex",alignItems:"center",justifyContent:"center",py:8},children:U.jsxs(kO,{initial:{opacity:0,y:40,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.6,ease:"easeOut"},sx:{width:"100%",borderRadius:4,p:{xs:4,md:6},boxShadow:8,bgcolor:"background.paper",position:"relative",overflow:"hidden"},children:[U.jsx(kO,{initial:{opacity:0,scale:.6},animate:{opacity:.9,scale:1},transition:{duration:1.2,ease:"easeOut"},sx:{position:"absolute",inset:-80,background:"radial-gradient(circle at 0% 0%, rgba(59,130,246,0.3), transparent 60%)",pointerEvents:"none"}}),U.jsxs(hr,{spacing:3,textAlign:"center",position:"relative",children:[U.jsx(DO,{variant:"h3",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:"WiFi Proximity App"}),U.jsx(DO,{variant:"body1",color:"text.secondary",initial:{opacity:0,y:16},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:"Connect with people nearby at events using shared WiFi and realtime profiles. No awkward introductions, just instant context."}),U.jsxs(hr,{direction:{xs:"column",sm:"row"},spacing:2,justifyContent:"center",sx:{mt:1},children:[U.jsx(LO,{whileHover:{scale:1.03,boxShadow:"0 12px 30px rgba(0,0,0,0.25)"},whileTap:{scale:.98},children:U.jsx(cs,{variant:"contained",component:xc,to:"/login",children:"Login"})}),U.jsx(LO,{whileHover:{scale:1.03},whileTap:{scale:.98},children:U.jsx(cs,{variant:"outlined",component:xc,to:"/signup",children:"Sign Up"})})]})]})]})})})}const Ise=Xf(Ec);function Rse(){const[t,e]=W.useState(""),[n,i]=W.useState(""),[u,f]=W.useState(""),[g,b]=W.useState(!1),o=Cc(),S=async M=>{M.preventDefault(),f(""),b(!0);try{await IZ(t,n),o("/dashboard")}catch(O){if(console.error("Login error:",O),O instanceof xu)switch(O.code){case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":f("Invalid email or password. Please try again.");break;case"auth/invalid-email":f("Invalid email address.");break;case"auth/user-disabled":f("This account has been disabled.");break;case"auth/configuration-not-found":case"auth/project-not-found":f("Firebase is not configured properly. Please check your setup.");break;default:f(`Failed to login: ${O.code}. Please try again or check the console.`)}else f("An unexpected error occurred. Please try again.")}finally{b(!1)}};return U.jsx(On,{sx:{minHeight:"100vh",pt:8,display:"flex",alignItems:"center",justifyContent:"center"},children:U.jsx(_h,{maxWidth:"xs",children:U.jsxs(Ise,{elevation:6,sx:{p:4,borderRadius:3},initial:{opacity:0,y:24},animate:{opacity:1,y:0},exit:{opacity:0,y:-24},transition:{duration:.4},children:[U.jsx(sn,{variant:"h5",component:"h1",gutterBottom:!0,align:"center",children:"Login"}),u&&U.jsx(sn,{color:"error",variant:"body2",sx:{mb:2,textAlign:"center"},children:u}),U.jsx(On,{component:"form",onSubmit:S,children:U.jsxs(hr,{spacing:2,children:[U.jsx(Ys,{label:"Email",type:"email",fullWidth:!0,value:t,onChange:M=>e(M.target.value),required:!0}),U.jsx(Ys,{label:"Password",type:"password",fullWidth:!0,value:n,onChange:M=>i(M.target.value),required:!0}),U.jsx(cs,{type:"submit",variant:"contained",fullWidth:!0,disabled:g,children:g?"Logging in...":"Login"})]})}),U.jsxs(sn,{variant:"body2",sx:{mt:2,textAlign:"center"},children:["Don't have an account? ",U.jsx(xc,{to:"/signup",children:"Sign up"})]})]})})})}const Mse=Xf(Ec);function Pse(){const[t,e]=W.useState(""),[n,i]=W.useState(""),[u,f]=W.useState(""),[g,b]=W.useState(""),[o,S]=W.useState(!1),M=Cc(),O=async N=>{N.preventDefault(),b(""),S(!0);try{await AZ(t,n),M("/dashboard")}catch(j){if(console.error("Signup error:",j),j instanceof xu)switch(j.code){case"auth/email-already-in-use":b("This email is already registered. Please use a different email or login instead.");break;case"auth/weak-password":b("Password is too weak. Please use at least 6 characters.");break;case"auth/invalid-email":b("Invalid email address.");break;case"auth/configuration-not-found":case"auth/project-not-found":b("Firebase is not configured properly. Please check your setup.");break;default:b(`Failed to create account: ${j.code}. Please check the console for details.`)}else b("An unexpected error occurred. Please try again.");S(!1)}finally{S(!1)}};return U.jsx(On,{sx:{minHeight:"100vh",pt:8,display:"flex",alignItems:"center",justifyContent:"center"},children:U.jsx(_h,{maxWidth:"xs",children:U.jsxs(Mse,{elevation:6,sx:{p:4,borderRadius:3},initial:{opacity:0,y:24},animate:{opacity:1,y:0},exit:{opacity:0,y:-24},transition:{duration:.4},children:[U.jsx(sn,{variant:"h5",component:"h1",gutterBottom:!0,align:"center",children:"Sign Up"}),g&&U.jsx(sn,{color:"error",variant:"body2",sx:{mb:2,textAlign:"center"},children:g}),U.jsx(On,{component:"form",onSubmit:O,children:U.jsxs(hr,{spacing:2,children:[U.jsx(Ys,{label:"Name",fullWidth:!0,value:u,onChange:N=>f(N.target.value),required:!0}),U.jsx(Ys,{label:"Email",type:"email",fullWidth:!0,value:t,onChange:N=>e(N.target.value),required:!0}),U.jsx(Ys,{label:"Password",type:"password",fullWidth:!0,value:n,onChange:N=>i(N.target.value),required:!0,inputProps:{minLength:6}}),U.jsx(cs,{type:"submit",variant:"contained",fullWidth:!0,disabled:o,children:o?"Creating Account...":"Sign Up"})]})}),U.jsxs(sn,{variant:"body2",sx:{mt:2,textAlign:"center"},children:["Already have an account? ",U.jsx(xc,{to:"/login",children:"Login"})]})]})})})}const kse="/wifi-proximity-app/assets/graingerhall-YVw-ntIC.jpeg",OO="/wifi-proximity-app/assets/unionsouth-PrmAY2Td.jpeg";async function Dse(t,e,n){try{const i=`event_images/${e}/${n}_${t.name}`,u=xZ(CZ,i);return await _Z(u,t),await vZ(u)}catch(i){throw new Error(`Firebase storage upload failed: ${i?.message||i}`)}}const nV=Fo(U.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"})),Lse=Fo(U.jsx("path",{d:"M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 16H5V10h14zM9 14H7v-2h2zm4 0h-2v-2h2zm4 0h-2v-2h2zm-8 4H7v-2h2zm4 0h-2v-2h2zm4 0h-2v-2h2z"})),Ose=Fo([U.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),U.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")]),zse=Fo(U.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"})),v_=Gl`
  0% {
    opacity: 0;
    transform: translateY(18px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
`,Bse=Gl`
  0% {
    opacity: 0;
    transform: scale(0.92);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
`,rV=Gl`
  0% { transform: translateY(0); }
  50% { transform: translateY(-6px); }
  100% { transform: translateY(0); }
`,Nse=Gl`
  0% {
    opacity: 0;
    transform: translateX(-20px);
  }
  100% {
    opacity: 1;
    transform: translateX(0);
  }
`;Gl`
  0% {
    opacity: 0;
    transform: translateX(20px);
  }
  100% {
    opacity: 1;
    transform: translateX(0);
  }
`;async function hM(t){const{ownerUserId:e,otherUserId:n,eventCode:i,note:u}=t,f=`${e}_${i}_${n}`,g=Dd(el,"interactions",f);await Vx(g,{ownerUserId:e,otherUserId:n,eventCode:i,note:u,createdAt:Fg(),updatedAt:Fg()},{merge:!0})}async function Vse(t,e){const n=db(sv(el,"interactions"),B_("ownerUserId","==",t),B_("eventCode","==",e));return(await ov(n)).docs.map(u=>({id:u.id,...u.data()}))}const Sb="events",Cb="eventMemberships";async function Fse(t){const{code:e,name:n,date:i,time:u,location:f,createdByUid:g,role:b,imageUrl:o,lat:S,lng:M,startTimestamp:O}=t,N=Dd(el,Sb,e);if((await fb(N)).exists())throw new Error("Event code already exists. Please try again.");await Vx(N,{code:e,name:n,date:i,time:u,location:f,createdByUid:g,imageUrl:o||null,lat:S??null,lng:M??null,startTimestamp:O??null,createdAt:Fg()});const Z=Dd(el,Cb,`${g}_${e}`);await Vx(Z,{eventCode:e,userId:g,role:b,joinedAt:Fg()})}async function iV(t,e,n){const i=Dd(el,Sb,t),u=await fb(i);if(!u.exists())throw new Error("That event code does not exist.");const f=Dd(el,Cb,`${e}_${t}`);return await Vx(f,{eventCode:t,userId:e,role:n,joinedAt:Fg()},{merge:!0}),u.data()}async function zO(t){const e=db(sv(el,Cb),B_("userId","==",t)),n=await ov(e),i=[];for(const u of n.docs){const f=u.data(),g=Dd(el,Sb,f.eventCode),b=await fb(g);b.exists()&&i.push({event:b.data(),role:f.role})}return i}async function Use(t,e){const n=Dd(el,Sb,t),i=await fb(n);if(!i.exists())throw new Error("Event does not exist.");const u=i.data(),f=Dd(el,Cb,`${e}_${t}`);if(u.createdByUid!==e){await FS(f);return}await Promise.all([FS(f),FS(n)])}async function jse(){return(await ov(sv(el,Sb))).docs.map(e=>e.data())}async function BO(t){const e=db(sv(el,Cb),B_("eventCode","==",t));return(await ov(e)).docs.map(i=>i.data())}const $se=Fo(U.jsx("path",{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4z"})),sV=W.createContext({mode:"light",toggleColorMode:()=>{}});function qse({children:t}){const[e,n]=W.useState("light"),i=()=>{n(g=>g==="light"?"dark":"light")},u=W.useMemo(()=>({mode:e,toggleColorMode:i}),[e]),f=W.useMemo(()=>_E({palette:{mode:e,primary:{main:e==="light"?"#2563eb":"#3b82f6",light:e==="light"?"#60a5fa":"#93c5fd",dark:e==="light"?"#1e40af":"#1d4ed8"},secondary:{main:e==="light"?"#7c3aed":"#a78bfa",light:e==="light"?"#a78bfa":"#c4b5fd",dark:e==="light"?"#5b21b6":"#6d28d9"},success:{main:e==="light"?"#059669":"#10b981"},background:{default:e==="light"?"#f8fafc":"#0f172a",paper:e==="light"?"#ffffff":"#1e293b"}},typography:{fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif",h1:{fontFamily:"'Poppins', 'Inter', sans-serif",fontWeight:800,letterSpacing:"-0.035em",fontSize:"3.5rem",lineHeight:1.15},h2:{fontFamily:"'Poppins', 'Inter', sans-serif",fontWeight:700,letterSpacing:"-0.03em",fontSize:"2.75rem",lineHeight:1.2},h3:{fontFamily:"'Poppins', 'Inter', sans-serif",fontWeight:700,letterSpacing:"-0.025em",fontSize:"2.25rem",lineHeight:1.25},h4:{fontFamily:"'Poppins', 'Inter', sans-serif",fontWeight:700,letterSpacing:"-0.02em",fontSize:"1.875rem",lineHeight:1.3},h5:{fontFamily:"'Poppins', 'Inter', sans-serif",fontWeight:600,letterSpacing:"-0.015em",fontSize:"1.5rem",lineHeight:1.35},h6:{fontFamily:"'Poppins', 'Inter', sans-serif",fontWeight:600,letterSpacing:"-0.01em",fontSize:"1.25rem",lineHeight:1.4},subtitle1:{fontFamily:"'Inter', sans-serif",fontWeight:600,fontSize:"1.125rem",letterSpacing:"-0.01em",lineHeight:1.5},subtitle2:{fontFamily:"'Inter', sans-serif",fontWeight:600,fontSize:"1rem",letterSpacing:"-0.005em",lineHeight:1.5},body1:{fontFamily:"'Inter', sans-serif",fontSize:"1rem",fontWeight:400,letterSpacing:"-0.011em",lineHeight:1.75},body2:{fontFamily:"'Inter', sans-serif",fontSize:"0.875rem",fontWeight:400,letterSpacing:"-0.006em",lineHeight:1.65},button:{fontFamily:"'Inter', sans-serif",textTransform:"none",fontWeight:600,letterSpacing:"-0.01em",fontSize:"0.9375rem"},caption:{fontFamily:"'Inter', sans-serif",fontSize:"0.75rem",fontWeight:400,letterSpacing:"0.01em",lineHeight:1.5},overline:{fontFamily:"'Inter', sans-serif",fontSize:"0.75rem",fontWeight:700,letterSpacing:"0.08em",textTransform:"uppercase",lineHeight:1.5}},shape:{borderRadius:12},shadows:["none","0 1px 2px 0 rgb(0 0 0 / 0.05)","0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)","0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)","0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)","0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1)","0 25px 50px -12px rgb(0 0 0 / 0.25)","0 25px 50px -12px rgb(0 0 0 / 0.25)","0 25px 50px -12px rgb(0 0 0 / 0.25)","0 25px 50px -12px rgb(0 0 0 / 0.25)","0 25px 50px -12px rgb(0 0 0 / 0.25)","0 25px 50px -12px rgb(0 0 0 / 0.25)","0 25px 50px -12px rgb(0 0 0 / 0.25)","0 25px 50px -12px rgb(0 0 0 / 0.25)","0 25px 50px -12px rgb(0 0 0 / 0.25)","0 25px 50px -12px rgb(0 0 0 / 0.25)","0 25px 50px -12px rgb(0 0 0 / 0.25)","0 25px 50px -12px rgb(0 0 0 / 0.25)","0 25px 50px -12px rgb(0 0 0 / 0.25)","0 25px 50px -12px rgb(0 0 0 / 0.25)","0 25px 50px -12px rgb(0 0 0 / 0.25)","0 25px 50px -12px rgb(0 0 0 / 0.25)","0 25px 50px -12px rgb(0 0 0 / 0.25)","0 25px 50px -12px rgb(0 0 0 / 0.25)","0 25px 50px -12px rgb(0 0 0 / 0.25)"],components:{MuiButton:{styleOverrides:{root:{borderRadius:10,padding:"10px 24px",fontSize:"0.95rem",boxShadow:"none",transition:"all 0.2s ease","&:hover":{boxShadow:"0 4px 12px 0 rgb(0 0 0 / 0.15)",transform:"translateY(-1px)"}},contained:{fontWeight:600}}},MuiCard:{styleOverrides:{root:{borderRadius:16,boxShadow:e==="light"?"0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)":"0 4px 6px -1px rgb(0 0 0 / 0.3), 0 2px 4px -2px rgb(0 0 0 / 0.3)"}}},MuiPaper:{styleOverrides:{root:{borderRadius:12}}},MuiTextField:{styleOverrides:{root:{"& .MuiOutlinedInput-root":{borderRadius:10}}}},MuiChip:{styleOverrides:{root:{fontWeight:500,borderRadius:8}}}}}),[e]);return U.jsx(sV.Provider,{value:u,children:U.jsxs(uJ,{theme:f,children:[U.jsx(Ene,{}),t]})})}function Gse(){const{mode:t,toggleColorMode:e}=W.useContext(sV),n=t==="dark";return U.jsxs("label",{className:"switch",children:[U.jsx("input",{type:"checkbox",checked:n,onChange:e}),U.jsxs("span",{className:"slider",children:[U.jsx("span",{className:"star star_1"}),U.jsx("span",{className:"star star_2"}),U.jsx("span",{className:"star star_3"}),U.jsx("svg",{className:"cloud",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg",children:U.jsx("path",{fill:"#fff",d:"M406.5 399.1c47.6 0 86.2-38.6 86.2-86.2s-38.6-86.2-86.2-86.2c-1.9 0-3.8.1-5.6.2C390.3 165.5 338.4 128 278 128c-53.4 0-99 33.5-117.2 80.5-4.7-.5-9.5-.8-14.3-.8-61.9 0-112.1 50.2-112.1 112.1S84.6 432 146.5 432h260z"})})]})]})}const Hse=Xf(Ig),Wse=()=>Math.random().toString(36).substring(2,8).toUpperCase(),q0=t=>{const e=t.toLowerCase();return e.includes("union south")?OO:e.includes("grainger")?kse:OO};function Xse(){const{user:t}=W.useContext(zd),e=Em(),n=Cc(),i=t?.displayName||(t?.email?t.email.split("@")[0]:"guest"),[u,f]=W.useState([]),[g,b]=W.useState(!0),[o,S]=W.useState(!1),[M,O]=W.useState(""),[N,j]=W.useState("attendee"),[Z,K]=W.useState(""),[Q,ce]=W.useState(!1),[ge,ue]=W.useState(""),[pe,me]=W.useState(""),[Te,ae]=W.useState(""),[re,he]=W.useState(""),[se,ve]=W.useState("attendee"),[Y,le]=W.useState(null),[Ne,Ze]=W.useState(null),[Ie,Je]=W.useState(""),[dt,et]=W.useState("");W.useEffect(()=>{if(!t){f([]),b(!1);return}b(!0),zO(t.uid).then(At=>{const Qt=At.map(({event:Wt,role:vn})=>({code:Wt.code,name:Wt.name,date:Wt.date,time:Wt.time,location:Wt.location,joined:!0,image:Wt.imageUrl||q0(Wt.location),createdByUid:Wt.createdByUid,role:vn}));f(Qt)}).finally(()=>b(!1))},[t]);const Kt=async()=>{if(!M.trim()||!t)return;const At=M.trim().toUpperCase();try{const Qt=await iV(At,t.uid,N),Wt=q0(Qt.location);f(vn=>vn.find(Cn=>Cn.code===At)?vn.map(Cn=>Cn.code===At?{...Cn,joined:!0,role:N}:Cn):[...vn,{code:Qt.code,name:Qt.name,date:Qt.date,time:Qt.time,location:Qt.location,joined:!0,image:Wt,createdByUid:Qt.createdByUid,role:N}]),n(`/nearby/${At}`),O(""),K(""),S(!1)}catch(Qt){K(Qt.message||"Could not join event.")}},De=async()=>{if(!t)return;if(!ge.trim()){et("Event name is required.");return}const At=Wse();let Qt=pe||"",Wt=Te||"";if(Wt){const qn=Wt.trim().match(/^(\d{1,2}):(\d{2})(?::\d{2})?$/);if(qn){const Rn=parseInt(qn[1],10),An=parseInt(qn[2],10);Rn>=0&&Rn<=23&&An>=0&&An<=59?Wt=`${String(Rn).padStart(2,"0")}:${String(An).padStart(2,"0")}`:(console.warn("Invalid time values:",Wt),Wt="")}else console.warn("Unexpected time format:",Wt),Wt=""}const vn=re||"TBD";if(!Qt&&Wt){const ln=new Date,qn=ln.getFullYear(),Rn=String(ln.getMonth()+1).padStart(2,"0"),An=String(ln.getDate()).padStart(2,"0");Qt=`${qn}-${Rn}-${An}`}const Gt=Qt||"TBD",Cn=Wt||"TBD";try{let ln,qn,Rn,An;if(Ie&&Ie.trim())ln=Ie.trim();else if(Ne)try{ln=await Dse(Ne,t.uid,At)}catch(En){console.warn("Image upload failed, continuing without image:",En)}if(Qt&&Wt){const En=new Date(`${Qt}T${Wt}`);isNaN(En.getTime())||(An=En.getTime())}const rr="pk.eyJ1Ijoid2lsbGlhbWxpODgiLCJhIjoiY21pYmM5eG92MTZpNzJscTFoYzV2cHFuYyJ9";if(rr&&re&&re.trim())try{const En=encodeURIComponent(re.trim()),bn=await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${En}.json?access_token=${rr}&limit=1`);if(bn.ok){const mn=(await bn.json())?.features?.[0];mn&&mn.center&&mn.center.length>=2&&(Rn=Number(mn.center[0]),qn=Number(mn.center[1]))}}catch(En){console.warn("Geocode failed",En)}await Fse({code:At,name:ge.trim(),date:Gt,time:Cn,location:vn,createdByUid:t.uid,role:se,imageUrl:ln,lat:qn??null,lng:Rn??null,startTimestamp:An??null});try{console.debug("created event imageUrl:",ln),await new Promise(zn=>setTimeout(zn,300));const bn=(await zO(t.uid)).map(({event:zn,role:mn})=>({code:zn.code,name:zn.name,date:zn.date,time:zn.time,location:zn.location,joined:!0,image:zn.imageUrl||q0(zn.location),createdByUid:zn.createdByUid,role:mn}));f(bn)}catch{const bn={code:At,name:ge.trim(),date:Gt,time:Cn,location:vn,joined:!0,image:ln||q0(vn),createdByUid:t.uid,role:se};f(zn=>[...zn,bn])}le(At),et(""),Ze(null),Je("")}catch(ln){console.error(ln),et(ln.message||"Failed to create event.")}},tt=async At=>{if(!(!t||!window.confirm("Are you sure you want to delete this event? This cannot be undone.")))try{await Use(At,t.uid),f(Wt=>Wt.filter(vn=>vn.code!==At))}catch(Wt){console.error(Wt),alert(Wt.message||"Failed to delete event.")}},Et=()=>{ce(!1),le(null),ue(""),me(""),ae(""),he(""),ve("attendee"),Ze(null),Je(""),et("")},wt=t?u.filter(At=>At.createdByUid===t.uid):[],Lt=t?u.filter(At=>At.createdByUid!==t.uid):u,Ut=(At,Qt)=>U.jsx(On,{sx:{flex:"1 1 360px",maxWidth:480},children:U.jsxs(rM,{elevation:3,sx:{borderRadius:3,overflow:"hidden",position:"relative",backgroundImage:`url(${At.image||q0(At.location)})`,backgroundSize:"cover",backgroundPosition:"center",color:"common.white",animation:`${Bse} 0.4s ease-out`,animationDelay:`${Qt*.05}s`,animationFillMode:"backwards"},children:[U.jsx(On,{sx:{position:"absolute",inset:0,bgcolor:"rgba(0,0,0,0.6)"}}),U.jsxs(sM,{sx:{position:"relative",px:3,py:2.5},children:[U.jsx(sn,{variant:"h6",gutterBottom:!0,children:U.jsx("b",{children:At.name})}),U.jsxs(hr,{spacing:.5,children:[U.jsxs(hr,{direction:"row",spacing:1,alignItems:"center",children:[U.jsx(Lse,{fontSize:"small"}),U.jsx(sn,{variant:"body2",children:At.date})]}),U.jsxs(hr,{direction:"row",spacing:1,alignItems:"center",children:[U.jsx(Ose,{fontSize:"small"}),U.jsx(sn,{variant:"body2",children:an(At.time)})]}),U.jsxs(hr,{direction:"row",spacing:1,alignItems:"center",children:[U.jsx(zse,{fontSize:"small"}),U.jsx(sn,{variant:"body2",children:At.location})]}),U.jsxs(sn,{variant:"body2",sx:{mt:.5,opacity:.85},children:["Code: ",At.code]}),At.role&&U.jsxs(sn,{variant:"body2",sx:{opacity:.9},children:["Your role:"," ",At.role==="recruiter"?"Recruiter":"Attendee"]})]})]}),U.jsxs(iM,{sx:{position:"relative",px:3,pb:2},children:[U.jsx(cs,{size:"small",component:xc,to:`/events/${At.code}`,sx:{color:"common.white"},children:"View Contacts"}),At.joined&&U.jsx(cs,{size:"small",component:xc,to:`/nearby/${At.code}`,sx:{color:"common.white"},children:"Find Nearby"}),t&&At.createdByUid===t.uid&&U.jsx(cs,{size:"small",color:"error",sx:{ml:"auto",color:"error.light"},onClick:()=>tt(At.code),children:"Delete"})]})]})},At.code);function an(At){if(!At||At==="TBD")return"TBD";const Qt=At.match(/^(\d{1,2}):(\d{2})$/);if(!Qt)return At;let Wt=Number(Qt[1]);const vn=Qt[2],Gt=Wt>=12?"PM":"AM";return Wt=Wt%12,Wt===0&&(Wt=12),`${Wt}:${vn} ${Gt}`}return U.jsxs(On,{sx:{minHeight:"100vh",bgcolor:e.palette.mode==="dark"?"background.default":"#f5f5f7"},children:[U.jsx(On,{sx:{position:"fixed",top:30,left:15,zIndex:2e3},children:U.jsx(Hse,{onClick:async()=>{try{await RZ()}catch(At){console.error("Logout failed",At)}n("/")},sx:{bgcolor:"rgba(255,255,255,0.95)",color:"text.primary",border:"1px solid rgba(0,0,0,0.06)",boxShadow:2,"&:hover":{bgcolor:"grey.100"}},"aria-label":"Logout",initial:{opacity:0,x:-8,scale:.9},animate:{opacity:1,x:[0,4,0],scale:1},transition:{opacity:{duration:.25},scale:{duration:.25},x:{duration:1.4,repeat:1/0,repeatType:"reverse",delay:.6}},whileTap:{x:-18,opacity:.7,scale:.95},children:U.jsx($se,{})})}),U.jsx(_h,{maxWidth:"lg",sx:{pt:10,pb:6},children:U.jsxs(hr,{spacing:4,children:[U.jsxs(hr,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{animation:`${v_} 0.6s ease-out`},children:[U.jsxs(On,{children:[U.jsx(sn,{variant:"h4",fontWeight:600,children:"Events Dashboard"}),U.jsx(sn,{variant:"body2",color:"text.secondary",children:"Create events, join events, see whos nearby, and manage your profile."})]}),U.jsx(Gse,{})]}),U.jsxs(hr,{spacing:1,sx:{animation:`${v_} 0.7s ease-out`},children:[U.jsxs(sn,{variant:"body1",children:["Welcome ",U.jsx("b",{children:i}),"!"]}),U.jsxs(hr,{direction:{xs:"column",sm:"row"},spacing:2,children:[U.jsx(cs,{variant:"contained",component:xc,to:"/profile/me",children:"My Profile"}),U.jsx(cs,{color:"secondary",variant:"contained",component:xc,to:"/map",children:"Search for nearby events"}),U.jsx(cs,{variant:"outlined",onClick:()=>{S(!0),K(""),O("")},children:"Join Event"})]})]}),U.jsxs(hr,{spacing:3,children:[g&&U.jsx(sn,{variant:"body2",color:"text.secondary",children:"Loading your events"}),wt.length>0&&U.jsxs(U.Fragment,{children:[U.jsx(sn,{variant:"h6",fontWeight:600,sx:{animation:`${v_} 0.8s ease-out`},children:"Events you created"}),U.jsx(On,{sx:{display:"flex",flexWrap:"wrap",gap:3},children:wt.map((At,Qt)=>Ut(At,Qt))})]}),U.jsx(sn,{variant:"h6",fontWeight:600,sx:{animation:`${v_} 0.8s ease-out`},children:"Your Events"}),U.jsxs(On,{sx:{display:"flex",flexWrap:"wrap",gap:3},children:[u.length===0&&!g&&U.jsx(sn,{variant:"body2",color:"text.secondary",children:"You havent joined any events yet. Use Join Event or create one with the + button."}),Lt.map((At,Qt)=>Ut(At,Qt))]})]})]})}),U.jsx(HN,{color:"primary","aria-label":"create-event",sx:{position:"fixed",bottom:24,right:24,animation:`${rV} 3s ease-in-out infinite`},onClick:()=>{ce(!0),le(null)},children:U.jsx(nV,{})}),U.jsxs(hO,{open:o,onClose:()=>{S(!1),K(""),O("")},children:[U.jsx(pO,{children:"Join Event"}),U.jsx(fO,{children:U.jsxs(hr,{spacing:2,sx:{mt:1},children:[U.jsx(Ys,{autoFocus:!0,margin:"dense",label:"Event Code",fullWidth:!0,variant:"outlined",value:M,onChange:At=>{O(At.target.value.toUpperCase()),K("")},onKeyDown:At=>{At.key==="Enter"&&Kt()}}),U.jsxs(RA,{component:"fieldset",children:[U.jsx(MA,{component:"legend",children:"I am attending as"}),U.jsxs(EO,{row:!0,value:N,onChange:At=>j(At.target.value),children:[U.jsx(ow,{value:"attendee",control:U.jsx(lw,{}),label:"Attendee"}),U.jsx(ow,{value:"recruiter",control:U.jsx(lw,{}),label:"Recruiter"})]})]}),Z&&U.jsx(sn,{color:"error",variant:"body2",children:Z})]})}),U.jsxs(dO,{children:[U.jsx(cs,{onClick:()=>{S(!1),K(""),O("")},children:"Cancel"}),U.jsx(cs,{onClick:Kt,variant:"contained",children:"Join"})]})]}),U.jsxs(hO,{open:Q,onClose:Et,children:[U.jsx(pO,{children:"Create Event"}),U.jsx(fO,{children:U.jsxs(hr,{spacing:2,sx:{mt:1},children:[U.jsx(Ys,{label:"Event Name",fullWidth:!0,variant:"outlined",value:ge,onChange:At=>ue(At.target.value)}),U.jsx(Ys,{label:"Date",type:"date",fullWidth:!0,InputLabelProps:{shrink:!0},value:pe,onChange:At=>me(At.target.value)}),U.jsx(Ys,{label:"Time",type:"time",fullWidth:!0,InputLabelProps:{shrink:!0},value:Te,onChange:At=>ae(At.target.value)}),U.jsx(Ys,{label:"Location",fullWidth:!0,variant:"outlined",value:re,onChange:At=>he(At.target.value)}),U.jsxs(cs,{variant:"outlined",component:"label",sx:{alignSelf:"flex-start",mt:1},children:["Upload event image",U.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:At=>{const Qt=At.target.files?.[0]||null;Ze(Qt)}})]}),U.jsx(Ys,{label:"Event image URL (optional)",fullWidth:!0,variant:"outlined",value:Ie,onChange:At=>Je(At.target.value),sx:{mt:1}}),Ne?U.jsxs(sn,{variant:"caption",sx:{mt:.5},children:["Selected file: ",Ne.name]}):Ie?U.jsxs(sn,{variant:"caption",sx:{mt:.5},children:["Using URL: ",Ie]}):null,U.jsxs(RA,{component:"fieldset",children:[U.jsx(MA,{component:"legend",children:"I am attending as"}),U.jsxs(EO,{row:!0,value:se,onChange:At=>ve(At.target.value),children:[U.jsx(ow,{value:"attendee",control:U.jsx(lw,{}),label:"Attendee"}),U.jsx(ow,{value:"recruiter",control:U.jsx(lw,{}),label:"Recruiter"})]})]}),Y&&U.jsxs(sn,{variant:"body2",sx:{mt:1},children:["Event created! Your event code is ",U.jsx("b",{children:Y}),"."]}),dt&&U.jsx(sn,{color:"error",variant:"body2",children:dt})]})}),U.jsxs(dO,{children:[U.jsx(cs,{onClick:Et,children:"Close"}),U.jsx(cs,{onClick:De,variant:"contained",children:"Create"})]})]})]})}function Zse(t){return t.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}async function Kse(t,e){const n=db(sv(el,"profiles"),B_("slug","==",t));return(await ov(n)).docs.some(u=>u.id!==e)}async function Yse(t,e){const n=Zse(t);if(!n)return`user-${e.slice(0,8)}`;let i=n,u=2;for(;await Kse(i,e);)i=`${n}-${u}`,u++;return i}async function Qse(t,e){const n=Dd(el,"profiles",t);let i=e.slug;!i&&e.name&&(i=await Yse(e.name,t)),await Vx(n,{...e,slug:i,userId:t,updatedAt:Fg(),createdAt:e.createdAt||Fg()},{merge:!0})}async function CE(t){const e=Dd(el,"profiles",t),n=await fb(e);return n.exists()?n.data():null}async function oV(t){const e=db(sv(el,"profiles"),B_("slug","==",t)),n=await ov(e);return n.empty?null:n.docs[0].data()}async function aV(t){const e=await oV(t);return e||await CE(t)}const mw=Fo(U.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),Jse=Gl`
  0% { opacity: 0; transform: translateY(16px) scale(0.98); }
  100% { opacity: 1; transform: translateY(0) scale(1); }
`,eoe=Gl`
  0% { box-shadow: 0 0 0 0 rgba(25,118,210,0.4); }
  70% { box-shadow: 0 0 0 10px rgba(25,118,210,0); }
  100% { box-shadow: 0 0 0 0 rgba(25,118,210,0); }
`,iC=t=>{const e=t.filter(Boolean);return[...e,...Array(5-e.length).fill("")].slice(0,5)};function toe(){const{user:t}=W.useContext(zd),e=Cc(),[n,i]=W.useState(""),[u,f]=W.useState(""),[g,b]=W.useState(""),[o,S]=W.useState(""),[M,O]=W.useState(""),[N,j]=W.useState(""),[Z,K]=W.useState(""),[Q,ce]=W.useState(""),[ge,ue]=W.useState(["","","","",""]),[pe,me]=W.useState(""),[Te,ae]=W.useState(!1),[re,he]=W.useState("");W.useEffect(()=>{if(!t)return;let Ne=!0;return(async()=>{try{const Ze=await CE(t.uid);if(!Ne||!Ze)return;const Ie=(Ze.name||"").split(" ");i(Ze.firstName||Ie[0]||""),f(Ze.lastName||Ie.slice(1).join(" ")||""),b(Ze.bio||""),Array.isArray(Ze.interests)?S(Ze.interests.join(", ")):Ze.interests&&S(Ze.interests),O(Ze.linkedin||""),j(Ze.website||""),K(Ze.photoURL||""),ce(Ze.resumeUrl||""),Array.isArray(Ze.galleryUrls)&&ue(iC(Ze.galleryUrls)),me(Ze.videoUrl||"")}catch(Ze){console.error("Failed to load profile:",Ze)}})(),()=>{Ne=!1}},[t]);const se=(Ne,Ze)=>{const Ie=[...ge];Ie[Ne]=Ze.trim(),ue(iC(Ie))},ve=Ne=>{const Ze=[...ge];Ze[Ne]="",ue(iC(Ze))},Y=async Ne=>{if(Ne.preventDefault(),he(""),!t){he("You must be signed in to save your profile.");return}ae(!0);try{const Ze=o.split(",").map(dt=>dt.trim()).filter(Boolean),Ie=`${n} ${u}`.trim(),Je=ge.filter(Boolean);await Qse(t.uid,{firstName:n,lastName:u,name:Ie,bio:g,interests:Ze,linkedin:M,website:N,photoURL:Z,resumeUrl:Q,galleryUrls:Je,videoUrl:pe}),e("/profile/me")}catch(Ze){console.error(Ze),he("Failed to save profile. Check console for details.")}finally{ae(!1)}},le=(n||u||"U").trim().charAt(0).toUpperCase();return U.jsx(On,{sx:{minHeight:"100vh",pt:8,display:"flex",alignItems:"center",justifyContent:"center",background:"radial-gradient(circle at top, rgba(25,118,210,0.12), transparent 60%)"},children:U.jsx(_h,{maxWidth:"sm",children:U.jsxs(Ec,{sx:{p:4,borderRadius:4,boxShadow:6,backdropFilter:"blur(10px)",animation:`${Jse} 0.5s ease-out`},children:[U.jsx(sn,{variant:"h5",gutterBottom:!0,align:"center",children:"Edit Profile"}),U.jsxs(hr,{spacing:2,alignItems:"center",sx:{mb:3},children:[U.jsx(Eb,{src:Z||void 0,sx:{width:128,height:128,border:"3px solid white",boxShadow:4,animation:`${eoe} 2.4s infinite`,bgcolor:"primary.main",fontSize:40},children:le}),U.jsx(hr,{direction:"row",spacing:1,alignItems:"center",children:U.jsx(Ig,{"aria-label":"remove photo",onClick:()=>K(""),children:U.jsx(mw,{fontSize:"small"})})}),U.jsx(Ys,{size:"small",label:"Photo URL (optional)",fullWidth:!0,value:Z,onChange:Ne=>K(Ne.target.value)})]}),U.jsx(On,{component:"form",onSubmit:Y,children:U.jsxs(hr,{spacing:2,children:[U.jsxs(hr,{direction:{xs:"column",sm:"row"},spacing:2,children:[U.jsx(Ys,{label:"First name",fullWidth:!0,value:n,onChange:Ne=>i(Ne.target.value),disabled:Te}),U.jsx(Ys,{label:"Last name",fullWidth:!0,value:u,onChange:Ne=>f(Ne.target.value),disabled:Te})]}),U.jsx(Ys,{label:"Bio",fullWidth:!0,multiline:!0,minRows:3,value:g,onChange:Ne=>b(Ne.target.value),disabled:Te}),U.jsx(Ys,{label:"Interests (comma separated)",fullWidth:!0,value:o,onChange:Ne=>S(Ne.target.value),disabled:Te}),U.jsxs(hr,{direction:{xs:"column",sm:"row"},spacing:2,children:[U.jsx(Ys,{label:"LinkedIn URL",fullWidth:!0,value:M,onChange:Ne=>O(Ne.target.value),disabled:Te}),U.jsx(Ys,{label:"Website",fullWidth:!0,value:N,onChange:Ne=>j(Ne.target.value),disabled:Te})]}),U.jsx(_o,{flexItem:!0}),U.jsx(sn,{variant:"subtitle1",children:"Resume (PDF)"}),U.jsxs(hr,{direction:{xs:"column",sm:"row"},spacing:2,children:[U.jsx(Ys,{label:"Resume URL (optional)",fullWidth:!0,value:Q,onChange:Ne=>ce(Ne.target.value)}),U.jsx(Ig,{"aria-label":"remove resume",onClick:()=>ce(""),children:U.jsx(mw,{fontSize:"small"})})]}),U.jsx(_o,{flexItem:!0}),U.jsx(sn,{variant:"subtitle1",children:"Photo Gallery (up to 5 images)"}),U.jsx(hr,{spacing:1,children:ge.map((Ne,Ze)=>U.jsxs(hr,{direction:{xs:"column",sm:"row"},spacing:1,alignItems:"center",children:[U.jsxs(sn,{variant:"body2",sx:{width:60,flexShrink:0},children:["Image ",Ze+1]}),U.jsx(Ys,{size:"small",label:"Image URL (optional)",fullWidth:!0,value:Ne,onChange:Ie=>se(Ze,Ie.target.value)}),U.jsx(Ig,{"aria-label":`remove image ${Ze+1}`,onClick:()=>ve(Ze),children:U.jsx(mw,{fontSize:"small"})})]},Ze))}),U.jsx(_o,{flexItem:!0}),U.jsx(sn,{variant:"subtitle1",children:"Video Portfolio (max 60 seconds)"}),U.jsxs(hr,{direction:{xs:"column",sm:"row"},spacing:2,children:[U.jsx(Ys,{label:"Video URL (optional)",fullWidth:!0,value:pe,onChange:Ne=>me(Ne.target.value)}),U.jsx(Ig,{"aria-label":"remove video",onClick:()=>me(""),children:U.jsx(mw,{fontSize:"small"})})]}),re&&U.jsx(sn,{color:"error",variant:"body2",children:re}),U.jsx(cs,{type:"submit",variant:"contained",disabled:Te,children:Te?"Saving...":"Save Profile"})]})})]})})})}const dM=Fo(U.jsx("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 4-8 5-8-5V6l8 5 8-5z"})),fM=Fo(U.jsx("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02z"})),pM=Fo(U.jsx("path",{d:"M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"})),lV=Fo(U.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2m6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56M12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96M4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56m2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8M12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96M14.34 14H9.66c-.09-.66-.16-1.32-.16-2s.07-1.35.16-2h4.68c.09.65.16 1.32.16 2s-.07 1.34-.16 2m.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56M16.36 14c.08-.66.14-1.32.14-2s-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2z"})),cV=Fo(U.jsx("path",{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5zm4-3H19v1h1.5V11H19v2h-1.5V7h3zM9 9.5h1v-1H9zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4zm10 5.5h1v-3h-1z"})),uV=Fo(U.jsx("path",{d:"M22 16V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2m-11-4 2.03 2.71L16 11l4 5H8zM2 6v14c0 1.1.9 2 2 2h14v-2H4V6z"})),hV=Fo(U.jsx("path",{d:"m18 4 2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4z"})),AE=Fo(U.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"})),noe=Gl`
  0% { opacity: 0; transform: translateY(16px); }
  100% { opacity: 1; transform: translateY(0); }
`,NO={transition:"transform 0.25s ease, box-shadow 0.25s ease","&:hover":{transform:"translateY(-4px)",boxShadow:8}};function roe(){const{user:t}=W.useContext(zd),e=Cc(),[n,i]=W.useState(null),[u,f]=W.useState(!1);W.useEffect(()=>{if(!t)return;let o=!0;return f(!0),(async()=>{try{const S=await CE(t.uid);if(!o)return;i(S||{})}catch(S){console.error("Failed to load profile:",S)}finally{o&&f(!1)}})(),()=>{o=!1}},[t]);const g=(n?.name||n?.firstName||t?.email||"U").trim().charAt(0).toUpperCase()||"U",b=(n?.galleryUrls||[]).filter(Boolean);return U.jsx(On,{sx:{minHeight:"100vh",pt:8,display:"flex",alignItems:"center",justifyContent:"center",background:"radial-gradient(circle at top, rgba(25,118,210,0.13), transparent 60%)"},children:U.jsxs(_h,{maxWidth:"sm",children:[U.jsx(cs,{onClick:()=>e("/dashboard"),startIcon:U.jsx(AE,{}),sx:{mb:2},children:"Back"}),U.jsxs(Ec,{sx:{p:4,borderRadius:4,animation:`${noe} 0.45s ease-out`,...NO},children:[U.jsxs(hr,{direction:"row",justifyContent:"space-between",alignItems:"center",mb:2,children:[U.jsx(sn,{variant:"h5",children:"My Profile"}),U.jsx(cs,{variant:"outlined",size:"small",component:xc,to:"/profile/edit",children:"Edit"})]}),u?U.jsx(sn,{children:"Loading"}):U.jsxs(U.Fragment,{children:[U.jsxs(hr,{direction:"column",alignItems:"center",spacing:2,children:[U.jsx(Eb,{src:n?.photoURL||void 0,sx:{width:120,height:120,bgcolor:"primary.main",fontSize:40},children:g}),U.jsx(sn,{variant:"h4",align:"center",children:n?.name||"(name not set)"}),n?.bio&&U.jsxs(On,{sx:{mt:1,width:"100%"},children:[U.jsx(sn,{variant:"subtitle2",sx:{fontWeight:600,mb:.5},children:"Bio"}),U.jsx(sn,{variant:"body1",color:"text.secondary",sx:{whiteSpace:"pre-line"},children:n.bio})]})]}),U.jsx(_o,{sx:{my:3}}),U.jsxs(hr,{spacing:1.5,children:[n?.email&&U.jsxs(On,{sx:{display:"flex",alignItems:"center",gap:1},children:[U.jsx(dM,{color:"action"}),U.jsx(sn,{sx:{wordBreak:"break-word"},children:n.email})]}),n?.phone&&U.jsxs(On,{sx:{display:"flex",alignItems:"center",gap:1},children:[U.jsx(fM,{color:"action"}),U.jsx(sn,{sx:{wordBreak:"break-word"},children:n.phone})]}),n?.linkedin&&U.jsxs(On,{sx:{display:"flex",alignItems:"center",gap:1},children:[U.jsx(pM,{color:"action"}),U.jsx(sn,{component:"a",href:n.linkedin,target:"_blank",rel:"noopener noreferrer",sx:{textDecoration:"none",color:"primary.main",wordBreak:"break-word"},children:"LinkedIn"})]}),n?.website&&U.jsxs(On,{sx:{display:"flex",alignItems:"center",gap:1},children:[U.jsx(lV,{color:"action"}),U.jsx(sn,{component:"a",href:n.website,target:"_blank",rel:"noopener noreferrer",sx:{textDecoration:"none",color:"primary.main",wordBreak:"break-word"},children:"Website"})]})]}),n?.interests&&n.interests.length>0&&U.jsxs(U.Fragment,{children:[U.jsx(_o,{sx:{my:3}}),U.jsx(sn,{variant:"h6",gutterBottom:!0,children:"Interests"}),U.jsx(On,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:n.interests.map((o,S)=>U.jsx(Tb,{label:o,color:"primary",variant:"outlined"},S))})]}),n?.resumeUrl&&U.jsxs(U.Fragment,{children:[U.jsx(_o,{sx:{my:3}}),U.jsxs(hr,{direction:"row",spacing:1,alignItems:"center",mb:1,children:[U.jsx(cV,{fontSize:"small"}),U.jsx(sn,{variant:"h6",children:"Resume"})]}),U.jsx(On,{component:"iframe",src:n.resumeUrl,title:"Resume",sx:{width:"100%",height:320,borderRadius:2,border:"1px solid",borderColor:"divider",bgcolor:"background.paper"}})]}),b.length>0&&U.jsxs(U.Fragment,{children:[U.jsx(_o,{sx:{my:3}}),U.jsxs(hr,{direction:"row",spacing:1,alignItems:"center",mb:1,children:[U.jsx(uV,{fontSize:"small"}),U.jsx(sn,{variant:"h6",children:"Photos"})]}),U.jsx(On,{sx:{display:"flex",flexDirection:"row",gap:1.5,overflowX:"auto",py:1,px:.5},children:b.map((o,S)=>U.jsx(On,{sx:{flex:"0 0 70%",maxWidth:280,borderRadius:2,overflow:"hidden",boxShadow:3,...NO},children:U.jsx(On,{component:"img",src:o,alt:`Gallery ${S+1}`,sx:{display:"block",width:"100%",height:"100%",objectFit:"cover",aspectRatio:"4 / 3"}})},S))})]}),n?.videoUrl&&U.jsxs(U.Fragment,{children:[U.jsx(_o,{sx:{my:3}}),U.jsxs(hr,{direction:"row",spacing:1,alignItems:"center",mb:1,children:[U.jsx(hV,{fontSize:"small"}),U.jsx(sn,{variant:"h6",children:"Video Portfolio"})]}),U.jsx(On,{component:"video",src:n.videoUrl,controls:!0,sx:{width:"100%",borderRadius:2,boxShadow:4,maxHeight:320,objectFit:"cover"}})]})]})]})]})})}const ioe=Xf(Ig);function soe(){const{slug:t}=PT(),[e]=c3(),n=e.get("eventCode"),i=e.get("back")||"events",u=Cc(),{user:f}=W.useContext(zd),[g,b]=W.useState(null),[o,S]=W.useState(!0),[M,O]=W.useState(!1);W.useEffect(()=>{t&&oV(t).then(j=>{j&&b(j)}).finally(()=>S(!1))},[t]);const N=async()=>{f&&n&&g&&!M&&(await hM({ownerUserId:f.uid,otherUserId:g.userId,eventCode:n,note:"Met via proximity detection"}),O(!0)),u(i==="nearby"&&n?`/nearby/${n}`:i==="contacts"&&n?`/events/${n}`:n?`/events/${n}`:"/events")};return o?U.jsx(On,{sx:{display:"flex",justifyContent:"center",pt:10},children:U.jsx(sn,{children:"Loading profile..."})}):g?U.jsxs(On,{sx:{minHeight:"100vh",bgcolor:"#f5f5f5",pt:8},children:[U.jsx(On,{sx:{position:"fixed",top:70,left:16,zIndex:1e3},children:U.jsx(ioe,{onClick:N,whileTap:{x:-10,opacity:.7},transition:{type:"spring",stiffness:300,damping:20},sx:{bgcolor:"white",boxShadow:2,"&:hover":{bgcolor:"grey.100"}},children:U.jsx(AE,{})})}),U.jsxs(_h,{maxWidth:"sm",sx:{py:4},children:[U.jsxs(Ec,{elevation:3,sx:{p:4,borderRadius:3},children:[U.jsxs(hr,{direction:"column",alignItems:"center",spacing:2,children:[U.jsx(Eb,{src:g.photoURL,sx:{width:120,height:120,bgcolor:"primary.main",boxShadow:3},children:g.name?.charAt(0).toUpperCase()}),U.jsx(sn,{variant:"h4",align:"center",children:g.name}),g.bio&&U.jsx(sn,{variant:"body1",color:"text.secondary",align:"center",children:g.bio})]}),U.jsx(_o,{sx:{my:3}}),U.jsxs(hr,{spacing:2,children:[g.email&&U.jsxs(On,{sx:{display:"flex",alignItems:"center",gap:1},children:[U.jsx(dM,{color:"action"}),U.jsx(sn,{children:g.email})]}),g.phone&&U.jsxs(On,{sx:{display:"flex",alignItems:"center",gap:1},children:[U.jsx(fM,{color:"action"}),U.jsx(sn,{children:g.phone})]}),g.linkedin&&U.jsxs(On,{sx:{display:"flex",alignItems:"center",gap:1},children:[U.jsx(pM,{color:"action"}),U.jsx(sn,{component:"a",href:g.linkedin,target:"_blank",rel:"noreferrer",sx:{textDecoration:"none",color:"primary.main"},children:"LinkedIn Profile"})]}),g.website&&U.jsxs(On,{sx:{display:"flex",alignItems:"center",gap:1},children:[U.jsx(sn,{fontWeight:600,children:"Website:"}),U.jsx(sn,{component:"a",href:g.website,target:"_blank",rel:"noreferrer",sx:{textDecoration:"none",color:"primary.main"},children:g.website})]})]}),g.interests&&g.interests.length>0&&U.jsxs(U.Fragment,{children:[U.jsx(_o,{sx:{my:3}}),U.jsx(sn,{variant:"h6",gutterBottom:!0,children:"Interests"}),U.jsx(On,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:g.interests.map((j,Z)=>U.jsx(Tb,{label:j,color:"primary",variant:"outlined"},Z))})]}),g.resumeUrl&&U.jsxs(U.Fragment,{children:[U.jsx(_o,{sx:{my:3}}),U.jsx(sn,{variant:"h6",gutterBottom:!0,children:"Resume"}),U.jsx(On,{sx:{borderRadius:2,border:"1px solid",borderColor:"divider",p:1,bgcolor:"background.default",height:300,overflow:"hidden"},children:U.jsx("iframe",{src:g.resumeUrl,title:"Resume",style:{border:"none",width:"100%",height:"100%"}})})]}),g.galleryUrls&&g.galleryUrls.length>0&&U.jsxs(U.Fragment,{children:[U.jsx(_o,{sx:{my:3}}),U.jsx(sn,{variant:"h6",gutterBottom:!0,children:"Photo Gallery"}),U.jsx(On,{sx:{display:"flex",gap:1.5,overflowX:"auto",pb:1},children:g.galleryUrls.map((j,Z)=>U.jsx(On,{component:"img",src:j,alt:`Gallery ${Z+1}`,sx:{width:180,height:180,objectFit:"cover",borderRadius:2,flexShrink:0}},Z))})]}),g.videoUrl&&U.jsxs(U.Fragment,{children:[U.jsx(_o,{sx:{my:3}}),U.jsx(sn,{variant:"h6",gutterBottom:!0,children:"Video Portfolio"}),U.jsx(On,{sx:{borderRadius:2,overflow:"hidden",bgcolor:"black"},children:U.jsx("video",{src:g.videoUrl,controls:!0,style:{width:"100%",maxHeight:260,display:"block"}})})]}),U.jsx(On,{sx:{mt:4,display:"flex",justifyContent:"center"},children:U.jsx(cs,{variant:"contained",size:"large",fullWidth:!0,onClick:N,children:M?"Contact Saved! Go Back":"Save Contact & Go Back"})})]}),n&&U.jsxs(sn,{variant:"caption",color:"text.secondary",align:"center",sx:{display:"block",mt:2},children:["Met at event: ",n]})]})]}):U.jsx(On,{sx:{display:"flex",justifyContent:"center",pt:10},children:U.jsx(sn,{children:"Profile not found"})})}const ooe=Gl`
  0% { opacity: 0; transform: translateY(16px); }
  100% { opacity: 1; transform: translateY(0); }
`,VO={transition:"transform 0.25s ease, box-shadow 0.25s ease","&:hover":{transform:"translateY(-4px)",boxShadow:8}};function aoe(){const{slug:t}=PT(),[e]=c3(),n=e.get("eventCode"),i=e.get("back")||"events",u=Cc(),{user:f}=W.useContext(zd),[g,b]=W.useState(null),[o,S]=W.useState(!0),[M,O]=W.useState(!1);W.useEffect(()=>{let K=!1;async function Q(){if(!t){S(!1);return}try{const ce=await aV(t);console.log("ProfileView slug =",t,"data =",ce),!K&&ce&&b(ce)}finally{K||S(!1)}}return Q(),()=>{K=!0}},[t]);const N=async()=>{f&&n&&g&&!M&&(await hM({ownerUserId:f.uid,otherUserId:g.userId,eventCode:n,note:"Met via proximity detection"}),O(!0)),i==="nearby"&&n?u(`/nearby/${n}`,{replace:!0}):i==="contacts"&&n?u(`/events/${n}`,{replace:!0}):n?u(`/events/${n}`,{replace:!0}):u("/dashboard",{replace:!0})};if(o)return U.jsx(On,{sx:{display:"flex",justifyContent:"center",pt:10},children:U.jsx(sn,{children:"Loading profile..."})});if(!g)return U.jsx(On,{sx:{display:"flex",justifyContent:"center",pt:10},children:U.jsx(sn,{children:"Profile not found"})});const j=(g.name||g.firstName||"").trim().charAt(0).toUpperCase()||"U",Z=(g.galleryUrls||[]).filter(Boolean);return U.jsx(On,{sx:{minHeight:"100vh",bgcolor:"#f5f5f5",pt:8,background:"radial-gradient(circle at top, rgba(25,118,210,0.13), transparent 60%)"},children:U.jsxs(_h,{maxWidth:"sm",sx:{py:2},children:[U.jsx(cs,{onClick:N,startIcon:U.jsx(AE,{}),sx:{mb:2},children:"Back"}),U.jsxs(Ec,{elevation:4,sx:{p:4,borderRadius:4,animation:`${ooe} 0.45s ease-out`,...VO},children:[U.jsxs(hr,{direction:"column",alignItems:"center",spacing:2,children:[U.jsx(Eb,{src:g.photoURL||void 0,sx:{width:120,height:120,bgcolor:"primary.main",fontSize:40},children:j}),U.jsx(sn,{variant:"h4",align:"center",children:g.name}),g.bio&&U.jsxs(On,{sx:{mt:1,width:"100%"},children:[U.jsx(sn,{variant:"subtitle2",sx:{fontWeight:600,mb:.5},children:"Bio"}),U.jsx(sn,{variant:"body1",color:"text.secondary",sx:{whiteSpace:"pre-line"},children:g.bio})]})]}),U.jsx(_o,{sx:{my:3}}),U.jsxs(hr,{spacing:1.5,children:[g.email&&U.jsxs(On,{sx:{display:"flex",alignItems:"center",gap:1},children:[U.jsx(dM,{color:"action"}),U.jsx(sn,{sx:{wordBreak:"break-word"},children:g.email})]}),g.phone&&U.jsxs(On,{sx:{display:"flex",alignItems:"center",gap:1},children:[U.jsx(fM,{color:"action"}),U.jsx(sn,{sx:{wordBreak:"break-word"},children:g.phone})]}),g.linkedin&&U.jsxs(On,{sx:{display:"flex",alignItems:"center",gap:1},children:[U.jsx(pM,{color:"action"}),U.jsx(sn,{component:"a",href:g.linkedin,target:"_blank",rel:"noopener noreferrer",sx:{textDecoration:"none",color:"primary.main",wordBreak:"break-word"},children:"LinkedIn"})]}),g.website&&U.jsxs(On,{sx:{display:"flex",alignItems:"center",gap:1},children:[U.jsx(lV,{color:"action"}),U.jsx(sn,{component:"a",href:g.website,target:"_blank",rel:"noopener noreferrer",sx:{textDecoration:"none",color:"primary.main",wordBreak:"break-word"},children:"Website"})]})]}),g.interests&&g.interests.length>0&&U.jsxs(U.Fragment,{children:[U.jsx(_o,{sx:{my:3}}),U.jsx(sn,{variant:"h6",gutterBottom:!0,children:"Interests"}),U.jsx(On,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:g.interests.map((K,Q)=>U.jsx(Tb,{label:K,color:"primary",variant:"outlined"},Q))})]}),g.resumeUrl&&U.jsxs(U.Fragment,{children:[U.jsx(_o,{sx:{my:3}}),U.jsxs(hr,{direction:"row",spacing:1,alignItems:"center",mb:1,children:[U.jsx(cV,{fontSize:"small"}),U.jsx(sn,{variant:"h6",children:"Resume"})]}),U.jsx(On,{component:"iframe",src:g.resumeUrl,title:"Resume",sx:{width:"100%",height:320,borderRadius:2,border:"1px solid",borderColor:"divider",bgcolor:"background.paper"}})]}),Z.length>0&&U.jsxs(U.Fragment,{children:[U.jsx(_o,{sx:{my:3}}),U.jsxs(hr,{direction:"row",spacing:1,alignItems:"center",mb:1,children:[U.jsx(uV,{fontSize:"small"}),U.jsx(sn,{variant:"h6",children:"Photos"})]}),U.jsx(On,{sx:{display:"flex",flexDirection:"row",gap:1.5,overflowX:"auto",py:1,px:.5},children:Z.map((K,Q)=>U.jsx(On,{sx:{flex:"0 0 70%",maxWidth:280,borderRadius:2,overflow:"hidden",boxShadow:3,...VO},children:U.jsx(On,{component:"img",src:K,alt:`Gallery ${Q+1}`,sx:{display:"block",width:"100%",height:"100%",objectFit:"cover",aspectRatio:"4 / 3"}})},Q))})]}),g.videoUrl&&U.jsxs(U.Fragment,{children:[U.jsx(_o,{sx:{my:3}}),U.jsxs(hr,{direction:"row",spacing:1,alignItems:"center",mb:1,children:[U.jsx(hV,{fontSize:"small"}),U.jsx(sn,{variant:"h6",children:"Video Portfolio"})]}),U.jsx(On,{component:"video",src:g.videoUrl,controls:!0,sx:{width:"100%",borderRadius:2,boxShadow:4,maxHeight:320,objectFit:"cover"}})]}),U.jsx(On,{sx:{mt:4,display:"flex",justifyContent:"center"},children:U.jsx(cs,{variant:"contained",size:"large",fullWidth:!0,onClick:N,children:M?"Contact Saved! Go Back":"Save Contact & Go Back"})})]}),n&&U.jsxs(sn,{variant:"caption",color:"text.secondary",align:"center",sx:{display:"block",mt:2},children:["Met at event: ",n]})]})})}const Od=Object.create(null);Od.open="0";Od.close="1";Od.ping="2";Od.pong="3";Od.message="4";Od.upgrade="5";Od.noop="6";const Uw=Object.create(null);Object.keys(Od).forEach(t=>{Uw[Od[t]]=t});const kA={type:"error",data:"parser error"},dV=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",fV=typeof ArrayBuffer=="function",pV=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,mM=({type:t,data:e},n,i)=>dV&&e instanceof Blob?n?i(e):FO(e,i):fV&&(e instanceof ArrayBuffer||pV(e))?n?i(e):FO(new Blob([e]),i):i(Od[t]+(e||"")),FO=(t,e)=>{const n=new FileReader;return n.onload=function(){const i=n.result.split(",")[1];e("b"+(i||""))},n.readAsDataURL(t)};function UO(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let sC;function loe(t,e){if(dV&&t.data instanceof Blob)return t.data.arrayBuffer().then(UO).then(e);if(fV&&(t.data instanceof ArrayBuffer||pV(t.data)))return e(UO(t.data));mM(t,!1,n=>{sC||(sC=new TextEncoder),e(sC.encode(n))})}const jO="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rx=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<jO.length;t++)rx[jO.charCodeAt(t)]=t;const coe=t=>{let e=t.length*.75,n=t.length,i,u=0,f,g,b,o;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const S=new ArrayBuffer(e),M=new Uint8Array(S);for(i=0;i<n;i+=4)f=rx[t.charCodeAt(i)],g=rx[t.charCodeAt(i+1)],b=rx[t.charCodeAt(i+2)],o=rx[t.charCodeAt(i+3)],M[u++]=f<<2|g>>4,M[u++]=(g&15)<<4|b>>2,M[u++]=(b&3)<<6|o&63;return S},uoe=typeof ArrayBuffer=="function",gM=(t,e)=>{if(typeof t!="string")return{type:"message",data:mV(t,e)};const n=t.charAt(0);return n==="b"?{type:"message",data:hoe(t.substring(1),e)}:Uw[n]?t.length>1?{type:Uw[n],data:t.substring(1)}:{type:Uw[n]}:kA},hoe=(t,e)=>{if(uoe){const n=coe(t);return mV(n,e)}else return{base64:!0,data:t}},mV=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},gV="",doe=(t,e)=>{const n=t.length,i=new Array(n);let u=0;t.forEach((f,g)=>{mM(f,!1,b=>{i[g]=b,++u===n&&e(i.join(gV))})})},foe=(t,e)=>{const n=t.split(gV),i=[];for(let u=0;u<n.length;u++){const f=gM(n[u],e);if(i.push(f),f.type==="error")break}return i};function poe(){return new TransformStream({transform(t,e){loe(t,n=>{const i=n.length;let u;if(i<126)u=new Uint8Array(1),new DataView(u.buffer).setUint8(0,i);else if(i<65536){u=new Uint8Array(3);const f=new DataView(u.buffer);f.setUint8(0,126),f.setUint16(1,i)}else{u=new Uint8Array(9);const f=new DataView(u.buffer);f.setUint8(0,127),f.setBigUint64(1,BigInt(i))}t.data&&typeof t.data!="string"&&(u[0]|=128),e.enqueue(u),e.enqueue(n)})}})}let oC;function gw(t){return t.reduce((e,n)=>e+n.length,0)}function yw(t,e){if(t[0].length===e)return t.shift();const n=new Uint8Array(e);let i=0;for(let u=0;u<e;u++)n[u]=t[0][i++],i===t[0].length&&(t.shift(),i=0);return t.length&&i<t[0].length&&(t[0]=t[0].slice(i)),n}function moe(t,e){oC||(oC=new TextDecoder);const n=[];let i=0,u=-1,f=!1;return new TransformStream({transform(g,b){for(n.push(g);;){if(i===0){if(gw(n)<1)break;const o=yw(n,1);f=(o[0]&128)===128,u=o[0]&127,u<126?i=3:u===126?i=1:i=2}else if(i===1){if(gw(n)<2)break;const o=yw(n,2);u=new DataView(o.buffer,o.byteOffset,o.length).getUint16(0),i=3}else if(i===2){if(gw(n)<8)break;const o=yw(n,8),S=new DataView(o.buffer,o.byteOffset,o.length),M=S.getUint32(0);if(M>Math.pow(2,21)-1){b.enqueue(kA);break}u=M*Math.pow(2,32)+S.getUint32(4),i=3}else{if(gw(n)<u)break;const o=yw(n,u);b.enqueue(gM(f?o:oC.decode(o),e)),i=0}if(u===0||u>t){b.enqueue(kA);break}}}})}const yV=4;function bo(t){if(t)return goe(t)}function goe(t){for(var e in bo.prototype)t[e]=bo.prototype[e];return t}bo.prototype.on=bo.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};bo.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this};bo.prototype.off=bo.prototype.removeListener=bo.prototype.removeAllListeners=bo.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var i,u=0;u<n.length;u++)if(i=n[u],i===e||i.fn===e){n.splice(u,1);break}return n.length===0&&delete this._callbacks["$"+t],this};bo.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(n){n=n.slice(0);for(var i=0,u=n.length;i<u;++i)n[i].apply(this,e)}return this};bo.prototype.emitReserved=bo.prototype.emit;bo.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};bo.prototype.hasListeners=function(t){return!!this.listeners(t).length};const IE=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,n)=>n(e,0),lu=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),yoe="arraybuffer";function _V(t,...e){return e.reduce((n,i)=>(t.hasOwnProperty(i)&&(n[i]=t[i]),n),{})}const _oe=lu.setTimeout,voe=lu.clearTimeout;function RE(t,e){e.useNativeTimers?(t.setTimeoutFn=_oe.bind(lu),t.clearTimeoutFn=voe.bind(lu)):(t.setTimeoutFn=lu.setTimeout.bind(lu),t.clearTimeoutFn=lu.clearTimeout.bind(lu))}const xoe=1.33;function boe(t){return typeof t=="string"?woe(t):Math.ceil((t.byteLength||t.size)*xoe)}function woe(t){let e=0,n=0;for(let i=0,u=t.length;i<u;i++)e=t.charCodeAt(i),e<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(i++,n+=4);return n}function vV(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Toe(t){let e="";for(let n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e}function Eoe(t){let e={},n=t.split("&");for(let i=0,u=n.length;i<u;i++){let f=n[i].split("=");e[decodeURIComponent(f[0])]=decodeURIComponent(f[1])}return e}class Soe extends Error{constructor(e,n,i){super(e),this.description=n,this.context=i,this.type="TransportError"}}class yM extends bo{constructor(e){super(),this.writable=!1,RE(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,n,i){return super.emitReserved("error",new Soe(e,n,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const n=gM(e,this.socket.binaryType);this.onPacket(n)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,n={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const n=Toe(e);return n.length?"?"+n:""}}class Coe extends yM{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const n=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let i=0;this._polling&&(i++,this.once("pollComplete",function(){--i||n()})),this.writable||(i++,this.once("drain",function(){--i||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const n=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};foe(e,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,doe(e,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=vV()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(e,n)}}let xV=!1;try{xV=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Aoe=xV;function Ioe(){}class Roe extends Coe{constructor(e){if(super(e),typeof location<"u"){const n=location.protocol==="https:";let i=location.port;i||(i=n?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||i!==e.port}}doWrite(e,n){const i=this.request({method:"POST",data:e});i.on("success",n),i.on("error",(u,f)=>{this.onError("xhr post error",u,f)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(n,i)=>{this.onError("xhr poll error",n,i)}),this.pollXhr=e}}let I_=class jw extends bo{constructor(e,n,i){super(),this.createRequest=e,RE(this,i),this._opts=i,this._method=i.method||"GET",this._uri=n,this._data=i.data!==void 0?i.data:null,this._create()}_create(){var e;const n=_V(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(n);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let u in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(u)&&i.setRequestHeader(u,this._opts.extraHeaders[u])}}catch{}if(this._method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var u;i.readyState===3&&((u=this._opts.cookieJar)===null||u===void 0||u.parseCookies(i.getResponseHeader("set-cookie"))),i.readyState===4&&(i.status===200||i.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof i.status=="number"?i.status:0)},0))},i.send(this._data)}catch(u){this.setTimeoutFn(()=>{this._onError(u)},0);return}typeof document<"u"&&(this._index=jw.requestsCount++,jw.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Ioe,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete jw.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};I_.requestsCount=0;I_.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",$O);else if(typeof addEventListener=="function"){const t="onpagehide"in lu?"pagehide":"unload";addEventListener(t,$O,!1)}}function $O(){for(let t in I_.requests)I_.requests.hasOwnProperty(t)&&I_.requests[t].abort()}const Moe=(function(){const t=bV({xdomain:!1});return t&&t.responseType!==null})();class Poe extends Roe{constructor(e){super(e);const n=e&&e.forceBase64;this.supportsBinary=Moe&&!n}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new I_(bV,this.uri(),e)}}function bV(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||Aoe))return new XMLHttpRequest}catch{}if(!e)try{return new lu[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const wV=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class koe extends yM{get name(){return"websocket"}doOpen(){const e=this.uri(),n=this.opts.protocols,i=wV?{}:_V(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,n,i)}catch(u){return this.emitReserved("error",u)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const i=e[n],u=n===e.length-1;mM(i,this.supportsBinary,f=>{try{this.doWrite(i,f)}catch{}u&&IE(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=vV()),this.supportsBinary||(n.b64=1),this.createUri(e,n)}}const aC=lu.WebSocket||lu.MozWebSocket;class Doe extends koe{createSocket(e,n,i){return wV?new aC(e,n,i):n?new aC(e,n):new aC(e)}doWrite(e,n){this.ws.send(n)}}class Loe extends yM{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const n=moe(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=e.readable.pipeThrough(n).getReader(),u=poe();u.readable.pipeTo(e.writable),this._writer=u.writable.getWriter();const f=()=>{i.read().then(({done:b,value:o})=>{b||(this.onPacket(o),f())}).catch(b=>{})};f();const g={type:"open"};this.query.sid&&(g.data=`{"sid":"${this.query.sid}"}`),this._writer.write(g).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const i=e[n],u=n===e.length-1;this._writer.write(i).then(()=>{u&&IE(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const Ooe={websocket:Doe,webtransport:Loe,polling:Poe},zoe=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Boe=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function DA(t){if(t.length>8e3)throw"URI too long";const e=t,n=t.indexOf("["),i=t.indexOf("]");n!=-1&&i!=-1&&(t=t.substring(0,n)+t.substring(n,i).replace(/:/g,";")+t.substring(i,t.length));let u=zoe.exec(t||""),f={},g=14;for(;g--;)f[Boe[g]]=u[g]||"";return n!=-1&&i!=-1&&(f.source=e,f.host=f.host.substring(1,f.host.length-1).replace(/;/g,":"),f.authority=f.authority.replace("[","").replace("]","").replace(/;/g,":"),f.ipv6uri=!0),f.pathNames=Noe(f,f.path),f.queryKey=Voe(f,f.query),f}function Noe(t,e){const n=/\/{2,9}/g,i=e.replace(n,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&i.splice(0,1),e.slice(-1)=="/"&&i.splice(i.length-1,1),i}function Voe(t,e){const n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,u,f){u&&(n[u]=f)}),n}const LA=typeof addEventListener=="function"&&typeof removeEventListener=="function",$w=[];LA&&addEventListener("offline",()=>{$w.forEach(t=>t())},!1);class om extends bo{constructor(e,n){if(super(),this.binaryType=yoe,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(n=e,e=null),e){const i=DA(e);n.hostname=i.host,n.secure=i.protocol==="https"||i.protocol==="wss",n.port=i.port,i.query&&(n.query=i.query)}else n.host&&(n.hostname=DA(n.host).host);RE(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(i=>{const u=i.prototype.name;this.transports.push(u),this._transportsByName[u]=i}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Eoe(this.opts.query)),LA&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},$w.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const n=Object.assign({},this.opts.query);n.EIO=yV,n.transport=e,this.id&&(n.sid=this.id);const i=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](i)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&om.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(e);n.open(),this.setTransport(n)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",om.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=e.data,this._onError(n);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let i=0;i<this.writeBuffer.length;i++){const u=this.writeBuffer[i].data;if(u&&(n+=boe(u)),i>0&&n>this._maxPayload)return this.writeBuffer.slice(0,i);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,IE(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,n,i){return this._sendPacket("message",e,n,i),this}send(e,n,i){return this._sendPacket("message",e,n,i),this}_sendPacket(e,n,i,u){if(typeof n=="function"&&(u=n,n=void 0),typeof i=="function"&&(u=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const f={type:e,data:n,options:i};this.emitReserved("packetCreate",f),this.writeBuffer.push(f),u&&this.once("flush",u),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),e()},i=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():e()}):this.upgrading?i():e()),this}_onError(e){if(om.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),LA&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const i=$w.indexOf(this._offlineEventListener);i!==-1&&$w.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,n),this.writeBuffer=[],this._prevBufferLen=0}}}om.protocol=yV;class Foe extends om{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let n=this.createTransport(e),i=!1;om.priorWebsocketSuccess=!1;const u=()=>{i||(n.send([{type:"ping",data:"probe"}]),n.once("packet",O=>{if(!i)if(O.type==="pong"&&O.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;om.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(M(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const N=new Error("probe error");N.transport=n.name,this.emitReserved("upgradeError",N)}}))};function f(){i||(i=!0,M(),n.close(),n=null)}const g=O=>{const N=new Error("probe error: "+O);N.transport=n.name,f(),this.emitReserved("upgradeError",N)};function b(){g("transport closed")}function o(){g("socket closed")}function S(O){n&&O.name!==n.name&&f()}const M=()=>{n.removeListener("open",u),n.removeListener("error",g),n.removeListener("close",b),this.off("close",o),this.off("upgrading",S)};n.once("open",u),n.once("error",g),n.once("close",b),this.once("close",o),this.once("upgrading",S),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{i||n.open()},200):n.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const n=[];for(let i=0;i<e.length;i++)~this.transports.indexOf(e[i])&&n.push(e[i]);return n}}let Uoe=class extends Foe{constructor(e,n={}){const i=typeof e=="object"?e:n;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(u=>Ooe[u]).filter(u=>!!u)),super(e,i)}};function joe(t,e="",n){let i=t;n=n||typeof location<"u"&&location,t==null&&(t=n.protocol+"//"+n.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=n.protocol+t:t=n.host+t),/^(https?|wss?):\/\//.test(t)||(typeof n<"u"?t=n.protocol+"//"+t:t="https://"+t),i=DA(t)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const f=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+f+":"+i.port+e,i.href=i.protocol+"://"+f+(n&&n.port===i.port?"":":"+i.port),i}const $oe=typeof ArrayBuffer=="function",qoe=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,TV=Object.prototype.toString,Goe=typeof Blob=="function"||typeof Blob<"u"&&TV.call(Blob)==="[object BlobConstructor]",Hoe=typeof File=="function"||typeof File<"u"&&TV.call(File)==="[object FileConstructor]";function _M(t){return $oe&&(t instanceof ArrayBuffer||qoe(t))||Goe&&t instanceof Blob||Hoe&&t instanceof File}function qw(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let n=0,i=t.length;n<i;n++)if(qw(t[n]))return!0;return!1}if(_M(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return qw(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&qw(t[n]))return!0;return!1}function Woe(t){const e=[],n=t.data,i=t;return i.data=OA(n,e),i.attachments=e.length,{packet:i,buffers:e}}function OA(t,e){if(!t)return t;if(_M(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}else if(Array.isArray(t)){const n=new Array(t.length);for(let i=0;i<t.length;i++)n[i]=OA(t[i],e);return n}else if(typeof t=="object"&&!(t instanceof Date)){const n={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=OA(t[i],e));return n}return t}function Xoe(t,e){return t.data=zA(t.data,e),delete t.attachments,t}function zA(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=zA(t[n],e);else if(typeof t=="object")for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=zA(t[n],e));return t}const Zoe=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Koe=5;var ci;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(ci||(ci={}));class Yoe{constructor(e){this.replacer=e}encode(e){return(e.type===ci.EVENT||e.type===ci.ACK)&&qw(e)?this.encodeAsBinary({type:e.type===ci.EVENT?ci.BINARY_EVENT:ci.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let n=""+e.type;return(e.type===ci.BINARY_EVENT||e.type===ci.BINARY_ACK)&&(n+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(n+=e.nsp+","),e.id!=null&&(n+=e.id),e.data!=null&&(n+=JSON.stringify(e.data,this.replacer)),n}encodeAsBinary(e){const n=Woe(e),i=this.encodeAsString(n.packet),u=n.buffers;return u.unshift(i),u}}function qO(t){return Object.prototype.toString.call(t)==="[object Object]"}class vM extends bo{constructor(e){super(),this.reviver=e}add(e){let n;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(e);const i=n.type===ci.BINARY_EVENT;i||n.type===ci.BINARY_ACK?(n.type=i?ci.EVENT:ci.ACK,this.reconstructor=new Qoe(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(_M(e)||e.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(e),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let n=0;const i={type:Number(e.charAt(0))};if(ci[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===ci.BINARY_EVENT||i.type===ci.BINARY_ACK){const f=n+1;for(;e.charAt(++n)!=="-"&&n!=e.length;);const g=e.substring(f,n);if(g!=Number(g)||e.charAt(n)!=="-")throw new Error("Illegal attachments");i.attachments=Number(g)}if(e.charAt(n+1)==="/"){const f=n+1;for(;++n&&!(e.charAt(n)===","||n===e.length););i.nsp=e.substring(f,n)}else i.nsp="/";const u=e.charAt(n+1);if(u!==""&&Number(u)==u){const f=n+1;for(;++n;){const g=e.charAt(n);if(g==null||Number(g)!=g){--n;break}if(n===e.length)break}i.id=Number(e.substring(f,n+1))}if(e.charAt(++n)){const f=this.tryParse(e.substr(n));if(vM.isPayloadValid(i.type,f))i.data=f;else throw new Error("invalid payload")}return i}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,n){switch(e){case ci.CONNECT:return qO(n);case ci.DISCONNECT:return n===void 0;case ci.CONNECT_ERROR:return typeof n=="string"||qO(n);case ci.EVENT:case ci.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&Zoe.indexOf(n[0])===-1);case ci.ACK:case ci.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Qoe{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const n=Xoe(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Joe=Object.freeze(Object.defineProperty({__proto__:null,Decoder:vM,Encoder:Yoe,get PacketType(){return ci},protocol:Koe},Symbol.toStringTag,{value:"Module"}));function ch(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const eae=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class EV extends bo{constructor(e,n,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=n,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[ch(e,"open",this.onopen.bind(this)),ch(e,"packet",this.onpacket.bind(this)),ch(e,"error",this.onerror.bind(this)),ch(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...n){var i,u,f;if(eae.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(n.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const g={type:ci.EVENT,data:n};if(g.options={},g.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const M=this.ids++,O=n.pop();this._registerAckCallback(M,O),g.id=M}const b=(u=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||u===void 0?void 0:u.writable,o=this.connected&&!(!((f=this.io.engine)===null||f===void 0)&&f._hasPingExpired());return this.flags.volatile&&!b||(o?(this.notifyOutgoingListeners(g),this.packet(g)):this.sendBuffer.push(g)),this.flags={},this}_registerAckCallback(e,n){var i;const u=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(u===void 0){this.acks[e]=n;return}const f=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let b=0;b<this.sendBuffer.length;b++)this.sendBuffer[b].id===e&&this.sendBuffer.splice(b,1);n.call(this,new Error("operation has timed out"))},u),g=(...b)=>{this.io.clearTimeoutFn(f),n.apply(this,b)};g.withError=!0,this.acks[e]=g}emitWithAck(e,...n){return new Promise((i,u)=>{const f=(g,b)=>g?u(g):i(b);f.withError=!0,n.push(f),this.emit(e,...n)})}_addToQueue(e){let n;typeof e[e.length-1]=="function"&&(n=e.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((u,...f)=>i!==this._queue[0]?void 0:(u!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(u)):(this._queue.shift(),n&&n(null,...f)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!e||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:ci.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(i=>String(i.id)===e)){const i=this.acks[e];delete this.acks[e],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case ci.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ci.EVENT:case ci.BINARY_EVENT:this.onevent(e);break;case ci.ACK:case ci.BINARY_ACK:this.onack(e);break;case ci.DISCONNECT:this.ondisconnect();break;case ci.CONNECT_ERROR:this.destroy();const i=new Error(e.data.message);i.data=e.data.data,this.emitReserved("connect_error",i);break}}onevent(e){const n=e.data||[];e.id!=null&&n.push(this.ack(e.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const i of n)i.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const n=this;let i=!1;return function(...u){i||(i=!0,n.packet({type:ci.ACK,id:e,data:u}))}}onack(e){const n=this.acks[e.id];typeof n=="function"&&(delete this.acks[e.id],n.withError&&e.data.unshift(null),n.apply(this,e.data))}onconnect(e,n){this.id=e,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ci.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const n=this._anyListeners;for(let i=0;i<n.length;i++)if(e===n[i])return n.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const n=this._anyOutgoingListeners;for(let i=0;i<n.length;i++)if(e===n[i])return n.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const i of n)i.apply(this,e.data)}}}function cv(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}cv.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-n:t+n}return Math.min(t,this.max)|0};cv.prototype.reset=function(){this.attempts=0};cv.prototype.setMin=function(t){this.ms=t};cv.prototype.setMax=function(t){this.max=t};cv.prototype.setJitter=function(t){this.jitter=t};class BA extends bo{constructor(e,n){var i;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(n=e,e=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,RE(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((i=n.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new cv({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=e;const u=n.parser||Joe;this.encoder=new u.Encoder,this.decoder=new u.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var n;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(n=this.backoff)===null||n===void 0||n.setMin(e),this)}randomizationFactor(e){var n;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(n=this.backoff)===null||n===void 0||n.setJitter(e),this)}reconnectionDelayMax(e){var n;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(n=this.backoff)===null||n===void 0||n.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Uoe(this.uri,this.opts);const n=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const u=ch(n,"open",function(){i.onopen(),e&&e()}),f=b=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",b),e?e(b):this.maybeReconnectOnOpen()},g=ch(n,"error",f);if(this._timeout!==!1){const b=this._timeout,o=this.setTimeoutFn(()=>{u(),f(new Error("timeout")),n.close()},b);this.opts.autoUnref&&o.unref(),this.subs.push(()=>{this.clearTimeoutFn(o)})}return this.subs.push(u),this.subs.push(g),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(ch(e,"ping",this.onping.bind(this)),ch(e,"data",this.ondata.bind(this)),ch(e,"error",this.onerror.bind(this)),ch(e,"close",this.onclose.bind(this)),ch(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(n){this.onclose("parse error",n)}}ondecoded(e){IE(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,n){let i=this.nsps[e];return i?this._autoConnect&&!i.active&&i.connect():(i=new EV(this,e,n),this.nsps[e]=i),i}_destroy(e){const n=Object.keys(this.nsps);for(const i of n)if(this.nsps[i].active)return;this._close()}_packet(e){const n=this.encoder.encode(e);for(let i=0;i<n.length;i++)this.engine.write(n[i],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,n){var i;this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(u=>{u?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",u)):e.onreconnect()}))},n);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const G0={};function Gw(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const n=joe(t,e.path||"/socket.io"),i=n.source,u=n.id,f=n.path,g=G0[u]&&f in G0[u].nsps,b=e.forceNew||e["force new connection"]||e.multiplex===!1||g;let o;return b?o=new BA(i,e):(G0[u]||(G0[u]=new BA(i,e)),o=G0[u]),n.query&&!e.query&&(e.query=n.queryKey),o.socket(n.path,e)}Object.assign(Gw,{Manager:BA,Socket:EV,io:Gw,connect:Gw});let lC=null;function cC(){return lC||(lC=Gw("http://10.141.117.148:3001",{transports:["websocket","polling"]})),lC}const tae=Xf(Ig),xM=({onClick:t})=>{const e=Cc(),i=Em().palette.mode==="dark",u=()=>{t?t():e(-1)};return U.jsx(On,{sx:{position:"fixed",top:30,left:15,zIndex:2e3},children:U.jsx(tae,{onClick:u,sx:{bgcolor:i?"rgba(30, 41, 59, 0.95)":"rgba(255,255,255,0.95)",color:i?"grey.100":"text.primary",border:i?"1px solid rgba(255,255,255,0.1)":"1px solid rgba(0,0,0,0.06)",boxShadow:2,"&:hover":{bgcolor:i?"rgba(51, 65, 85, 0.95)":"grey.100"}},"aria-label":"Back",initial:{opacity:0,x:-8,scale:.9},animate:{opacity:1,x:[0,4,0],scale:1},transition:{opacity:{duration:.25},scale:{duration:.25},x:{duration:1.4,repeat:1/0,repeatType:"reverse",delay:.6}},whileTap:{x:-18,opacity:.7,scale:.95},children:U.jsx(AE,{})})})},_w=250,GO=1;function nae(){const{eventCode:t}=PT(),e=Cc(),{user:n}=W.useContext(zd),[i]=W.useState(()=>n?.uid?`uid-${n.uid}`:"anon-"+Math.random().toString(36).slice(2)),[u,f]=W.useState(""),[g,b]=W.useState([]),[o,S]=W.useState(!1),[M,O]=W.useState(!0),N=W.useRef(!0),j=W.useRef(new Set);W.useEffect(()=>{N.current=M},[M]),W.useEffect(()=>{n&&CE(n.uid).then(Q=>{Q?.slug&&f(Q.slug)})},[n]);const Z=W.useCallback(async Q=>new Promise(ce=>{const ge=cC(),ue=Date.now(),pe=me=>{if(me.fromDeviceId===Q&&me.toDeviceId===i){const Te=Date.now()-ue;ge.off("latencyPong",pe),ce(Te)}};ge.on("latencyPong",pe),ge.emit("latencyPing",{targetDeviceId:Q,deviceId:i}),setTimeout(()=>{ge.off("latencyPong",pe),ce(9999)},1e3)}),[i]),K=W.useCallback(async(Q,ce={})=>{if(!n||!t)return;const{latencyOverride:ge,ignoreAutoOpenGate:ue=!1,allowRepeat:pe=!1}=ce,me=ge!==void 0?ge:await Z(Q.deviceId);if(me<_w&&!(!ue&&!N.current)&&!(!pe&&j.current.has(Q.deviceId))){if(j.current.add(Q.deviceId),!Q.profileSlug){console.warn("No profileSlug for nearby user; skipping auto-open");return}await hM({ownerUserId:n.uid,otherUserId:Q.profileSlug,eventCode:t,note:`Auto-detected via WiFi proximity (${me}ms latency)`}),e(`/profile/view/${Q.profileSlug}?eventCode=${t}&back=nearby`)}},[n,t,Z,e]);return W.useEffect(()=>{if(!t||!n)return;const Q=cC(),ce=u||n.uid||i,ge=()=>{Q.emit("presence",{eventCode:t,deviceId:i,profileSlug:ce,userId:n.uid,timestamp:Date.now()})};ge();const ue=setInterval(ge,1500);return Q.on("presence",pe=>{if(pe.deviceId===i)return;const me=Date.now(),Te=me-(pe.timestamp||me),ae={deviceId:pe.deviceId,profileSlug:pe.profileSlug,userId:pe.userId,latency:Te,timestamp:me};Te<_w&&K(ae,{latencyOverride:Te}),b(re=>re.find(se=>se.profileSlug===pe.profileSlug)?re.map(se=>se.profileSlug===pe.profileSlug?{...se,deviceId:pe.deviceId,latency:Te,timestamp:me}:se):[...re,ae])}),Q.on("latencyPing",pe=>{pe.toDeviceId===i&&Q.emit("latencyPong",{fromDeviceId:i,toDeviceId:pe.fromDeviceId})}),Q.on("incomingProfile",pe=>{pe.toDeviceId===i&&e(`/profile/view/${pe.profileSlug}?eventCode=${t}&back=nearby`)}),()=>{clearInterval(ue),Q.off("presence"),Q.off("latencyPing"),Q.off("incomingProfile")}},[i,t,u,e,K,n]),U.jsxs(On,{sx:{minHeight:"100vh",pt:10,pb:4,display:"flex",alignItems:"center",bgcolor:"background.default"},children:[U.jsx(xM,{onClick:()=>{try{window.history&&window.history.length>1?e(-1):e(`/events/${t}`,{replace:!0})}catch{e(`/events/${t}`,{replace:!0})}}}),U.jsxs(_h,{maxWidth:"md",sx:{animation:`${v_} 0.6s ease-out`},children:[U.jsxs(sn,{variant:"h3",gutterBottom:!0,sx:{fontWeight:700},children:["Nearby people at ",t]}),U.jsx(sn,{variant:"h6",color:"text.secondary",gutterBottom:!0,sx:{fontWeight:400},children:"Anyone on the same WiFi with this page open and event code selected will appear here."}),U.jsxs(hr,{direction:"row",alignItems:"center",spacing:2,sx:{mt:3,animation:`${Nse} 0.5s ease-out`},children:[U.jsx(Tb,{size:"medium",color:"primary",label:`Latency < ${_w}ms (~${GO}ft)`,sx:{fontSize:"1rem",px:1.5,py:2.5}}),U.jsxs(sn,{variant:"body1",color:"text.secondary",children:["Auto pop-up ",M?"ON":"OFF"," (via +)"]})]}),g.length===0&&U.jsx(sn,{variant:"h6",color:"text.secondary",sx:{mt:4,fontWeight:400},children:"Waiting for other devices"}),U.jsx(hr,{spacing:3,sx:{mt:4},children:g.map(Q=>{const ce=Q.latency!==void 0&&Q.latency<_w;return U.jsxs(rM,{sx:{bgcolor:ce?"#e8f5e9":"white",animation:`${v_} 0.45s ease-out`,borderRadius:3},children:[U.jsxs(sM,{sx:{p:3},children:[U.jsxs(sn,{variant:"h5",sx:{fontWeight:600,mb:1.5},children:["Someone nearby ",ce&&""]}),U.jsx(sn,{variant:"h6",color:"text.secondary",sx:{fontWeight:400},children:Q.latency!==void 0?`Latency: ${Q.latency}ms ${ce?"(< 3 feet!)":""}`:"Measuring distance..."}),ce&&U.jsx(sn,{variant:"body1",color:"success.main",sx:{mt:2,display:"block",fontWeight:500},children:" In proximity  will auto-open when + is ON"})]}),U.jsxs(iM,{sx:{p:3,pt:0},children:[U.jsx(cs,{size:"large",variant:ce?"contained":"outlined",color:ce?"success":"primary",disabled:o,sx:{minWidth:160,fontSize:"1rem"},onClick:()=>{o||(S(!0),Z(Q.deviceId).then(ge=>{S(!1),b(ue=>ue.map(pe=>pe.deviceId===Q.deviceId?{...pe,latency:ge}:pe)),K(Q,{latencyOverride:ge,ignoreAutoOpenGate:!0,allowRepeat:!0})}))},children:o?"Checking...":ce?"View Profile":"Check Distance"}),U.jsx(cs,{size:"large",sx:{minWidth:100,fontSize:"1rem"},onClick:()=>{if(!u){alert("You need to set up your profile before sharing it.");return}cC().emit("shareProfile",{toDeviceId:Q.deviceId,profileSlug:u})},children:"Share"})]})]},Q.deviceId)})})]}),U.jsx(_se,{title:M?`Auto pop-up on (<${GO}ft)`:"Enable auto pop-up (<3ft)",children:U.jsx(HN,{color:M?"success":"default","aria-label":"toggle-latency",onClick:()=>O(Q=>!Q),sx:{position:"fixed",bottom:32,right:32,width:72,height:72,animation:`${rV} 3s ease-in-out infinite`},children:U.jsx(nV,{sx:{fontSize:36}})})})]})}function rae(){const{eventCode:t}=PT(),{user:e}=W.useContext(zd),n=Cc(),[i,u]=W.useState([]);return W.useEffect(()=>{e&&t&&Vse(e.uid,t).then(async f=>{const g=await Promise.all(f.map(async b=>{const o=await aV(b.otherUserId);return o?{...b,profile:{name:o.name||"Unknown User",email:o.email||"",photoURL:o.photoURL||"",slug:o.slug||b.otherUserId}}:{...b,profile:{name:"Unknown User",slug:b.otherUserId}}}));u(g)})},[e,t]),U.jsxs(On,{sx:{minHeight:"100vh",pt:8,py:4},children:[U.jsx(xM,{onClick:()=>n("/dashboard")}),U.jsxs(_h,{maxWidth:"md",children:[U.jsx(wse,{}),U.jsx(sn,{variant:"h4",gutterBottom:!0,align:"center",children:"Event Contacts"}),U.jsxs(sn,{variant:"body1",color:"text.secondary",align:"center",sx:{mb:4},children:["Event Code: ",U.jsx("strong",{children:t})]}),i.length===0?U.jsxs(Ec,{sx:{p:4,textAlign:"center"},children:[U.jsx(sn,{variant:"body1",color:"text.secondary",children:'No contacts yet. Use the "Find Nearby" feature to meet people at this event!'}),U.jsx(cs,{component:xc,to:`/nearby/${t}`,variant:"contained",sx:{mt:2},children:"Find Nearby People"})]}):U.jsx(hr,{spacing:2,children:i.map(f=>U.jsxs(rM,{sx:{boxShadow:"0 6px 18px rgba(16,24,40,0.06)"},children:[U.jsx(sM,{children:U.jsxs(On,{sx:{display:"flex",alignItems:"center",gap:2},children:[U.jsx(Eb,{src:f.profile.photoURL,sx:{width:56,height:56},children:f.profile.name?.charAt(0).toUpperCase()}),U.jsxs(On,{sx:{flex:1},children:[U.jsx(sn,{variant:"h6",sx:{wordBreak:"break-word",fontWeight:700,textShadow:"0 1px 2px rgba(0,0,0,0.04)"},children:f.profile.name}),f.profile.email&&U.jsx(sn,{variant:"body2",color:"text.secondary",sx:{wordBreak:"break-word",textShadow:"0 1px 2px rgba(0,0,0,0.03)"},children:f.profile.email}),f.note&&U.jsx(sn,{variant:"caption",color:"text.secondary",sx:{fontStyle:"italic",wordBreak:"break-word",textShadow:"0 1px 2px rgba(0,0,0,0.02)"},children:f.note})]})]})}),U.jsx(iM,{children:U.jsx(cs,{size:"small",component:xc,to:`/profile/view/${f.profile.slug}?eventCode=${t}&back=contacts`,children:"View Profile"})})]},f.id))})]})]})}var Hw={exports:{}},iae=Hw.exports,HO;function sae(){return HO||(HO=1,(function(t,e){var n={};(function(i,u){t.exports=u()})(iae,(function(){var i,u,f;function g(o,S){if(!i)i=S;else if(!u)u=S;else{var M="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+i+")(sharedChunk); ("+u+")(sharedChunk); self.onerror = null;",O={};i(O),f=S(O),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(f.workerUrl=window.URL.createObjectURL(new Blob([M],{type:"text/javascript"})))}}g(["exports"],(function(o){var S=typeof self<"u"?self:{},M="2.15.0";let O;const N={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(O==null){const s=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{O=n.API_URL_REGEX!=null?new RegExp(n.API_URL_REGEX):s}catch{O=s}}return O},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!N.API_URL)return null;try{const s=new URL(N.API_URL);return s.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":s.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},j={supported:!1,testSupport:function(s){!Q&&K&&(ce?ge(s):Z=s)}};let Z,K,Q=!1,ce=!1;function ge(s){const r=s.createTexture();s.bindTexture(s.TEXTURE_2D,r);try{if(s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,K),s.isContextLost())return;j.supported=!0}catch{}s.deleteTexture(r),Q=!0}S.document&&(K=S.document.createElement("img"),K.onload=function(){Z&&ge(Z),Z=null,ce=!0},K.onerror=function(){Q=!0,Z=null},K.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ue="01";function pe(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var me=Te;function Te(s,r,a,d){this.cx=3*s,this.bx=3*(a-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(d-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=r,this.p2x=a,this.p2y=d}Te.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,r){if(r===void 0&&(r=1e-6),s<0)return 0;if(s>1)return 1;for(var a=s,d=0;d<8;d++){var m=this.sampleCurveX(a)-s;if(Math.abs(m)<r)return a;var v=this.sampleCurveDerivativeX(a);if(Math.abs(v)<1e-6)break;a-=m/v}var w=0,C=1;for(a=s,d=0;d<20&&(m=this.sampleCurveX(a),!(Math.abs(m-s)<r));d++)s>m?w=a:C=a,a=.5*(C-w)+w;return a},solve:function(s,r){return this.sampleCurveY(this.solveCurveX(s,r))}};var ae=pe(me),re=he;function he(s,r){this.x=s,this.y=r}he.prototype={clone:function(){return new he(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,r){return this.clone()._rotateAround(s,r)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var r=s.x-this.x,a=s.y-this.y;return r*r+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,r){return Math.atan2(this.x*r-this.y*s,this.x*s+this.y*r)},_matMult:function(s){var r=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=r,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var r=Math.cos(s),a=Math.sin(s),d=a*this.x+r*this.y;return this.x=r*this.x-a*this.y,this.y=d,this},_rotateAround:function(s,r){var a=Math.cos(s),d=Math.sin(s),m=r.y+d*(this.x-r.x)+a*(this.y-r.y);return this.x=r.x+a*(this.x-r.x)-d*(this.y-r.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},he.convert=function(s){return s instanceof he?s:Array.isArray(s)?new he(s[0],s[1]):s};var se=pe(re);const ve=Math.PI/180,Y=180/Math.PI;function le(s){return s*ve}function Ne(s){return s*Y}const Ze=[[0,0],[1,0],[1,1],[0,1]];function Ie(s){if(s<=0)return 0;if(s>=1)return 1;const r=s*s,a=r*s;return 4*(s<.5?a:3*(s-r)+a-.75)}function Je(s,r,a,d){const m=new ae(s,r,a,d);return function(v){return m.solve(v)}}const dt=Je(.25,.1,.25,1);function et(s,r,a){return Math.min(a,Math.max(r,s))}function Kt(s,r,a){return(a=et((a-s)/(r-s),0,1))*a*(3-2*a)}function De(s,r,a){const d=a-r,m=((s-r)%d+d)%d+r;return m===r?a:m}function tt(s,r,a){if(!s.length)return a(null,[]);let d=s.length;const m=new Array(s.length);let v=null;s.forEach(((w,C)=>{r(w,((I,P)=>{I&&(v=I),m[C]=P,--d==0&&a(v,m)}))}))}function Et(s){const r=[];for(const a in s)r.push(s[a]);return r}function wt(s,...r){for(const a of r)for(const d in a)s[d]=a[d];return s}let Lt=1;function Ut(){return Lt++}function an(){return(function s(r){return r?(r^Math.random()*(16>>r/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,s)})()}function At(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function Qt(s){return!!s&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(s)}function Wt(s,r){s.forEach((a=>{r[a]&&(r[a]=r[a].bind(r))}))}function vn(s,r){return s.indexOf(r,s.length-r.length)!==-1}function Gt(s,r,a){const d={};for(const m in s)d[m]=r.call(this,s[m],m,s);return d}function Cn(s,r,a){const d={};for(const m in s)r.call(a||this,s[m],m,s)&&(d[m]=s[m]);return d}function ln(s){return Array.isArray(s)?s.map(ln):typeof s=="object"&&s?Gt(s,ln):s}const qn={};function Rn(s){qn[s]||(typeof console<"u"&&console.warn(s),qn[s]=!0)}function An(s,r,a){return(a.y-s.y)*(r.x-s.x)>(r.y-s.y)*(a.x-s.x)}function rr(s){let r=0;for(let a,d,m=0,v=s.length,w=v-1;m<v;w=m++)a=s[m],d=s[w],r+=(d.x-a.x)*(a.y+d.y);return r}function En(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function bn(s){const r={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((a,d,m,v)=>{const w=m||v;return r[d]=!w||w.toLowerCase(),""})),r["max-age"]){const a=parseInt(r["max-age"],10);isNaN(a)?delete r["max-age"]:r["max-age"]=a}return r}let zn=null;function mn(s){if(zn==null){const r=s.navigator?s.navigator.userAgent:null;zn=!!s.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return zn}function ti(s){try{const r=S[s];return r.setItem("_mapbox_test_",1),r.removeItem("_mapbox_test_"),!0}catch{return!1}}function Xn(s,r){return[s[4*r],s[4*r+1],s[4*r+2],s[4*r+3]]}const on="mapbox-tiles";let Jt=500,yn=50,_n,In;function Bn(){try{return S.caches}catch{}}function Nn(){Bn()&&!_n&&(_n=S.caches.open(on))}function Br(s){const r=s.indexOf("?");if(r<0)return s;const a=(function(m){const v=m.indexOf("?");return v>0?m.slice(v+1).split("&"):[]})(s),d=a.filter((m=>{const v=m.split("=");return v[0]==="language"||v[0]==="worldview"}));return d.length?`${s.slice(0,r)}?${d.join("&")}`:s.slice(0,r)}let tr=1/0;const _r={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(_r);class xn extends Error{constructor(r,a,d){a===401&&nt(d)&&(r+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(r),this.status=a,this.url=d}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const $n=En()?()=>self.worker&&self.worker.referrer:()=>(S.location.protocol==="blob:"?S.parent:S).location.href,jr=function(s,r){if(!(/^file:/.test(a=s.url)||/^file:/.test($n())&&!/^\w+:/.test(a))){if(S.fetch&&S.Request&&S.AbortController&&S.Request.prototype.hasOwnProperty("signal"))return(function(d,m){const v=new S.AbortController,w=new S.Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,referrer:$n(),referrerPolicy:d.referrerPolicy,signal:v.signal});let C=!1,I=!1;const P=(B=w.url).indexOf("sku=")>0&&nt(B);var B;d.type==="json"&&w.headers.set("Accept","application/json");const F=(X,J,oe)=>{if(I)return;if(X&&X.message!=="SecurityError"&&Rn(X.toString()),J&&oe)return $(J);const _e=Date.now();S.fetch(w).then((Re=>{if(Re.ok){const Be=P?Re.clone():null;return $(Re,Be,_e)}return m(new xn(Re.statusText,Re.status,d.url))})).catch((Re=>{Re.name!=="AbortError"&&m(new Error(`${Re.message} ${d.url}`))}))},$=(X,J,oe)=>{(d.type==="arrayBuffer"?X.arrayBuffer():d.type==="json"?X.json():X.text()).then((_e=>{I||(J&&oe&&(function(Re,Be,Pe){if(Nn(),!_n)return;const ze={status:Be.status,statusText:Be.statusText,headers:new S.Headers};Be.headers.forEach(((ut,ot)=>ze.headers.set(ot,ut)));const Ue=bn(Be.headers.get("Cache-Control")||"");if(Ue["no-store"])return;Ue["max-age"]&&ze.headers.set("Expires",new Date(Pe+1e3*Ue["max-age"]).toUTCString());const Fe=ze.headers.get("Expires");Fe&&(new Date(Fe).getTime()-Pe<42e4||(function(ut,ot){if(In===void 0)try{new Response(new ReadableStream),In=!0}catch{In=!1}In?ot(ut.body):ut.blob().then(ot)})(Be,(ut=>{const ot=new S.Response(ut,ze);Nn(),_n&&_n.then((bt=>bt.put(Br(Re.url),ot))).catch((bt=>Rn(bt.message)))})))})(w,J,oe),C=!0,m(null,_e,X.headers.get("Cache-Control"),X.headers.get("Expires")))})).catch((_e=>{I||m(new Error(_e.message))}))};return P?(function(X,J){if(Nn(),!_n)return J(null);const oe=Br(X.url);_n.then((_e=>{_e.match(oe).then((Re=>{const Be=(function(Pe){if(!Pe)return!1;const ze=new Date(Pe.headers.get("Expires")||0),Ue=bn(Pe.headers.get("Cache-Control")||"");return ze>Date.now()&&!Ue["no-cache"]})(Re);_e.delete(oe),Be&&_e.put(oe,Re.clone()),J(null,Re,Be)})).catch(J)})).catch(J)})(w,F):F(null,null),{cancel:()=>{I=!0,C||v.abort()}}})(s,r);if(En()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,r,void 0,!0)}var a;return(function(d,m){const v=new S.XMLHttpRequest;v.open(d.method||"GET",d.url,!0),d.type==="arrayBuffer"&&(v.responseType="arraybuffer");for(const w in d.headers)v.setRequestHeader(w,d.headers[w]);return d.type==="json"&&(v.responseType="text",v.setRequestHeader("Accept","application/json")),v.withCredentials=d.credentials==="include",v.onerror=()=>{m(new Error(v.statusText))},v.onload=()=>{if((v.status>=200&&v.status<300||v.status===0)&&v.response!==null){let w=v.response;if(d.type==="json")try{w=JSON.parse(v.response)}catch(C){return m(C)}m(null,w,v.getResponseHeader("Cache-Control"),v.getResponseHeader("Expires"))}else m(new xn(v.statusText,v.status,d.url))},v.send(d.body),{cancel:()=>v.abort()}})(s,r)},Gi=function(s,r){return jr(wt(s,{type:"arrayBuffer"}),r)};function eo(s){const r=S.document.createElement("a");return r.href=s,r.protocol===S.document.location.protocol&&r.host===S.document.location.host}const Oe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let fe,de;fe=[],de=0;const Me=function(s,r){if(j.supported&&(s.headers||(s.headers={}),s.headers.accept="image/webp,*/*"),de>=N.MAX_PARALLEL_IMAGE_REQUESTS){const v={requestParameters:s,callback:r,cancelled:!1,cancel(){this.cancelled=!0}};return fe.push(v),v}de++;let a=!1;const d=()=>{if(!a)for(a=!0,de--;fe.length&&de<N.MAX_PARALLEL_IMAGE_REQUESTS;){const v=fe.shift(),{requestParameters:w,callback:C,cancelled:I}=v;I||(v.cancel=Me(w,C).cancel)}},m=Gi(s,((v,w,C,I)=>{d(),v?r(v):w&&(S.createImageBitmap?(function(P,B){const F=new S.Blob([new Uint8Array(P)],{type:"image/png"});S.createImageBitmap(F).then(($=>{B(null,$)})).catch(($=>{B(new Error(`Could not load image because of ${$.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))})(w,((P,B)=>r(P,B,C,I))):(function(P,B){const F=new S.Image,$=S.URL;F.onload=()=>{B(null,F),$.revokeObjectURL(F.src),F.onload=null,S.requestAnimationFrame((()=>{F.src=Oe}))},F.onerror=()=>B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const X=new S.Blob([new Uint8Array(P)],{type:"image/png"});F.src=P.byteLength?$.createObjectURL(X):Oe})(w,((P,B)=>r(P,B,C,I))))}));return{cancel:()=>{m.cancel(),d()}}},Ve="NO_ACCESS_TOKEN";function Ge(s){return s.indexOf("mapbox:")===0}function nt(s){return N.API_URL_REGEX.test(s)}function Xe(s){return N.API_CDN_URL_REGEX.test(s)}function $e(s){return N.API_STYLE_REGEX.test(s)&&!ct(s)}function ct(s){return N.API_SPRITE_REGEX.test(s)}const Xt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function en(s){const r=s.match(Xt);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function jt(s){const r=s.params.length?`?${s.params.join("&")}`:"";return`${s.protocol}://${s.authority}${s.path}${r}`}const Kn="mapbox.eventData";function Jn(s){if(!s)return null;const r=s.split(".");if(!r||r.length!==3)return null;try{return JSON.parse(decodeURIComponent(S.atob(r[1]).split("").map((a=>"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2))).join("")))}catch{return null}}class Hn{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const a=Jn(N.ACCESS_TOKEN);let d="";return d=a&&a.u?S.btoa(encodeURIComponent(a.u).replace(/%([0-9A-F]{2})/g,((m,v)=>String.fromCharCode(+("0x"+v))))):N.ACCESS_TOKEN||"",r?`${Kn}.${r}:${d}`:`${Kn}:${d}`}fetchEventData(){const r=ti("localStorage"),a=this.getStorageKey(),d=this.getStorageKey("uuid");if(r)try{const m=S.localStorage.getItem(a);m&&(this.eventData=JSON.parse(m));const v=S.localStorage.getItem(d);v&&(this.anonId=v)}catch{Rn("Unable to read from LocalStorage")}}saveEventData(){const r=ti("localStorage"),a=this.getStorageKey(),d=this.getStorageKey("uuid");if(r)try{S.localStorage.setItem(d,this.anonId),Object.keys(this.eventData).length>=1&&S.localStorage.setItem(a,JSON.stringify(this.eventData))}catch{Rn("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,a,d,m){if(!N.EVENTS_URL)return;const v=en(N.EVENTS_URL);v.params.push(`access_token=${m||N.ACCESS_TOKEN||""}`);const w={event:this.type,created:new Date(r).toISOString()},C=a?wt(w,a):w,I={url:jt(v),headers:{"Content-Type":"text/plain"},body:JSON.stringify([C])};this.pendingRequest=(function(P,B){return jr(wt(P,{method:"POST"}),B)})(I,(P=>{this.pendingRequest=null,d(P),this.saveEventData(),this.processRequests(m)}))}queueRequest(r,a){this.queue.push(r),this.processRequests(a)}}const ir=new class extends Hn{constructor(s){super("appUserTurnstile"),this._customAccessToken=s}postTurnstileEvent(s,r){N.EVENTS_URL&&N.ACCESS_TOKEN&&Array.isArray(s)&&s.some((a=>Ge(a)||nt(a)))&&this.queueRequest(Date.now(),r)}processRequests(s){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=Jn(N.ACCESS_TOKEN),a=r?r.u:N.ACCESS_TOKEN;let d=a!==this.eventData.tokenU;Qt(this.anonId)||(this.anonId=an(),d=!0);const m=this.queue.shift();if(this.eventData.lastSuccess){const v=new Date(this.eventData.lastSuccess),w=new Date(m),C=(m-this.eventData.lastSuccess)/864e5;d=d||C>=1||C<-1||v.getDate()!==w.getDate()}else d=!0;d?this.postEvent(m,{sdkIdentifier:"mapbox-gl-js",sdkVersion:M,skuId:ue,"enabled.telemetry":!1,userId:this.anonId},(v=>{v||(this.eventData.lastSuccess=m,this.eventData.tokenU=a)}),s):this.processRequests()}},er=ir.postTurnstileEvent.bind(ir),Nr=new class extends Hn{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(s,r,a,d){this.skuToken=r,this.errorCb=d,N.EVENTS_URL&&(a||N.ACCESS_TOKEN?this.queueRequest({id:s,timestamp:Date.now()},a):this.errorCb(new Error(Ve)))}processRequests(s){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:a}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),Qt(this.anonId)||(this.anonId=an()),this.postEvent(a,{sdkIdentifier:"mapbox-gl-js",sdkVersion:M,skuId:ue,skuToken:this.skuToken,userId:this.anonId},(d=>{d?this.errorCb(d):r&&(this.success[r]=!0)}),s))}},Cr=Nr.postMapLoadEvent.bind(Nr),Xr=new class extends Hn{constructor(){super("gljs.performance")}postPerformanceEvent(s,r){N.EVENTS_URL&&(s||N.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},s)}processRequests(s){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,performanceData:a}=this.queue.shift(),d=(function(m){const v=S.performance.getEntriesByType("resource"),w=S.performance.getEntriesByType("mark"),C=(function($){const X={};if($){for(const J in $)if(J!=="other")for(const oe of $[J]){const _e=`${J}ResolveRangeMin`,Re=`${J}ResolveRangeMax`,Be=`${J}RequestCount`,Pe=`${J}RequestCachedCount`;X[_e]=Math.min(X[_e]||1/0,oe.startTime),X[Re]=Math.max(X[Re]||-1/0,oe.responseEnd);const ze=Ue=>{X[Ue]===void 0&&(X[Ue]=0),++X[Ue]};oe.transferSize!==void 0&&oe.transferSize===0&&ze(Pe),ze(Be)}}return X})((function($,X){const J={};if($)for(const oe of $){const _e=X(oe);J[_e]===void 0&&(J[_e]=[]),J[_e].push(oe)}return J})(v,wu)),I=S.devicePixelRatio,P=S.navigator.connection||S.navigator.mozConnection||S.navigator.webkitConnection,B={counters:[],metadata:[],attributes:[]},F=($,X,J)=>{J!=null&&$.push({name:X,value:J.toString()})};for(const $ in C)F(B.counters,$,C[$]);if(m.interactionRange[0]!==1/0&&m.interactionRange[1]!==-1/0&&(F(B.counters,"interactionRangeMin",m.interactionRange[0]),F(B.counters,"interactionRangeMax",m.interactionRange[1])),w)for(const $ of Object.keys(Hl)){const X=Hl[$],J=w.find((oe=>oe.name===X));J&&F(B.counters,X,J.startTime)}return F(B.counters,"visibilityHidden",m.visibilityHidden),F(B.attributes,"style",(function($){if($)for(const X of $){const J=X.name.split("?")[0];if($e(J)){const oe=J.split("/").slice(-2);if(oe.length===2)return`mapbox://styles/${oe[0]}/${oe[1]}`}}})(v)),F(B.attributes,"terrainEnabled",m.terrainEnabled?"true":"false"),F(B.attributes,"fogEnabled",m.fogEnabled?"true":"false"),F(B.attributes,"projection",m.projection),F(B.attributes,"zoom",m.zoom),F(B.metadata,"devicePixelRatio",I),F(B.metadata,"connectionEffectiveType",P?P.effectiveType:void 0),F(B.metadata,"navigatorUserAgent",S.navigator.userAgent),F(B.metadata,"screenWidth",S.screen.width),F(B.metadata,"screenHeight",S.screen.height),F(B.metadata,"windowWidth",S.innerWidth),F(B.metadata,"windowHeight",S.innerHeight),F(B.metadata,"mapWidth",m.width/I),F(B.metadata,"mapHeight",m.height/I),F(B.metadata,"webglRenderer",m.renderer),F(B.metadata,"webglVendor",m.vendor),F(B.metadata,"sdkVersion",M),F(B.metadata,"sdkIdentifier","mapbox-gl-js"),B})(a);for(const m of d.metadata);for(const m of d.counters);for(const m of d.attributes);this.postEvent(r,d,(()=>{}),s)}},mi=Xr.postPerformanceEvent.bind(Xr),Eo=new class extends Hn{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(s,r,a,d){if(!N.API_URL||!N.SESSION_PATH)return;const m=en(N.API_URL+N.SESSION_PATH);m.params.push(`sku=${r||""}`),m.params.push(`access_token=${d||N.ACCESS_TOKEN||""}`);const v={url:jt(m),headers:{"Content-Type":"text/plain"}};this.pendingRequest=(function(w,C){return jr(wt(w,{method:"GET"}),C)})(v,(w=>{this.pendingRequest=null,a(w),this.saveEventData(),this.processRequests(d)}))}getSessionAPI(s,r,a,d){this.skuToken=r,this.errorCb=d,N.SESSION_PATH&&N.API_URL&&(a||N.ACCESS_TOKEN?this.queueRequest({id:s,timestamp:Date.now()},a):this.errorCb(new Error(Ve)))}processRequests(s){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:a}=this.queue.shift();r&&this.success[r]||this.getSession(a,this.skuToken,(d=>{d?this.errorCb(d):r&&(this.success[r]=!0)}),s)}},gs=Eo.getSessionAPI.bind(Eo),ks=new Set,Hl={create:"create",load:"load",fullLoad:"fullLoad"},wl={mark(s){S.performance.mark(s)},measure(s,r,a){S.performance.measure(s,r,a)}};function wu(s){const r=s.name.split("?")[0];return Xe(r)&&r.includes("mapbox-gl.js")?"javascript":Xe(r)&&r.includes("mapbox-gl.css")?"css":(function(a){return N.API_FONTS_REGEX.test(a)})(r)?"fontRange":ct(r)?"sprite":$e(r)?"style":(function(a){return N.API_TILEJSON_REGEX.test(a)})(r)?"tilejson":"other"}const vr=S.performance;function Uo(s){const r=s?s.url.toString():void 0;return vr.getEntriesByName(r)}let $s,wa,ts,jo;const ea={now:()=>ts!==void 0?ts:S.performance.now(),setNow(s){ts=s},restoreNow(){ts=void 0},frame(s){const r=S.requestAnimationFrame(s);return{cancel:()=>S.cancelAnimationFrame(r)}},getImageData(s,r=0){const{width:a,height:d}=s;jo||(jo=S.document.createElement("canvas"));const m=jo.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return(a>jo.width||d>jo.height)&&(jo.width=a,jo.height=d),m.clearRect(-r,-r,a+2*r,d+2*r),m.drawImage(s,0,0,a,d),m.getImageData(-r,-r,a+2*r,d+2*r)},resolveURL:s=>($s||($s=S.document.createElement("a")),$s.href=s,$s.href),get devicePixelRatio(){return S.devicePixelRatio},get prefersReducedMotion(){return!!S.matchMedia&&(wa==null&&(wa=S.matchMedia("(prefers-reduced-motion: reduce)")),wa.matches)}};function Ta(s,r,a){a[s]&&a[s].indexOf(r)!==-1||(a[s]=a[s]||[],a[s].push(r))}function Ea(s,r,a){if(a&&a[s]){const d=a[s].indexOf(r);d!==-1&&a[s].splice(d,1)}}class tl{constructor(r,a={}){wt(this,a),this.type=r}}class ta extends tl{constructor(r,a={}){super("error",wt({error:r},a))}}class Wl{on(r,a){return this._listeners=this._listeners||{},Ta(r,a,this._listeners),this}off(r,a){return Ea(r,a,this._listeners),Ea(r,a,this._oneTimeListeners),this}once(r,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Ta(r,a,this._oneTimeListeners),this):new Promise((d=>this.once(r,d)))}fire(r,a){typeof r=="string"&&(r=new tl(r,a||{}));const d=r.type;if(this.listens(d)){r.target=this;const m=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const C of m)C.call(this,r);const v=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const C of v)Ea(d,C,this._oneTimeListeners),C.call(this,r);const w=this._eventedParent;w&&(wt(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(r))}else r instanceof ta&&console.error(r.error);return this}listens(r){return!!(this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r))}setEventedParent(r,a){return this._eventedParent=r,this._eventedParentData=a,this}}var vt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function $o(s,...r){for(const a of r)for(const d in a)s[d]=a[d];return s}function Zr(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function Dr(s){if(Array.isArray(s))return s.map(Dr);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const r={};for(const a in s)r[a]=Dr(s[a]);return r}return Zr(s)}class Es extends Error{constructor(r,a){super(a),this.message=a,this.key=r}}var qs=Es;class Tu{constructor(r,a=[]){this.parent=r,this.bindings={};for(const[d,m]of a)this.bindings[d]=m}concat(r){return new Tu(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}var ui=Tu;const Sa={kind:"null"},nn={kind:"number"},sr={kind:"string"},Wn={kind:"boolean"},Ds={kind:"color"},qo={kind:"object"},or={kind:"value"},ys={kind:"collator"},Ac={kind:"formatted"},Go={kind:"resolvedImage"};function Hi(s,r){return{kind:"array",itemType:s,N:r}}function gi(s){if(s.kind==="array"){const r=gi(s.itemType);return typeof s.N=="number"?`array<${r}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${r}>`}return s.kind}const vh=[Sa,nn,sr,Wn,Ds,Ac,qo,Hi(or),Go];function na(s,r){if(r.kind==="error")return null;if(s.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!na(s.itemType,r.itemType))&&(typeof s.N!="number"||s.N===r.N))return null}else{if(s.kind===r.kind)return null;if(s.kind==="value"){for(const a of vh)if(!na(a,r))return null}}return`Expected ${gi(s)} but found ${gi(r)} instead.`}function Tl(s,r){return r.some((a=>a.kind===s.kind))}function Ic(s,r){return r.some((a=>a==="null"?s===null:a==="array"?Array.isArray(s):a==="object"?s&&!Array.isArray(s)&&typeof s=="object":a===typeof s))}var El,Eu={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function So(s){return(s=Math.round(s))<0?0:s>255?255:s}function Xl(s){return So(s[s.length-1]==="%"?parseFloat(s)/100*255:parseInt(s))}function Co(s){return(r=s[s.length-1]==="%"?parseFloat(s)/100:parseFloat(s))<0?0:r>1?1:r;var r}function ra(s,r,a){return a<0?a+=1:a>1&&(a-=1),6*a<1?s+(r-s)*a*6:2*a<1?r:3*a<2?s+(r-s)*(2/3-a)*6:s}try{El={}.parseCSSColor=function(s){var r,a=s.replace(/ /g,"").toLowerCase();if(a in Eu)return Eu[a].slice();if(a[0]==="#")return a.length===4?(r=parseInt(a.substr(1),16))>=0&&r<=4095?[(3840&r)>>4|(3840&r)>>8,240&r|(240&r)>>4,15&r|(15&r)<<4,1]:null:a.length===7&&(r=parseInt(a.substr(1),16))>=0&&r<=16777215?[(16711680&r)>>16,(65280&r)>>8,255&r,1]:null;var d=a.indexOf("("),m=a.indexOf(")");if(d!==-1&&m+1===a.length){var v=a.substr(0,d),w=a.substr(d+1,m-(d+1)).split(","),C=1;switch(v){case"rgba":if(w.length!==4)return null;C=Co(w.pop());case"rgb":return w.length!==3?null:[Xl(w[0]),Xl(w[1]),Xl(w[2]),C];case"hsla":if(w.length!==4)return null;C=Co(w.pop());case"hsl":if(w.length!==3)return null;var I=(parseFloat(w[0])%360+360)%360/360,P=Co(w[1]),B=Co(w[2]),F=B<=.5?B*(P+1):B+P-B*P,$=2*B-F;return[So(255*ra($,F,I+1/3)),So(255*ra($,F,I)),So(255*ra($,F,I-1/3)),C];default:return null}}return null}}catch{}class ns{constructor(r,a,d,m=1){this.r=r,this.g=a,this.b=d,this.a=m}static parse(r){if(!r)return;if(r instanceof ns)return r;if(typeof r!="string")return;const a=El(r);return a?new ns(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3]):void 0}toString(){const[r,a,d,m]=this.toArray();return`rgba(${Math.round(r)},${Math.round(a)},${Math.round(d)},${m})`}toArray(){const{r,g:a,b:d,a:m}=this;return m===0?[0,0,0,0]:[255*r/m,255*a/m,255*d/m,m]}toArray01(){const{r,g:a,b:d,a:m}=this;return m===0?[0,0,0,0]:[r/m,a/m,d/m,m]}toArray01PremultipliedAlpha(){const{r,g:a,b:d,a:m}=this;return[r,a,d,m]}}ns.black=new ns(0,0,0,1),ns.white=new ns(1,1,1,1),ns.transparent=new ns(0,0,0,0),ns.red=new ns(1,0,0,1),ns.blue=new ns(0,0,1,1);var Ti=ns;class Rc{constructor(r,a,d){this.sensitivity=r?a?"variant":"case":a?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,a){return this.collator.compare(r,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Sl{constructor(r,a,d,m,v){this.text=r.normalize?r.normalize():r,this.image=a,this.scale=d,this.fontStack=m,this.textColor=v}}class Yi{constructor(r){this.sections=r}static fromString(r){return new Yi([new Sl(r,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((r=>r.text.length!==0||r.image&&r.image.name.length!==0))}static factory(r){return r instanceof Yi?r:Yi.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map((r=>r.text)).join("")}serialize(){const r=["format"];for(const a of this.sections){if(a.image){r.push(["image",a.image.name]);continue}r.push(a.text);const d={};a.fontStack&&(d["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(d["font-scale"]=a.scale),a.textColor&&(d["text-color"]=["rgba"].concat(a.textColor.toArray())),r.push(d)}return r}}class rs{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new rs({name:r,available:!1}):null}serialize(){return["image",this.name]}}function Mc(s,r,a,d){return typeof s=="number"&&s>=0&&s<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof a=="number"&&a>=0&&a<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[s,r,a,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[s,r,a,d]:[s,r,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ni(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof Ti||s instanceof Rc||s instanceof Yi||s instanceof rs)return!0;if(Array.isArray(s)){for(const r of s)if(!ni(r))return!1;return!0}if(typeof s=="object"){for(const r in s)if(!ni(s[r]))return!1;return!0}return!1}function ri(s){if(s===null)return Sa;if(typeof s=="string")return sr;if(typeof s=="boolean")return Wn;if(typeof s=="number")return nn;if(s instanceof Ti)return Ds;if(s instanceof Rc)return ys;if(s instanceof Yi)return Ac;if(s instanceof rs)return Go;if(Array.isArray(s)){const r=s.length;let a;for(const d of s){const m=ri(d);if(a){if(a===m)continue;a=or;break}a=m}return Hi(a||or,r)}return qo}function Zl(s){const r=typeof s;return s===null?"":r==="string"||r==="number"||r==="boolean"?String(s):s instanceof Ti||s instanceof Yi||s instanceof rs?s.toString():JSON.stringify(s)}class Kl{constructor(r,a){this.type=r,this.value=a}static parse(r,a){if(r.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!ni(r[1]))return a.error("invalid value");const d=r[1];let m=ri(d);const v=a.expectedType;return m.kind!=="array"||m.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(m=v),new Kl(m,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Ti?["rgba"].concat(this.value.toArray()):this.value instanceof Yi?this.value.serialize():this.value}}var nl=Kl,is=class{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}};const rl={string:sr,number:nn,boolean:Wn,object:qo};class ia{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");let d,m=1;const v=r[0];if(v==="array"){let C,I;if(r.length>2){const P=r[1];if(typeof P!="string"||!(P in rl)||P==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);C=rl[P],m++}else C=or;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return a.error('The length argument to "array" must be a positive integer literal',2);I=r[2],m++}d=Hi(C,I)}else d=rl[v];const w=[];for(;m<r.length;m++){const C=a.parse(r[m],m,or);if(!C)return null;w.push(C)}return new ia(d,w)}evaluate(r){for(let a=0;a<this.args.length;a++){const d=this.args[a].evaluate(r);if(!na(this.type,ri(d)))return d;if(a===this.args.length-1)throw new is(`Expected value to be of type ${gi(this.type)}, but found ${gi(ri(d))} instead.`)}return null}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every((r=>r.outputDefined()))}serialize(){const r=this.type,a=[r.kind];if(r.kind==="array"){const d=r.itemType;if(d.kind==="string"||d.kind==="number"||d.kind==="boolean"){a.push(d.kind);const m=r.N;(typeof m=="number"||this.args.length>1)&&a.push(m)}}return a.concat(this.args.map((d=>d.serialize())))}}var Wi=ia;class to{constructor(r){this.type=Ac,this.sections=r}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");const d=r[1];if(!Array.isArray(d)&&typeof d=="object")return a.error("First argument must be an image or text section.");const m=[];let v=!1;for(let w=1;w<=r.length-1;++w){const C=r[w];if(v&&typeof C=="object"&&!Array.isArray(C)){v=!1;let I=null;if(C["font-scale"]&&(I=a.parse(C["font-scale"],1,nn),!I))return null;let P=null;if(C["text-font"]&&(P=a.parse(C["text-font"],1,Hi(sr)),!P))return null;let B=null;if(C["text-color"]&&(B=a.parse(C["text-color"],1,Ds),!B))return null;const F=m[m.length-1];F.scale=I,F.font=P,F.textColor=B}else{const I=a.parse(r[w],1,or);if(!I)return null;const P=I.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,m.push({content:I,scale:null,font:null,textColor:null})}}return new to(m)}evaluate(r){return new Yi(this.sections.map((a=>{const d=a.content.evaluate(r);return ri(d)===Go?new Sl("",d,null,null,null):new Sl(Zl(d),null,a.scale?a.scale.evaluate(r):null,a.font?a.font.evaluate(r).join(","):null,a.textColor?a.textColor.evaluate(r):null)})))}eachChild(r){for(const a of this.sections)r(a.content),a.scale&&r(a.scale),a.font&&r(a.font),a.textColor&&r(a.textColor)}outputDefined(){return!1}serialize(){const r=["format"];for(const a of this.sections){r.push(a.content.serialize());const d={};a.scale&&(d["font-scale"]=a.scale.serialize()),a.font&&(d["text-font"]=a.font.serialize()),a.textColor&&(d["text-color"]=a.textColor.serialize()),r.push(d)}return r}}class sa{constructor(r){this.type=Go,this.input=r}static parse(r,a){if(r.length!==2)return a.error("Expected two arguments.");const d=a.parse(r[1],1,sr);return d?new sa(d):a.error("No image name provided.")}evaluate(r){const a=this.input.evaluate(r),d=rs.fromString(a);return d&&r.availableImages&&(d.available=r.availableImages.indexOf(a)>-1),d}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Pc={"to-boolean":Wn,"to-color":Ds,"to-number":nn,"to-string":sr};class Su{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");const d=r[0];if((d==="to-boolean"||d==="to-string")&&r.length!==2)return a.error("Expected one argument.");const m=Pc[d],v=[];for(let w=1;w<r.length;w++){const C=a.parse(r[w],w,or);if(!C)return null;v.push(C)}return new Su(m,v)}evaluate(r){if(this.type.kind==="boolean")return!!this.args[0].evaluate(r);if(this.type.kind==="color"){let a,d;for(const m of this.args){if(a=m.evaluate(r),d=null,a instanceof Ti)return a;if(typeof a=="string"){const v=r.parseColor(a);if(v)return v}else if(Array.isArray(a)&&(d=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:Mc(a[0],a[1],a[2],a[3]),!d))return new Ti(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new is(d||`Could not parse color from value '${typeof a=="string"?a:String(JSON.stringify(a))}'`)}if(this.type.kind==="number"){let a=null;for(const d of this.args){if(a=d.evaluate(r),a===null)return 0;const m=Number(a);if(!isNaN(m))return m}throw new is(`Could not convert ${JSON.stringify(a)} to number.`)}return this.type.kind==="formatted"?Yi.fromString(Zl(this.args[0].evaluate(r))):this.type.kind==="resolvedImage"?rs.fromString(Zl(this.args[0].evaluate(r))):Zl(this.args[0].evaluate(r))}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every((r=>r.outputDefined()))}serialize(){if(this.type.kind==="formatted")return new to([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new sa(this.args[0]).serialize();const r=[`to-${this.type.kind}`];return this.eachChild((a=>{r.push(a.serialize())})),r}}var oa=Su;const Ao=["Unknown","Point","LineString","Polygon"];var Ca=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ao[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const s=this.featureDistanceData.center,r=this.featureDistanceData.scale,{x:a,y:d}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(a*r-s[0])+this.featureDistanceData.bearing[1]*(d*r-s[1])}return 0}parseColor(s){let r=this._parseColorCache[s];return r||(r=this._parseColorCache[s]=Ti.parse(s)),r}};class Aa{constructor(r,a,d,m){this.name=r,this.type=a,this._evaluate=d,this.args=m}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((r=>r.serialize())))}static parse(r,a){const d=r[0],m=Aa.definitions[d];if(!m)return a.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(m)?m[0]:m.type,w=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,C=w.filter((([P])=>!Array.isArray(P)||P.length===r.length-1));let I=null;for(const[P,B]of C){I=new pn(a.registry,a.path,null,a.scope);const F=[];let $=!1;for(let X=1;X<r.length;X++){const J=r[X],oe=Array.isArray(P)?P[X-1]:P.type,_e=I.parse(J,1+F.length,oe);if(!_e){$=!0;break}F.push(_e)}if(!$)if(Array.isArray(P)&&P.length!==F.length)I.error(`Expected ${P.length} arguments, but found ${F.length} instead.`);else{for(let X=0;X<F.length;X++){const J=Array.isArray(P)?P[X]:P.type,oe=F[X];I.concat(X+1).checkSubtype(J,oe.type)}if(I.errors.length===0)return new Aa(d,v,B,F)}}if(C.length===1)a.errors.push(...I.errors);else{const P=(C.length?C:w).map((([F])=>{return $=F,Array.isArray($)?`(${$.map(gi).join(", ")})`:`(${gi($.type)}...)`;var $})).join(" | "),B=[];for(let F=1;F<r.length;F++){const $=a.parse(r[F],1+B.length);if(!$)return null;B.push(gi($.type))}a.error(`Expected arguments of type ${P}, but found (${B.join(", ")}) instead.`)}return null}static register(r,a){Aa.definitions=a;for(const d in a)r[d]=Aa}}var aa=Aa;class il{constructor(r,a,d){this.type=ys,this.locale=d,this.caseSensitive=r,this.diacriticSensitive=a}static parse(r,a){if(r.length!==2)return a.error("Expected one argument.");const d=r[1];if(typeof d!="object"||Array.isArray(d))return a.error("Collator options argument must be an object.");const m=a.parse(d["case-sensitive"]!==void 0&&d["case-sensitive"],1,Wn);if(!m)return null;const v=a.parse(d["diacritic-sensitive"]!==void 0&&d["diacritic-sensitive"],1,Wn);if(!v)return null;let w=null;return d.locale&&(w=a.parse(d.locale,1,sr),!w)?null:new il(m,v,w)}evaluate(r){return new Rc(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}serialize(){const r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]}}const Ia=8192;function Cu(s,r){s[0]=Math.min(s[0],r[0]),s[1]=Math.min(s[1],r[1]),s[2]=Math.max(s[2],r[0]),s[3]=Math.max(s[3],r[1])}function Ra(s,r){return!(s[0]<=r[0]||s[2]>=r[2]||s[1]<=r[1]||s[3]>=r[3])}function Yl(s,r){const a=(180+s[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,m=Math.pow(2,r.z);return[Math.round(a*m*Ia),Math.round(d*m*Ia)]}function Vd(s,r,a){const d=s[0]-r[0],m=s[1]-r[1],v=s[0]-a[0],w=s[1]-a[1];return d*w-v*m==0&&d*v<=0&&m*w<=0}function Ql(s,r){let a=!1;for(let w=0,C=r.length;w<C;w++){const I=r[w];for(let P=0,B=I.length;P<B-1;P++){if(Vd(s,I[P],I[P+1]))return!1;(m=I[P])[1]>(d=s)[1]!=(v=I[P+1])[1]>d[1]&&d[0]<(v[0]-m[0])*(d[1]-m[1])/(v[1]-m[1])+m[0]&&(a=!a)}}var d,m,v;return a}function xh(s,r){for(let a=0;a<r.length;a++)if(Ql(s,r[a]))return!0;return!1}function bh(s,r,a,d){const m=d[0]-a[0],v=d[1]-a[1],w=(s[0]-a[0])*v-m*(s[1]-a[1]),C=(r[0]-a[0])*v-m*(r[1]-a[1]);return w>0&&C<0||w<0&&C>0}function Io(s,r,a){for(const P of a)for(let B=0;B<P.length-1;++B)if((C=[(w=P[B+1])[0]-(v=P[B])[0],w[1]-v[1]])[0]*(I=[(m=r)[0]-(d=s)[0],m[1]-d[1]])[1]-C[1]*I[0]!=0&&bh(d,m,v,w)&&bh(v,w,d,m))return!0;var d,m,v,w,C,I;return!1}function Lr(s,r){for(let a=0;a<s.length;++a)if(!Ql(s[a],r))return!1;for(let a=0;a<s.length-1;++a)if(Io(s[a],s[a+1],r))return!1;return!0}function Zf(s,r){for(let a=0;a<r.length;a++)if(Lr(s,r[a]))return!0;return!1}function wh(s,r,a){const d=[];for(let m=0;m<s.length;m++){const v=[];for(let w=0;w<s[m].length;w++){const C=Yl(s[m][w],a);Cu(r,C),v.push(C)}d.push(v)}return d}function Fd(s,r,a){const d=[];for(let m=0;m<s.length;m++){const v=wh(s[m],r,a);d.push(v)}return d}function Cl(s,r,a,d){if(s[0]<a[0]||s[0]>a[2]){const m=.5*d;let v=s[0]-a[0]>m?-d:a[0]-s[0]>m?d:0;v===0&&(v=s[0]-a[2]>m?-d:a[2]-s[0]>m?d:0),s[0]+=v}Cu(r,s)}function no(s,r,a,d){const m=Math.pow(2,d.z)*Ia,v=[d.x*Ia,d.y*Ia],w=[];if(!s)return w;for(const C of s)for(const I of C){const P=[I.x+v[0],I.y+v[1]];Cl(P,r,a,m),w.push(P)}return w}function Th(s,r,a,d){const m=Math.pow(2,d.z)*Ia,v=[d.x*Ia,d.y*Ia],w=[];if(!s)return w;for(const I of s){const P=[];for(const B of I){const F=[B.x+v[0],B.y+v[1]];Cu(r,F),P.push(F)}w.push(P)}if(r[2]-r[0]<=m/2){(C=r)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const I of w)for(const P of I)Cl(P,r,a,m)}var C;return w}class Jl{constructor(r,a){this.type=Wn,this.geojson=r,this.geometries=a}static parse(r,a){if(r.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(ni(r[1])){const d=r[1];if(d.type==="FeatureCollection")for(let m=0;m<d.features.length;++m){const v=d.features[m].geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Jl(d,d.features[m].geometry)}else if(d.type==="Feature"){const m=d.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Jl(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new Jl(d,d)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return(function(a,d){const m=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],w=a.canonicalID();if(!w)return!1;if(d.type==="Polygon"){const C=wh(d.coordinates,v,w),I=no(a.geometry(),m,v,w);if(!Ra(m,v))return!1;for(const P of I)if(!Ql(P,C))return!1}if(d.type==="MultiPolygon"){const C=Fd(d.coordinates,v,w),I=no(a.geometry(),m,v,w);if(!Ra(m,v))return!1;for(const P of I)if(!xh(P,C))return!1}return!0})(r,this.geometries);if(r.geometryType()==="LineString")return(function(a,d){const m=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],w=a.canonicalID();if(!w)return!1;if(d.type==="Polygon"){const C=wh(d.coordinates,v,w),I=Th(a.geometry(),m,v,w);if(!Ra(m,v))return!1;for(const P of I)if(!Lr(P,C))return!1}if(d.type==="MultiPolygon"){const C=Fd(d.coordinates,v,w),I=Th(a.geometry(),m,v,w);if(!Ra(m,v))return!1;for(const P of I)if(!Zf(P,C))return!1}return!0})(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Ma=Jl;function R(s){if(s instanceof aa&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof Ma)return!1;let r=!0;return s.eachChild((a=>{r&&!R(a)&&(r=!1)})),r}function H(s){if(s instanceof aa&&s.name==="feature-state")return!1;let r=!0;return s.eachChild((a=>{r&&!H(a)&&(r=!1)})),r}function ie(s,r){if(s instanceof aa&&r.indexOf(s.name)>=0)return!1;let a=!0;return s.eachChild((d=>{a&&!ie(d,r)&&(a=!1)})),a}class Ae{constructor(r,a){this.type=a.type,this.name=r,this.boundExpression=a}static parse(r,a){if(r.length!==2||typeof r[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const d=r[1];return a.scope.has(d)?new Ae(d,a.scope.get(d)):a.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var ht=Ae;class yt{constructor(r,a=[],d,m=new ui,v=[]){this.registry=r,this.path=a,this.key=a.map((w=>`[${w}]`)).join(""),this.scope=m,this.errors=v,this.expectedType=d}parse(r,a,d,m,v={}){return a?this.concat(a,d,m)._parse(r,v):this._parse(r,v)}_parse(r,a){function d(m,v,w){return w==="assert"?new Wi(v,[m]):w==="coerce"?new oa(v,[m]):m}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=r[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[m];if(v){let w=v.parse(r,this);if(!w)return null;if(this.expectedType){const C=this.expectedType,I=w.type;if(C.kind!=="string"&&C.kind!=="number"&&C.kind!=="boolean"&&C.kind!=="object"&&C.kind!=="array"||I.kind!=="value")if(C.kind!=="color"&&C.kind!=="formatted"&&C.kind!=="resolvedImage"||I.kind!=="value"&&I.kind!=="string"){if(this.checkSubtype(C,I))return null}else w=d(w,C,a.typeAnnotation||"coerce");else w=d(w,C,a.typeAnnotation||"assert")}if(!(w instanceof nl)&&w.type.kind!=="resolvedImage"&&gr(w)){const C=new Ca;try{w=new nl(w.type,w.evaluate(C))}catch(I){return this.error(I.message),null}}return w}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,a,d){const m=typeof r=="number"?this.path.concat(r):this.path,v=d?this.scope.concat(d):this.scope;return new yt(this.registry,m,a||null,v,this.errors)}error(r,...a){const d=`${this.key}${a.map((m=>`[${m}]`)).join("")}`;this.errors.push(new qs(d,r))}checkSubtype(r,a){const d=na(r,a);return d&&this.error(d),d}}var pn=yt;function gr(s){if(s instanceof ht)return gr(s.boundExpression);if(s instanceof aa&&s.name==="error"||s instanceof il||s instanceof Ma)return!1;const r=s instanceof oa||s instanceof Wi;let a=!0;return s.eachChild((d=>{a=r?a&&gr(d):a&&d instanceof nl})),!!a&&R(s)&&ie(s,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Qi(s,r){const a=s.length-1;let d,m,v=0,w=a,C=0;for(;v<=w;)if(C=Math.floor((v+w)/2),d=s[C],m=s[C+1],d<=r){if(C===a||r<m)return C;v=C+1}else{if(!(d>r))throw new is("Input is not a number.");w=C-1}return 0}class $r{constructor(r,a,d){this.type=r,this.input=a,this.labels=[],this.outputs=[];for(const[m,v]of d)this.labels.push(m),this.outputs.push(v)}static parse(r,a){if(r.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return a.error("Expected an even number of arguments.");const d=a.parse(r[1],1,nn);if(!d)return null;const m=[];let v=null;a.expectedType&&a.expectedType.kind!=="value"&&(v=a.expectedType);for(let w=1;w<r.length;w+=2){const C=w===1?-1/0:r[w],I=r[w+1],P=w,B=w+1;if(typeof C!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(m.length&&m[m.length-1][0]>=C)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const F=a.parse(I,B,v);if(!F)return null;v=v||F.type,m.push([C,F])}return new $r(v,d,m)}evaluate(r){const a=this.labels,d=this.outputs;if(a.length===1)return d[0].evaluate(r);const m=this.input.evaluate(r);if(m<=a[0])return d[0].evaluate(r);const v=a.length;return m>=a[v-1]?d[v-1].evaluate(r):d[Qi(a,m)].evaluate(r)}eachChild(r){r(this.input);for(const a of this.outputs)r(a)}outputDefined(){return this.outputs.every((r=>r.outputDefined()))}serialize(){const r=["step",this.input.serialize()];for(let a=0;a<this.labels.length;a++)a>0&&r.push(this.labels[a]),r.push(this.outputs[a].serialize());return r}}var Vi=$r;function nr(s,r,a){return s*(1-a)+r*a}var Ho=Object.freeze({__proto__:null,array:function(s,r,a){return s.map(((d,m)=>nr(d,r[m],a)))},color:function(s,r,a){return new Ti(nr(s.r,r.r,a),nr(s.g,r.g,a),nr(s.b,r.b,a),nr(s.a,r.a,a))},number:nr});const Pa=.95047,la=1.08883,kc=4/29,ka=6/29,Dc=3*ka*ka,uv=ka*ka*ka,hv=Math.PI/180,dv=180/Math.PI;function Kf(s){return s>uv?Math.pow(s,1/3):s/Dc+kc}function Yf(s){return s>ka?s*s*s:Dc*(s-kc)}function Au(s){return 255*(s<=.0031308?12.92*s:1.055*Math.pow(s,1/2.4)-.055)}function Lc(s){return(s/=255)<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function Kg(s){const r=Lc(s.r),a=Lc(s.g),d=Lc(s.b),m=Kf((.4124564*r+.3575761*a+.1804375*d)/Pa),v=Kf((.2126729*r+.7151522*a+.072175*d)/1);return{l:116*v-16,a:500*(m-v),b:200*(v-Kf((.0193339*r+.119192*a+.9503041*d)/la)),alpha:s.a}}function Ud(s){let r=(s.l+16)/116,a=isNaN(s.a)?r:r+s.a/500,d=isNaN(s.b)?r:r-s.b/200;return r=1*Yf(r),a=Pa*Yf(a),d=la*Yf(d),new Ti(Au(3.2404542*a-1.5371385*r-.4985314*d),Au(-.969266*a+1.8760108*r+.041556*d),Au(.0556434*a-.2040259*r+1.0572252*d),s.alpha)}function Yg(s,r,a){const d=r-s;return s+a*(d>180||d<-180?d-360*Math.round(d/360):d)}const Eh={forward:Kg,reverse:Ud,interpolate:function(s,r,a){return{l:nr(s.l,r.l,a),a:nr(s.a,r.a,a),b:nr(s.b,r.b,a),alpha:nr(s.alpha,r.alpha,a)}}},Oc={forward:function(s){const{l:r,a,b:d}=Kg(s),m=Math.atan2(d,a)*dv;return{h:m<0?m+360:m,c:Math.sqrt(a*a+d*d),l:r,alpha:s.a}},reverse:function(s){const r=s.h*hv,a=s.c;return Ud({l:s.l,a:Math.cos(r)*a,b:Math.sin(r)*a,alpha:s.alpha})},interpolate:function(s,r,a){return{h:Yg(s.h,r.h,a),c:nr(s.c,r.c,a),l:nr(s.l,r.l,a),alpha:nr(s.alpha,r.alpha,a)}}};var jd=Object.freeze({__proto__:null,hcl:Oc,lab:Eh});class Sh{constructor(r,a,d,m,v){this.type=r,this.operator=a,this.interpolation=d,this.input=m,this.labels=[],this.outputs=[];for(const[w,C]of v)this.labels.push(w),this.outputs.push(C)}static interpolationFactor(r,a,d,m){let v=0;if(r.name==="exponential")v=Qf(a,r.base,d,m);else if(r.name==="linear")v=Qf(a,1,d,m);else if(r.name==="cubic-bezier"){const w=r.controlPoints;v=new ae(w[0],w[1],w[2],w[3]).solve(Qf(a,1,d,m))}return v}static parse(r,a){let[d,m,v,...w]=r;if(!Array.isArray(m)||m.length===0)return a.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const P=m[1];if(typeof P!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:P}}else{if(m[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const P=m.slice(1);if(P.length!==4||P.some((B=>typeof B!="number"||B<0||B>1)))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:P}}}if(r.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(v=a.parse(v,2,nn),!v)return null;const C=[];let I=null;d==="interpolate-hcl"||d==="interpolate-lab"?I=Ds:a.expectedType&&a.expectedType.kind!=="value"&&(I=a.expectedType);for(let P=0;P<w.length;P+=2){const B=w[P],F=w[P+1],$=P+3,X=P+4;if(typeof B!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(C.length&&C[C.length-1][0]>=B)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const J=a.parse(F,X,I);if(!J)return null;I=I||J.type,C.push([B,J])}return I.kind==="number"||I.kind==="color"||I.kind==="array"&&I.itemType.kind==="number"&&typeof I.N=="number"?new Sh(I,d,m,v,C):a.error(`Type ${gi(I)} is not interpolatable.`)}evaluate(r){const a=this.labels,d=this.outputs;if(a.length===1)return d[0].evaluate(r);const m=this.input.evaluate(r);if(m<=a[0])return d[0].evaluate(r);const v=a.length;if(m>=a[v-1])return d[v-1].evaluate(r);const w=Qi(a,m),C=Sh.interpolationFactor(this.interpolation,m,a[w],a[w+1]),I=d[w].evaluate(r),P=d[w+1].evaluate(r);return this.operator==="interpolate"?Ho[this.type.kind.toLowerCase()](I,P,C):this.operator==="interpolate-hcl"?Oc.reverse(Oc.interpolate(Oc.forward(I),Oc.forward(P),C)):Eh.reverse(Eh.interpolate(Eh.forward(I),Eh.forward(P),C))}eachChild(r){r(this.input);for(const a of this.outputs)r(a)}outputDefined(){return this.outputs.every((r=>r.outputDefined()))}serialize(){let r;r=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const a=[this.operator,r,this.input.serialize()];for(let d=0;d<this.labels.length;d++)a.push(this.labels[d],this.outputs[d].serialize());return a}}function Qf(s,r,a,d){const m=d-a,v=s-a;return m===0?0:r===1?v/m:(Math.pow(r,v)-1)/(Math.pow(r,m)-1)}var sl=Sh;class Jf{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expectected at least one argument.");let d=null;const m=a.expectedType;m&&m.kind!=="value"&&(d=m);const v=[];for(const C of r.slice(1)){const I=a.parse(C,1+v.length,d,void 0,{typeAnnotation:"omit"});if(!I)return null;d=d||I.type,v.push(I)}const w=m&&v.some((C=>na(m,C.type)));return new Jf(w?or:d,v)}evaluate(r){let a,d=null,m=0;for(const v of this.args){if(m++,d=v.evaluate(r),d&&d instanceof rs&&!d.available&&(a||(a=d),d=null,m===this.args.length))return a;if(d!==null)break}return d}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every((r=>r.outputDefined()))}serialize(){const r=["coalesce"];return this.eachChild((a=>{r.push(a.serialize())})),r}}var Am=Jf;class ep{constructor(r,a){this.type=a.type,this.bindings=[].concat(r),this.result=a}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const a of this.bindings)r(a[1]);r(this.result)}static parse(r,a){if(r.length<4)return a.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const d=[];for(let v=1;v<r.length-1;v+=2){const w=r[v];if(typeof w!="string")return a.error(`Expected string, but found ${typeof w} instead.`,v);if(/[^a-zA-Z0-9_]/.test(w))return a.error("Variable names must contain only alphanumeric characters or '_'.",v);const C=a.parse(r[v+1],v+1);if(!C)return null;d.push([w,C])}const m=a.parse(r[r.length-1],r.length-1,a.expectedType,d);return m?new ep(d,m):null}outputDefined(){return this.result.outputDefined()}serialize(){const r=["let"];for(const[a,d]of this.bindings)r.push(a,d.serialize());return r.push(this.result.serialize()),r}}var Qg=ep;class Im{constructor(r,a,d){this.type=r,this.index=a,this.input=d}static parse(r,a){if(r.length!==3)return a.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const d=a.parse(r[1],1,nn),m=a.parse(r[2],2,Hi(a.expectedType||or));return d&&m?new Im(m.type.itemType,d,m):null}evaluate(r){const a=this.index.evaluate(r),d=this.input.evaluate(r);if(a<0)throw new is(`Array index out of bounds: ${a} < 0.`);if(a>=d.length)throw new is(`Array index out of bounds: ${a} > ${d.length-1}.`);if(a!==Math.floor(a))throw new is(`Array index must be an integer, but found ${a} instead.`);return d[a]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var ca=Im;class Iu{constructor(r,a){this.type=Wn,this.needle=r,this.haystack=a}static parse(r,a){if(r.length!==3)return a.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const d=a.parse(r[1],1,or),m=a.parse(r[2],2,or);return d&&m?Tl(d.type,[Wn,sr,nn,Sa,or])?new Iu(d,m):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${gi(d.type)} instead`):null}evaluate(r){const a=this.needle.evaluate(r),d=this.haystack.evaluate(r);if(d==null)return!1;if(!Ic(a,["boolean","string","number","null"]))throw new is(`Expected first argument to be of type boolean, string, number or null, but found ${gi(ri(a))} instead.`);if(!Ic(d,["string","array"]))throw new is(`Expected second argument to be of type array or string, but found ${gi(ri(d))} instead.`);return d.indexOf(a)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var $d=Iu;class Ch{constructor(r,a,d){this.type=nn,this.needle=r,this.haystack=a,this.fromIndex=d}static parse(r,a){if(r.length<=2||r.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const d=a.parse(r[1],1,or),m=a.parse(r[2],2,or);if(!d||!m)return null;if(!Tl(d.type,[Wn,sr,nn,Sa,or]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${gi(d.type)} instead`);if(r.length===4){const v=a.parse(r[3],3,nn);return v?new Ch(d,m,v):null}return new Ch(d,m)}evaluate(r){const a=this.needle.evaluate(r),d=this.haystack.evaluate(r);if(!Ic(a,["boolean","string","number","null"]))throw new is(`Expected first argument to be of type boolean, string, number or null, but found ${gi(ri(a))} instead.`);if(!Ic(d,["string","array"]))throw new is(`Expected second argument to be of type array or string, but found ${gi(ri(d))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(r);return d.indexOf(a,m)}return d.indexOf(a)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const r=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),r]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Rm=Ch;class tp{constructor(r,a,d,m,v,w){this.inputType=r,this.type=a,this.input=d,this.cases=m,this.outputs=v,this.otherwise=w}static parse(r,a){if(r.length<5)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return a.error("Expected an even number of arguments.");let d,m;a.expectedType&&a.expectedType.kind!=="value"&&(m=a.expectedType);const v={},w=[];for(let P=2;P<r.length-1;P+=2){let B=r[P];const F=r[P+1];Array.isArray(B)||(B=[B]);const $=a.concat(P);if(B.length===0)return $.error("Expected at least one branch label.");for(const J of B){if(typeof J!="number"&&typeof J!="string")return $.error("Branch labels must be numbers or strings.");if(typeof J=="number"&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof J=="number"&&Math.floor(J)!==J)return $.error("Numeric branch labels must be integer values.");if(d){if($.checkSubtype(d,ri(J)))return null}else d=ri(J);if(v[String(J)]!==void 0)return $.error("Branch labels must be unique.");v[String(J)]=w.length}const X=a.parse(F,P,m);if(!X)return null;m=m||X.type,w.push(X)}const C=a.parse(r[1],1,or);if(!C)return null;const I=a.parse(r[r.length-1],r.length-1,m);return I?C.type.kind!=="value"&&a.concat(1).checkSubtype(d,C.type)?null:new tp(d,m,C,v,w,I):null}evaluate(r){const a=this.input.evaluate(r);return(ri(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every((r=>r.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const r=["match",this.input.serialize()],a=Object.keys(this.cases).sort(),d=[],m={};for(const w of a){const C=m[this.cases[w]];C===void 0?(m[this.cases[w]]=d.length,d.push([this.cases[w],[w]])):d[C][1].push(w)}const v=w=>this.inputType.kind==="number"?Number(w):w;for(const[w,C]of d)r.push(C.length===1?v(C[0]):C.map(v)),r.push(this.outputs[w].serialize());return r.push(this.otherwise.serialize()),r}}var Mm=tp;class Pm{constructor(r,a,d){this.type=r,this.branches=a,this.otherwise=d}static parse(r,a){if(r.length<4)return a.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return a.error("Expected an odd number of arguments.");let d;a.expectedType&&a.expectedType.kind!=="value"&&(d=a.expectedType);const m=[];for(let w=1;w<r.length-1;w+=2){const C=a.parse(r[w],w,Wn);if(!C)return null;const I=a.parse(r[w+1],w+1,d);if(!I)return null;m.push([C,I]),d=d||I.type}const v=a.parse(r[r.length-1],r.length-1,d);return v?new Pm(d,m,v):null}evaluate(r){for(const[a,d]of this.branches)if(a.evaluate(r))return d.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[a,d]of this.branches)r(a),r(d);r(this.otherwise)}outputDefined(){return this.branches.every((([r,a])=>a.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const r=["case"];return this.eachChild((a=>{r.push(a.serialize())})),r}}var Ru=Pm;class Mu{constructor(r,a,d,m){this.type=r,this.input=a,this.beginIndex=d,this.endIndex=m}static parse(r,a){if(r.length<=2||r.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const d=a.parse(r[1],1,or),m=a.parse(r[2],2,nn);if(!d||!m)return null;if(!Tl(d.type,[Hi(or),sr,or]))return a.error(`Expected first argument to be of type array or string, but found ${gi(d.type)} instead`);if(r.length===4){const v=a.parse(r[3],3,nn);return v?new Mu(d.type,d,m,v):null}return new Mu(d.type,d,m)}evaluate(r){const a=this.input.evaluate(r),d=this.beginIndex.evaluate(r);if(!Ic(a,["string","array"]))throw new is(`Expected first argument to be of type array or string, but found ${gi(ri(a))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(r);return a.slice(d,m)}return a.slice(d)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const r=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),r]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Ah=Mu;function Ih(s,r){return s==="=="||s==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function km(s,r,a,d){return d.compare(r,a)===0}function Da(s,r,a){const d=s!=="=="&&s!=="!=";return class SV{constructor(v,w,C){this.type=Wn,this.lhs=v,this.rhs=w,this.collator=C,this.hasUntypedArgument=v.type.kind==="value"||w.type.kind==="value"}static parse(v,w){if(v.length!==3&&v.length!==4)return w.error("Expected two or three arguments.");const C=v[0];let I=w.parse(v[1],1,or);if(!I)return null;if(!Ih(C,I.type))return w.concat(1).error(`"${C}" comparisons are not supported for type '${gi(I.type)}'.`);let P=w.parse(v[2],2,or);if(!P)return null;if(!Ih(C,P.type))return w.concat(2).error(`"${C}" comparisons are not supported for type '${gi(P.type)}'.`);if(I.type.kind!==P.type.kind&&I.type.kind!=="value"&&P.type.kind!=="value")return w.error(`Cannot compare types '${gi(I.type)}' and '${gi(P.type)}'.`);d&&(I.type.kind==="value"&&P.type.kind!=="value"?I=new Wi(P.type,[I]):I.type.kind!=="value"&&P.type.kind==="value"&&(P=new Wi(I.type,[P])));let B=null;if(v.length===4){if(I.type.kind!=="string"&&P.type.kind!=="string"&&I.type.kind!=="value"&&P.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(B=w.parse(v[3],3,ys),!B)return null}return new SV(I,P,B)}evaluate(v){const w=this.lhs.evaluate(v),C=this.rhs.evaluate(v);if(d&&this.hasUntypedArgument){const I=ri(w),P=ri(C);if(I.kind!==P.kind||I.kind!=="string"&&I.kind!=="number")throw new is(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${I.kind}, ${P.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const I=ri(w),P=ri(C);if(I.kind!=="string"||P.kind!=="string")return r(v,w,C)}return this.collator?a(v,w,C,this.collator.evaluate(v)):r(v,w,C)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}serialize(){const v=[s];return this.eachChild((w=>{v.push(w.serialize())})),v}}}const Rh=Da("==",(function(s,r,a){return r===a}),km),Dm=Da("!=",(function(s,r,a){return r!==a}),(function(s,r,a,d){return!km(0,r,a,d)})),Jg=Da("<",(function(s,r,a){return r<a}),(function(s,r,a,d){return d.compare(r,a)<0})),Pu=Da(">",(function(s,r,a){return r>a}),(function(s,r,a,d){return d.compare(r,a)>0})),ey=Da("<=",(function(s,r,a){return r<=a}),(function(s,r,a,d){return d.compare(r,a)<=0})),Lm=Da(">=",(function(s,r,a){return r>=a}),(function(s,r,a,d){return d.compare(r,a)>=0}));class qd{constructor(r,a,d,m,v,w){this.type=sr,this.number=r,this.locale=a,this.currency=d,this.unit=m,this.minFractionDigits=v,this.maxFractionDigits=w}static parse(r,a){if(r.length!==3)return a.error("Expected two arguments.");const d=a.parse(r[1],1,nn);if(!d)return null;const m=r[2];if(typeof m!="object"||Array.isArray(m))return a.error("NumberFormat options argument must be an object.");let v=null;if(m.locale&&(v=a.parse(m.locale,1,sr),!v))return null;let w=null;if(m.currency&&(w=a.parse(m.currency,1,sr),!w))return null;let C=null;if(m.unit&&(C=a.parse(m.unit,1,sr),!C))return null;let I=null;if(m["min-fraction-digits"]&&(I=a.parse(m["min-fraction-digits"],1,nn),!I))return null;let P=null;return m["max-fraction-digits"]&&(P=a.parse(m["max-fraction-digits"],1,nn),!P)?null:new qd(d,v,w,C,I,P)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(r):void 0,unit:this.unit?this.unit.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.unit&&r(this.unit),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.unit&&(r.unit=this.unit.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]}}class Mh{constructor(r){this.type=nn,this.input=r}static parse(r,a){if(r.length!==2)return a.error(`Expected 1 argument, but found ${r.length-1} instead.`);const d=a.parse(r[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${gi(d.type)} instead.`):new Mh(d):null}evaluate(r){const a=this.input.evaluate(r);if(typeof a=="string"||Array.isArray(a))return a.length;throw new is(`Expected value to be of type string or array, but found ${gi(ri(a))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){const r=["length"];return this.eachChild((a=>{r.push(a.serialize())})),r}}const ty={"==":Rh,"!=":Dm,">":Pu,"<":Jg,">=":Lm,"<=":ey,array:Wi,at:ca,boolean:Wi,case:Ru,coalesce:Am,collator:il,format:to,image:sa,in:$d,"index-of":Rm,interpolate:sl,"interpolate-hcl":sl,"interpolate-lab":sl,length:Mh,let:Qg,literal:nl,match:Mm,number:Wi,"number-format":qd,object:Wi,slice:Ah,step:Vi,string:Wi,"to-boolean":oa,"to-color":oa,"to-number":oa,"to-string":oa,var:ht,within:Ma};function ny(s,[r,a,d,m]){r=r.evaluate(s),a=a.evaluate(s),d=d.evaluate(s);const v=m?m.evaluate(s):1,w=Mc(r,a,d,v);if(w)throw new is(w);return new Ti(r/255*v,a/255*v,d/255*v,v)}function Al(s,r){return s in r}function Gd(s,r){const a=r[s];return a===void 0?null:a}function Wo(s){return{type:s}}aa.register(ty,{error:[{kind:"error"},[sr],(s,[r])=>{throw new is(r.evaluate(s))}],typeof:[sr,[or],(s,[r])=>gi(ri(r.evaluate(s)))],"to-rgba":[Hi(nn,4),[Ds],(s,[r])=>r.evaluate(s).toArray()],rgb:[Ds,[nn,nn,nn],ny],rgba:[Ds,[nn,nn,nn,nn],ny],has:{type:Wn,overloads:[[[sr],(s,[r])=>Al(r.evaluate(s),s.properties())],[[sr,qo],(s,[r,a])=>Al(r.evaluate(s),a.evaluate(s))]]},get:{type:or,overloads:[[[sr],(s,[r])=>Gd(r.evaluate(s),s.properties())],[[sr,qo],(s,[r,a])=>Gd(r.evaluate(s),a.evaluate(s))]]},"feature-state":[or,[sr],(s,[r])=>Gd(r.evaluate(s),s.featureState||{})],properties:[qo,[],s=>s.properties()],"geometry-type":[sr,[],s=>s.geometryType()],id:[or,[],s=>s.id()],zoom:[nn,[],s=>s.globals.zoom],pitch:[nn,[],s=>s.globals.pitch||0],"distance-from-center":[nn,[],s=>s.distanceFromCenter()],"heatmap-density":[nn,[],s=>s.globals.heatmapDensity||0],"line-progress":[nn,[],s=>s.globals.lineProgress||0],"sky-radial-progress":[nn,[],s=>s.globals.skyRadialProgress||0],accumulated:[or,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[nn,Wo(nn),(s,r)=>{let a=0;for(const d of r)a+=d.evaluate(s);return a}],"*":[nn,Wo(nn),(s,r)=>{let a=1;for(const d of r)a*=d.evaluate(s);return a}],"-":{type:nn,overloads:[[[nn,nn],(s,[r,a])=>r.evaluate(s)-a.evaluate(s)],[[nn],(s,[r])=>-r.evaluate(s)]]},"/":[nn,[nn,nn],(s,[r,a])=>r.evaluate(s)/a.evaluate(s)],"%":[nn,[nn,nn],(s,[r,a])=>r.evaluate(s)%a.evaluate(s)],ln2:[nn,[],()=>Math.LN2],pi:[nn,[],()=>Math.PI],e:[nn,[],()=>Math.E],"^":[nn,[nn,nn],(s,[r,a])=>Math.pow(r.evaluate(s),a.evaluate(s))],sqrt:[nn,[nn],(s,[r])=>Math.sqrt(r.evaluate(s))],log10:[nn,[nn],(s,[r])=>Math.log(r.evaluate(s))/Math.LN10],ln:[nn,[nn],(s,[r])=>Math.log(r.evaluate(s))],log2:[nn,[nn],(s,[r])=>Math.log(r.evaluate(s))/Math.LN2],sin:[nn,[nn],(s,[r])=>Math.sin(r.evaluate(s))],cos:[nn,[nn],(s,[r])=>Math.cos(r.evaluate(s))],tan:[nn,[nn],(s,[r])=>Math.tan(r.evaluate(s))],asin:[nn,[nn],(s,[r])=>Math.asin(r.evaluate(s))],acos:[nn,[nn],(s,[r])=>Math.acos(r.evaluate(s))],atan:[nn,[nn],(s,[r])=>Math.atan(r.evaluate(s))],min:[nn,Wo(nn),(s,r)=>Math.min(...r.map((a=>a.evaluate(s))))],max:[nn,Wo(nn),(s,r)=>Math.max(...r.map((a=>a.evaluate(s))))],abs:[nn,[nn],(s,[r])=>Math.abs(r.evaluate(s))],round:[nn,[nn],(s,[r])=>{const a=r.evaluate(s);return a<0?-Math.round(-a):Math.round(a)}],floor:[nn,[nn],(s,[r])=>Math.floor(r.evaluate(s))],ceil:[nn,[nn],(s,[r])=>Math.ceil(r.evaluate(s))],"filter-==":[Wn,[sr,or],(s,[r,a])=>s.properties()[r.value]===a.value],"filter-id-==":[Wn,[or],(s,[r])=>s.id()===r.value],"filter-type-==":[Wn,[sr],(s,[r])=>s.geometryType()===r.value],"filter-<":[Wn,[sr,or],(s,[r,a])=>{const d=s.properties()[r.value],m=a.value;return typeof d==typeof m&&d<m}],"filter-id-<":[Wn,[or],(s,[r])=>{const a=s.id(),d=r.value;return typeof a==typeof d&&a<d}],"filter->":[Wn,[sr,or],(s,[r,a])=>{const d=s.properties()[r.value],m=a.value;return typeof d==typeof m&&d>m}],"filter-id->":[Wn,[or],(s,[r])=>{const a=s.id(),d=r.value;return typeof a==typeof d&&a>d}],"filter-<=":[Wn,[sr,or],(s,[r,a])=>{const d=s.properties()[r.value],m=a.value;return typeof d==typeof m&&d<=m}],"filter-id-<=":[Wn,[or],(s,[r])=>{const a=s.id(),d=r.value;return typeof a==typeof d&&a<=d}],"filter->=":[Wn,[sr,or],(s,[r,a])=>{const d=s.properties()[r.value],m=a.value;return typeof d==typeof m&&d>=m}],"filter-id->=":[Wn,[or],(s,[r])=>{const a=s.id(),d=r.value;return typeof a==typeof d&&a>=d}],"filter-has":[Wn,[or],(s,[r])=>r.value in s.properties()],"filter-has-id":[Wn,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[Wn,[Hi(sr)],(s,[r])=>r.value.indexOf(s.geometryType())>=0],"filter-id-in":[Wn,[Hi(or)],(s,[r])=>r.value.indexOf(s.id())>=0],"filter-in-small":[Wn,[sr,Hi(or)],(s,[r,a])=>a.value.indexOf(s.properties()[r.value])>=0],"filter-in-large":[Wn,[sr,Hi(or)],(s,[r,a])=>(function(d,m,v,w){for(;v<=w;){const C=v+w>>1;if(m[C]===d)return!0;m[C]>d?w=C-1:v=C+1}return!1})(s.properties()[r.value],a.value,0,a.value.length-1)],all:{type:Wn,overloads:[[[Wn,Wn],(s,[r,a])=>r.evaluate(s)&&a.evaluate(s)],[Wo(Wn),(s,r)=>{for(const a of r)if(!a.evaluate(s))return!1;return!0}]]},any:{type:Wn,overloads:[[[Wn,Wn],(s,[r,a])=>r.evaluate(s)||a.evaluate(s)],[Wo(Wn),(s,r)=>{for(const a of r)if(a.evaluate(s))return!0;return!1}]]},"!":[Wn,[Wn],(s,[r])=>!r.evaluate(s)],"is-supported-script":[Wn,[sr],(s,[r])=>{const a=s.globals&&s.globals.isSupportedScript;return!a||a(r.evaluate(s))}],upcase:[sr,[sr],(s,[r])=>r.evaluate(s).toUpperCase()],downcase:[sr,[sr],(s,[r])=>r.evaluate(s).toLowerCase()],concat:[sr,Wo(or),(s,r)=>r.map((a=>Zl(a.evaluate(s)))).join("")],"resolved-locale":[sr,[ys],(s,[r])=>r.evaluate(s).resolvedLocale()]});var Ro=ty;function Hd(s){return{result:"success",value:s}}function Ls(s){return{result:"error",value:s}}function ol(s){return s["property-type"]==="data-driven"}function Ph(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function ku(s){return!!s.expression&&s.expression.interpolated}function Mr(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function Du(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function zc(s){return s}function Wd(s,r){const a=r.type==="color",d=s.stops&&typeof s.stops[0][0]=="object",m=d||!(d||s.property!==void 0),v=s.type||(ku(r)?"exponential":"interval");if(a&&((s=$o({},s)).stops&&(s.stops=s.stops.map((P=>[P[0],Ti.parse(P[1])]))),s.default=Ti.parse(s.default?s.default:r.default)),s.colorSpace&&s.colorSpace!=="rgb"&&!jd[s.colorSpace])throw new Error(`Unknown color space: ${s.colorSpace}`);let w,C,I;if(v==="exponential")w=ds;else if(v==="interval")w=np;else if(v==="categorical"){w=Lu,C=Object.create(null);for(const P of s.stops)C[P[0]]=P[1];I=typeof s.stops[0][0]}else{if(v!=="identity")throw new Error(`Unknown function type "${v}"`);w=rp}if(d){const P={},B=[];for(let X=0;X<s.stops.length;X++){const J=s.stops[X],oe=J[0].zoom;P[oe]===void 0&&(P[oe]={zoom:oe,type:s.type,property:s.property,default:s.default,stops:[]},B.push(oe)),P[oe].stops.push([J[0].value,J[1]])}const F=[];for(const X of B)F.push([P[X].zoom,Wd(P[X],r)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:sl.interpolationFactor.bind(void 0,$),zoomStops:F.map((X=>X[0])),evaluate:({zoom:X},J)=>ds({stops:F,base:s.base},r,X).evaluate(X,J)}}if(m){const P=v==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:P,interpolationFactor:sl.interpolationFactor.bind(void 0,P),zoomStops:s.stops.map((B=>B[0])),evaluate:({zoom:B})=>w(s,r,B,C,I)}}return{kind:"source",evaluate(P,B){const F=B&&B.properties?B.properties[s.property]:void 0;return F===void 0?ec(s.default,r.default):w(s,r,F,C,I)}}}function ec(s,r,a){return s!==void 0?s:r!==void 0?r:a!==void 0?a:void 0}function Lu(s,r,a,d,m){return ec(typeof a===m?d[a]:void 0,s.default,r.default)}function np(s,r,a){if(Mr(a)!=="number")return ec(s.default,r.default);const d=s.stops.length;if(d===1||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[d-1][0])return s.stops[d-1][1];const m=Qi(s.stops.map((v=>v[0])),a);return s.stops[m][1]}function ds(s,r,a){const d=s.base!==void 0?s.base:1;if(Mr(a)!=="number")return ec(s.default,r.default);const m=s.stops.length;if(m===1||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[m-1][0])return s.stops[m-1][1];const v=Qi(s.stops.map((B=>B[0])),a),w=(function(B,F,$,X){const J=X-$,oe=B-$;return J===0?0:F===1?oe/J:(Math.pow(F,oe)-1)/(Math.pow(F,J)-1)})(a,d,s.stops[v][0],s.stops[v+1][0]),C=s.stops[v][1],I=s.stops[v+1][1];let P=Ho[r.type]||zc;if(s.colorSpace&&s.colorSpace!=="rgb"){const B=jd[s.colorSpace];P=(F,$)=>B.reverse(B.interpolate(B.forward(F),B.forward($),w))}return typeof C.evaluate=="function"?{evaluate(...B){const F=C.evaluate.apply(void 0,B),$=I.evaluate.apply(void 0,B);if(F!==void 0&&$!==void 0)return P(F,$,w)}}:P(C,I,w)}function rp(s,r,a){return r.type==="color"?a=Ti.parse(a):r.type==="formatted"?a=Yi.fromString(a.toString()):r.type==="resolvedImage"?a=rs.fromString(a.toString()):Mr(a)===r.type||r.type==="enum"&&r.values[a]||(a=void 0),ec(a,s.default,r.default)}class La{constructor(r,a){this.expression=r,this._warningHistory={},this._evaluator=new Ca,this._defaultValue=a?(function(d){return d.type==="color"&&(Du(d.default)||Array.isArray(d.default))?new Ti(0,0,0,0):d.type==="color"?Ti.parse(d.default)||null:d.default===void 0?null:d.default})(a):null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(r,a,d,m,v,w,C,I){return this._evaluator.globals=r,this._evaluator.feature=a,this._evaluator.featureState=d,this._evaluator.canonical=m||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=w,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=I||null,this.expression.evaluate(this._evaluator)}evaluate(r,a,d,m,v,w,C,I){this._evaluator.globals=r,this._evaluator.feature=a||null,this._evaluator.featureState=d||null,this._evaluator.canonical=m||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=w||null,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=I||null;try{const P=this.expression.evaluate(this._evaluator);if(P==null||typeof P=="number"&&P!=P)return this._defaultValue;if(this._enumValues&&!(P in this._enumValues))throw new is(`Expected value to be one of ${Object.keys(this._enumValues).map((B=>JSON.stringify(B))).join(", ")}, but found ${JSON.stringify(P)} instead.`);return P}catch(P){return this._warningHistory[P.message]||(this._warningHistory[P.message]=!0,typeof console<"u"&&console.warn(P.message)),this._defaultValue}}}function Ou(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in Ro}function tc(s,r){const a=new pn(Ro,[],r?(function(m){const v={color:Ds,string:sr,number:nn,enum:sr,boolean:Wn,formatted:Ac,resolvedImage:Go};return m.type==="array"?Hi(v[m.value]||or,m.length):v[m.type]})(r):void 0),d=a.parse(s,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?Hd(new La(d,r)):Ls(a.errors)}class nc{constructor(r,a){this.kind=r,this._styleExpression=a,this.isStateDependent=r!=="constant"&&!H(a.expression)}evaluateWithoutErrorHandling(r,a,d,m,v,w){return this._styleExpression.evaluateWithoutErrorHandling(r,a,d,m,v,w)}evaluate(r,a,d,m,v,w){return this._styleExpression.evaluate(r,a,d,m,v,w)}}class zu{constructor(r,a,d,m){this.kind=r,this.zoomStops=d,this._styleExpression=a,this.isStateDependent=r!=="camera"&&!H(a.expression),this.interpolationType=m}evaluateWithoutErrorHandling(r,a,d,m,v,w){return this._styleExpression.evaluateWithoutErrorHandling(r,a,d,m,v,w)}evaluate(r,a,d,m,v,w){return this._styleExpression.evaluate(r,a,d,m,v,w)}interpolationFactor(r,a,d){return this.interpolationType?sl.interpolationFactor(this.interpolationType,r,a,d):0}}function kh(s,r){if((s=tc(s,r)).result==="error")return s;const a=s.value.expression,d=R(a);if(!d&&!ol(r))return Ls([new qs("","data expressions not supported")]);const m=ie(a,["zoom","pitch","distance-from-center"]);if(!m&&!Ph(r))return Ls([new qs("","zoom expressions not supported")]);const v=Xd(a);return v||m?v instanceof qs?Ls([v]):v instanceof sl&&!ku(r)?Ls([new qs("",'"interpolate" expressions cannot be used with this property')]):Hd(v?new zu(d?"camera":"composite",s.value,v.labels,v instanceof sl?v.interpolation:void 0):new nc(d?"constant":"source",s.value)):Ls([new qs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Dh{constructor(r,a){this._parameters=r,this._specification=a,$o(this,Wd(this._parameters,this._specification))}static deserialize(r){return new Dh(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function Xd(s){let r=null;if(s instanceof Qg)r=Xd(s.result);else if(s instanceof Am){for(const a of s.args)if(r=Xd(a),r)break}else(s instanceof Vi||s instanceof sl)&&s.input instanceof aa&&s.input.name==="zoom"&&(r=s);return r instanceof qs||s.eachChild((a=>{const d=Xd(a);d instanceof qs?r=d:!r&&d?r=new qs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&d&&r!==d&&(r=new qs("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),r}class rn{constructor(r,a,d,m){this.message=(r?`${r}: `:"")+d,m&&(this.identifier=m),a!=null&&a.__line__&&(this.line=a.__line__)}}function ro(s){const r=s.key,a=s.value,d=s.valueSpec||{},m=s.objectElementValidators||{},v=s.style,w=s.styleSpec;let C=[];const I=Mr(a);if(I!=="object")return[new rn(r,a,`object expected, ${I} found`)];for(const P in a){const B=P.split(".")[0];let F;m[B]?F=m[B]:d[B]?F=fs:m["*"]?F=m["*"]:d["*"]&&(F=fs),F?C=C.concat(F({key:(r&&`${r}.`)+P,value:a[P],valueSpec:d[B]||d["*"],style:v,styleSpec:w,object:a,objectKey:P},a)):C.push(new rn(r,a[P],`unknown property "${P}"`))}for(const P in d)m[P]||d[P].required&&d[P].default===void 0&&a[P]===void 0&&C.push(new rn(r,a,`missing required property "${P}"`));return C}function Bu(s){const r=s.value,a=s.valueSpec,d=s.style,m=s.styleSpec,v=s.key,w=s.arrayElementValidator||fs;if(Mr(r)!=="array")return[new rn(v,r,`array expected, ${Mr(r)} found`)];if(a.length&&r.length!==a.length)return[new rn(v,r,`array length ${a.length} expected, length ${r.length} found`)];if(a["min-length"]&&r.length<a["min-length"])return[new rn(v,r,`array length at least ${a["min-length"]} expected, length ${r.length} found`)];let C={type:a.value,values:a.values,minimum:a.minimum,maximum:a.maximum,function:void 0};m.$version<7&&(C.function=a.function),Mr(a.value)==="object"&&(C=a.value);let I=[];for(let P=0;P<r.length;P++)I=I.concat(w({array:r,arrayIndex:P,value:r[P],valueSpec:C,style:d,styleSpec:m,key:`${v}[${P}]`}));return I}function Bc(s){const r=s.key,a=s.value,d=s.valueSpec;let m=Mr(a);if(m==="number"&&a!=a&&(m="NaN"),m!=="number")return[new rn(r,a,`number expected, ${m} found`)];if("minimum"in d){let v=d.minimum;if(Mr(d.minimum)==="array"&&(v=d.minimum[s.arrayIndex]),a<v)return[new rn(r,a,`${a} is less than the minimum value ${v}`)]}if("maximum"in d){let v=d.maximum;if(Mr(d.maximum)==="array"&&(v=d.maximum[s.arrayIndex]),a>v)return[new rn(r,a,`${a} is greater than the maximum value ${v}`)]}return[]}function rc(s){const r=s.valueSpec,a=Zr(s.value.type);let d,m,v,w={};const C=a!=="categorical"&&s.value.property===void 0,I=!C,P=Mr(s.value.stops)==="array"&&Mr(s.value.stops[0])==="array"&&Mr(s.value.stops[0][0])==="object",B=ro({key:s.key,value:s.value,valueSpec:s.styleSpec.function,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(X){if(a==="identity")return[new rn(X.key,X.value,'identity function may not have a "stops" property')];let J=[];const oe=X.value;return J=J.concat(Bu({key:X.key,value:oe,valueSpec:X.valueSpec,style:X.style,styleSpec:X.styleSpec,arrayElementValidator:F})),Mr(oe)==="array"&&oe.length===0&&J.push(new rn(X.key,oe,"array must have at least one stop")),J},default:function(X){return fs({key:X.key,value:X.value,valueSpec:r,style:X.style,styleSpec:X.styleSpec})}}});return a==="identity"&&C&&B.push(new rn(s.key,s.value,'missing required property "property"')),a==="identity"||s.value.stops||B.push(new rn(s.key,s.value,'missing required property "stops"')),a==="exponential"&&s.valueSpec.expression&&!ku(s.valueSpec)&&B.push(new rn(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(I&&!ol(s.valueSpec)?B.push(new rn(s.key,s.value,"property functions not supported")):C&&!Ph(s.valueSpec)&&B.push(new rn(s.key,s.value,"zoom functions not supported"))),a!=="categorical"&&!P||s.value.property!==void 0||B.push(new rn(s.key,s.value,'"property" property is required')),B;function F(X){let J=[];const oe=X.value,_e=X.key;if(Mr(oe)!=="array")return[new rn(_e,oe,`array expected, ${Mr(oe)} found`)];if(oe.length!==2)return[new rn(_e,oe,`array length 2 expected, length ${oe.length} found`)];if(P){if(Mr(oe[0])!=="object")return[new rn(_e,oe,`object expected, ${Mr(oe[0])} found`)];if(oe[0].zoom===void 0)return[new rn(_e,oe,"object stop key must have zoom")];if(oe[0].value===void 0)return[new rn(_e,oe,"object stop key must have value")];const Re=Zr(oe[0].zoom);if(typeof Re!="number")return[new rn(_e,oe[0].zoom,"stop zoom values must be numbers")];if(v&&v>Re)return[new rn(_e,oe[0].zoom,"stop zoom values must appear in ascending order")];Re!==v&&(v=Re,m=void 0,w={}),J=J.concat(ro({key:`${_e}[0]`,value:oe[0],valueSpec:{zoom:{}},style:X.style,styleSpec:X.styleSpec,objectElementValidators:{zoom:Bc,value:$}}))}else J=J.concat($({key:`${_e}[0]`,value:oe[0],style:X.style,styleSpec:X.styleSpec},oe));return Ou(Dr(oe[1]))?J.concat([new rn(`${_e}[1]`,oe[1],"expressions are not allowed in function stops.")]):J.concat(fs({key:`${_e}[1]`,value:oe[1],valueSpec:r,style:X.style,styleSpec:X.styleSpec}))}function $(X,J){const oe=Mr(X.value),_e=Zr(X.value),Re=X.value!==null?X.value:J;if(d){if(oe!==d)return[new rn(X.key,Re,`${oe} stop domain type must match previous stop domain type ${d}`)]}else d=oe;if(oe!=="number"&&oe!=="string"&&oe!=="boolean"&&typeof _e!="number"&&typeof _e!="string"&&typeof _e!="boolean")return[new rn(X.key,Re,"stop domain value must be a number, string, or boolean")];if(oe!=="number"&&a!=="categorical"){let Be=`number expected, ${oe} found`;return ol(r)&&a===void 0&&(Be+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new rn(X.key,Re,Be)]}return a!=="categorical"||oe!=="number"||typeof _e=="number"&&isFinite(_e)&&Math.floor(_e)===_e?a!=="categorical"&&oe==="number"&&typeof _e=="number"&&typeof m=="number"&&m!==void 0&&_e<m?[new rn(X.key,Re,"stop domain values must appear in ascending order")]:(m=_e,a==="categorical"&&_e in w?[new rn(X.key,Re,"stop domain values must be unique")]:(w[_e]=!0,[])):[new rn(X.key,Re,`integer expected, found ${String(_e)}`)]}}function yi(s){const r=(s.expressionContext==="property"?kh:tc)(Dr(s.value),s.valueSpec);if(r.result==="error")return r.value.map((d=>new rn(`${s.key}${d.key}`,s.value,d.message)));const a=r.value.expression||r.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!a.outputDefined())return[new rn(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!H(a))return[new rn(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter")return io(a,s);if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!ie(a,["zoom","feature-state"]))return[new rn(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!R(a))return[new rn(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function io(s,r){const a=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const m of r.valueSpec.expression.parameters)a.delete(m);if(a.size===0)return[];const d=[];return s instanceof aa&&a.has(s.name)?[new rn(r.key,r.value,`["${s.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(s.eachChild((m=>{d.push(...io(m,r))})),d)}function al(s){const r=s.key,a=s.value,d=s.valueSpec,m=[];return Array.isArray(d.values)?d.values.indexOf(Zr(a))===-1&&m.push(new rn(r,a,`expected one of [${d.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(d.values).indexOf(Zr(a))===-1&&m.push(new rn(r,a,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(a)} found`)),m}function Oa(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const r of s.slice(1))if(!Oa(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}function ua(s,r="fill"){if(s==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Oa(s)||(s=hi(s));const a=s;let d=!0;try{d=(function(P){if(!Nc(P))return P;let B=Dr(P);return Zd(B),B=Il(B),B})(a)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(a,null,2)}
        `)}const m=vt[`filter_${r}`],v=tc(d,m);let w=null;if(v.result==="error")throw new Error(v.value.map((P=>`${P.key}: ${P.message}`)).join(", "));w=(P,B,F)=>v.value.evaluate(P,B,{},F);let C=null,I=null;if(d!==a){const P=tc(a,m);if(P.result==="error")throw new Error(P.value.map((B=>`${B.key}: ${B.message}`)).join(", "));C=(B,F,$,X,J)=>P.value.evaluate(B,F,{},$,void 0,void 0,X,J),I=!R(P.value.expression)}return{filter:w,dynamicFilter:C||void 0,needGeometry:Os(d),needFeature:!!I}}function Il(s){if(!Array.isArray(s))return s;const r=(function(a){if(Kd.has(a[0])){for(let d=1;d<a.length;d++)if(Nc(a[d]))return!0}return a})(s);return r===!0?r:r.map((a=>Il(a)))}function Zd(s){let r=!1;const a=[];if(s[0]==="case"){for(let d=1;d<s.length-1;d+=2)r=r||Nc(s[d]),a.push(s[d+1]);a.push(s[s.length-1])}else if(s[0]==="match"){r=r||Nc(s[1]);for(let d=2;d<s.length-1;d+=2)a.push(s[d+1]);a.push(s[s.length-1])}else if(s[0]==="step"){r=r||Nc(s[1]);for(let d=1;d<s.length-1;d+=2)a.push(s[d+1])}r&&(s.length=0,s.push("any",...a));for(let d=1;d<s.length;d++)Zd(s[d])}function Nc(s){if(!Array.isArray(s))return!1;if((r=s[0])==="pitch"||r==="distance-from-center")return!0;var r;for(let a=1;a<s.length;a++)if(Nc(s[a]))return!0;return!1}const Kd=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function ry(s,r){return s<r?-1:s>r?1:0}function Os(s){if(!Array.isArray(s))return!1;if(s[0]==="within")return!0;for(let r=1;r<s.length;r++)if(Os(s[r]))return!0;return!1}function hi(s){if(!s)return!0;const r=s[0];return s.length<=1?r!=="any":r==="=="?Or(s[1],s[2],"=="):r==="!="?Lh(Or(s[1],s[2],"==")):r==="<"||r===">"||r==="<="||r===">="?Or(s[1],s[2],r):r==="any"?(a=s.slice(1),["any"].concat(a.map(hi))):r==="all"?["all"].concat(s.slice(1).map(hi)):r==="none"?["all"].concat(s.slice(1).map(hi).map(Lh)):r==="in"?Rl(s[1],s.slice(2)):r==="!in"?Lh(Rl(s[1],s.slice(2))):r==="has"?Xo(s[1]):r==="!has"?Lh(Xo(s[1])):r!=="within"||s;var a}function Or(s,r,a){switch(s){case"$type":return[`filter-type-${a}`,r];case"$id":return[`filter-id-${a}`,r];default:return[`filter-${a}`,s,r]}}function Rl(s,r){if(r.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some((a=>typeof a!=typeof r[0]))?["filter-in-large",s,["literal",r.sort(ry)]]:["filter-in-small",s,["literal",r]]}}function Xo(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function Lh(s){return["!",s]}function za(s){return Oa(Dr(s.value))?yi($o({},s,{expressionContext:"filter",valueSpec:s.styleSpec[`filter_${s.layerType||"fill"}`]})):Oh(s)}function Oh(s){const r=s.value,a=s.key;if(Mr(r)!=="array")return[new rn(a,r,`array expected, ${Mr(r)} found`)];const d=s.styleSpec;let m,v=[];if(r.length<1)return[new rn(a,r,"filter array must have at least 1 element")];switch(v=v.concat(al({key:`${a}[0]`,value:r[0],valueSpec:d.filter_operator,style:s.style,styleSpec:s.styleSpec})),Zr(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&Zr(r[1])==="$type"&&v.push(new rn(a,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&v.push(new rn(a,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(m=Mr(r[1]),m!=="string"&&v.push(new rn(`${a}[1]`,r[1],`string expected, ${m} found`)));for(let w=2;w<r.length;w++)m=Mr(r[w]),Zr(r[1])==="$type"?v=v.concat(al({key:`${a}[${w}]`,value:r[w],valueSpec:d.geometry_type,style:s.style,styleSpec:s.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&v.push(new rn(`${a}[${w}]`,r[w],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let w=1;w<r.length;w++)v=v.concat(Oh({key:`${a}[${w}]`,value:r[w],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":m=Mr(r[1]),r.length!==2?v.push(new rn(a,r,`filter array for "${r[0]}" operator must have 2 elements`)):m!=="string"&&v.push(new rn(`${a}[1]`,r[1],`string expected, ${m} found`));break;case"within":m=Mr(r[1]),r.length!==2?v.push(new rn(a,r,`filter array for "${r[0]}" operator must have 2 elements`)):m!=="object"&&v.push(new rn(`${a}[1]`,r[1],`object expected, ${m} found`))}return v}function ip(s,r){const a=s.key,d=s.style,m=s.styleSpec,v=s.value,w=s.objectKey,C=m[`${r}_${s.layerType}`];if(!C)return[];const I=w.match(/^(.*)-transition$/);if(r==="paint"&&I&&C[I[1]]&&C[I[1]].transition)return fs({key:a,value:v,valueSpec:m.transition,style:d,styleSpec:m});const P=s.valueSpec||C[w];if(!P)return[new rn(a,v,`unknown property "${w}"`)];let B;if(Mr(v)==="string"&&ol(P)&&!P.tokens&&(B=/^{([^}]+)}$/.exec(v))){const $=`\`{ "type": "identity", "property": ${B?JSON.stringify(B[1]):'"_"'} }\``;return[new rn(a,v,`"${w}" does not support interpolation syntax
Use an identity property function instead: ${$}.`)]}const F=[];return s.layerType==="symbol"&&(w==="text-field"&&d&&!d.glyphs&&F.push(new rn(a,v,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&Du(Dr(v))&&Zr(v.type)==="identity"&&F.push(new rn(a,v,'"text-font" does not support identity functions'))),F.concat(fs({key:s.key,value:v,valueSpec:P,style:d,styleSpec:m,expressionContext:"property",propertyType:r,propertyKey:w}))}function Nu(s){return ip(s,"paint")}function ic(s){return ip(s,"layout")}function sp(s){let r=[];const a=s.value,d=s.key,m=s.style,v=s.styleSpec;a.type||a.ref||r.push(new rn(d,a,'either "type" or "ref" is required'));let w=Zr(a.type);const C=Zr(a.ref);if(a.id){const I=Zr(a.id);for(let P=0;P<s.arrayIndex;P++){const B=m.layers[P];Zr(B.id)===I&&r.push(new rn(d,a.id,`duplicate layer id "${a.id}", previously used at line ${B.id.__line__}`))}}if("ref"in a){let I;["type","source","source-layer","filter","layout"].forEach((P=>{P in a&&r.push(new rn(d,a[P],`"${P}" is prohibited for ref layers`))})),m.layers.forEach((P=>{Zr(P.id)===C&&(I=P)})),I?I.ref?r.push(new rn(d,a.ref,"ref cannot reference another ref layer")):w=Zr(I.type):typeof C=="string"&&r.push(new rn(d,a.ref,`ref layer "${C}" not found`))}else if(w!=="background"&&w!=="sky")if(a.source){const I=m.sources&&m.sources[a.source],P=I&&Zr(I.type);I?P==="vector"&&w==="raster"?r.push(new rn(d,a.source,`layer "${a.id}" requires a raster source`)):P==="raster"&&w!=="raster"?r.push(new rn(d,a.source,`layer "${a.id}" requires a vector source`)):P!=="vector"||a["source-layer"]?P==="raster-dem"&&w!=="hillshade"?r.push(new rn(d,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="line"||!a.paint||!a.paint["line-gradient"]&&!a.paint["line-trim-offset"]||P==="geojson"&&I.lineMetrics||r.push(new rn(d,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new rn(d,a,`layer "${a.id}" must specify a "source-layer"`)):r.push(new rn(d,a.source,`source "${a.source}" not found`))}else r.push(new rn(d,a,'missing required property "source"'));return r=r.concat(ro({key:d,value:a,valueSpec:v.layer,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{"*":()=>[],type:()=>fs({key:`${d}.type`,value:a.type,valueSpec:v.layer.type,style:s.style,styleSpec:s.styleSpec,object:a,objectKey:"type"}),filter:I=>za($o({layerType:w},I)),layout:I=>ro({layer:a,key:I.key,value:I.value,valueSpec:{},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":P=>ic($o({layerType:w},P))}}),paint:I=>ro({layer:a,key:I.key,value:I.value,valueSpec:{},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":P=>Nu($o({layerType:w},P))}})}})),r}function Ba(s){const r=s.value,a=s.key,d=Mr(r);return d!=="string"?[new rn(a,r,`string expected, ${d} found`)]:[]}const op={promoteId:function({key:s,value:r}){if(Mr(r)==="string")return Ba({key:s,value:r});{const a=[];for(const d in r)a.push(...Ba({key:`${s}.${d}`,value:r[d]}));return a}}};function Vc(s){const r=s.value,a=s.key,d=s.styleSpec,m=s.style;if(!r.type)return[new rn(a,r,'"type" is required')];const v=Zr(r.type);let w;switch(v){case"vector":case"raster":case"raster-dem":return w=ro({key:a,value:r,valueSpec:d[`source_${v.replace("-","_")}`],style:s.style,styleSpec:d,objectElementValidators:op}),w;case"geojson":if(w=ro({key:a,value:r,valueSpec:d.source_geojson,style:m,styleSpec:d,objectElementValidators:op}),r.cluster)for(const C in r.clusterProperties){const[I,P]=r.clusterProperties[C],B=typeof I=="string"?[I,["accumulated"],["get",C]]:I;w.push(...yi({key:`${a}.${C}.map`,value:P,expressionContext:"cluster-map"})),w.push(...yi({key:`${a}.${C}.reduce`,value:B,expressionContext:"cluster-reduce"}))}return w;case"video":return ro({key:a,value:r,valueSpec:d.source_video,style:m,styleSpec:d});case"image":return ro({key:a,value:r,valueSpec:d.source_image,style:m,styleSpec:d});case"canvas":return[new rn(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return al({key:`${a}.type`,value:r.type,valueSpec:{values:sc(d)}})}}function sc(s){return s.source.reduce(((r,a)=>{const d=s[a];return d.type.type==="enum"&&(r=r.concat(Object.keys(d.type.values))),r}),[])}function oc(s){const r=s.value,a=s.styleSpec,d=a.light,m=s.style;let v=[];const w=Mr(r);if(r===void 0)return v;if(w!=="object")return v=v.concat([new rn("light",r,`object expected, ${w} found`)]),v;for(const C in r){const I=C.match(/^(.*)-transition$/);v=v.concat(I&&d[I[1]]&&d[I[1]].transition?fs({key:C,value:r[C],valueSpec:a.transition,style:m,styleSpec:a}):d[C]?fs({key:C,value:r[C],valueSpec:d[C],style:m,styleSpec:a}):[new rn(C,r[C],`unknown property "${C}"`)])}return v}function ll(s){const r=s.value,a=s.key,d=s.style,m=s.styleSpec,v=m.terrain;let w=[];const C=Mr(r);if(r===void 0)return w;if(C!=="object")return w=w.concat([new rn("terrain",r,`object expected, ${C} found`)]),w;for(const I in r){const P=I.match(/^(.*)-transition$/);w=w.concat(P&&v[P[1]]&&v[P[1]].transition?fs({key:I,value:r[I],valueSpec:m.transition,style:d,styleSpec:m}):v[I]?fs({key:I,value:r[I],valueSpec:v[I],style:d,styleSpec:m}):[new rn(I,r[I],`unknown property "${I}"`)])}if(r.source){const I=d.sources&&d.sources[r.source],P=I&&Zr(I.type);I?P!=="raster-dem"&&w.push(new rn(a,r.source,`terrain cannot be used with a source of type ${String(P)}, it only be used with a "raster-dem" source type`)):w.push(new rn(a,r.source,`source "${r.source}" not found`))}else w.push(new rn(a,r,'terrain is missing required property "source"'));return w}function ap(s){const r=s.value,a=s.style,d=s.styleSpec,m=d.fog;let v=[];const w=Mr(r);if(r===void 0)return v;if(w!=="object")return v=v.concat([new rn("fog",r,`object expected, ${w} found`)]),v;for(const C in r){const I=C.match(/^(.*)-transition$/);v=v.concat(I&&m[I[1]]&&m[I[1]].transition?fs({key:C,value:r[C],valueSpec:d.transition,style:a,styleSpec:d}):m[C]?fs({key:C,value:r[C],valueSpec:m[C],style:a,styleSpec:d}):[new rn(C,r[C],`unknown property "${C}"`)])}return v}const lp={"*":()=>[],array:Bu,boolean:function(s){const r=s.value,a=s.key,d=Mr(r);return d!=="boolean"?[new rn(a,r,`boolean expected, ${d} found`)]:[]},number:Bc,color:function(s){const r=s.key,a=s.value,d=Mr(a);return d!=="string"?[new rn(r,a,`color expected, ${d} found`)]:El(a)===null?[new rn(r,a,`color expected, "${a}" found`)]:[]},enum:al,filter:za,function:rc,layer:sp,object:ro,source:Vc,light:oc,terrain:ll,fog:ap,string:Ba,formatted:function(s){return Ba(s).length===0?[]:yi(s)},resolvedImage:function(s){return Ba(s).length===0?[]:yi(s)},projection:function(s){const r=s.value,a=s.styleSpec,d=a.projection,m=s.style;let v=[];const w=Mr(r);if(w==="object")for(const C in r)v=v.concat(fs({key:C,value:r[C],valueSpec:d[C],style:m,styleSpec:a}));else w!=="string"&&(v=v.concat([new rn("projection",r,`object or string expected, ${w} found`)]));return v}};function fs(s){const r=s.value,a=s.valueSpec,d=s.styleSpec;return a.expression&&Du(Zr(r))?rc(s):a.expression&&Ou(Dr(r))?yi(s):a.type&&lp[a.type]?lp[a.type](s):ro($o({},s,{valueSpec:a.type?d[a.type]:a}))}function cp(s){const r=s.value,a=s.key,d=Ba(s);return d.length||(r.indexOf("{fontstack}")===-1&&d.push(new rn(a,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&d.push(new rn(a,r,'"glyphs" url must include a "{range}" token'))),d}function Fc(s,r=vt){return ha(fs({key:"",value:s,valueSpec:r.$root,styleSpec:r,style:s,objectElementValidators:{glyphs:cp,"*":()=>[]}}))}const Gs=s=>ha(Nu(s)),up=s=>ha(ic(s));function ha(s){return s.slice().sort(((r,a)=>r.line&&a.line?r.line-a.line:0))}function iy(s,r){let a=!1;if(r&&r.length)for(const d of r)s.fire(new ta(new Error(d.message))),a=!0;return a}var fv=_i,cl=3;function _i(s,r,a){var d=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var m=new Int32Array(this.arrayBuffer);s=m[0],this.d=(r=m[1])+2*(a=m[2]);for(var v=0;v<this.d*this.d;v++){var w=m[cl+v],C=m[cl+v+1];d.push(w===C?null:m.subarray(w,C))}var I=m[cl+d.length+1];this.keys=m.subarray(m[cl+d.length],I),this.bboxes=m.subarray(I),this.insert=this._insertReadonly}else{this.d=r+2*a;for(var P=0;P<this.d*this.d;P++)d.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=s,this.padding=a,this.scale=r/s,this.uid=0;var B=a/r*s;this.min=-B,this.max=s+B}_i.prototype.insert=function(s,r,a,d,m){this._forEachCell(r,a,d,m,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(r),this.bboxes.push(a),this.bboxes.push(d),this.bboxes.push(m)},_i.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},_i.prototype._insertCell=function(s,r,a,d,m,v){this.cells[m].push(v)},_i.prototype.query=function(s,r,a,d,m){var v=this.min,w=this.max;if(s<=v&&r<=v&&w<=a&&w<=d&&!m)return Array.prototype.slice.call(this.keys);var C=[];return this._forEachCell(s,r,a,d,this._queryCell,C,{},m),C},_i.prototype._queryCell=function(s,r,a,d,m,v,w,C){var I=this.cells[m];if(I!==null)for(var P=this.keys,B=this.bboxes,F=0;F<I.length;F++){var $=I[F];if(w[$]===void 0){var X=4*$;(C?C(B[X+0],B[X+1],B[X+2],B[X+3]):s<=B[X+2]&&r<=B[X+3]&&a>=B[X+0]&&d>=B[X+1])?(w[$]=!0,v.push(P[$])):w[$]=!1}}},_i.prototype._forEachCell=function(s,r,a,d,m,v,w,C){for(var I=this._convertToCellCoord(s),P=this._convertToCellCoord(r),B=this._convertToCellCoord(a),F=this._convertToCellCoord(d),$=I;$<=B;$++)for(var X=P;X<=F;X++){var J=this.d*X+$;if((!C||C(this._convertFromCellCoord($),this._convertFromCellCoord(X),this._convertFromCellCoord($+1),this._convertFromCellCoord(X+1)))&&m.call(this,s,r,a,d,J,v,w,C))return}},_i.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},_i.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},_i.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,r=cl+this.cells.length+1+1,a=0,d=0;d<this.cells.length;d++)a+=this.cells[d].length;var m=new Int32Array(r+a+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;for(var v=r,w=0;w<s.length;w++){var C=s[w];m[cl+w]=v,m.set(C,v),v+=C.length}return m[cl+s.length]=v,m.set(this.keys,v),m[cl+s.length+1]=v+=this.keys.length,m.set(this.bboxes,v),v+=this.bboxes.length,m.buffer};var ac=pe(fv);const Uc={};function gn(s,r,a={}){Object.defineProperty(s,"_classRegistryKey",{value:r,writeable:!1}),Uc[r]={klass:s,omit:a.omit||[]}}gn(Object,"Object"),ac.serialize=function(s,r){const a=s.toArrayBuffer();return r&&r.push(a),{buffer:a}},ac.deserialize=function(s){return new ac(s.buffer)},Object.defineProperty(ac,"name",{value:"Grid"}),gn(ac,"Grid"),gn(Ti,"Color"),gn(Error,"Error"),gn(xn,"AJAXError"),gn(rs,"ResolvedImage"),gn(Dh,"StylePropertyFunction"),gn(La,"StyleExpression",{omit:["_evaluator"]}),gn(zu,"ZoomDependentExpression"),gn(nc,"ZoomConstantExpression"),gn(aa,"CompoundExpression",{omit:["_evaluate"]});for(const s in Ro)Uc[Ro[s]._classRegistryKey]||gn(Ro[s],`Expression${s}`);function Yd(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function jc(s){return S.ImageBitmap&&s instanceof S.ImageBitmap}function ul(s,r){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp)return s;if(Yd(s)||jc(s))return r&&r.push(s),s;if(ArrayBuffer.isView(s)){const a=s;return r&&r.push(a.buffer),a}if(s instanceof S.ImageData)return r&&r.push(s.data.buffer),s;if(Array.isArray(s)){const a=[];for(const d of s)a.push(ul(d,r));return a}if(typeof s=="object"){const a=s.constructor,d=a._classRegistryKey;if(!d)throw new Error(`can't serialize object of unregistered class ${d}`);const m=a.serialize?a.serialize(s,r):{};if(!a.serialize){for(const v in s)s.hasOwnProperty(v)&&(Uc[d].omit.indexOf(v)>=0||(m[v]=ul(s[v],r)));s instanceof Error&&(m.message=s.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return d!=="Object"&&(m.$name=d),m}throw new Error("can't serialize object of type "+typeof s)}function Vu(s){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||Yd(s)||jc(s)||ArrayBuffer.isView(s)||s instanceof S.ImageData)return s;if(Array.isArray(s))return s.map(Vu);if(typeof s=="object"){const r=s.$name||"Object",{klass:a}=Uc[r];if(!a)throw new Error(`can't deserialize unregistered class ${r}`);if(a.deserialize)return a.deserialize(s);const d=Object.create(a.prototype);for(const m of Object.keys(s))m!=="$name"&&(d[m]=Vu(s[m]));return d}throw new Error("can't deserialize object of type "+typeof s)}const un={"Latin-1 Supplement":s=>s>=128&&s<=255,Arabic:s=>s>=1536&&s<=1791,"Arabic Supplement":s=>s>=1872&&s<=1919,"Arabic Extended-A":s=>s>=2208&&s<=2303,"Hangul Jamo":s=>s>=4352&&s<=4607,"Unified Canadian Aboriginal Syllabics":s=>s>=5120&&s<=5759,Khmer:s=>s>=6016&&s<=6143,"Unified Canadian Aboriginal Syllabics Extended":s=>s>=6320&&s<=6399,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"CJK Radicals Supplement":s=>s>=11904&&s<=12031,"Kangxi Radicals":s=>s>=12032&&s<=12255,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Hiragana:s=>s>=12352&&s<=12447,Katakana:s=>s>=12448&&s<=12543,Bopomofo:s=>s>=12544&&s<=12591,"Hangul Compatibility Jamo":s=>s>=12592&&s<=12687,Kanbun:s=>s>=12688&&s<=12703,"Bopomofo Extended":s=>s>=12704&&s<=12735,"CJK Strokes":s=>s>=12736&&s<=12783,"Katakana Phonetic Extensions":s=>s>=12784&&s<=12799,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"CJK Unified Ideographs Extension A":s=>s>=13312&&s<=19903,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"CJK Unified Ideographs":s=>s>=19968&&s<=40959,"Yi Syllables":s=>s>=40960&&s<=42127,"Yi Radicals":s=>s>=42128&&s<=42191,"Hangul Jamo Extended-A":s=>s>=43360&&s<=43391,"Hangul Syllables":s=>s>=44032&&s<=55215,"Hangul Jamo Extended-B":s=>s>=55216&&s<=55295,"Private Use Area":s=>s>=57344&&s<=63743,"CJK Compatibility Ideographs":s=>s>=63744&&s<=64255,"Arabic Presentation Forms-A":s=>s>=64336&&s<=65023,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Arabic Presentation Forms-B":s=>s>=65136&&s<=65279,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function Om(s){for(const r of s)if(Qd(r.charCodeAt(0)))return!0;return!1}function sy(s){for(const r of s)if(!$c(r.charCodeAt(0)))return!1;return!0}function $c(s){return!(un.Arabic(s)||un["Arabic Supplement"](s)||un["Arabic Extended-A"](s)||un["Arabic Presentation Forms-A"](s)||un["Arabic Presentation Forms-B"](s))}function Qd(s){return!(s!==746&&s!==747&&(s<4352||!(un["Bopomofo Extended"](s)||un.Bopomofo(s)||un["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||un["CJK Compatibility Ideographs"](s)||un["CJK Compatibility"](s)||un["CJK Radicals Supplement"](s)||un["CJK Strokes"](s)||!(!un["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||un["CJK Unified Ideographs Extension A"](s)||un["CJK Unified Ideographs"](s)||un["Enclosed CJK Letters and Months"](s)||un["Hangul Compatibility Jamo"](s)||un["Hangul Jamo Extended-A"](s)||un["Hangul Jamo Extended-B"](s)||un["Hangul Jamo"](s)||un["Hangul Syllables"](s)||un.Hiragana(s)||un["Ideographic Description Characters"](s)||un.Kanbun(s)||un["Kangxi Radicals"](s)||un["Katakana Phonetic Extensions"](s)||un.Katakana(s)&&s!==12540||!(!un["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!un["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||un["Unified Canadian Aboriginal Syllabics"](s)||un["Unified Canadian Aboriginal Syllabics Extended"](s)||un["Vertical Forms"](s)||un["Yijing Hexagram Symbols"](s)||un["Yi Syllables"](s)||un["Yi Radicals"](s))))}function Jd(s){return!(Qd(s)||(function(r){return!!(un["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||un["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||un["Letterlike Symbols"](r)||un["Number Forms"](r)||un["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||un["Control Pictures"](r)&&r!==9251||un["Optical Character Recognition"](r)||un["Enclosed Alphanumerics"](r)||un["Geometric Shapes"](r)||un["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||un["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||un["CJK Symbols and Punctuation"](r)||un.Katakana(r)||un["Private Use Area"](r)||un["CJK Compatibility Forms"](r)||un["Small Form Variants"](r)||un["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)})(s))}function zm(s){return s>=1424&&s<=2303||un["Arabic Presentation Forms-A"](s)||un["Arabic Presentation Forms-B"](s)}function zh(s,r){return!(!r&&zm(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||un.Khmer(s))}function Bm(s){for(const r of s)if(zm(r.charCodeAt(0)))return!0;return!1}const Bh="deferred",Nh="loading",hp="loaded";let Fu=null,_="unavailable",l=null;const p=function(s){s&&typeof s=="string"&&s.indexOf("NetworkError")>-1&&(_="error"),Fu&&Fu(s)};function x(){E.fire(new tl("pluginStateChange",{pluginStatus:_,pluginURL:l}))}const E=new Wl,A=function(){return _},D=function(){if(_!==Bh||!l)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");_=Nh,x(),l&&Gi({url:l},(s=>{s?p(s):(_=hp,x())}))},L={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>_===hp||L.applyArabicShaping!=null,isLoading:()=>_===Nh,setState(s){_=s.pluginStatus,l=s.pluginURL},isParsed:()=>L.applyArabicShaping!=null&&L.processBidirectionalText!=null&&L.processStyledBidirectionalText!=null,getPluginURL:()=>l};class V{constructor(r,a){this.zoom=r,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.transition=a.transition,this.pitch=a.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(r){return(function(a,d){for(const m of a)if(!zh(m.charCodeAt(0),d))return!1;return!0})(r,L.isLoaded())}}class G{constructor(r,a){this.property=r,this.value=a,this.expression=(function(d,m){if(Du(d))return new Dh(d,m);if(Ou(d)){const v=kh(d,m);if(v.result==="error")throw new Error(v.value.map((w=>`${w.key}: ${w.message}`)).join(", "));return v.value}{let v=d;return typeof d=="string"&&m.type==="color"&&(v=Ti.parse(d)),{kind:"constant",evaluate:()=>v}}})(a===void 0?r.specification.default:a,r.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,a,d){return this.property.possiblyEvaluate(this,r,a,d)}}class q{constructor(r){this.property=r,this.value=new G(r,void 0)}transitioned(r,a){return new ye(this.property,this.value,a,wt({},r.transition,this.transition),r.now)}untransitioned(){return new ye(this.property,this.value,null,{},0)}}class te{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return ln(this._values[r].value.value)}setValue(r,a){this._values.hasOwnProperty(r)||(this._values[r]=new q(this._values[r].property)),this._values[r].value=new G(this._values[r].property,a===null?void 0:ln(a))}getTransition(r){return ln(this._values[r].transition)}setTransition(r,a){this._values.hasOwnProperty(r)||(this._values[r]=new q(this._values[r].property)),this._values[r].transition=ln(a)||void 0}serialize(){const r={};for(const a of Object.keys(this._values)){const d=this.getValue(a);d!==void 0&&(r[a]=d);const m=this.getTransition(a);m!==void 0&&(r[`${a}-transition`]=m)}return r}transitioned(r,a){const d=new we(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].transitioned(r,a._values[m]);return d}untransitioned(){const r=new we(this._properties);for(const a of Object.keys(this._values))r._values[a]=this._values[a].untransitioned();return r}}class ye{constructor(r,a,d,m,v){const w=m.delay||0,C=m.duration||0;v=v||0,this.property=r,this.value=a,this.begin=v+w,this.end=this.begin+C,r.specification.transition&&(m.delay||m.duration)&&(this.prior=d)}possiblyEvaluate(r,a,d){const m=r.now||0,v=this.value.possiblyEvaluate(r,a,d),w=this.prior;if(w){if(m>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(m<this.begin)return w.possiblyEvaluate(r,a,d);{const C=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(r,a,d),v,Ie(C))}}return v}}class we{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,a,d){const m=new Ce(this._properties);for(const v of Object.keys(this._values))m._values[v]=this._values[v].possiblyEvaluate(r,a,d);return m}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class Se{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}getValue(r){return ln(this._values[r].value)}setValue(r,a){this._values[r]=new G(this._values[r].property,a===null?void 0:ln(a))}serialize(){const r={};for(const a of Object.keys(this._values)){const d=this.getValue(a);d!==void 0&&(r[a]=d)}return r}possiblyEvaluate(r,a,d){const m=new Ce(this._properties);for(const v of Object.keys(this._values))m._values[v]=this._values[v].possiblyEvaluate(r,a,d);return m}}class Ee{constructor(r,a,d){this.property=r,this.value=a,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,a,d,m){return this.property.evaluate(this.value,this.parameters,r,a,d,m)}}class Ce{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class ne{constructor(r){this.specification=r}possiblyEvaluate(r,a){return r.expression.evaluate(a)}interpolate(r,a,d){const m=Ho[this.specification.type];return m?m(r,a,d):r}}class be{constructor(r,a){this.specification=r,this.overrides=a}possiblyEvaluate(r,a,d,m){return new Ee(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(a,null,{},d,m)}:r.expression,a)}interpolate(r,a,d){if(r.value.kind!=="constant"||a.value.kind!=="constant")return r;if(r.value.value===void 0||a.value.value===void 0)return new Ee(this,{kind:"constant",value:void 0},r.parameters);const m=Ho[this.specification.type];return m?new Ee(this,{kind:"constant",value:m(r.value.value,a.value.value,d)},r.parameters):r}evaluate(r,a,d,m,v,w){return r.kind==="constant"?r.value:r.evaluate(a,d,m,v,w)}}class ke{constructor(r){this.specification=r}possiblyEvaluate(r,a,d,m){return!!r.expression.evaluate(a,null,{},d,m)}interpolate(){return!1}}class Le{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const a=new V(0,{});for(const d in r){const m=r[d];m.specification.overridable&&this.overridableProperties.push(d);const v=this.defaultPropertyValues[d]=new G(m,void 0),w=this.defaultTransitionablePropertyValues[d]=new q(m);this.defaultTransitioningPropertyValues[d]=w.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=v.possiblyEvaluate(a)}}}function je(s,r){return 256*(s=et(Math.floor(s),0,255))+et(Math.floor(r),0,255)}gn(be,"DataDrivenProperty"),gn(ne,"DataConstantProperty"),gn(ke,"ColorRampProperty");const He={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class qe{constructor(r,a){this._structArray=r,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Qe{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,a){return r._trim(),a&&(r.isTransferred=!0,a.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const a=Object.create(this.prototype);return a.arrayBuffer=r.arrayBuffer,a.length=r.length,a.capacity=r.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ye(s,r=1){let a=0,d=0;return{members:s.map((m=>{const v=He[m.type].BYTES_PER_ELEMENT,w=a=lt(a,Math.max(r,v)),C=m.components||1;return d=Math.max(d,v),a+=v*C,{name:m.name,type:m.type,components:C,offset:w}})),size:lt(a,Math.max(d,r)),alignment:r}}function lt(s,r){return Math.ceil(s/r)*r}class Vt extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a){const d=this.length;return this.resize(d+1),this.emplace(d,r,a)}emplace(r,a,d){const m=2*r;return this.int16[m+0]=a,this.int16[m+1]=d,r}}Vt.prototype.bytesPerElement=4,gn(Vt,"StructArrayLayout2i4");class rt extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,d){const m=this.length;return this.resize(m+1),this.emplace(m,r,a,d)}emplace(r,a,d,m){const v=3*r;return this.int16[v+0]=a,this.int16[v+1]=d,this.int16[v+2]=m,r}}rt.prototype.bytesPerElement=6,gn(rt,"StructArrayLayout3i6");class _t extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,d,m){const v=this.length;return this.resize(v+1),this.emplace(v,r,a,d,m)}emplace(r,a,d,m,v){const w=4*r;return this.int16[w+0]=a,this.int16[w+1]=d,this.int16[w+2]=m,this.int16[w+3]=v,r}}_t.prototype.bytesPerElement=8,gn(_t,"StructArrayLayout4i8");class at extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,d,m,v,w,C){const I=this.length;return this.resize(I+1),this.emplace(I,r,a,d,m,v,w,C)}emplace(r,a,d,m,v,w,C,I){const P=6*r,B=12*r,F=3*r;return this.int16[P+0]=a,this.int16[P+1]=d,this.uint8[B+4]=m,this.uint8[B+5]=v,this.uint8[B+6]=w,this.uint8[B+7]=C,this.float32[F+2]=I,r}}at.prototype.bytesPerElement=12,gn(at,"StructArrayLayout2i4ub1f12");class Ot extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,d,m){const v=this.length;return this.resize(v+1),this.emplace(v,r,a,d,m)}emplace(r,a,d,m,v){const w=4*r;return this.float32[w+0]=a,this.float32[w+1]=d,this.float32[w+2]=m,this.float32[w+3]=v,r}}Ot.prototype.bytesPerElement=16,gn(Ot,"StructArrayLayout4f16");class st extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,d,m,v){const w=this.length;return this.resize(w+1),this.emplace(w,r,a,d,m,v)}emplace(r,a,d,m,v,w){const C=6*r,I=3*r;return this.uint16[C+0]=a,this.uint16[C+1]=d,this.uint16[C+2]=m,this.uint16[C+3]=v,this.float32[I+2]=w,r}}st.prototype.bytesPerElement=12,gn(st,"StructArrayLayout4ui1f12");class St extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,d,m){const v=this.length;return this.resize(v+1),this.emplace(v,r,a,d,m)}emplace(r,a,d,m,v){const w=4*r;return this.uint16[w+0]=a,this.uint16[w+1]=d,this.uint16[w+2]=m,this.uint16[w+3]=v,r}}St.prototype.bytesPerElement=8,gn(St,"StructArrayLayout4ui8");class zt extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,d,m,v,w){const C=this.length;return this.resize(C+1),this.emplace(C,r,a,d,m,v,w)}emplace(r,a,d,m,v,w,C){const I=6*r;return this.int16[I+0]=a,this.int16[I+1]=d,this.int16[I+2]=m,this.int16[I+3]=v,this.int16[I+4]=w,this.int16[I+5]=C,r}}zt.prototype.bytesPerElement=12,gn(zt,"StructArrayLayout6i12");class Ct extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,d,m,v,w,C,I,P,B,F,$){const X=this.length;return this.resize(X+1),this.emplace(X,r,a,d,m,v,w,C,I,P,B,F,$)}emplace(r,a,d,m,v,w,C,I,P,B,F,$,X){const J=12*r;return this.int16[J+0]=a,this.int16[J+1]=d,this.int16[J+2]=m,this.int16[J+3]=v,this.uint16[J+4]=w,this.uint16[J+5]=C,this.uint16[J+6]=I,this.uint16[J+7]=P,this.int16[J+8]=B,this.int16[J+9]=F,this.int16[J+10]=$,this.int16[J+11]=X,r}}Ct.prototype.bytesPerElement=24,gn(Ct,"StructArrayLayout4i4ui4i24");class It extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,d,m,v,w){const C=this.length;return this.resize(C+1),this.emplace(C,r,a,d,m,v,w)}emplace(r,a,d,m,v,w,C){const I=10*r,P=5*r;return this.int16[I+0]=a,this.int16[I+1]=d,this.int16[I+2]=m,this.float32[P+2]=v,this.float32[P+3]=w,this.float32[P+4]=C,r}}It.prototype.bytesPerElement=20,gn(It,"StructArrayLayout3i3f20");class Sn extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.uint32[1*r+0]=a,r}}Sn.prototype.bytesPerElement=4,gn(Sn,"StructArrayLayout1ul4");class Un extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,d,m,v,w,C,I,P,B,F,$,X){const J=this.length;return this.resize(J+1),this.emplace(J,r,a,d,m,v,w,C,I,P,B,F,$,X)}emplace(r,a,d,m,v,w,C,I,P,B,F,$,X,J){const oe=20*r,_e=10*r;return this.int16[oe+0]=a,this.int16[oe+1]=d,this.int16[oe+2]=m,this.int16[oe+3]=v,this.int16[oe+4]=w,this.float32[_e+3]=C,this.float32[_e+4]=I,this.float32[_e+5]=P,this.float32[_e+6]=B,this.int16[oe+14]=F,this.uint32[_e+8]=$,this.uint16[oe+18]=X,this.uint16[oe+19]=J,r}}Un.prototype.bytesPerElement=40,gn(Un,"StructArrayLayout5i4f1i1ul2ui40");class Bt extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,d,m,v,w,C){const I=this.length;return this.resize(I+1),this.emplace(I,r,a,d,m,v,w,C)}emplace(r,a,d,m,v,w,C,I){const P=8*r;return this.int16[P+0]=a,this.int16[P+1]=d,this.int16[P+2]=m,this.int16[P+4]=v,this.int16[P+5]=w,this.int16[P+6]=C,this.int16[P+7]=I,r}}Bt.prototype.bytesPerElement=16,gn(Bt,"StructArrayLayout3i2i2i16");class hn extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,d,m,v){const w=this.length;return this.resize(w+1),this.emplace(w,r,a,d,m,v)}emplace(r,a,d,m,v,w){const C=4*r,I=8*r;return this.float32[C+0]=a,this.float32[C+1]=d,this.float32[C+2]=m,this.int16[I+6]=v,this.int16[I+7]=w,r}}hn.prototype.bytesPerElement=16,gn(hn,"StructArrayLayout2f1f2i16");class Fn extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,d,m){const v=this.length;return this.resize(v+1),this.emplace(v,r,a,d,m)}emplace(r,a,d,m,v){const w=12*r,C=3*r;return this.uint8[w+0]=a,this.uint8[w+1]=d,this.float32[C+1]=m,this.float32[C+2]=v,r}}Fn.prototype.bytesPerElement=12,gn(Fn,"StructArrayLayout2ub2f12");class ar extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,d){const m=this.length;return this.resize(m+1),this.emplace(m,r,a,d)}emplace(r,a,d,m){const v=3*r;return this.float32[v+0]=a,this.float32[v+1]=d,this.float32[v+2]=m,r}}ar.prototype.bytesPerElement=12,gn(ar,"StructArrayLayout3f12");class Tn extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,d){const m=this.length;return this.resize(m+1),this.emplace(m,r,a,d)}emplace(r,a,d,m){const v=3*r;return this.uint16[v+0]=a,this.uint16[v+1]=d,this.uint16[v+2]=m,r}}Tn.prototype.bytesPerElement=6,gn(Tn,"StructArrayLayout3ui6");class Pr extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,a,d,m,v,w,C,I,P,B,F,$,X,J,oe,_e,Re,Be,Pe,ze,Ue){const Fe=this.length;return this.resize(Fe+1),this.emplace(Fe,r,a,d,m,v,w,C,I,P,B,F,$,X,J,oe,_e,Re,Be,Pe,ze,Ue)}emplace(r,a,d,m,v,w,C,I,P,B,F,$,X,J,oe,_e,Re,Be,Pe,ze,Ue,Fe){const ut=30*r,ot=15*r,bt=60*r;return this.int16[ut+0]=a,this.int16[ut+1]=d,this.int16[ut+2]=m,this.float32[ot+2]=v,this.float32[ot+3]=w,this.uint16[ut+8]=C,this.uint16[ut+9]=I,this.uint32[ot+5]=P,this.uint32[ot+6]=B,this.uint32[ot+7]=F,this.uint16[ut+16]=$,this.uint16[ut+17]=X,this.uint16[ut+18]=J,this.float32[ot+10]=oe,this.float32[ot+11]=_e,this.uint8[bt+48]=Re,this.uint8[bt+49]=Be,this.uint8[bt+50]=Pe,this.uint32[ot+13]=ze,this.int16[ut+28]=Ue,this.uint8[bt+58]=Fe,r}}Pr.prototype.bytesPerElement=60,gn(Pr,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Kr extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,a,d,m,v,w,C,I,P,B,F,$,X,J,oe,_e,Re,Be,Pe,ze,Ue,Fe,ut,ot,bt,$t,pt,Rt,Mt,Nt){const Zt=this.length;return this.resize(Zt+1),this.emplace(Zt,r,a,d,m,v,w,C,I,P,B,F,$,X,J,oe,_e,Re,Be,Pe,ze,Ue,Fe,ut,ot,bt,$t,pt,Rt,Mt,Nt)}emplace(r,a,d,m,v,w,C,I,P,B,F,$,X,J,oe,_e,Re,Be,Pe,ze,Ue,Fe,ut,ot,bt,$t,pt,Rt,Mt,Nt,Zt){const xt=38*r,dn=19*r;return this.int16[xt+0]=a,this.int16[xt+1]=d,this.int16[xt+2]=m,this.float32[dn+2]=v,this.float32[dn+3]=w,this.int16[xt+8]=C,this.int16[xt+9]=I,this.int16[xt+10]=P,this.int16[xt+11]=B,this.int16[xt+12]=F,this.int16[xt+13]=$,this.uint16[xt+14]=X,this.uint16[xt+15]=J,this.uint16[xt+16]=oe,this.uint16[xt+17]=_e,this.uint16[xt+18]=Re,this.uint16[xt+19]=Be,this.uint16[xt+20]=Pe,this.uint16[xt+21]=ze,this.uint16[xt+22]=Ue,this.uint16[xt+23]=Fe,this.uint16[xt+24]=ut,this.uint16[xt+25]=ot,this.uint16[xt+26]=bt,this.uint16[xt+27]=$t,this.uint16[xt+28]=pt,this.uint32[dn+15]=Rt,this.float32[dn+16]=Mt,this.float32[dn+17]=Nt,this.float32[dn+18]=Zt,r}}Kr.prototype.bytesPerElement=76,gn(Kr,"StructArrayLayout3i2f6i15ui1ul3f76");class qr extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.float32[1*r+0]=a,r}}qr.prototype.bytesPerElement=4,gn(qr,"StructArrayLayout1f4");class Vr extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,d,m,v){const w=this.length;return this.resize(w+1),this.emplace(w,r,a,d,m,v)}emplace(r,a,d,m,v,w){const C=5*r;return this.float32[C+0]=a,this.float32[C+1]=d,this.float32[C+2]=m,this.float32[C+3]=v,this.float32[C+4]=w,r}}Vr.prototype.bytesPerElement=20,gn(Vr,"StructArrayLayout5f20");class so extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,d,m){const v=this.length;return this.resize(v+1),this.emplace(v,r,a,d,m)}emplace(r,a,d,m,v){const w=6*r;return this.uint32[3*r+0]=a,this.uint16[w+2]=d,this.uint16[w+3]=m,this.uint16[w+4]=v,r}}so.prototype.bytesPerElement=12,gn(so,"StructArrayLayout1ul3ui12");class kr extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a){const d=this.length;return this.resize(d+1),this.emplace(d,r,a)}emplace(r,a,d){const m=2*r;return this.uint16[m+0]=a,this.uint16[m+1]=d,r}}kr.prototype.bytesPerElement=4,gn(kr,"StructArrayLayout2ui4");class Zo extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.uint16[1*r+0]=a,r}}Zo.prototype.bytesPerElement=2,gn(Zo,"StructArrayLayout1ui2");class Na extends Qe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a){const d=this.length;return this.resize(d+1),this.emplace(d,r,a)}emplace(r,a,d){const m=2*r;return this.float32[m+0]=a,this.float32[m+1]=d,r}}Na.prototype.bytesPerElement=8,gn(Na,"StructArrayLayout2f8");class Mi extends qe{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Mi.prototype.size=40;class li extends Un{get(r){return new Mi(this,r)}}gn(li,"CollisionBoxArray");class Fr extends qe{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(r){this._structArray.uint8[this._pos1+49]=r}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(r){this._structArray.uint8[this._pos1+50]=r}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(r){this._structArray.uint32[this._pos4+13]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(r){this._structArray.uint8[this._pos1+58]=r}}Fr.prototype.size=60;class ss extends Pr{get(r){return new Fr(this,r)}}gn(ss,"PlacedSymbolArray");class Hs extends qe{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(r){this._structArray.uint32[this._pos4+15]=r}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Hs.prototype.size=76;class vi extends Kr{get(r){return new Hs(this,r)}}gn(vi,"SymbolInstanceArray");class Ei extends qr{getoffsetX(r){return this.float32[1*r+0]}}gn(Ei,"GlyphOffsetArray");class Ji extends Vt{getx(r){return this.int16[2*r+0]}gety(r){return this.int16[2*r+1]}}gn(Ji,"SymbolLineVertexArray");class Ml extends qe{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Ml.prototype.size=12;class lc extends so{get(r){return new Ml(this,r)}}gn(lc,"FeatureIndexArray");class Va extends kr{geta_centroid_pos0(r){return this.uint16[2*r+0]}geta_centroid_pos1(r){return this.uint16[2*r+1]}}gn(Va,"FillExtrusionCentroidArray");const Pl=Ye([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Mo=Ye([{name:"a_dash",components:4,type:"Uint16"}]);var Uu={exports:{}},ju={exports:{}};ju.exports=function(s,r){var a,d,m,v,w,C,I,P;for(d=s.length-(a=3&s.length),m=r,w=3432918353,C=461845907,P=0;P<d;)I=255&s.charCodeAt(P)|(255&s.charCodeAt(++P))<<8|(255&s.charCodeAt(++P))<<16|(255&s.charCodeAt(++P))<<24,++P,m=27492+(65535&(v=5*(65535&(m=(m^=I=(65535&(I=(I=(65535&I)*w+(((I>>>16)*w&65535)<<16)&4294967295)<<15|I>>>17))*C+(((I>>>16)*C&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(I=0,a){case 3:I^=(255&s.charCodeAt(P+2))<<16;case 2:I^=(255&s.charCodeAt(P+1))<<8;case 1:m^=I=(65535&(I=(I=(65535&(I^=255&s.charCodeAt(P)))*w+(((I>>>16)*w&65535)<<16)&4294967295)<<15|I>>>17))*C+(((I>>>16)*C&65535)<<16)&4294967295}return m^=s.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0};var ef=ju.exports,pv={exports:{}};pv.exports=function(s,r){for(var a,d=s.length,m=r^d,v=0;d>=4;)a=1540483477*(65535&(a=255&s.charCodeAt(v)|(255&s.charCodeAt(++v))<<8|(255&s.charCodeAt(++v))<<16|(255&s.charCodeAt(++v))<<24))+((1540483477*(a>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),d-=4,++v;switch(d){case 3:m^=(255&s.charCodeAt(v+2))<<16;case 2:m^=(255&s.charCodeAt(v+1))<<8;case 1:m=1540483477*(65535&(m^=255&s.charCodeAt(v)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0};var mv=ef,Ab=pv.exports;Uu.exports=mv,Uu.exports.murmur3=mv,Uu.exports.murmur2=Ab;var oy=pe(Uu.exports);class Nm{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,a,d,m){this.ids.push(gv(r)),this.positions.push(a,d,m)}getPositions(r){const a=gv(r);let d=0,m=this.ids.length-1;for(;d<m;){const w=d+m>>1;this.ids[w]>=a?m=w:d=w+1}const v=[];for(;this.ids[d]===a;)v.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return v}static serialize(r,a){const d=new Float64Array(r.ids),m=new Uint32Array(r.positions);return Vm(d,m,0,d.length-1),a&&a.push(d.buffer,m.buffer),{ids:d,positions:m}}static deserialize(r){const a=new Nm;return a.ids=r.ids,a.positions=r.positions,a.indexed=!0,a}}function gv(s){const r=+s;return!isNaN(r)&&Number.MIN_SAFE_INTEGER<=r&&r<=Number.MAX_SAFE_INTEGER?r:oy(String(s))}function Vm(s,r,a,d){for(;a<d;){const m=s[a+d>>1];let v=a-1,w=d+1;for(;;){do v++;while(s[v]<m);do w--;while(s[w]>m);if(v>=w)break;Fm(s,v,w),Fm(r,3*v,3*w),Fm(r,3*v+1,3*w+1),Fm(r,3*v+2,3*w+2)}w-a<d-w?(Vm(s,r,a,w),a=w+1):(Vm(s,r,w+1,d),d=w)}}function Fm(s,r,a){const d=s[r];s[r]=s[a],s[a]=d}gn(Nm,"FeaturePositionMap");class $u{constructor(r){this.gl=r.gl,this.initialized=!1}fetchUniformLocation(r,a){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(r,a),this.initialized=!0),!!this.location}}class Um extends $u{constructor(r){super(r),this.current=0}set(r,a,d){this.fetchUniformLocation(r,a)&&this.current!==d&&(this.current=d,this.gl.uniform1f(this.location,d))}}class yv extends $u{constructor(r){super(r),this.current=[0,0,0,0]}set(r,a,d){this.fetchUniformLocation(r,a)&&(d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]&&d[3]===this.current[3]||(this.current=d,this.gl.uniform4f(this.location,d[0],d[1],d[2],d[3])))}}class _v extends $u{constructor(r){super(r),this.current=Ti.transparent}set(r,a,d){this.fetchUniformLocation(r,a)&&(d.r===this.current.r&&d.g===this.current.g&&d.b===this.current.b&&d.a===this.current.a||(this.current=d,this.gl.uniform4f(this.location,d.r,d.g,d.b,d.a)))}}const vv=new Float32Array(16),Ib=new Float32Array(9),Rb=new Float32Array(4);function ay(s){return[je(255*s.r,255*s.g),je(255*s.b,255*s.a)]}class dp{constructor(r,a,d){this.value=r,this.uniformNames=a.map((m=>`u_${m}`)),this.type=d}setUniform(r,a,d,m,v){a.set(r,v,m.constantOr(this.value))}getBinding(r,a){return this.type==="color"?new _v(r):new Um(r)}}class tf{constructor(r,a){this.uniformNames=a.map((d=>`u_${d}`)),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(r){this.pixelRatio=r.pixelRatio||1,this.pattern=r.tl.concat(r.br)}setUniform(r,a,d,m,v){const w=v==="u_pattern"||v==="u_dash"?this.pattern:v==="u_pixel_ratio"?this.pixelRatio:null;w&&a.set(r,v,w)}getBinding(r,a){return a==="u_pattern"||a==="u_dash"?new yv(r):new Um(r)}}class qu{constructor(r,a,d,m){this.expression=r,this.type=d,this.maxValue=0,this.paintVertexAttributes=a.map((v=>({name:`a_${v}`,type:"Float32",components:d==="color"?2:1,offset:0}))),this.paintVertexArray=new m}populatePaintArray(r,a,d,m,v,w){const C=this.paintVertexArray.length,I=this.expression.evaluate(new V(0),a,{},v,m,w);this.paintVertexArray.resize(r),this._setPaintValue(C,r,I)}updatePaintArray(r,a,d,m,v){const w=this.expression.evaluate({zoom:0},d,m,void 0,v);this._setPaintValue(r,a,w)}_setPaintValue(r,a,d){if(this.type==="color"){const m=ay(d);for(let v=r;v<a;v++)this.paintVertexArray.emplace(v,m[0],m[1])}else{for(let m=r;m<a;m++)this.paintVertexArray.emplace(m,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class kl{constructor(r,a,d,m,v,w){this.expression=r,this.uniformNames=a.map((C=>`u_${C}_t`)),this.type=d,this.useIntegerZoom=m,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=a.map((C=>({name:`a_${C}`,type:"Float32",components:d==="color"?4:2,offset:0}))),this.paintVertexArray=new w}populatePaintArray(r,a,d,m,v,w){const C=this.expression.evaluate(new V(this.zoom),a,{},v,m,w),I=this.expression.evaluate(new V(this.zoom+1),a,{},v,m,w),P=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(P,r,C,I)}updatePaintArray(r,a,d,m,v){const w=this.expression.evaluate({zoom:this.zoom},d,m,void 0,v),C=this.expression.evaluate({zoom:this.zoom+1},d,m,void 0,v);this._setPaintValue(r,a,w,C)}_setPaintValue(r,a,d,m){if(this.type==="color"){const v=ay(d),w=ay(m);for(let C=r;C<a;C++)this.paintVertexArray.emplace(C,v[0],v[1],w[0],w[1])}else{for(let v=r;v<a;v++)this.paintVertexArray.emplace(v,d,m);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(m))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,a,d,m,v){const w=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,C=et(this.expression.interpolationFactor(w,this.zoom,this.zoom+1),0,1);a.set(r,v,C)}getBinding(r,a){return new Um(r)}}class hl{constructor(r,a,d,m,v){this.expression=r,this.layerId=v,this.paintVertexAttributes=(d==="array"?Mo:Pl).members;for(let w=0;w<a.length;++w);this.paintVertexArray=new m}populatePaintArray(r,a,d){const m=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValues(m,r,a.patterns&&a.patterns[this.layerId],d)}updatePaintArray(r,a,d,m,v,w){this._setPaintValues(r,a,d.patterns&&d.patterns[this.layerId],w)}_setPaintValues(r,a,d,m){if(!m||!d)return;const v=m[d];if(!v)return;const{tl:w,br:C,pixelRatio:I}=v;for(let P=r;P<a;P++)this.paintVertexArray.emplace(P,w[0],w[1],C[0],C[1],I)}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Gu{constructor(r,a,d=(()=>!0)){this.binders={},this._buffers=[];const m=[];for(const v in r.paint._values){if(!d(v))continue;const w=r.paint.get(v);if(!(w instanceof Ee&&ol(w.property.specification)))continue;const C=Mb(v,r.type),I=w.value,P=w.property.specification.type,B=!!w.property.useIntegerZoom,F=v==="line-dasharray"||v.endsWith("pattern"),$=v==="line-dasharray"&&r.layout.get("line-cap").value.kind!=="constant";if(I.kind!=="constant"||$)if(I.kind==="source"||$||F){const X=bv(v,P,"source");this.binders[v]=F?new hl(I,C,P,X,r.id):new qu(I,C,P,X),m.push(`/a_${v}`)}else{const X=bv(v,P,"composite");this.binders[v]=new kl(I,C,P,B,a,X),m.push(`/z_${v}`)}else this.binders[v]=F?new tf(I.value,C):new dp(I.value,C,P),m.push(`/u_${v}`)}this.cacheKey=m.sort().join("")}getMaxValue(r){const a=this.binders[r];return a instanceof qu||a instanceof kl?a.maxValue:0}populatePaintArrays(r,a,d,m,v,w){for(const C in this.binders){const I=this.binders[C];(I instanceof qu||I instanceof kl||I instanceof hl)&&I.populatePaintArray(r,a,d,m,v,w)}}setConstantPatternPositions(r){for(const a in this.binders){const d=this.binders[a];d instanceof tf&&d.setConstantPatternPositions(r)}}updatePaintArrays(r,a,d,m,v,w){let C=!1;for(const I in r){const P=a.getPositions(I);for(const B of P){const F=d.feature(B.index);for(const $ in this.binders){const X=this.binders[$];if((X instanceof qu||X instanceof kl||X instanceof hl)&&X.expression.isStateDependent===!0){const J=m.paint.get($);X.expression=J.value,X.updatePaintArray(B.start,B.end,F,r[I],v,w),C=!0}}}}return C}defines(){const r=[];for(const a in this.binders){const d=this.binders[a];(d instanceof dp||d instanceof tf)&&r.push(...d.uniformNames.map((m=>`#define HAS_UNIFORM_${m}`)))}return r}getBinderAttributes(){const r=[];for(const a in this.binders){const d=this.binders[a];if(d instanceof qu||d instanceof kl||d instanceof hl)for(let m=0;m<d.paintVertexAttributes.length;m++)r.push(d.paintVertexAttributes[m].name)}return r}getBinderUniforms(){const r=[];for(const a in this.binders){const d=this.binders[a];if(d instanceof dp||d instanceof tf||d instanceof kl)for(const m of d.uniformNames)r.push(m)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r){const a=[];for(const d in this.binders){const m=this.binders[d];if(m instanceof dp||m instanceof tf||m instanceof kl)for(const v of m.uniformNames)a.push({name:v,property:d,binding:m.getBinding(r,v)})}return a}setUniforms(r,a,d,m,v){for(const{name:w,property:C,binding:I}of d)this.binders[C].setUniform(r,I,v,m.get(C),w)}updatePaintBuffers(){this._buffers=[];for(const r in this.binders){const a=this.binders[r];(a instanceof qu||a instanceof kl||a instanceof hl)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(r){for(const a in this.binders){const d=this.binders[a];(d instanceof qu||d instanceof kl||d instanceof hl)&&d.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const a=this.binders[r];(a instanceof qu||a instanceof kl||a instanceof hl)&&a.destroy()}}}class qc{constructor(r,a,d=(()=>!0)){this.programConfigurations={};for(const m of r)this.programConfigurations[m.id]=new Gu(m,a,d);this.needsUpload=!1,this._featureMap=new Nm,this._bufferOffset=0}populatePaintArrays(r,a,d,m,v,w,C){for(const I in this.programConfigurations)this.programConfigurations[I].populatePaintArrays(r,a,m,v,w,C);a.id!==void 0&&this._featureMap.add(a.id,d,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,a,d,m,v){for(const w of d)this.needsUpload=this.programConfigurations[w.id].updatePaintArrays(r,this._featureMap,a,w,m,v)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}const ly={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Mb(s,r){return ly[s]||[s.replace(`${r}-`,"").replace(/-/g,"_")]}const xv={"line-pattern":{source:st,composite:st},"fill-pattern":{source:st,composite:st},"fill-extrusion-pattern":{source:st,composite:st},"line-dasharray":{source:St,composite:St}},ME={color:{source:Na,composite:Ot},number:{source:qr,composite:Na}};function bv(s,r,a){const d=xv[s];return d&&d[a]||ME[r][a]}gn(dp,"ConstantBinder"),gn(tf,"PatternConstantBinder"),gn(qu,"SourceExpressionBinder"),gn(hl,"PatternCompositeBinder"),gn(kl,"CompositeExpressionBinder"),gn(Gu,"ProgramConfiguration",{omit:["_buffers"]}),gn(qc,"ProgramConfigurationSet");const wv="-transition";class Dl extends Wl{constructor(r,a){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&r.type!=="sky"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),a.layout&&(this._unevaluatedLayout=new Se(a.layout)),a.paint)){this._transitionablePaint=new te(a.paint);for(const d in r.paint)this.setPaintProperty(d,r.paint[d],{validate:!1});for(const d in r.layout)this.setLayoutProperty(d,r.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ce(a.paint)}}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,a,d={}){a!=null&&this._validate(up,`layers.${this.id}.layout.${r}`,r,a,d)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,a):this.visibility=a)}getPaintProperty(r){return vn(r,wv)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,a,d={}){if(a!=null&&this._validate(Gs,`layers.${this.id}.paint.${r}`,r,a,d))return!1;if(vn(r,wv))return this._transitionablePaint.setTransition(r.slice(0,-11),a||void 0),!1;{const m=this._transitionablePaint._values[r],v=m.value.isDataDriven(),w=m.value;this._transitionablePaint.setValue(r,a),this._handleSpecialPaintPropertyUpdate(r);const C=this._transitionablePaint._values[r].value,I=C.isDataDriven(),P=vn(r,"pattern")||r==="line-dasharray";return I||v||P||this._handleOverridablePaintPropertyUpdate(r,w,C)}}_handleSpecialPaintPropertyUpdate(r){}getProgramIds(){return null}getProgramConfiguration(r){return null}_handleOverridablePaintPropertyUpdate(r,a,d){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,a){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,a)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Cn(r,((a,d)=>!(a===void 0||d==="layout"&&!Object.keys(a).length||d==="paint"&&!Object.keys(a).length)))}_validate(r,a,d,m,v={}){return(!v||v.validate!==!1)&&iy(this,r.call(Fc,{key:a,layerType:this.type,objectKey:d,value:m,styleSpec:vt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const a=this.paint.get(r);if(a instanceof Ee&&ol(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=ua(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Pb=Ye([{name:"a_pos",components:2,type:"Int16"}],4),kb=Ye([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class os{constructor(r=[]){this.segments=r}prepareSegment(r,a,d,m){let v=this.segments[this.segments.length-1];return r>os.MAX_VERTEX_ARRAY_LENGTH&&Rn(`Max vertices per segment is ${os.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!v||v.vertexLength+r>os.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==m)&&(v={vertexOffset:a.length,primitiveOffset:d.length,vertexLength:0,primitiveLength:0},m!==void 0&&(v.sortKey=m),this.segments.push(v)),v}get(){return this.segments}destroy(){for(const r of this.segments)for(const a in r.vaos)r.vaos[a].destroy()}static simpleSegment(r,a,d,m){return new os([{vertexOffset:r,primitiveOffset:a,vertexLength:d,primitiveLength:m,vaos:{},sortKey:0}])}}os.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,gn(os,"SegmentVector");var Dn=8192;class Hu{constructor(r,a){r&&(a?this.setSouthWest(r).setNorthEast(a):r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1]))}setNorthEast(r){return this._ne=r instanceof Yr?new Yr(r.lng,r.lat):Yr.convert(r),this}setSouthWest(r){return this._sw=r instanceof Yr?new Yr(r.lng,r.lat):Yr.convert(r),this}extend(r){const a=this._sw,d=this._ne;let m,v;if(r instanceof Yr)m=r,v=r;else{if(!(r instanceof Hu))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(Hu.convert(r)):this.extend(Yr.convert(r)):typeof r=="object"&&r!==null&&r.hasOwnProperty("lat")&&(r.hasOwnProperty("lon")||r.hasOwnProperty("lng"))?this.extend(Yr.convert(r)):this;if(m=r._sw,v=r._ne,!m||!v)return this}return a||d?(a.lng=Math.min(m.lng,a.lng),a.lat=Math.min(m.lat,a.lat),d.lng=Math.max(v.lng,d.lng),d.lat=Math.max(v.lat,d.lat)):(this._sw=new Yr(m.lng,m.lat),this._ne=new Yr(v.lng,v.lat)),this}getCenter(){return new Yr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Yr(this.getWest(),this.getNorth())}getSouthEast(){return new Yr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:a,lat:d}=Yr.convert(r);let m=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&m}static convert(r){return!r||r instanceof Hu?r:new Hu(r)}}var fp=1e-6,da=typeof Float32Array<"u"?Float32Array:Array;function Tv(){var s=new da(9);return da!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function Db(s,r,a){var d=r[0],m=r[1],v=r[2],w=r[3],C=r[4],I=r[5],P=r[6],B=r[7],F=r[8],$=a[0],X=a[1],J=a[2],oe=a[3],_e=a[4],Re=a[5],Be=a[6],Pe=a[7],ze=a[8];return s[0]=$*d+X*w+J*P,s[1]=$*m+X*C+J*B,s[2]=$*v+X*I+J*F,s[3]=oe*d+_e*w+Re*P,s[4]=oe*m+_e*C+Re*B,s[5]=oe*v+_e*I+Re*F,s[6]=Be*d+Pe*w+ze*P,s[7]=Be*m+Pe*C+ze*B,s[8]=Be*v+Pe*I+ze*F,s}function dl(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function cy(s,r){var a=r[0],d=r[1],m=r[2],v=r[3],w=r[4],C=r[5],I=r[6],P=r[7],B=r[8],F=r[9],$=r[10],X=r[11],J=r[12],oe=r[13],_e=r[14],Re=r[15],Be=a*C-d*w,Pe=a*I-m*w,ze=a*P-v*w,Ue=d*I-m*C,Fe=d*P-v*C,ut=m*P-v*I,ot=B*oe-F*J,bt=B*_e-$*J,$t=B*Re-X*J,pt=F*_e-$*oe,Rt=F*Re-X*oe,Mt=$*Re-X*_e,Nt=Be*Mt-Pe*Rt+ze*pt+Ue*$t-Fe*bt+ut*ot;return Nt?(s[0]=(C*Mt-I*Rt+P*pt)*(Nt=1/Nt),s[1]=(m*Rt-d*Mt-v*pt)*Nt,s[2]=(oe*ut-_e*Fe+Re*Ue)*Nt,s[3]=($*Fe-F*ut-X*Ue)*Nt,s[4]=(I*$t-w*Mt-P*bt)*Nt,s[5]=(a*Mt-m*$t+v*bt)*Nt,s[6]=(_e*ze-J*ut-Re*Pe)*Nt,s[7]=(B*ut-$*ze+X*Pe)*Nt,s[8]=(w*Rt-C*$t+P*ot)*Nt,s[9]=(d*$t-a*Rt-v*ot)*Nt,s[10]=(J*Fe-oe*ze+Re*Be)*Nt,s[11]=(F*ze-B*Fe-X*Be)*Nt,s[12]=(C*bt-w*pt-I*ot)*Nt,s[13]=(a*pt-d*bt+m*ot)*Nt,s[14]=(oe*Pe-J*Ue-_e*Be)*Nt,s[15]=(B*Ue-F*Pe+$*Be)*Nt,s):null}function Vh(s,r,a){var d=r[0],m=r[1],v=r[2],w=r[3],C=r[4],I=r[5],P=r[6],B=r[7],F=r[8],$=r[9],X=r[10],J=r[11],oe=r[12],_e=r[13],Re=r[14],Be=r[15],Pe=a[0],ze=a[1],Ue=a[2],Fe=a[3];return s[0]=Pe*d+ze*C+Ue*F+Fe*oe,s[1]=Pe*m+ze*I+Ue*$+Fe*_e,s[2]=Pe*v+ze*P+Ue*X+Fe*Re,s[3]=Pe*w+ze*B+Ue*J+Fe*Be,s[4]=(Pe=a[4])*d+(ze=a[5])*C+(Ue=a[6])*F+(Fe=a[7])*oe,s[5]=Pe*m+ze*I+Ue*$+Fe*_e,s[6]=Pe*v+ze*P+Ue*X+Fe*Re,s[7]=Pe*w+ze*B+Ue*J+Fe*Be,s[8]=(Pe=a[8])*d+(ze=a[9])*C+(Ue=a[10])*F+(Fe=a[11])*oe,s[9]=Pe*m+ze*I+Ue*$+Fe*_e,s[10]=Pe*v+ze*P+Ue*X+Fe*Re,s[11]=Pe*w+ze*B+Ue*J+Fe*Be,s[12]=(Pe=a[12])*d+(ze=a[13])*C+(Ue=a[14])*F+(Fe=a[15])*oe,s[13]=Pe*m+ze*I+Ue*$+Fe*_e,s[14]=Pe*v+ze*P+Ue*X+Fe*Re,s[15]=Pe*w+ze*B+Ue*J+Fe*Be,s}function nf(s,r,a){var d,m,v,w,C,I,P,B,F,$,X,J,oe=a[0],_e=a[1],Re=a[2];return r===s?(s[12]=r[0]*oe+r[4]*_e+r[8]*Re+r[12],s[13]=r[1]*oe+r[5]*_e+r[9]*Re+r[13],s[14]=r[2]*oe+r[6]*_e+r[10]*Re+r[14],s[15]=r[3]*oe+r[7]*_e+r[11]*Re+r[15]):(m=r[1],v=r[2],w=r[3],C=r[4],I=r[5],P=r[6],B=r[7],F=r[8],$=r[9],X=r[10],J=r[11],s[0]=d=r[0],s[1]=m,s[2]=v,s[3]=w,s[4]=C,s[5]=I,s[6]=P,s[7]=B,s[8]=F,s[9]=$,s[10]=X,s[11]=J,s[12]=d*oe+C*_e+F*Re+r[12],s[13]=m*oe+I*_e+$*Re+r[13],s[14]=v*oe+P*_e+X*Re+r[14],s[15]=w*oe+B*_e+J*Re+r[15]),s}function Fh(s,r,a){var d=a[0],m=a[1],v=a[2];return s[0]=r[0]*d,s[1]=r[1]*d,s[2]=r[2]*d,s[3]=r[3]*d,s[4]=r[4]*m,s[5]=r[5]*m,s[6]=r[6]*m,s[7]=r[7]*m,s[8]=r[8]*v,s[9]=r[9]*v,s[10]=r[10]*v,s[11]=r[11]*v,s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15],s}function uy(s,r,a){var d=Math.sin(a),m=Math.cos(a),v=r[4],w=r[5],C=r[6],I=r[7],P=r[8],B=r[9],F=r[10],$=r[11];return r!==s&&(s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[4]=v*m+P*d,s[5]=w*m+B*d,s[6]=C*m+F*d,s[7]=I*m+$*d,s[8]=P*m-v*d,s[9]=B*m-w*d,s[10]=F*m-C*d,s[11]=$*m-I*d,s}function hy(s,r,a){var d=Math.sin(a),m=Math.cos(a),v=r[0],w=r[1],C=r[2],I=r[3],P=r[8],B=r[9],F=r[10],$=r[11];return r!==s&&(s[4]=r[4],s[5]=r[5],s[6]=r[6],s[7]=r[7],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[0]=v*m-P*d,s[1]=w*m-B*d,s[2]=C*m-F*d,s[3]=I*m-$*d,s[8]=v*d+P*m,s[9]=w*d+B*m,s[10]=C*d+F*m,s[11]=I*d+$*m,s}function Lb(s,r){return s[0]=r[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=r[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=r[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Ev(s,r,a){var d,m,v,w=a[0],C=a[1],I=a[2],P=Math.hypot(w,C,I);return P<fp?null:(w*=P=1/P,C*=P,I*=P,d=Math.sin(r),m=Math.cos(r),s[0]=w*w*(v=1-m)+m,s[1]=C*w*v+I*d,s[2]=I*w*v-C*d,s[3]=0,s[4]=w*C*v-I*d,s[5]=C*C*v+m,s[6]=I*C*v+w*d,s[7]=0,s[8]=w*I*v+C*d,s[9]=C*I*v-w*d,s[10]=I*I*v+m,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s)}Math.hypot||(Math.hypot=function(){for(var s=0,r=arguments.length;r--;)s+=arguments[r]*arguments[r];return Math.sqrt(s)});var jm=Vh;function $m(){var s=new da(3);return da!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function qm(s){var r=new da(3);return r[0]=s[0],r[1]=s[1],r[2]=s[2],r}function pp(s){return Math.hypot(s[0],s[1],s[2])}function rf(s,r,a){var d=new da(3);return d[0]=s,d[1]=r,d[2]=a,d}function fl(s,r,a){return s[0]=r[0]+a[0],s[1]=r[1]+a[1],s[2]=r[2]+a[2],s}function dy(s,r,a){return s[0]=r[0]-a[0],s[1]=r[1]-a[1],s[2]=r[2]-a[2],s}function fy(s,r,a){return s[0]=r[0]*a[0],s[1]=r[1]*a[1],s[2]=r[2]*a[2],s}function mp(s,r,a){return s[0]=Math.min(r[0],a[0]),s[1]=Math.min(r[1],a[1]),s[2]=Math.min(r[2],a[2]),s}function sf(s,r,a){return s[0]=Math.max(r[0],a[0]),s[1]=Math.max(r[1],a[1]),s[2]=Math.max(r[2],a[2]),s}function fa(s,r,a){return s[0]=r[0]*a,s[1]=r[1]*a,s[2]=r[2]*a,s}function gp(s,r,a,d){return s[0]=r[0]+a[0]*d,s[1]=r[1]+a[1]*d,s[2]=r[2]+a[2]*d,s}function Po(s,r){var a=r[0],d=r[1],m=r[2],v=a*a+d*d+m*m;return v>0&&(v=1/Math.sqrt(v)),s[0]=r[0]*v,s[1]=r[1]*v,s[2]=r[2]*v,s}function oo(s,r){return s[0]*r[0]+s[1]*r[1]+s[2]*r[2]}function py(s,r,a){var d=r[0],m=r[1],v=r[2],w=a[0],C=a[1],I=a[2];return s[0]=m*I-v*C,s[1]=v*w-d*I,s[2]=d*C-m*w,s}function as(s,r,a){var d=r[0],m=r[1],v=r[2],w=a[3]*d+a[7]*m+a[11]*v+a[15];return s[0]=(a[0]*d+a[4]*m+a[8]*v+a[12])/(w=w||1),s[1]=(a[1]*d+a[5]*m+a[9]*v+a[13])/w,s[2]=(a[2]*d+a[6]*m+a[10]*v+a[14])/w,s}function Sv(s,r,a){var d=a[0],m=a[1],v=a[2],w=r[0],C=r[1],I=r[2],P=m*I-v*C,B=v*w-d*I,F=d*C-m*w,$=m*F-v*B,X=v*P-d*F,J=d*B-m*P,oe=2*a[3];return B*=oe,F*=oe,X*=2,J*=2,s[0]=w+(P*=oe)+($*=2),s[1]=C+B+X,s[2]=I+F+J,s}var Uh,Ll=dy,Cv=fy,Ob=pp;function Av(s,r,a){return s[0]=r[0]*a,s[1]=r[1]*a,s[2]=r[2]*a,s[3]=r[3]*a,s}function zb(s,r){var a=r[0],d=r[1],m=r[2],v=r[3],w=a*a+d*d+m*m+v*v;return w>0&&(w=1/Math.sqrt(w)),s[0]=a*w,s[1]=d*w,s[2]=m*w,s[3]=v*w,s}function Wu(s,r,a){var d=r[0],m=r[1],v=r[2],w=r[3];return s[0]=a[0]*d+a[4]*m+a[8]*v+a[12]*w,s[1]=a[1]*d+a[5]*m+a[9]*v+a[13]*w,s[2]=a[2]*d+a[6]*m+a[10]*v+a[14]*w,s[3]=a[3]*d+a[7]*m+a[11]*v+a[15]*w,s}function Ss(){var s=new da(4);return da!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function ao(s){return s[0]=0,s[1]=0,s[2]=0,s[3]=1,s}function Iv(s,r,a){a*=.5;var d=r[0],m=r[1],v=r[2],w=r[3],C=Math.sin(a),I=Math.cos(a);return s[0]=d*I+w*C,s[1]=m*I+v*C,s[2]=v*I-m*C,s[3]=w*I-d*C,s}function Rv(s,r,a){a*=.5;var d=r[0],m=r[1],v=r[2],w=r[3],C=Math.sin(a),I=Math.cos(a);return s[0]=d*I-v*C,s[1]=m*I+w*C,s[2]=v*I+d*C,s[3]=w*I-m*C,s}$m(),Uh=new da(4),da!=Float32Array&&(Uh[0]=0,Uh[1]=0,Uh[2]=0,Uh[3]=0);var Bb=zb;$m(),rf(1,0,0),rf(0,1,0),Ss(),Ss(),Tv();const Nb=Ye([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:yp}=Nb,Mv=Ye([{name:"a_pos_3",components:3,type:"Int16"}]);var jh=Ye([{name:"a_pos",type:"Int16",components:2}]);class my{constructor(r,a){this.pos=r,this.dir=a}intersectsPlane(r,a,d){const m=oo(a,this.dir);if(Math.abs(m)<1e-6)return!1;const v=((r[0]-this.pos[0])*a[0]+(r[1]-this.pos[1])*a[1]+(r[2]-this.pos[2])*a[2])/m;return d[0]=this.pos[0]+this.dir[0]*v,d[1]=this.pos[1]+this.dir[1]*v,d[2]=this.pos[2]+this.dir[2]*v,!0}closestPointOnSphere(r,a,d){if((function(X,J){var oe=X[0],_e=X[1],Re=X[2],Be=J[0],Pe=J[1],ze=J[2];return Math.abs(oe-Be)<=fp*Math.max(1,Math.abs(oe),Math.abs(Be))&&Math.abs(_e-Pe)<=fp*Math.max(1,Math.abs(_e),Math.abs(Pe))&&Math.abs(Re-ze)<=fp*Math.max(1,Math.abs(Re),Math.abs(ze))})(this.pos,r)||a===0)return d[0]=d[1]=d[2]=0,!1;const[m,v,w]=this.dir,C=this.pos[0]-r[0],I=this.pos[1]-r[1],P=this.pos[2]-r[2],B=m*m+v*v+w*w,F=2*(C*m+I*v+P*w),$=F*F-4*B*(C*C+I*I+P*P-a*a);if($<0){const X=Math.max(-F/2,0),J=C+m*X,oe=I+v*X,_e=P+w*X,Re=Math.hypot(J,oe,_e);return d[0]=J*a/Re,d[1]=oe*a/Re,d[2]=_e*a/Re,!1}{const X=(-F-Math.sqrt($))/(2*B);if(X<0){const J=Math.hypot(C,I,P);return d[0]=C*a/J,d[1]=I*a/J,d[2]=P*a/J,!1}return d[0]=C+m*X,d[1]=I+v*X,d[2]=P+w*X,!0}}}class Pv{constructor(r,a,d,m,v){this.TL=r,this.TR=a,this.BR=d,this.BL=m,this.horizon=v}static fromInvProjectionMatrix(r,a,d){const m=[-1,1,1],v=[1,1,1],w=[1,-1,1],C=[-1,-1,1],I=as(m,m,r),P=as(v,v,r),B=as(w,w,r),F=as(C,C,r);return new Pv(I,P,B,F,a/d)}}class _p{constructor(r,a){this.points=r,this.planes=a}static fromInvProjectionMatrix(r,a,d,m){const v=Math.pow(2,d),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((I=>{const P=Wu([],I,r),B=1/P[3]/a*v;return(function(F,$,X){return F[0]=$[0]*X[0],F[1]=$[1]*X[1],F[2]=$[2]*X[2],F[3]=$[3]*X[3],F})(P,P,[B,B,m?1/P[3]:B,B])})),C=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((I=>{const P=Po([],py([],Ll([],w[I[0]],w[I[1]]),Ll([],w[I[2]],w[I[1]]))),B=-oo(P,w[I[1]]);return P.concat(B)}));return new _p(w,C)}}class lo{static fromPoints(r){const a=[1/0,1/0,1/0],d=[-1/0,-1/0,-1/0];for(const m of r)mp(a,a,m),sf(d,d,m);return new lo(a,d)}static applyTransform(r,a){const d=r.getCorners();for(let m=0;m<d.length;++m)as(d[m],d[m],a);return lo.fromPoints(d)}constructor(r,a){this.min=r,this.max=a,this.center=fa([],fl([],this.min,this.max),.5)}quadrant(r){const a=[r%2==0,r<2],d=qm(this.min),m=qm(this.max);for(let v=0;v<a.length;v++)d[v]=a[v]?this.min[v]:this.center[v],m[v]=a[v]?this.center[v]:this.max[v];return m[2]=this.max[2],new lo(d,m)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}distanceZ(r){return Math.max(Math.min(this.max[2],r[2]),this.min[2])-r[2]}getCorners(){const r=this.min,a=this.max;return[[r[0],r[1],r[2]],[a[0],r[1],r[2]],[a[0],a[1],r[2]],[r[0],a[1],r[2]],[r[0],r[1],a[2]],[a[0],r[1],a[2]],[a[0],a[1],a[2]],[r[0],a[1],a[2]]]}intersects(r){const a=this.getCorners();let d=!0;for(let m=0;m<r.planes.length;m++){const v=r.planes[m];let w=0;for(let C=0;C<a.length;C++)w+=oo(v,a[C])+v[3]>=0;if(w===0)return 0;w!==a.length&&(d=!1)}if(d)return 2;for(let m=0;m<3;m++){let v=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let C=0;C<r.points.length;C++){const I=r.points[C][m]-this.min[m];v=Math.min(v,I),w=Math.max(w,I)}if(w<0||v>this.max[m]-this.min[m])return 0}return 1}}const gy=5,kv=6,cc=Dn/Math.PI/2,Dv=16383,Xu=64,of=[Xu,32,16],pl=-cc,Fa=cc,yy=[new lo([pl,pl,pl],[Fa,Fa,Fa]),new lo([pl,pl,pl],[0,0,Fa]),new lo([0,pl,pl],[Fa,0,Fa]),new lo([pl,0,pl],[0,Fa,Fa]),new lo([0,0,pl],[Fa,Fa,Fa])];function vp(s){return s*cc/wp}function Lv(s,r,a,d=!0){const m=fa([],s._camera.position,s.worldSize),v=[r,a,1,1];Wu(v,v,s.pixelMatrixInverse),Av(v,v,1/v[3]);const w=Po([],Ll([],v,m)),C=s.globeMatrix,I=[C[12],C[13],C[14]],P=Ll([],I,m),B=pp(P),F=Po([],P),$=s.worldSize/(2*Math.PI),X=oo(F,w),J=Math.asin($/B);if(J<Math.acos(X)){if(!d)return null;const $t=[],pt=[];fa($t,w,B/X),Po(pt,Ll(pt,$t,P)),Po(w,fl(w,P,fa(w,pt,Math.tan(J)*B)))}const oe=[];new my(m,w).closestPointOnSphere(I,$,oe);const _e=Po([],Xn(C,0)),Re=Po([],Xn(C,1)),Be=Po([],Xn(C,2)),Pe=oo(_e,oe),ze=oo(Re,oe),Ue=oo(Be,oe),Fe=Ne(Math.asin(-ze/$));let ut=Ne(Math.atan2(Pe,Ue));ut=s.center.lng+(function($t,pt){const Rt=(pt-$t+180)%360-180;return Rt<-180?Rt+360:Rt})(s.center.lng,ut);const ot=uo(ut),bt=et(ki(Fe),0,1);return new Di(ot,bt)}class Ov{constructor(r,a,d){this.a=Ll([],r,d),this.b=Ll([],a,d),this.center=d;const m=Po([],this.a),v=Po([],this.b);this.angle=Math.acos(oo(m,v))}}function _y(s,r){if(s.angle===0)return null;let a;return a=s.a[r]===0?1/s.angle*.5*Math.PI:1/s.angle*Math.atan(s.b[r]/s.a[r]/Math.sin(s.angle)-1/Math.tan(s.angle)),a<0||a>1?null:(function(d,m,v,w){const C=Math.sin(v);return d*(Math.sin((1-w)*v)/C)+m*(Math.sin(w*v)/C)})(s.a[r],s.b[r],s.angle,et(a,0,1))+s.center[r]}function co(s){if(s.z<=1)return yy[s.z+2*s.y+s.x];const r=vy(xp(s));return lo.fromPoints(r)}function Zu(s,r,a){return fa(s,s,1-a),gp(s,s,r,a)}function Vb(s,r){const a=lf(r.zoom);if(a===0)return co(s);const d=xp(s),m=vy(d),v=uo(d.getWest())*r.worldSize,w=uo(d.getEast())*r.worldSize,C=ki(d.getNorth())*r.worldSize,I=ki(d.getSouth())*r.worldSize,P=[v,C,0],B=[w,C,0],F=[v,I,0],$=[w,I,0],X=cy([],r.globeMatrix);return as(P,P,X),as(B,B,X),as(F,F,X),as($,$,X),m[0]=Zu(m[0],F,a),m[1]=Zu(m[1],$,a),m[2]=Zu(m[2],B,a),m[3]=Zu(m[3],P,a),lo.fromPoints(m)}function zv(s,r,a){for(const d of s)as(d,d,r),fa(d,d,a)}function Ku(s,r,a){const d=r/s.worldSize,m=s.globeMatrix;if(a.z<=1){const ot=co(a).getCorners();return zv(ot,m,d),lo.fromPoints(ot)}const v=xp(a),w=vy(v);zv(w,m,d);const C=Number.MAX_VALUE,I=[-C,-C,-C],P=[C,C,C];if(v.contains(s.center)){for(const $t of w)mp(P,P,$t),sf(I,I,$t);I[2]=0;const ot=s.point,bt=[ot.x*d,ot.y*d,0];return mp(P,P,bt),sf(I,I,bt),new lo(P,I)}const B=[m[12]*d,m[13]*d,m[14]*d],F=v.getCenter(),$=et(s.center.lat,-Ws,Ws),X=et(F.lat,-Ws,Ws),J=uo(s.center.lng),oe=ki($);let _e=J-uo(F.lng);const Re=oe-ki(X);_e>.5?_e-=1:_e<-.5&&(_e+=1);let Be=0;Math.abs(_e)>Math.abs(Re)?Be=_e>=0?1:3:(Be=Re>=0?0:2,gp(B,B,[m[4]*d,m[5]*d,m[6]*d],-Math.sin(le(Re>=0?v.getSouth():v.getNorth()))*cc));const Pe=w[Be],ze=w[(Be+1)%4],Ue=new Ov(Pe,ze,B),Fe=[_y(Ue,0)||Pe[0],_y(Ue,1)||Pe[1],_y(Ue,2)||Pe[2]],ut=lf(s.zoom);if(ut>0){const ot=(function({x:$t,y:pt,z:Rt},Mt,Nt,Zt,xt){const dn=1/(1<<Rt);let wn=$t*dn,fn=wn+dn,lr=pt*dn,Yt=lr+dn,Vn=0;const cr=(wn+fn)/2-Zt;return cr>.5?Vn=-1:cr<-.5&&(Vn=1),wn=((wn+Vn)*Mt-(Zt*=Mt))*Nt+Zt,fn=((fn+Vn)*Mt-Zt)*Nt+Zt,lr=(lr*Mt-(xt*=Mt))*Nt+xt,Yt=(Yt*Mt-xt)*Nt+xt,[[wn,Yt,0],[fn,Yt,0],[fn,lr,0],[wn,lr,0]]})(a,r,s._pixelsPerMercatorPixel,J,oe);for(let $t=0;$t<w.length;$t++)Zu(w[$t],ot[$t],ut);const bt=fl([],ot[Be],ot[(Be+1)%4]);fa(bt,bt,.5),Zu(Fe,bt,ut)}for(const ot of w)mp(P,P,ot),sf(I,I,ot);return P[2]=Math.min(Pe[2],ze[2]),mp(P,P,Fe),sf(I,I,Fe),new lo(P,I)}function xp({x:s,y:r,z:a}){const d=1/(1<<a),m=new Yr(Ua(s*d),Qr((r+1)*d)),v=new Yr(Ua((s+1)*d),Qr(r*d));return new Hu(m,v)}function vy(s){const r=le(s.getNorth()),a=le(s.getSouth()),d=Math.cos(r),m=Math.cos(a),v=Math.sin(r),w=Math.sin(a),C=s.getWest(),I=s.getEast();return[Yu(m,w,C),Yu(m,w,I),Yu(d,v,I),Yu(d,v,C)]}function Yu(s,r,a,d=cc){return a=le(a),[s*Math.sin(a)*d,-r*d,s*Math.cos(a)*d]}function Gc(s,r,a){return Yu(Math.cos(le(s)),Math.sin(le(s)),r,a)}function Pi(s,r,a,d){const m=1<<a.z,v=(s/Dn+a.x)/m;return Gc(Qr((r/Dn+a.y)/m),Ua(v),d)}function xy({min:s,max:r}){return Dv/Math.max(r[0]-s[0],r[1]-s[1],r[2]-s[2])}const Fb=new Float64Array(16);function bp(s){const r=xy(s),a=Lb(Fb,[r,r,r]);return nf(a,a,((d=[])[0]=-(m=s.min)[0],d[1]=-m[1],d[2]=-m[2],d));var d,m}function af(s){const r=(d=s.min,(a=Fb)[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=d[0],a[13]=d[1],a[14]=d[2],a[15]=1,a);var a,d;const m=1/xy(s);return Fh(r,r,[m,m,m])}function Qu(s,r,a,d,m){const v=(function(I){const P=Dn/(2*Math.PI);return I/(2*Math.PI)/P})(a),w=[s,r,-a/(2*Math.PI)],C=dl(new Float64Array(16));return nf(C,C,w),Fh(C,C,[v,v,v]),uy(C,C,le(-m)),hy(C,C,le(-d)),C}function lf(s){return Kt(gy,kv,s)}function Bv(s,r){const a=Gc(r.lat,r.lng),d=(function(J){const oe=Gc(J._center.lat,J._center.lng);let _e=py([],rf(0,1,0),oe);const Re=Ev([],-J.angle,oe);_e=as(_e,_e,Re),Ev(Re,-J._pitch,_e);const Be=Po([],oe);return fa(Be,Be,vp(J.cameraToCenterDistance/J.pixelsPerMeter)),as(Be,Be,Re),fl([],oe,Be)})(s);return w=(m=dy([],d,a))[0],C=m[1],I=m[2],P=(v=a)[0],B=v[1],F=v[2],X=($=Math.sqrt(w*w+C*C+I*I)*Math.sqrt(P*P+B*B+F*F))&&oo(m,v)/$,Math.acos(Math.min(Math.max(X,-1),1));var m,v,w,C,I,P,B,F,$,X}function cf(s,r){return Bv(s,r)>Math.PI/2*1.01}const uc=le(85),Ub=Math.cos(uc),Nv=Math.sin(uc),wp=63710088e-1,by=2*Math.PI*wp;class Hc{constructor(r,a){if(isNaN(r)||isNaN(a))throw new Error(`Invalid LngLat object: (${r}, ${a})`);if(this.lng=+r,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Hc(De(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const a=Math.PI/180,d=this.lat*a,m=r.lat*a,v=Math.sin(d)*Math.sin(m)+Math.cos(d)*Math.cos(m)*Math.cos((r.lng-this.lng)*a);return wp*Math.acos(Math.min(v,1))}toBounds(r=0){const a=360*r/40075017,d=a/Math.cos(Math.PI/180*this.lat);return new Hu(new Hc(this.lng-d,this.lat-a),new Hc(this.lng+d,this.lat+a))}toEcef(r){const a=vp(r);return Gc(this.lat,this.lng,cc+a)}static convert(r){if(r instanceof Hc)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new Hc(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new Hc(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Yr=Hc;function wy(s){return by*Math.cos(s*Math.PI/180)}function uo(s){return(180+s)/360}function ki(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function ml(s,r){return s/wy(r)}function Ua(s){return 360*s-180}function Qr(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function jb(s,r){return s*wy(Qr(r))}const Ws=85.051129;function Vv(s){return 1/Math.cos(s*Math.PI/180)}class Di{constructor(r,a,d=0){this.x=+r,this.y=+a,this.z=+d}static fromLngLat(r,a=0){const d=Yr.convert(r);return new Di(uo(d.lng),ki(d.lat),ml(a,d.lat))}toLngLat(){return new Yr(Ua(this.x),Qr(this.y))}toAltitude(){return jb(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/by*Vv(Qr(this.y))}}function Ko(s,r,a,d,m,v,w,C,I){const P=(r+d)/2,B=(a+m)/2,F=new se(P,B);C(F),(function($,X,J,oe,_e,Re){const Be=J-_e,Pe=oe-Re;return Math.abs((oe-X)*Be-(J-$)*Pe)/Math.hypot(Be,Pe)})(F.x,F.y,v.x,v.y,w.x,w.y)>=I?(Ko(s,r,a,P,B,v,F,C,I),Ko(s,P,B,d,m,F,w,C,I)):s.push(w)}function Wc(s,r,a){let d=s[0],m=d.x,v=d.y;r(d);const w=[d];for(let C=1;C<s.length;C++){const I=s[C],{x:P,y:B}=I;r(I),Ko(w,m,v,P,B,d,I,r,a),m=P,v=B,d=I}return w}function Ty(s,r,a,d){if(d(r,a)){const m=r.add(a)._mult(.5);Ty(s,r,m,d),Ty(s,m,a,d)}else s.push(a)}function $b(s,r){let a=s[0];const d=[a];for(let m=1;m<s.length;m++){const v=s[m];Ty(d,a,v,r),a=v}return d}const Ey=Math.pow(2,14)-1,qb=-Ey-1;function Sy(s,r){const a=Math.round(s.x*r),d=Math.round(s.y*r);return s.x=et(a,qb,Ey),s.y=et(d,qb,Ey),(a<s.x||a>s.x+1||d<s.y||d>s.y+1)&&Rn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),s}function _s(s,r,a){const d=s.loadGeometry(),m=s.extent,v=Dn/m;if(r&&a&&a.projection.isReprojectedInTileSpace){const w=1<<r.z,{scale:C,x:I,y:P,projection:B}=a,F=$=>{const X=Ua((r.x+$.x/m)/w),J=Qr((r.y+$.y/m)/w),oe=B.project(X,J);$.x=(oe.x*C-I)*m,$.y=(oe.y*C-P)*m};for(let $=0;$<d.length;$++)if(s.type!==1)d[$]=Wc(d[$],F,1);else{const X=[];for(const J of d[$])J.x<0||J.x>=m||J.y<0||J.y>=m||(F(J),X.push(J));d[$]=X}}for(const w of d)for(const C of w)Sy(C,v);return d}function ko(s,r){return{type:s.type,id:s.id,properties:s.properties,geometry:r?_s(s):[]}}function Gm(s,r,a,d,m){s.emplaceBack(2*r+(d+1)/2,2*a+(m+1)/2)}function Do(s,r,a){s.emplaceBack(r.x,r.y,r.z,a[0]*16384,a[1]*16384,a[2]*16384)}class Cy{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((a=>a.id)),this.index=r.index,this.hasPattern=!1,this.projection=r.projection,this.layoutVertexArray=new Vt,this.indexArray=new Tn,this.segments=new os,this.programConfigurations=new qc(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter((a=>a.isStateDependent())).map((a=>a.id))}populate(r,a,d,m){const v=this.layers[0],w=[];let C=null;v.type==="circle"&&(C=v.layout.get("circle-sort-key"));for(const{feature:P,id:B,index:F,sourceLayerIndex:$}of r){const X=this.layers[0]._featureFilter.needGeometry,J=ko(P,X);if(!this.layers[0]._featureFilter.filter(new V(this.zoom),J,d))continue;const oe=C?C.evaluate(J,{},d):void 0,_e={id:B,properties:P.properties,type:P.type,sourceLayerIndex:$,index:F,geometry:X?J.geometry:_s(P,d,m),patterns:{},sortKey:oe};w.push(_e)}C&&w.sort(((P,B)=>P.sortKey-B.sortKey));let I=null;m.projection.name==="globe"&&(this.globeExtVertexArray=new zt,I=m.projection);for(const P of w){const{geometry:B,index:F,sourceLayerIndex:$}=P,X=r[F].feature;this.addFeature(P,B,F,a.availableImages,d,I),a.featureIndex.insert(X,B,F,$,this.index)}}update(r,a,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,d,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Pb.members),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,kb.members))),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(r,a,d,m,v,w){for(const C of a)for(const I of C){const P=I.x,B=I.y;if(P<0||P>=Dn||B<0||B>=Dn)continue;if(w){const X=w.projectTilePoint(P,B,v),J=w.upVector(v,P,B),oe=this.globeExtVertexArray;Do(oe,X,J),Do(oe,X,J),Do(oe,X,J),Do(oe,X,J)}const F=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),$=F.vertexLength;Gm(this.layoutVertexArray,P,B,-1,-1),Gm(this.layoutVertexArray,P,B,1,-1),Gm(this.layoutVertexArray,P,B,1,1),Gm(this.layoutVertexArray,P,B,-1,1),this.indexArray.emplaceBack($,$+1,$+2),this.indexArray.emplaceBack($,$+2,$+3),F.vertexLength+=4,F.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,d,{},m,v)}}function Xc(s,r){for(let a=0;a<s.length;a++)if(dc(r,s[a]))return!0;for(let a=0;a<r.length;a++)if(dc(s,r[a]))return!0;return!!Hm(s,r)}function uf(s,r,a){return!!dc(s,r)||!!Ay(r,s,a)}function Zc(s,r){if(s.length===1)return Tp(r,s[0]);for(let a=0;a<r.length;a++){const d=r[a];for(let m=0;m<d.length;m++)if(dc(s,d[m]))return!0}for(let a=0;a<s.length;a++)if(Tp(r,s[a]))return!0;for(let a=0;a<r.length;a++)if(Hm(s,r[a]))return!0;return!1}function Fv(s,r,a){if(s.length>1){if(Hm(s,r))return!0;for(let d=0;d<r.length;d++)if(Ay(r[d],s,a))return!0}for(let d=0;d<s.length;d++)if(Ay(s[d],r,a))return!0;return!1}function Hm(s,r){if(s.length===0||r.length===0)return!1;for(let a=0;a<s.length-1;a++){const d=s[a],m=s[a+1];for(let v=0;v<r.length-1;v++)if(hc(d,m,r[v],r[v+1]))return!0}return!1}function hc(s,r,a,d){return An(s,a,d)!==An(r,a,d)&&An(s,r,a)!==An(s,r,d)}function Ay(s,r,a){const d=a*a;if(r.length===1)return s.distSqr(r[0])<d;for(let m=1;m<r.length;m++)if(hf(s,r[m-1],r[m])<d)return!0;return!1}function hf(s,r,a){const d=r.distSqr(a);if(d===0)return s.distSqr(r);const m=((s.x-r.x)*(a.x-r.x)+(s.y-r.y)*(a.y-r.y))/d;return s.distSqr(m<0?r:m>1?a:a.sub(r)._mult(m)._add(r))}function Tp(s,r){let a,d,m,v=!1;for(let w=0;w<s.length;w++){a=s[w];for(let C=0,I=a.length-1;C<a.length;I=C++)d=a[C],m=a[I],d.y>r.y!=m.y>r.y&&r.x<(m.x-d.x)*(r.y-d.y)/(m.y-d.y)+d.x&&(v=!v)}return v}function dc(s,r){let a=!1;for(let d=0,m=s.length-1;d<s.length;m=d++){const v=s[d],w=s[m];v.y>r.y!=w.y>r.y&&r.x<(w.x-v.x)*(r.y-v.y)/(w.y-v.y)+v.x&&(a=!a)}return a}function df(s,r,a,d,m){for(const w of s)if(r<=w.x&&a<=w.y&&d>=w.x&&m>=w.y)return!0;const v=[new se(r,a),new se(r,m),new se(d,m),new se(d,a)];if(s.length>2){for(const w of v)if(dc(s,w))return!0}for(let w=0;w<s.length-1;w++)if(Gb(s[w],s[w+1],v))return!0;return!1}function Gb(s,r,a){const d=a[0],m=a[2];if(s.x<d.x&&r.x<d.x||s.x>m.x&&r.x>m.x||s.y<d.y&&r.y<d.y||s.y>m.y&&r.y>m.y)return!1;const v=An(s,r,a[0]);return v!==An(s,r,a[1])||v!==An(s,r,a[2])||v!==An(s,r,a[3])}function ff(s,r,a){const d=r.paint.get(s).value;return d.kind==="constant"?d.value:a.programConfigurations.get(r.id).getMaxValue(s)}function $h(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function Uv(s,r,a,d,m){if(!r[0]&&!r[1])return s;const v=se.convert(r)._mult(m);a==="viewport"&&v._rotate(-d);const w=[];for(let C=0;C<s.length;C++)w.push(s[C].sub(v));return w}function Wm(s,r,a,d){const m=se.convert(s)._mult(d);return r==="viewport"&&m._rotate(-a),m}gn(Cy,"CircleBucket",{omit:["layers"]});const Hb=new Le({"circle-sort-key":new be(vt.layout_circle["circle-sort-key"])});var PE={paint:new Le({"circle-radius":new be(vt.paint_circle["circle-radius"]),"circle-color":new be(vt.paint_circle["circle-color"]),"circle-blur":new be(vt.paint_circle["circle-blur"]),"circle-opacity":new be(vt.paint_circle["circle-opacity"]),"circle-translate":new ne(vt.paint_circle["circle-translate"]),"circle-translate-anchor":new ne(vt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ne(vt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ne(vt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new be(vt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new be(vt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new be(vt.paint_circle["circle-stroke-opacity"])}),layout:Hb};function Wb(s,r,a,d,m,v,w,C,I){if(v&&s.queryGeometry.isAboveHorizon)return!1;v&&(I*=s.pixelToTileUnitsFactor);const P=s.tileID.canonical,B=a.projection.upVectorScale(P,a.center.lat,a.worldSize).metersToTile;for(const F of r)for(const $ of F){const X=$.add(C),J=m&&a.elevation?a.elevation.exaggeration()*m.getElevationAt(X.x,X.y,!0):0,oe=a.projection.projectTilePoint(X.x,X.y,P);if(J>0){const Pe=a.projection.upVector(P,X.x,X.y);oe.x+=Pe[0]*B*J,oe.y+=Pe[1]*B*J,oe.z+=Pe[2]*B*J}const _e=v?X:xi(oe.x,oe.y,oe.z,d),Re=v?s.tilespaceRays.map((Pe=>Gr(Pe,J))):s.queryGeometry.screenGeometry,Be=Wu([],[oe.x,oe.y,oe.z,1],d);if(!w&&v?I*=Be[3]/a.cameraToCenterDistance:w&&!v&&(I*=a.cameraToCenterDistance/Be[3]),v){const Pe=Qr(($.y/Dn+P.y)/(1<<P.z));I/=a.projection.pixelsPerMeter(Pe,1)/ml(1,Pe)}if(uf(Re,_e,I))return!0}return!1}function xi(s,r,a,d){const m=Wu([],[s,r,a,1],d);return new se(m[0]/m[3],m[1]/m[3])}const Fi=rf(0,0,0),Ur=rf(0,0,1);function Gr(s,r){const a=$m();return Fi[2]=r,s.intersectsPlane(Fi,Ur,a),new se(a[0],a[1])}class Si extends Cy{}function ja(s,{width:r,height:a},d,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==r*a*d)throw new RangeError("mismatched image size")}else m=new Uint8Array(r*a*d);return s.width=r,s.height=a,s.data=m,s}function Ju(s,r,a){const{width:d,height:m}=r;d===s.width&&m===s.height||(qh(s,r,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,d),height:Math.min(s.height,m)},a),s.width=d,s.height=m,s.data=r.data)}function qh(s,r,a,d,m,v){if(m.width===0||m.height===0)return r;if(m.width>s.width||m.height>s.height||a.x>s.width-m.width||a.y>s.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>r.width||m.height>r.height||d.x>r.width-m.width||d.y>r.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const w=s.data,C=r.data;for(let I=0;I<m.height;I++){const P=((a.y+I)*s.width+a.x)*v,B=((d.y+I)*r.width+d.x)*v;for(let F=0;F<m.width*v;F++)C[B+F]=w[P+F]}return r}gn(Si,"HeatmapBucket",{omit:["layers"]});class fc{constructor(r,a){ja(this,r,1,a)}resize(r){Ju(this,new fc(r),1)}clone(){return new fc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,a,d,m,v){qh(r,a,d,m,v,1)}}class vs{constructor(r,a){ja(this,r,4,a)}resize(r){Ju(this,new vs(r),4)}replace(r,a){a?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new vs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,a,d,m,v){qh(r,a,d,m,v,4)}}gn(fc,"AlphaImage"),gn(vs,"RGBAImage");var xs={paint:new Le({"heatmap-radius":new be(vt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new be(vt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ne(vt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ke(vt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ne(vt.paint_heatmap["heatmap-opacity"])})};function Kc(s){const r={},a=s.resolution||256,d=s.clips?s.clips.length:1,m=s.image||new vs({width:a,height:d}),v=(w,C,I)=>{r[s.evaluationKey]=I;const P=s.expression.evaluate(r);m.data[w+C+0]=Math.floor(255*P.r/P.a),m.data[w+C+1]=Math.floor(255*P.g/P.a),m.data[w+C+2]=Math.floor(255*P.b/P.a),m.data[w+C+3]=Math.floor(255*P.a)};if(s.clips)for(let w=0,C=0;w<d;++w,C+=4*a)for(let I=0,P=0;I<a;I++,P+=4){const B=I/(a-1),{start:F,end:$}=s.clips[w];v(C,P,F*(1-B)+$*B)}else for(let w=0,C=0;w<a;w++,C+=4)v(0,C,w/(a-1));return m}var pf={paint:new Le({"hillshade-illumination-direction":new ne(vt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ne(vt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ne(vt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ne(vt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ne(vt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ne(vt.paint_hillshade["hillshade-accent-color"])})};const jv=Ye([{name:"a_pos",components:2,type:"Int16"}],4),{members:gl}=jv;var Gh={exports:{}};function Hh(s,r,a){a=a||2;var d,m,v,w,C,I,P,B=r&&r.length,F=B?r[0]*a:s.length,$=pa(s,0,F,a,!0),X=[];if(!$||$.next===$.prev)return X;if(B&&($=(function(oe,_e,Re,Be){var Pe,ze,Ue,Fe=[];for(Pe=0,ze=_e.length;Pe<ze;Pe++)(Ue=pa(oe,_e[Pe]*Be,Pe<ze-1?_e[Pe+1]*Be:oe.length,Be,!1))===Ue.next&&(Ue.steiner=!0),Fe.push($v(Ue));for(Fe.sort(Xs),Pe=0;Pe<Fe.length;Pe++)Re=Zh(Fe[Pe],Re);return Re})(s,r,$,a)),s.length>80*a){d=v=s[0],m=w=s[1];for(var J=a;J<F;J+=a)(C=s[J])<d&&(d=C),(I=s[J+1])<m&&(m=I),C>v&&(v=C),I>w&&(w=I);P=(P=Math.max(v-d,w-m))!==0?32767/P:0}return Wh($,X,a,d,m,P,0),X}function pa(s,r,a,d,m){var v,w;if(m===Zm(s,r,a,d)>0)for(v=r;v<a;v+=d)w=Kb(v,s[v],s[v+1],w);else for(v=a-d;v>=r;v-=d)w=Kb(v,s[v],s[v+1],w);return w&&Sp(w,w.next)&&(Ol(w),w=w.next),w}function eh(s,r){if(!s)return s;r||(r=s);var a,d=s;do if(a=!1,d.steiner||!Sp(d,d.next)&&Xi(d.prev,d,d.next)!==0)d=d.next;else{if(Ol(d),(d=r=d.prev)===d.next)break;a=!0}while(a||d!==r);return r}function Wh(s,r,a,d,m,v,w){if(s){!w&&v&&(function(B,F,$,X){var J=B;do J.z===0&&(J.z=pc(J.x,J.y,F,$,X)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next;while(J!==B);J.prevZ.nextZ=null,J.prevZ=null,(function(oe){var _e,Re,Be,Pe,ze,Ue,Fe,ut,ot=1;do{for(Re=oe,oe=null,ze=null,Ue=0;Re;){for(Ue++,Be=Re,Fe=0,_e=0;_e<ot&&(Fe++,Be=Be.nextZ);_e++);for(ut=ot;Fe>0||ut>0&&Be;)Fe!==0&&(ut===0||!Be||Re.z<=Be.z)?(Pe=Re,Re=Re.nextZ,Fe--):(Pe=Be,Be=Be.nextZ,ut--),ze?ze.nextZ=Pe:oe=Pe,Pe.prevZ=ze,ze=Pe;Re=Be}ze.nextZ=null,ot*=2}while(Ue>1)})(J)})(s,d,m,v);for(var C,I,P=s;s.prev!==s.next;)if(C=s.prev,I=s.next,v?Iy(s,d,m,v):Xb(s))r.push(C.i/a|0),r.push(s.i/a|0),r.push(I.i/a|0),Ol(s),s=I.next,P=I.next;else if((s=I)===P){w?w===1?Wh(s=Ry(eh(s),r,a),r,a,d,m,v,2):w===2&&Xh(s,r,a,d,m,v):Wh(eh(s),r,a,d,m,v,1);break}}}function Xb(s){var r=s.prev,a=s,d=s.next;if(Xi(r,a,d)>=0)return!1;for(var m=r.x,v=a.x,w=d.x,C=r.y,I=a.y,P=d.y,B=m<v?m<w?m:w:v<w?v:w,F=C<I?C<P?C:P:I<P?I:P,$=m>v?m>w?m:w:v>w?v:w,X=C>I?C>P?C:P:I>P?I:P,J=d.next;J!==r;){if(J.x>=B&&J.x<=$&&J.y>=F&&J.y<=X&&Kh(m,C,v,I,w,P,J.x,J.y)&&Xi(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function Iy(s,r,a,d){var m=s.prev,v=s,w=s.next;if(Xi(m,v,w)>=0)return!1;for(var C=m.x,I=v.x,P=w.x,B=m.y,F=v.y,$=w.y,X=C<I?C<P?C:P:I<P?I:P,J=B<F?B<$?B:$:F<$?F:$,oe=C>I?C>P?C:P:I>P?I:P,_e=B>F?B>$?B:$:F>$?F:$,Re=pc(X,J,r,a,d),Be=pc(oe,_e,r,a,d),Pe=s.prevZ,ze=s.nextZ;Pe&&Pe.z>=Re&&ze&&ze.z<=Be;){if(Pe.x>=X&&Pe.x<=oe&&Pe.y>=J&&Pe.y<=_e&&Pe!==m&&Pe!==w&&Kh(C,B,I,F,P,$,Pe.x,Pe.y)&&Xi(Pe.prev,Pe,Pe.next)>=0||(Pe=Pe.prevZ,ze.x>=X&&ze.x<=oe&&ze.y>=J&&ze.y<=_e&&ze!==m&&ze!==w&&Kh(C,B,I,F,P,$,ze.x,ze.y)&&Xi(ze.prev,ze,ze.next)>=0))return!1;ze=ze.nextZ}for(;Pe&&Pe.z>=Re;){if(Pe.x>=X&&Pe.x<=oe&&Pe.y>=J&&Pe.y<=_e&&Pe!==m&&Pe!==w&&Kh(C,B,I,F,P,$,Pe.x,Pe.y)&&Xi(Pe.prev,Pe,Pe.next)>=0)return!1;Pe=Pe.prevZ}for(;ze&&ze.z<=Be;){if(ze.x>=X&&ze.x<=oe&&ze.y>=J&&ze.y<=_e&&ze!==m&&ze!==w&&Kh(C,B,I,F,P,$,ze.x,ze.y)&&Xi(ze.prev,ze,ze.next)>=0)return!1;ze=ze.nextZ}return!0}function Ry(s,r,a){var d=s;do{var m=d.prev,v=d.next.next;!Sp(m,v)&&$a(m,d,d.next,v)&&Cp(m,v)&&Cp(v,m)&&(r.push(m.i/a|0),r.push(d.i/a|0),r.push(v.i/a|0),Ol(d),Ol(d.next),d=s=v),d=d.next}while(d!==s);return eh(d)}function Xh(s,r,a,d,m,v){var w=s;do{for(var C=w.next.next;C!==w.prev;){if(w.i!==C.i&&Zb(w,C)){var I=qv(w,C);return w=eh(w,w.next),I=eh(I,I.next),Wh(w,r,a,d,m,v,0),void Wh(I,r,a,d,m,v,0)}C=C.next}w=w.next}while(w!==s)}function Xs(s,r){return s.x-r.x}function Zh(s,r){var a=(function(m,v){var w,C=v,I=m.x,P=m.y,B=-1/0;do{if(P<=C.y&&P>=C.next.y&&C.next.y!==C.y){var F=C.x+(P-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(F<=I&&F>B&&(B=F,w=C.x<C.next.x?C:C.next,F===I))return w}C=C.next}while(C!==v);if(!w)return null;var $,X=w,J=w.x,oe=w.y,_e=1/0;C=w;do I>=C.x&&C.x>=J&&I!==C.x&&Kh(P<oe?I:B,P,J,oe,P<oe?B:I,P,C.x,C.y)&&($=Math.abs(P-C.y)/(I-C.x),Cp(C,m)&&($<_e||$===_e&&(C.x>w.x||C.x===w.x&&Ep(w,C)))&&(w=C,_e=$)),C=C.next;while(C!==X);return w})(s,r);if(!a)return r;var d=qv(a,s);return eh(d,d.next),eh(a,a.next)}function Ep(s,r){return Xi(s.prev,s,r.prev)<0&&Xi(r.next,s,s.next)<0}function pc(s,r,a,d,m){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-a)*m|0)|s<<8))|s<<4))|s<<2))|s<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-d)*m|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function $v(s){var r=s,a=s;do(r.x<a.x||r.x===a.x&&r.y<a.y)&&(a=r),r=r.next;while(r!==s);return a}function Kh(s,r,a,d,m,v,w,C){return(m-w)*(r-C)>=(s-w)*(v-C)&&(s-w)*(d-C)>=(a-w)*(r-C)&&(a-w)*(v-C)>=(m-w)*(d-C)}function Zb(s,r){return s.next.i!==r.i&&s.prev.i!==r.i&&!(function(a,d){var m=a;do{if(m.i!==a.i&&m.next.i!==a.i&&m.i!==d.i&&m.next.i!==d.i&&$a(m,m.next,a,d))return!0;m=m.next}while(m!==a);return!1})(s,r)&&(Cp(s,r)&&Cp(r,s)&&(function(a,d){var m=a,v=!1,w=(a.x+d.x)/2,C=(a.y+d.y)/2;do m.y>C!=m.next.y>C&&m.next.y!==m.y&&w<(m.next.x-m.x)*(C-m.y)/(m.next.y-m.y)+m.x&&(v=!v),m=m.next;while(m!==a);return v})(s,r)&&(Xi(s.prev,s,r.prev)||Xi(s,r.prev,r))||Sp(s,r)&&Xi(s.prev,s,s.next)>0&&Xi(r.prev,r,r.next)>0)}function Xi(s,r,a){return(r.y-s.y)*(a.x-r.x)-(r.x-s.x)*(a.y-r.y)}function Sp(s,r){return s.x===r.x&&s.y===r.y}function $a(s,r,a,d){var m=Lo(Xi(s,r,a)),v=Lo(Xi(s,r,d)),w=Lo(Xi(a,d,s)),C=Lo(Xi(a,d,r));return m!==v&&w!==C||!(m!==0||!Xm(s,a,r))||!(v!==0||!Xm(s,d,r))||!(w!==0||!Xm(a,s,d))||!(C!==0||!Xm(a,r,d))}function Xm(s,r,a){return r.x<=Math.max(s.x,a.x)&&r.x>=Math.min(s.x,a.x)&&r.y<=Math.max(s.y,a.y)&&r.y>=Math.min(s.y,a.y)}function Lo(s){return s>0?1:s<0?-1:0}function Cp(s,r){return Xi(s.prev,s,s.next)<0?Xi(s,r,s.next)>=0&&Xi(s,s.prev,r)>=0:Xi(s,r,s.prev)<0||Xi(s,s.next,r)<0}function qv(s,r){var a=new Ap(s.i,s.x,s.y),d=new Ap(r.i,r.x,r.y),m=s.next,v=r.prev;return s.next=r,r.prev=s,a.next=m,m.prev=a,d.next=a,a.prev=d,v.next=d,d.prev=v,d}function Kb(s,r,a,d){var m=new Ap(s,r,a);return d?(m.next=d.next,m.prev=d,d.next.prev=m,d.next=m):(m.prev=m,m.next=m),m}function Ol(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Ap(s,r,a){this.i=s,this.x=r,this.y=a,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Zm(s,r,a,d){for(var m=0,v=r,w=a-d;v<a;v+=d)m+=(s[w]-s[v])*(s[v+1]+s[w+1]),w=v;return m}Gh.exports=Hh,Gh.exports.default=Hh,Hh.deviation=function(s,r,a,d){var m=r&&r.length,v=Math.abs(Zm(s,0,m?r[0]*a:s.length,a));if(m)for(var w=0,C=r.length;w<C;w++)v-=Math.abs(Zm(s,r[w]*a,w<C-1?r[w+1]*a:s.length,a));var I=0;for(w=0;w<d.length;w+=3){var P=d[w]*a,B=d[w+1]*a,F=d[w+2]*a;I+=Math.abs((s[P]-s[F])*(s[B+1]-s[P+1])-(s[P]-s[B])*(s[F+1]-s[P+1]))}return v===0&&I===0?0:Math.abs((I-v)/v)},Hh.flatten=function(s){for(var r=s[0][0].length,a={vertices:[],holes:[],dimensions:r},d=0,m=0;m<s.length;m++){for(var v=0;v<s[m].length;v++)for(var w=0;w<r;w++)a.vertices.push(s[m][v][w]);m>0&&a.holes.push(d+=s[m-1].length)}return a};var Yh=pe(Gh.exports);function Yb(s,r,a,d,m){Gv(s,r,a,d||s.length-1,m||Qb)}function Gv(s,r,a,d,m){for(;d>a;){if(d-a>600){var v=d-a+1,w=r-a+1,C=Math.log(v),I=.5*Math.exp(2*C/3),P=.5*Math.sqrt(C*I*(v-I)/v)*(w-v/2<0?-1:1);Gv(s,r,Math.max(a,Math.floor(r-w*I/v+P)),Math.min(d,Math.floor(r+(v-w)*I/v+P)),m)}var B=s[r],F=a,$=d;for(Ip(s,a,r),m(s[d],B)>0&&Ip(s,a,d);F<$;){for(Ip(s,F,$),F++,$--;m(s[F],B)<0;)F++;for(;m(s[$],B)>0;)$--}m(s[a],B)===0?Ip(s,a,$):Ip(s,++$,d),$<=r&&(a=$+1),r<=$&&(d=$-1)}}function Ip(s,r,a){var d=s[r];s[r]=s[a],s[a]=d}function Qb(s,r){return s<r?-1:s>r?1:0}function Rp(s,r){const a=s.length;if(a<=1)return[s];const d=[];let m,v;for(let w=0;w<a;w++){const C=rr(s[w]);C!==0&&(s[w].area=Math.abs(C),v===void 0&&(v=C<0),v===C<0?(m&&d.push(m),m=[s[w]]):m.push(s[w]))}if(m&&d.push(m),r>1)for(let w=0;w<d.length;w++)d[w].length<=r||(Yb(d[w],r,1,d[w].length-1,Hv),d[w]=d[w].slice(0,r));return d}function Hv(s,r){return r.area-s.area}function Wv(s,r,a){const d=a.patternDependencies;let m=!1;for(const v of r){const w=v.paint.get(`${s}-pattern`);w.isConstant()||(m=!0);const C=w.constantOr(null);C&&(m=!0,d[C]=!0)}return m}function Xv(s,r,a,d,m){const v=m.patternDependencies;for(const w of r){const C=w.paint.get(`${s}-pattern`).value;if(C.kind!=="constant"){let I=C.evaluate({zoom:d},a,{},m.availableImages);I=I&&I.name?I.name:I,v[I]=!0,a.patterns[w.id]=I}}return a}class My{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((a=>a.id)),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Vt,this.indexArray=new Tn,this.indexArray2=new kr,this.programConfigurations=new qc(r.layers,r.zoom),this.segments=new os,this.segments2=new os,this.stateDependentLayerIds=this.layers.filter((a=>a.isStateDependent())).map((a=>a.id)),this.projection=r.projection}populate(r,a,d,m){this.hasPattern=Wv("fill",this.layers,a);const v=this.layers[0].layout.get("fill-sort-key"),w=[];for(const{feature:C,id:I,index:P,sourceLayerIndex:B}of r){const F=this.layers[0]._featureFilter.needGeometry,$=ko(C,F);if(!this.layers[0]._featureFilter.filter(new V(this.zoom),$,d))continue;const X=v?v.evaluate($,{},d,a.availableImages):void 0,J={id:I,properties:C.properties,type:C.type,sourceLayerIndex:B,index:P,geometry:F?$.geometry:_s(C,d,m),patterns:{},sortKey:X};w.push(J)}v&&w.sort(((C,I)=>C.sortKey-I.sortKey));for(const C of w){const{geometry:I,index:P,sourceLayerIndex:B}=C;if(this.hasPattern){const F=Xv("fill",this.layers,C,this.zoom,a);this.patternFeatures.push(F)}else this.addFeature(C,I,P,d,{},a.availableImages);a.featureIndex.insert(r[P].feature,I,P,B,this.index)}}update(r,a,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,d,m)}addFeatures(r,a,d,m,v){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,a,d,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,gl),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,a,d,m,v,w=[]){for(const C of Rp(a,500)){let I=0;for(const J of C)I+=J.length;const P=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray),B=P.vertexLength,F=[],$=[];for(const J of C){if(J.length===0)continue;J!==C[0]&&$.push(F.length/2);const oe=this.segments2.prepareSegment(J.length,this.layoutVertexArray,this.indexArray2),_e=oe.vertexLength;this.layoutVertexArray.emplaceBack(J[0].x,J[0].y),this.indexArray2.emplaceBack(_e+J.length-1,_e),F.push(J[0].x),F.push(J[0].y);for(let Re=1;Re<J.length;Re++)this.layoutVertexArray.emplaceBack(J[Re].x,J[Re].y),this.indexArray2.emplaceBack(_e+Re-1,_e+Re),F.push(J[Re].x),F.push(J[Re].y);oe.vertexLength+=J.length,oe.primitiveLength+=J.length}const X=Yh(F,$);for(let J=0;J<X.length;J+=3)this.indexArray.emplaceBack(B+X[J],B+X[J+1],B+X[J+2]);P.vertexLength+=I,P.primitiveLength+=X.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,d,v,w,m)}}gn(My,"FillBucket",{omit:["layers","patternFeatures"]});const Jb=new Le({"fill-sort-key":new be(vt.layout_fill["fill-sort-key"])});var e1={paint:new Le({"fill-antialias":new ne(vt.paint_fill["fill-antialias"]),"fill-opacity":new be(vt.paint_fill["fill-opacity"]),"fill-color":new be(vt.paint_fill["fill-color"]),"fill-outline-color":new be(vt.paint_fill["fill-outline-color"]),"fill-translate":new ne(vt.paint_fill["fill-translate"]),"fill-translate-anchor":new ne(vt.paint_fill["fill-translate-anchor"]),"fill-pattern":new be(vt.paint_fill["fill-pattern"])}),layout:Jb};const Mp=Ye([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Py=Ye([{name:"a_centroid_pos",components:2,type:"Uint16"}]),t1=Ye([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:n1}=Mp;var Km={},r1=re,Zv=mf;function mf(s,r,a,d,m){this.properties={},this.extent=a,this.type=0,this._pbf=s,this._geometry=-1,this._keys=d,this._values=m,s.readFields(ky,this,r)}function ky(s,r,a){s==1?r.id=a.readVarint():s==2?(function(d,m){for(var v=d.readVarint()+d.pos;d.pos<v;){var w=m._keys[d.readVarint()],C=m._values[d.readVarint()];m.properties[w]=C}})(a,r):s==3?r.type=a.readVarint():s==4&&(r._geometry=a.pos)}function i1(s){for(var r,a,d=0,m=0,v=s.length,w=v-1;m<v;w=m++)d+=((a=s[w]).x-(r=s[m]).x)*(r.y+a.y);return d}mf.types=["Unknown","Point","LineString","Polygon"],mf.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var r,a=s.readVarint()+s.pos,d=1,m=0,v=0,w=0,C=[];s.pos<a;){if(m<=0){var I=s.readVarint();d=7&I,m=I>>3}if(m--,d===1||d===2)v+=s.readSVarint(),w+=s.readSVarint(),d===1&&(r&&C.push(r),r=[]),r.push(new r1(v,w));else{if(d!==7)throw new Error("unknown command "+d);r&&r.push(r[0].clone())}}return r&&C.push(r),C},mf.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var r=s.readVarint()+s.pos,a=1,d=0,m=0,v=0,w=1/0,C=-1/0,I=1/0,P=-1/0;s.pos<r;){if(d<=0){var B=s.readVarint();a=7&B,d=B>>3}if(d--,a===1||a===2)(m+=s.readSVarint())<w&&(w=m),m>C&&(C=m),(v+=s.readSVarint())<I&&(I=v),v>P&&(P=v);else if(a!==7)throw new Error("unknown command "+a)}return[w,I,C,P]},mf.prototype.toGeoJSON=function(s,r,a){var d,m,v=this.extent*Math.pow(2,a),w=this.extent*s,C=this.extent*r,I=this.loadGeometry(),P=mf.types[this.type];function B(X){for(var J=0;J<X.length;J++){var oe=X[J];X[J]=[360*(oe.x+w)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(oe.y+C)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var F=[];for(d=0;d<I.length;d++)F[d]=I[d][0];B(I=F);break;case 2:for(d=0;d<I.length;d++)B(I[d]);break;case 3:for(I=(function(X){var J=X.length;if(J<=1)return[X];for(var oe,_e,Re=[],Be=0;Be<J;Be++){var Pe=i1(X[Be]);Pe!==0&&(_e===void 0&&(_e=Pe<0),_e===Pe<0?(oe&&Re.push(oe),oe=[X[Be]]):oe.push(X[Be]))}return oe&&Re.push(oe),Re})(I),d=0;d<I.length;d++)for(m=0;m<I[d].length;m++)B(I[d][m])}I.length===1?I=I[0]:P="Multi"+P;var $={type:"Feature",geometry:{type:P,coordinates:I},properties:this.properties};return"id"in this&&($.id=this.id),$};var s1=Zv,Ci=Dy;function Dy(s,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(kE,this,r),this.length=this._features.length}function kE(s,r,a){s===15?r.version=a.readVarint():s===1?r.name=a.readString():s===5?r.extent=a.readVarint():s===2?r._features.push(a.pos):s===3?r._keys.push(a.readString()):s===4&&r._values.push((function(d){for(var m=null,v=d.readVarint()+d.pos;d.pos<v;){var w=d.readVarint()>>3;m=w===1?d.readString():w===2?d.readFloat():w===3?d.readDouble():w===4?d.readVarint64():w===5?d.readVarint():w===6?d.readSVarint():w===7?d.readBoolean():null}return m})(a))}Dy.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var r=this._pbf.readVarint()+this._pbf.pos;return new s1(this._pbf,r,this.extent,this._keys,this._values)};var o1=Ci;function DE(s,r,a){if(s===3){var d=new o1(a,a.readVarint()+a.pos);d.length&&(r[d.name]=d)}}var Kv=Km.VectorTile=function(s,r){this.layers=s.readFields(DE,{},r)},Ly=Km.VectorTileFeature=Zv;function gf(s,r,a,d){const m=[],v=d===0?(w,C,I,P,B,F)=>{w.push(new se(F,I+(F-C)/(P-C)*(B-I)))}:(w,C,I,P,B,F)=>{w.push(new se(C+(F-I)/(B-I)*(P-C),F))};for(const w of s){const C=[];for(const I of w){if(I.length<=2)continue;const P=[];for(let $=0;$<I.length-1;$++){const X=I[$].x,J=I[$].y,oe=I[$+1].x,_e=I[$+1].y,Re=d===0?X:J,Be=d===0?oe:_e;Re<r?Be>r&&v(P,X,J,oe,_e,r):Re>a?Be<a&&v(P,X,J,oe,_e,a):P.push(I[$]),Be<r&&Re>=r&&v(P,X,J,oe,_e,r),Be>a&&Re<=a&&v(P,X,J,oe,_e,a)}let B=I[I.length-1];const F=d===0?B.x:B.y;F>=r&&F<=a&&P.push(B),P.length&&(B=P[P.length-1],P[0].x===B.x&&P[0].y===B.y||P.push(P[0]),C.push(P))}C.length&&m.push(C)}return m}Km.VectorTileLayer=Ci;const Pp=Ly.types,Yv=Math.pow(2,13);function Qh(s,r,a,d,m,v,w,C){s.emplaceBack((r<<1)+w,(a<<1)+v,(Math.floor(d*Yv)<<1)+m,Math.round(C))}function yf(s,r,a){s.emplaceBack(r.x,r.y,r.z,a[0]*16384,a[1]*16384,a[2]*16384)}class th{constructor(){this.acc=new se(0,0),this.polyCount=[]}startRing(r){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new se(r.x,r.y),this.max=new se(r.x,r.y))}append(r,a){this.currentPolyCount.edges++,this.acc._add(r);const d=this.min,m=this.max;r.x<d.x?d.x=r.x:r.x>m.x&&(m.x=r.x),r.y<d.y?d.y=r.y:r.y>m.y&&(m.y=r.y),((r.x===0||r.x===Dn)&&r.x===a.x)!=((r.y===0||r.y===Dn)&&r.y===a.y)&&this.processBorderOverlap(r,a),a.x<0!=r.x<0&&this.addBorderIntersection(0,nr(a.y,r.y,(0-a.x)/(r.x-a.x))),a.x>Dn!=r.x>Dn&&this.addBorderIntersection(1,nr(a.y,r.y,(Dn-a.x)/(r.x-a.x))),a.y<0!=r.y<0&&this.addBorderIntersection(2,nr(a.x,r.x,(0-a.y)/(r.y-a.y))),a.y>Dn!=r.y>Dn&&this.addBorderIntersection(3,nr(a.x,r.x,(Dn-a.y)/(r.y-a.y)))}addBorderIntersection(r,a){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const d=this.borders[r];a<d[0]&&(d[0]=a),a>d[1]&&(d[1]=a)}processBorderOverlap(r,a){if(r.x===a.x){if(r.y===a.y)return;const d=r.x===0?0:1;this.addBorderIntersection(d,a.y),this.addBorderIntersection(d,r.y)}else{const d=r.y===0?2:3;this.addBorderIntersection(d,a.x),this.addBorderIntersection(d,r.x)}}centroid(){const r=this.polyCount.reduce(((a,d)=>a+d.edges),0);return r!==0?this.acc.div(r)._round():new se(0,0)}span(){return new se(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce(((r,a)=>r+ +(a[0]!==Number.MAX_VALUE)),0)}}class qa{constructor(r){this.zoom=r.zoom,this.canonical=r.canonical,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((a=>a.id)),this.index=r.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=r.projection,this.layoutVertexArray=new _t,this.centroidVertexArray=new Va,this.indexArray=new Tn,this.programConfigurations=new qc(r.layers,r.zoom),this.segments=new os,this.stateDependentLayerIds=this.layers.filter((a=>a.isStateDependent())).map((a=>a.id)),this.enableTerrain=r.enableTerrain}populate(r,a,d,m){this.features=[],this.hasPattern=Wv("fill-extrusion",this.layers,a),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=(function(v){const w=Math.exp(Math.PI*(1-v.y/(1<<v.z)*2));return 80150034*w/(w*w+1)/Dn/(1<<v.z)})(d),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:v,id:w,index:C,sourceLayerIndex:I}of r){const P=this.layers[0]._featureFilter.needGeometry,B=ko(v,P);if(!this.layers[0]._featureFilter.filter(new V(this.zoom),B,d))continue;const F={id:w,sourceLayerIndex:I,index:C,geometry:P?B.geometry:_s(v,d,m),properties:v.properties,type:v.type,patterns:{}},$=this.layoutVertexArray.length;this.hasPattern?this.features.push(Xv("fill-extrusion",this.layers,F,this.zoom,a)):this.addFeature(F,F.geometry,C,d,{},a.availableImages,m),a.featureIndex.insert(v,F.geometry,C,I,this.index,$)}this.sortBorders()}addFeatures(r,a,d,m,v){for(const w of this.features){const{geometry:C}=w;this.addFeature(w,C,w.index,a,d,m,v)}this.sortBorders()}update(r,a,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,d,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,n1),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=r.createVertexBuffer(this.layoutVertexExtArray,t1.members,!0))),this.programConfigurations.upload(r),this.uploaded=!0}uploadCentroid(r){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,Py.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,a,d,m,v,w,C){const I=[new se(0,0),new se(Dn,Dn)],P=C.projection,B=P.name==="globe",F=this.enableTerrain&&!B?new th:null,$=Pp[r.type]==="Polygon";B&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new zt);const X=Rp(a,500);for(let Re=X.length-1;Re>=0;Re--){const Be=X[Re];(Be.length===0||(J=Be[0]).every((Pe=>Pe.x<=0))||J.every((Pe=>Pe.x>=Dn))||J.every((Pe=>Pe.y<=0))||J.every((Pe=>Pe.y>=Dn)))&&X.splice(Re,1)}var J;let oe;if(B)oe=Oy(X,I,m);else{oe=[];for(const Re of X)oe.push({polygon:Re,bounds:I})}const _e=$?this.edgeRadius:0;for(const{polygon:Re,bounds:Be}of oe){let Pe=0,ze=0;for(const Fe of Re)$&&!Fe[0].equals(Fe[Fe.length-1])&&Fe.push(Fe[0]),ze+=$?Fe.length-1:Fe.length;const Ue=this.segments.prepareSegment(($?5:4)*ze,this.layoutVertexArray,this.indexArray);if($){const Fe=[],ut=[];Pe=Ue.vertexLength;for(const bt of Re){let $t,pt;bt.length&&bt!==Re[0]&&ut.push(Fe.length/2),$t=bt[1].sub(bt[0])._perp()._unit();for(let Rt=1;Rt<bt.length;Rt++){const Mt=bt[Rt],Nt=bt[Rt===bt.length-1?1:Rt+1];let{x:Zt,y:xt}=Mt;if(_e){pt=Nt.sub(Mt)._perp()._unit();const dn=$t.add(pt)._unit(),wn=_e*Math.min(4,1/($t.x*dn.x+$t.y*dn.y));Zt+=wn*dn.x,xt+=wn*dn.y,$t=pt}Qh(this.layoutVertexArray,Zt,xt,0,0,1,1,0),Ue.vertexLength++,Fe.push(Mt.x,Mt.y),B&&yf(this.layoutVertexExtArray,P.projectTilePoint(Zt,xt,m),P.upVector(m,Zt,xt))}}const ot=Yh(Fe,ut);for(let bt=0;bt<ot.length;bt+=3)this.indexArray.emplaceBack(Pe+ot[bt],Pe+ot[bt+2],Pe+ot[bt+1]),Ue.primitiveLength++}for(const Fe of Re){F&&Fe.length&&F.startRing(Fe[0]);let ut,ot,bt,$t=Fe.length>4&&e0(Fe[Fe.length-2],Fe[0],Fe[1]),pt=_e?LE(Fe[Fe.length-2],Fe[0],Fe[1],_e):0;ot=Fe[1].sub(Fe[0])._perp()._unit();let Rt=!0;for(let Mt=1,Nt=0;Mt<Fe.length;Mt++){let Zt=Fe[Mt-1],xt=Fe[Mt];const dn=Fe[Mt===Fe.length-1?1:Mt+1];if(F&&$&&F.currentPolyCount.top++,Jv(xt,Zt,Be)){_e&&(ot=dn.sub(xt)._perp()._unit(),Rt=!Rt);continue}F&&F.append(xt,Zt);const wn=xt.sub(Zt)._perp(),fn=wn.x/(Math.abs(wn.x)+Math.abs(wn.y)),lr=wn.y>0?1:0,Yt=Zt.dist(xt);if(Nt+Yt>32768&&(Nt=0),_e){bt=dn.sub(xt)._perp()._unit();let ur=Qv(Zt,xt,dn,kp(ot,bt),_e);isNaN(ur)&&(ur=0);const Gn=xt.sub(Zt)._unit();Zt=Zt.add(Gn.mult(pt))._round(),xt=xt.add(Gn.mult(-ur))._round(),pt=ur,ot=bt}const Vn=Ue.vertexLength,cr=Fe.length>4&&e0(Zt,xt,dn);let Wr=t0(Nt,$t,Rt);if(Qh(this.layoutVertexArray,Zt.x,Zt.y,fn,lr,0,0,Wr),Qh(this.layoutVertexArray,Zt.x,Zt.y,fn,lr,0,1,Wr),Nt+=Yt,Wr=t0(Nt,cr,!Rt),$t=cr,Qh(this.layoutVertexArray,xt.x,xt.y,fn,lr,0,0,Wr),Qh(this.layoutVertexArray,xt.x,xt.y,fn,lr,0,1,Wr),Ue.vertexLength+=4,this.indexArray.emplaceBack(Vn+0,Vn+1,Vn+2),this.indexArray.emplaceBack(Vn+1,Vn+3,Vn+2),Ue.primitiveLength+=2,_e){const ur=Pe+(Mt===1?Fe.length-2:Mt-2),Gn=Mt===1?Pe:ur+1;if(this.indexArray.emplaceBack(Vn+1,ur,Vn+3),this.indexArray.emplaceBack(ur,Gn,Vn+3),Ue.primitiveLength+=2,ut===void 0&&(ut=Vn),!Jv(dn,Fe[Mt],Be)){const ji=Mt===Fe.length-1?ut:Ue.vertexLength;this.indexArray.emplaceBack(Vn+2,Vn+3,ji),this.indexArray.emplaceBack(Vn+3,ji+1,ji),this.indexArray.emplaceBack(Vn+3,Gn,ji+1),Ue.primitiveLength+=3}Rt=!Rt}if(B){const ur=this.layoutVertexExtArray,Gn=P.projectTilePoint(Zt.x,Zt.y,m),ji=P.projectTilePoint(xt.x,xt.y,m),dr=P.upVector(m,Zt.x,Zt.y),fr=P.upVector(m,xt.x,xt.y);yf(ur,Gn,dr),yf(ur,Gn,dr),yf(ur,ji,fr),yf(ur,ji,fr)}}$&&(Pe+=Fe.length-1)}}if(F&&F.polyCount.length>0){if(F.borders){F.vertexArrayOffset=this.centroidVertexArray.length;const Re=F.borders,Be=this.featuresOnBorder.push(F)-1;for(let Pe=0;Pe<4;Pe++)Re[Pe][0]!==Number.MAX_VALUE&&this.borders[Pe].push(Be)}this.encodeCentroid(F.borders?void 0:F.centroid(),F)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,d,v,w,m)}sortBorders(){for(let r=0;r<4;r++)this.borders[r].sort(((a,d)=>this.featuresOnBorder[a].borders[r][0]-this.featuresOnBorder[d].borders[r][0]))}encodeCentroid(r,a,d=!0){let m,v;if(r)if(r.y!==0){const C=a.span()._mult(this.tileToMeter);m=(Math.max(r.x,1)<<3)+Math.min(7,Math.round(C.x/10)),v=(Math.max(r.y,1)<<3)+Math.min(7,Math.round(C.y/10))}else m=Math.ceil(7*(r.x+450)),v=0;else m=0,v=+d;let w=d?this.centroidVertexArray.length:a.vertexArrayOffset;for(const C of a.polyCount){d&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*C.edges+C.top);for(let I=0;I<C.top;I++)this.centroidVertexArray.emplace(w++,m,v);for(let I=0;I<2*C.edges;I++)this.centroidVertexArray.emplace(w++,0,v),this.centroidVertexArray.emplace(w++,m,v)}}}function kp(s,r){const a=s.add(r)._unit();return s.x*a.x+s.y*a.y}function LE(s,r,a,d){const m=r.sub(s)._perp()._unit(),v=a.sub(r)._perp()._unit();return Qv(s,r,a,kp(m,v),d)}function Qv(s,r,a,d,m){const v=Math.sqrt(1-d*d);return Math.min(s.dist(r)/3,r.dist(a)/3,m*v/d)}function Jv(s,r,a){return s.x<a[0].x&&r.x<a[0].x||s.x>a[1].x&&r.x>a[1].x||s.y<a[0].y&&r.y<a[0].y||s.y>a[1].y&&r.y>a[1].y}function e0(s,r,a){if(s.x<0||s.x>=Dn||r.x<0||r.x>=Dn||a.x<0||a.x>=Dn)return!1;const d=a.sub(r),m=d.perp(),v=s.sub(r);return(d.x*v.x+d.y*v.y)/Math.sqrt((d.x*d.x+d.y*d.y)*(v.x*v.x+v.y*v.y))>-.866&&m.x*v.x+m.y*v.y<0}function t0(s,r,a){const d=r?2|s:-3&s;return a?1|d:-2&d}function a1(){const s=Math.PI/32,r=Math.tan(s),a=wp;return a*Math.sqrt(1+2*r*r)-a}function Oy(s,r,a){const d=1<<a.z,m=Ua(a.x/d),v=Ua((a.x+1)/d),w=Qr(a.y/d),C=Qr((a.y+1)/d);return(function(I,P,B,F,$=0,X){const J=[];if(!I.length||!B||!F)return J;const oe=(Fe,ut)=>{for(const ot of Fe)J.push({polygon:ot,bounds:ut})},_e=Math.ceil(Math.log2(B)),Re=Math.ceil(Math.log2(F)),Be=_e-Re,Pe=[];for(let Fe=0;Fe<Math.abs(Be);Fe++)Pe.push(Be>0?0:1);for(let Fe=0;Fe<Math.min(_e,Re);Fe++)Pe.push(0),Pe.push(1);let ze=I;if(ze=gf(ze,P[0].y-$,P[1].y+$,1),ze=gf(ze,P[0].x-$,P[1].x+$,0),!ze.length)return J;const Ue=[];for(Pe.length?Ue.push({polygons:ze,bounds:P,depth:0}):oe(ze,P);Ue.length;){const Fe=Ue.pop(),ut=Fe.depth,ot=Pe[ut],bt=Fe.bounds[0],$t=Fe.bounds[1],pt=ot===0?bt.x:bt.y,Rt=ot===0?$t.x:$t.y,Mt=X?X(ot,pt,Rt):.5*(pt+Rt),Nt=gf(Fe.polygons,pt-$,Mt+$,ot),Zt=gf(Fe.polygons,Mt-$,Rt+$,ot);if(Nt.length){const xt=[bt,new se(ot===0?Mt:$t.x,ot===1?Mt:$t.y)];Pe.length>ut+1?Ue.push({polygons:Nt,bounds:xt,depth:ut+1}):oe(Nt,xt)}if(Zt.length){const xt=[new se(ot===0?Mt:bt.x,ot===1?Mt:bt.y),$t];Pe.length>ut+1?Ue.push({polygons:Zt,bounds:xt,depth:ut+1}):oe(Zt,xt)}}return J})(s,r,Math.ceil((v-m)/11.25),Math.ceil((w-C)/11.25),1,((I,P,B)=>{if(I===0)return .5*(P+B);{const F=Qr((a.y+P/Dn)/d);return(ki(.5*(Qr((a.y+B/Dn)/d)+F))*d-a.y)*Dn}}))}gn(qa,"FillExtrusionBucket",{omit:["layers","features"]}),gn(th,"PartMetadata");const l1=new Le({"fill-extrusion-edge-radius":new ne(vt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var c1={paint:new Le({"fill-extrusion-opacity":new ne(vt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new be(vt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ne(vt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ne(vt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new be(vt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new be(vt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new be(vt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ne(vt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new ne(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new ne(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new ne(vt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:l1};function u1(s,r,a){var d=2*Math.PI*6378137/256/Math.pow(2,a);return[s*d-2*Math.PI*6378137/2,r*d-2*Math.PI*6378137/2]}class Dp{constructor(r,a,d){this.z=r,this.x=a,this.y=d,this.key=Ym(0,r,r,a,d)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,a){const d=(function(v,w,C){var I=u1(256*v,256*(w=Math.pow(2,C)-w-1),C),P=u1(256*(v+1),256*(w+1),C);return I[0]+","+I[1]+","+P[0]+","+P[1]})(this.x,this.y,this.z),m=(function(v,w,C){let I,P="";for(let B=v;B>0;B--)I=1<<B-1,P+=(w&I?1:0)+(C&I?2:0);return P})(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",m).replace("{bbox-epsg-3857}",d)}toString(){return`${this.z}/${this.x}/${this.y}`}}class zy{constructor(r,a){this.wrap=r,this.canonical=a,this.key=Ym(r,a.z,a.z,a.x,a.y)}}class Yo{constructor(r,a,d,m,v){this.overscaledZ=r,this.wrap=a,this.canonical=new Dp(d,+m,+v),this.key=a===0&&r===d?this.canonical.key:Ym(a,r,d,m,v)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){const a=this.canonical.z-r;return r>this.canonical.z?new Yo(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Yo(r,this.wrap,r,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(r,a=!0){if(this.overscaledZ===r&&a)return this.key;if(r>this.canonical.z)return Ym(this.wrap*+a,r,this.canonical.z,this.canonical.x,this.canonical.y);{const d=this.canonical.z-r;return Ym(this.wrap*+a,r,r,this.canonical.x>>d,this.canonical.y>>d)}}isChildOf(r){if(r.wrap!==this.wrap)return!1;const a=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>a&&r.canonical.y===this.canonical.y>>a}children(r){if(this.overscaledZ>=r)return[new Yo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,d=2*this.canonical.x,m=2*this.canonical.y;return[new Yo(a,this.wrap,a,d,m),new Yo(a,this.wrap,a,d+1,m),new Yo(a,this.wrap,a,d,m+1),new Yo(a,this.wrap,a,d+1,m+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Yo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Yo(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new zy(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Ym(s,r,a,d,m){const v=1<<Math.min(a,22);let w=v*(m%v)+d%v;return s&&a<22&&(w+=v*v*((s<0?-2*s-1:2*s)%(1<<2*(22-a)))),16*(32*w+a)+(r-a)}gn(Dp,"CanonicalTileID"),gn(Yo,"OverscaledTileID",{omit:["projMatrix"]});class Yc extends se{constructor(r,a,d){super(r,a),this.z=d}}function Qm(s,r){return s.x*r.x+s.y*r.y}function n0(s,r){if(s.length===1){let a=0;const d=r[a++];let m;for(;!m||d.equals(m);)if(m=r[a++],!m)return 1/0;for(;a<r.length;a++){const v=r[a],w=s[0],C=m.sub(d),I=v.sub(d),P=w.sub(d),B=Qm(C,C),F=Qm(C,I),$=Qm(I,I),X=Qm(P,C),J=Qm(P,I),oe=B*$-F*F,_e=($*X-F*J)/oe,Re=(B*J-F*X)/oe,Be=d.z*(1-_e-Re)+m.z*_e+v.z*Re;if(isFinite(Be))return Be}return 1/0}{let a=1/0;for(const d of r)a=Math.min(a,d.z);return a}}function zr(s,r,a,d,m,v,w,C){const I=w*m.getElevationAt(s,r,!0,!0),P=v[0]!==0,B=P?v[1]===0?w*(v[0]/7-450):w*(function(F,$,X){const J=Math.floor($[0]/8),oe=Math.floor($[1]/8),_e=10*($[0]-8*J),Re=10*($[1]-8*oe),Be=F.getElevationAt(J,oe,!0,!0),Pe=F.getMeterToDEM(X),ze=Math.floor(.5*(_e*Pe-1)),Ue=Math.floor(.5*(Re*Pe-1)),Fe=F.tileCoordToPixel(J,oe),ut=2*ze+1,ot=2*Ue+1,bt=(function(Zt,xt,dn,wn,fn){return[Zt.getElevationAtPixel(xt,dn,!0),Zt.getElevationAtPixel(xt+fn,dn,!0),Zt.getElevationAtPixel(xt,dn+fn,!0),Zt.getElevationAtPixel(xt+wn,dn+fn,!0)]})(F,Fe.x-ze,Fe.y-Ue,ut,ot),$t=Math.abs(bt[0]-bt[1]),pt=Math.abs(bt[2]-bt[3]),Rt=Math.abs(bt[0]-bt[2])+Math.abs(bt[1]-bt[3]),Mt=Math.min(.25,.5*Pe*($t+pt)/ut),Nt=Math.min(.25,.5*Pe*Rt/ot);return Be+Math.max(Mt*_e,Nt*Re)})(m,v,C):I;return{base:I+(a===0)?-1:a,top:P?Math.max(B+d,I+a+2):I+d}}const r0=Ye([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:By}=r0,i0=Ye([{name:"a_packed",components:4,type:"Float32"}]),{members:h1}=i0,s0=Ly.types,Jm=Math.cos(Math.PI/180*37.5);class _f{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((a=>a.id)),this.index=r.index,this.projection=r.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((a=>{this.gradients[a.id]={}})),this.layoutVertexArray=new at,this.layoutVertexArray2=new Ot,this.indexArray=new Tn,this.programConfigurations=new qc(r.layers,r.zoom),this.segments=new os,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((a=>a.isStateDependent())).map((a=>a.id))}populate(r,a,d,m){this.hasPattern=Wv("line",this.layers,a);const v=this.layers[0].layout.get("line-sort-key"),w=[];for(const{feature:B,id:F,index:$,sourceLayerIndex:X}of r){const J=this.layers[0]._featureFilter.needGeometry,oe=ko(B,J);if(!this.layers[0]._featureFilter.filter(new V(this.zoom),oe,d))continue;const _e=v?v.evaluate(oe,{},d):void 0,Re={id:F,properties:B.properties,type:B.type,sourceLayerIndex:X,index:$,geometry:J?oe.geometry:_s(B,d,m),patterns:{},sortKey:_e};w.push(Re)}v&&w.sort(((B,F)=>B.sortKey-F.sortKey));const{lineAtlas:C,featureIndex:I}=a,P=this.addConstantDashes(C);for(const B of w){const{geometry:F,index:$,sourceLayerIndex:X}=B;if(P&&this.addFeatureDashes(B,C),this.hasPattern){const J=Xv("line",this.layers,B,this.zoom,a);this.patternFeatures.push(J)}else this.addFeature(B,F,$,d,C.positions,a.availableImages);I.insert(r[$].feature,F,$,X,this.index)}}addConstantDashes(r){let a=!1;for(const d of this.layers){const m=d.paint.get("line-dasharray").value,v=d.layout.get("line-cap").value;if(m.kind!=="constant"||v.kind!=="constant")a=!0;else{const w=v.value,C=m.value;if(!C)continue;r.addDash(C,w)}}return a}addFeatureDashes(r,a){const d=this.zoom;for(const m of this.layers){const v=m.paint.get("line-dasharray").value,w=m.layout.get("line-cap").value;if(v.kind==="constant"&&w.kind==="constant")continue;let C,I;if(v.kind==="constant"){if(C=v.value,!C)continue}else C=v.evaluate({zoom:d},r);I=w.kind==="constant"?w.value:w.evaluate({zoom:d},r),a.addDash(C,I),r.patterns[m.id]=a.getKey(C,I)}}update(r,a,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,d,m)}addFeatures(r,a,d,m,v){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,a,d,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,h1)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,By),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&r.properties.hasOwnProperty("mapbox_clip_start")&&r.properties.hasOwnProperty("mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,a,d,m,v,w){const C=this.layers[0].layout,I=C.get("line-join").evaluate(r,{}),P=C.get("line-cap").evaluate(r,{}),B=C.get("line-miter-limit"),F=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const $ of a)this.addLine($,r,I,P,B,F);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,d,v,w,m)}addLine(r,a,d,m,v,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Re=0;Re<r.length-1;Re++)this.totalDistance+=r[Re].dist(r[Re+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const C=s0[a.type]==="Polygon";let I=r.length;for(;I>=2&&r[I-1].equals(r[I-2]);)I--;let P=0;for(;P<I-1&&r[P].equals(r[P+1]);)P++;if(I<(C?3:2))return;d==="bevel"&&(v=1.05);const B=this.overscaling<=16?15*Dn/(512*this.overscaling):0,F=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray);let $,X,J,oe,_e;this.e1=this.e2=-1,C&&($=r[I-2],_e=r[P].sub($)._unit()._perp());for(let Re=P;Re<I;Re++){if(J=Re===I-1?C?r[P+1]:void 0:r[Re+1],J&&r[Re].equals(J))continue;_e&&(oe=_e),$&&(X=$),$=r[Re],_e=J?J.sub($)._unit()._perp():oe,oe=oe||_e;let Be=oe.add(_e);Be.x===0&&Be.y===0||Be._unit();const Pe=oe.x*_e.x+oe.y*_e.y,ze=Be.x*_e.x+Be.y*_e.y,Ue=ze!==0?1/ze:1/0,Fe=2*Math.sqrt(2-2*ze),ut=ze<Jm&&X&&J,ot=oe.x*_e.y-oe.y*_e.x>0;if(ut&&Re>P){const pt=$.dist(X);if(pt>2*B){const Rt=$.sub($.sub(X)._mult(B/pt)._round());this.updateDistance(X,Rt),this.addCurrentVertex(Rt,oe,0,0,F),X=Rt}}const bt=X&&J;let $t=bt?d:C?"butt":m;if(bt&&$t==="round"&&(Ue<w?$t="miter":Ue<=2&&($t="fakeround")),$t==="miter"&&Ue>v&&($t="bevel"),$t==="bevel"&&(Ue>2&&($t="flipbevel"),Ue<v&&($t="miter")),X&&this.updateDistance(X,$),$t==="miter")Be._mult(Ue),this.addCurrentVertex($,Be,0,0,F);else if($t==="flipbevel"){if(Ue>100)Be=_e.mult(-1);else{const pt=Ue*oe.add(_e).mag()/oe.sub(_e).mag();Be._perp()._mult(pt*(ot?-1:1))}this.addCurrentVertex($,Be,0,0,F),this.addCurrentVertex($,Be.mult(-1),0,0,F)}else if($t==="bevel"||$t==="fakeround"){const pt=-Math.sqrt(Ue*Ue-1),Rt=ot?pt:0,Mt=ot?0:pt;if(X&&this.addCurrentVertex($,oe,Rt,Mt,F),$t==="fakeround"){const Nt=Math.round(180*Fe/Math.PI/20);for(let Zt=1;Zt<Nt;Zt++){let xt=Zt/Nt;if(xt!==.5){const wn=xt-.5;xt+=xt*wn*(xt-1)*((1.0904+Pe*(Pe*(3.55645-1.43519*Pe)-3.2452))*wn*wn+(.848013+Pe*(.215638*Pe-1.06021)))}const dn=_e.sub(oe)._mult(xt)._add(oe)._unit()._mult(ot?-1:1);this.addHalfVertex($,dn.x,dn.y,!1,ot,0,F)}}J&&this.addCurrentVertex($,_e,-Rt,-Mt,F)}else if($t==="butt")this.addCurrentVertex($,Be,0,0,F);else if($t==="square"){const pt=X?1:-1;X||this.addCurrentVertex($,Be,pt,pt,F),this.addCurrentVertex($,Be,0,0,F),X&&this.addCurrentVertex($,Be,pt,pt,F)}else $t==="round"&&(X&&(this.addCurrentVertex($,oe,0,0,F),this.addCurrentVertex($,oe,1,1,F,!0)),J&&(this.addCurrentVertex($,_e,-1,-1,F,!0),this.addCurrentVertex($,_e,0,0,F)));if(ut&&Re<I-1){const pt=$.dist(J);if(pt>2*B){const Rt=$.add(J.sub($)._mult(B/pt)._round());this.updateDistance($,Rt),this.addCurrentVertex(Rt,_e,0,0,F),$=Rt}}}}addCurrentVertex(r,a,d,m,v,w=!1){const C=a.y*m-a.x,I=-a.y-a.x*m;this.addHalfVertex(r,a.x+a.y*d,a.y-a.x*d,w,!1,d,v),this.addHalfVertex(r,C,I,w,!0,-m,v)}addHalfVertex({x:r,y:a},d,m,v,w,C,I){this.layoutVertexArray.emplaceBack((r<<1)+(v?1:0),(a<<1)+(w?1:0),Math.round(63*d)+128,Math.round(63*m)+128,1+(C===0?0:C<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const P=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,P),I.primitiveLength++),w?this.e2=P:this.e1=P}updateScaledDistance(){if(this.lineClips){const r=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=r*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(r,a){this.distance+=r.dist(a),this.updateScaledDistance()}}gn(_f,"LineBucket",{omit:["layers","patternFeatures"]});const OE=new Le({"line-cap":new be(vt.layout_line["line-cap"]),"line-join":new be(vt.layout_line["line-join"]),"line-miter-limit":new ne(vt.layout_line["line-miter-limit"]),"line-round-limit":new ne(vt.layout_line["line-round-limit"]),"line-sort-key":new be(vt.layout_line["line-sort-key"])});var o0={paint:new Le({"line-opacity":new be(vt.paint_line["line-opacity"]),"line-color":new be(vt.paint_line["line-color"]),"line-translate":new ne(vt.paint_line["line-translate"]),"line-translate-anchor":new ne(vt.paint_line["line-translate-anchor"]),"line-width":new be(vt.paint_line["line-width"]),"line-gap-width":new be(vt.paint_line["line-gap-width"]),"line-offset":new be(vt.paint_line["line-offset"]),"line-blur":new be(vt.paint_line["line-blur"]),"line-dasharray":new be(vt.paint_line["line-dasharray"]),"line-pattern":new be(vt.paint_line["line-pattern"]),"line-gradient":new ke(vt.paint_line["line-gradient"]),"line-trim-offset":new ne(vt.paint_line["line-trim-offset"])}),layout:OE};const d1=new class extends be{possiblyEvaluate(s,r){return r=new V(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,transition:r.transition}),super.possiblyEvaluate(s,r)}evaluate(s,r,a,d){return r=wt({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(s,r,a,d)}}(o0.paint.properties["line-width"].specification);function f1(s,r){return r>0?r+2*s:s}d1.useIntegerZoom=!0;const p1=Ye([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),m1=Ye([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Ui=Ye([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ye([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const a0=Ye([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Oo=Ye([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Ye([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const g1=Ye([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),y1=Ye([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ye([{name:"triangle",components:3,type:"Uint16"}]),Ye([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ye([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ye([{type:"Float32",name:"offsetX"}]),Ye([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Zs=24;const yl=128;function eg(s,r){const{expression:a}=r;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new V(s+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:d,interpolationType:m}=a;let v=0;for(;v<d.length&&d[v]<=s;)v++;v=Math.max(0,v-1);let w=v;for(;w<d.length&&d[w]<s+1;)w++;w=Math.min(d.length-1,w);const C=d[v],I=d[w];return a.kind==="composite"?{kind:"composite",minZoom:C,maxZoom:I,interpolationType:m}:{kind:"camera",minZoom:C,maxZoom:I,minSize:a.evaluate(new V(C)),maxSize:a.evaluate(new V(I)),interpolationType:m}}}function vf(s,{uSize:r,uSizeT:a},{lowerSize:d,upperSize:m}){return s.kind==="source"?d/yl:s.kind==="composite"?nr(d/yl,m/yl,a):r}function xf(s,r){let a=0,d=0;if(s.kind==="constant")d=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:m,minZoom:v,maxZoom:w}=s,C=m?et(sl.interpolationFactor(m,r,v,w),0,1):0;s.kind==="camera"?d=nr(s.minSize,s.maxSize,C):a=C}return{uSizeT:a,uSize:d}}var _1=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:yl,evaluateSizeForFeature:vf,evaluateSizeForZoom:xf,getSizeData:eg});function l0(s,r,a){return s.sections.forEach((d=>{d.text=(function(m,v,w){const C=v.layout.get("text-transform").evaluate(w,{});return C==="uppercase"?m=m.toLocaleUpperCase():C==="lowercase"&&(m=m.toLocaleLowerCase()),L.applyArabicShaping&&(m=L.applyArabicShaping(m)),m})(d.text,r,a)})),s}const bf={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function zE(s){return s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""}function v1(s){return s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""}var x1=bi,c0=function(s,r,a,d,m){var v,w,C=8*m-d-1,I=(1<<C)-1,P=I>>1,B=-7,F=m-1,$=-1,X=s[r+F];for(F+=$,v=X&(1<<-B)-1,X>>=-B,B+=C;B>0;v=256*v+s[r+F],F+=$,B-=8);for(w=v&(1<<-B)-1,v>>=-B,B+=d;B>0;w=256*w+s[r+F],F+=$,B-=8);if(v===0)v=1-P;else{if(v===I)return w?NaN:1/0*(X?-1:1);w+=Math.pow(2,d),v-=P}return(X?-1:1)*w*Math.pow(2,v-d)},b1=function(s,r,a,d,m,v){var w,C,I,P=8*v-m-1,B=(1<<P)-1,F=B>>1,$=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,X=0,J=1,oe=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(C=isNaN(r)?1:0,w=B):(w=Math.floor(Math.log(r)/Math.LN2),r*(I=Math.pow(2,-w))<1&&(w--,I*=2),(r+=w+F>=1?$/I:$*Math.pow(2,1-F))*I>=2&&(w++,I/=2),w+F>=B?(C=0,w=B):w+F>=1?(C=(r*I-1)*Math.pow(2,m),w+=F):(C=r*Math.pow(2,F-1)*Math.pow(2,m),w=0));m>=8;s[a+X]=255&C,X+=J,C/=256,m-=8);for(w=w<<m|C,P+=m;P>0;s[a+X]=255&w,X+=J,w/=256,P-=8);s[a+X-J]|=128*oe};function bi(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}bi.Varint=0,bi.Fixed64=1,bi.Bytes=2,bi.Fixed32=5;var Qc=4294967296,u0=1/Qc,h0=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function mc(s){return s.type===bi.Bytes?s.readVarint()+s.pos:s.pos+1}function Lp(s,r,a){return a?4294967296*r+(s>>>0):4294967296*(r>>>0)+(s>>>0)}function w1(s,r,a){var d=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));a.realloc(d);for(var m=a.pos-1;m>=s;m--)a.buf[m+d]=a.buf[m]}function T1(s,r){for(var a=0;a<s.length;a++)r.writeVarint(s[a])}function d0(s,r){for(var a=0;a<s.length;a++)r.writeSVarint(s[a])}function f0(s,r){for(var a=0;a<s.length;a++)r.writeFloat(s[a])}function BE(s,r){for(var a=0;a<s.length;a++)r.writeDouble(s[a])}function zl(s,r){for(var a=0;a<s.length;a++)r.writeBoolean(s[a])}function p0(s,r){for(var a=0;a<s.length;a++)r.writeFixed32(s[a])}function E1(s,r){for(var a=0;a<s.length;a++)r.writeSFixed32(s[a])}function S1(s,r){for(var a=0;a<s.length;a++)r.writeFixed64(s[a])}function C1(s,r){for(var a=0;a<s.length;a++)r.writeSFixed64(s[a])}function Jh(s,r){return(s[r]|s[r+1]<<8|s[r+2]<<16)+16777216*s[r+3]}function zo(s,r,a){s[a]=r,s[a+1]=r>>>8,s[a+2]=r>>>16,s[a+3]=r>>>24}function m0(s,r){return(s[r]|s[r+1]<<8|s[r+2]<<16)+(s[r+3]<<24)}bi.prototype={destroy:function(){this.buf=null},readFields:function(s,r,a){for(a=a||this.length;this.pos<a;){var d=this.readVarint(),m=d>>3,v=this.pos;this.type=7&d,s(m,r,this),this.pos===v&&this.skip(d)}return r},readMessage:function(s,r){return this.readFields(s,r,this.readVarint()+this.pos)},readFixed32:function(){var s=Jh(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=m0(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=Jh(this.buf,this.pos)+Jh(this.buf,this.pos+4)*Qc;return this.pos+=8,s},readSFixed64:function(){var s=Jh(this.buf,this.pos)+m0(this.buf,this.pos+4)*Qc;return this.pos+=8,s},readFloat:function(){var s=c0(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=c0(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var r,a,d=this.buf;return r=127&(a=d[this.pos++]),a<128?r:(r|=(127&(a=d[this.pos++]))<<7,a<128?r:(r|=(127&(a=d[this.pos++]))<<14,a<128?r:(r|=(127&(a=d[this.pos++]))<<21,a<128?r:(function(m,v,w){var C,I,P=w.buf;if(C=(112&(I=P[w.pos++]))>>4,I<128||(C|=(127&(I=P[w.pos++]))<<3,I<128)||(C|=(127&(I=P[w.pos++]))<<10,I<128)||(C|=(127&(I=P[w.pos++]))<<17,I<128)||(C|=(127&(I=P[w.pos++]))<<24,I<128)||(C|=(1&(I=P[w.pos++]))<<31,I<128))return Lp(m,C,v);throw new Error("Expected varint not more than 10 bytes")})(r|=(15&(a=d[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var s=this.readVarint()+this.pos,r=this.pos;return this.pos=s,s-r>=12&&h0?(function(a,d,m){return h0.decode(a.subarray(d,m))})(this.buf,r,s):(function(a,d,m){for(var v="",w=d;w<m;){var C,I,P,B=a[w],F=null,$=B>239?4:B>223?3:B>191?2:1;if(w+$>m)break;$===1?B<128&&(F=B):$===2?(192&(C=a[w+1]))==128&&(F=(31&B)<<6|63&C)<=127&&(F=null):$===3?(I=a[w+2],(192&(C=a[w+1]))==128&&(192&I)==128&&((F=(15&B)<<12|(63&C)<<6|63&I)<=2047||F>=55296&&F<=57343)&&(F=null)):$===4&&(I=a[w+2],P=a[w+3],(192&(C=a[w+1]))==128&&(192&I)==128&&(192&P)==128&&((F=(15&B)<<18|(63&C)<<12|(63&I)<<6|63&P)<=65535||F>=1114112)&&(F=null)),F===null?(F=65533,$=1):F>65535&&(F-=65536,v+=String.fromCharCode(F>>>10&1023|55296),F=56320|1023&F),v+=String.fromCharCode(F),w+=$}return v})(this.buf,r,s)},readBytes:function(){var s=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,s);return this.pos=s,r},readPackedVarint:function(s,r){if(this.type!==bi.Bytes)return s.push(this.readVarint(r));var a=mc(this);for(s=s||[];this.pos<a;)s.push(this.readVarint(r));return s},readPackedSVarint:function(s){if(this.type!==bi.Bytes)return s.push(this.readSVarint());var r=mc(this);for(s=s||[];this.pos<r;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==bi.Bytes)return s.push(this.readBoolean());var r=mc(this);for(s=s||[];this.pos<r;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==bi.Bytes)return s.push(this.readFloat());var r=mc(this);for(s=s||[];this.pos<r;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==bi.Bytes)return s.push(this.readDouble());var r=mc(this);for(s=s||[];this.pos<r;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==bi.Bytes)return s.push(this.readFixed32());var r=mc(this);for(s=s||[];this.pos<r;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==bi.Bytes)return s.push(this.readSFixed32());var r=mc(this);for(s=s||[];this.pos<r;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==bi.Bytes)return s.push(this.readFixed64());var r=mc(this);for(s=s||[];this.pos<r;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==bi.Bytes)return s.push(this.readSFixed64());var r=mc(this);for(s=s||[];this.pos<r;)s.push(this.readSFixed64());return s},skip:function(s){var r=7&s;if(r===bi.Varint)for(;this.buf[this.pos++]>127;);else if(r===bi.Bytes)this.pos=this.readVarint()+this.pos;else if(r===bi.Fixed32)this.pos+=4;else{if(r!==bi.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(s,r){this.writeVarint(s<<3|r)},realloc:function(s){for(var r=this.length||16;r<this.pos+s;)r*=2;if(r!==this.length){var a=new Uint8Array(r);a.set(this.buf),this.buf=a,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),zo(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),zo(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),zo(this.buf,-1&s,this.pos),zo(this.buf,Math.floor(s*u0),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),zo(this.buf,-1&s,this.pos),zo(this.buf,Math.floor(s*u0),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?(function(r,a){var d,m;if(r>=0?(d=r%4294967296|0,m=r/4294967296|0):(m=~(-r/4294967296),4294967295^(d=~(-r%4294967296))?d=d+1|0:(d=0,m=m+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),(function(v,w,C){C.buf[C.pos++]=127&v|128,v>>>=7,C.buf[C.pos++]=127&v|128,v>>>=7,C.buf[C.pos++]=127&v|128,v>>>=7,C.buf[C.pos++]=127&v|128,C.buf[C.pos]=127&(v>>>=7)})(d,0,a),(function(v,w){var C=(7&v)<<4;w.buf[w.pos++]|=C|((v>>>=3)?128:0),v&&(w.buf[w.pos++]=127&v|((v>>>=7)?128:0),v&&(w.buf[w.pos++]=127&v|((v>>>=7)?128:0),v&&(w.buf[w.pos++]=127&v|((v>>>=7)?128:0),v&&(w.buf[w.pos++]=127&v|((v>>>=7)?128:0),v&&(w.buf[w.pos++]=127&v)))))})(m,a)})(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(!!s)},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var r=this.pos;this.pos=(function(d,m,v){for(var w,C,I=0;I<m.length;I++){if((w=m.charCodeAt(I))>55295&&w<57344){if(!C){w>56319||I+1===m.length?(d[v++]=239,d[v++]=191,d[v++]=189):C=w;continue}if(w<56320){d[v++]=239,d[v++]=191,d[v++]=189,C=w;continue}w=C-55296<<10|w-56320|65536,C=null}else C&&(d[v++]=239,d[v++]=191,d[v++]=189,C=null);w<128?d[v++]=w:(w<2048?d[v++]=w>>6|192:(w<65536?d[v++]=w>>12|224:(d[v++]=w>>18|240,d[v++]=w>>12&63|128),d[v++]=w>>6&63|128),d[v++]=63&w|128)}return v})(this.buf,s,this.pos);var a=this.pos-r;a>=128&&w1(r,a,this),this.pos=r-1,this.writeVarint(a),this.pos+=a},writeFloat:function(s){this.realloc(4),b1(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),b1(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var r=s.length;this.writeVarint(r),this.realloc(r);for(var a=0;a<r;a++)this.buf[this.pos++]=s[a]},writeRawMessage:function(s,r){this.pos++;var a=this.pos;s(r,this);var d=this.pos-a;d>=128&&w1(a,d,this),this.pos=a-1,this.writeVarint(d),this.pos+=d},writeMessage:function(s,r,a){this.writeTag(s,bi.Bytes),this.writeRawMessage(r,a)},writePackedVarint:function(s,r){r.length&&this.writeMessage(s,T1,r)},writePackedSVarint:function(s,r){r.length&&this.writeMessage(s,d0,r)},writePackedBoolean:function(s,r){r.length&&this.writeMessage(s,zl,r)},writePackedFloat:function(s,r){r.length&&this.writeMessage(s,f0,r)},writePackedDouble:function(s,r){r.length&&this.writeMessage(s,BE,r)},writePackedFixed32:function(s,r){r.length&&this.writeMessage(s,p0,r)},writePackedSFixed32:function(s,r){r.length&&this.writeMessage(s,E1,r)},writePackedFixed64:function(s,r){r.length&&this.writeMessage(s,S1,r)},writePackedSFixed64:function(s,r){r.length&&this.writeMessage(s,C1,r)},writeBytesField:function(s,r){this.writeTag(s,bi.Bytes),this.writeBytes(r)},writeFixed32Field:function(s,r){this.writeTag(s,bi.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(s,r){this.writeTag(s,bi.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(s,r){this.writeTag(s,bi.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(s,r){this.writeTag(s,bi.Fixed64),this.writeSFixed64(r)},writeVarintField:function(s,r){this.writeTag(s,bi.Varint),this.writeVarint(r)},writeSVarintField:function(s,r){this.writeTag(s,bi.Varint),this.writeSVarint(r)},writeStringField:function(s,r){this.writeTag(s,bi.Bytes),this.writeString(r)},writeFloatField:function(s,r){this.writeTag(s,bi.Fixed32),this.writeFloat(r)},writeDoubleField:function(s,r){this.writeTag(s,bi.Fixed64),this.writeDouble(r)},writeBooleanField:function(s,r){this.writeVarintField(s,!!r)}};var wf=pe(x1);const gc=3;function NE(s,r,a){r.glyphs=[],s===1&&a.readMessage(VE,r)}function VE(s,r,a){if(s===3){const{id:d,bitmap:m,width:v,height:w,left:C,top:I,advance:P}=a.readMessage(Op,{});r.glyphs.push({id:d,bitmap:new fc({width:v+2*gc,height:w+2*gc},m),metrics:{width:v,height:w,left:C,top:I,advance:P}})}else s===4?r.ascender=a.readSVarint():s===5&&(r.descender=a.readSVarint())}function Op(s,r,a){s===1?r.id=a.readVarint():s===2?r.bitmap=a.readBytes():s===3?r.width=a.readVarint():s===4?r.height=a.readVarint():s===5?r.left=a.readSVarint():s===6?r.top=a.readSVarint():s===7&&(r.advance=a.readVarint())}const g0=gc;function y0(s){let r=0,a=0;for(const w of s)r+=w.w*w.h,a=Math.max(a,w.w);s.sort(((w,C)=>C.h-w.h));const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),a),h:1/0}];let m=0,v=0;for(const w of s)for(let C=d.length-1;C>=0;C--){const I=d[C];if(!(w.w>I.w||w.h>I.h)){if(w.x=I.x,w.y=I.y,v=Math.max(v,w.y+w.h),m=Math.max(m,w.x+w.w),w.w===I.w&&w.h===I.h){const P=d.pop();C<d.length&&(d[C]=P)}else w.h===I.h?(I.x+=w.w,I.w-=w.w):w.w===I.w?(I.y+=w.h,I.h-=w.h):(d.push({x:I.x+w.w,y:I.y,w:I.w-w.w,h:w.h}),I.y+=w.h,I.h-=w.h);break}}return{w:m,h:v,fill:r/(m*v)||0}}const ma=1;class _0{constructor(r,{pixelRatio:a,version:d,stretchX:m,stretchY:v,content:w}){this.paddedRect=r,this.pixelRatio=a,this.stretchX=m,this.stretchY=v,this.content=w,this.version=d}get tl(){return[this.paddedRect.x+ma,this.paddedRect.y+ma]}get br(){return[this.paddedRect.x+this.paddedRect.w-ma,this.paddedRect.y+this.paddedRect.h-ma]}get displaySize(){return[(this.paddedRect.w-2*ma)/this.pixelRatio,(this.paddedRect.h-2*ma)/this.pixelRatio]}}class A1{constructor(r,a){const d={},m={};this.haveRenderCallbacks=[];const v=[];this.addImages(r,d,v),this.addImages(a,m,v);const{w,h:C}=y0(v),I=new vs({width:w||1,height:C||1});for(const P in r){const B=r[P],F=d[P].paddedRect;vs.copy(B.data,I,{x:0,y:0},{x:F.x+ma,y:F.y+ma},B.data)}for(const P in a){const B=a[P],F=m[P].paddedRect,$=F.x+ma,X=F.y+ma,J=B.data.width,oe=B.data.height;vs.copy(B.data,I,{x:0,y:0},{x:$,y:X},B.data),vs.copy(B.data,I,{x:0,y:oe-1},{x:$,y:X-1},{width:J,height:1}),vs.copy(B.data,I,{x:0,y:0},{x:$,y:X+oe},{width:J,height:1}),vs.copy(B.data,I,{x:J-1,y:0},{x:$-1,y:X},{width:1,height:oe}),vs.copy(B.data,I,{x:0,y:0},{x:$+J,y:X},{width:1,height:oe})}this.image=I,this.iconPositions=d,this.patternPositions=m}addImages(r,a,d){for(const m in r){const v=r[m],w={x:0,y:0,w:v.data.width+2*ma,h:v.data.height+2*ma};d.push(w),a[m]=new _0(w,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(r,a){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((d=>r.hasImage(d))),r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in r.updatedImages)this.patchUpdatedImage(this.iconPositions[d],r.getImage(d),a),this.patchUpdatedImage(this.patternPositions[d],r.getImage(d),a)}patchUpdatedImage(r,a,d){if(!r||!a||r.version===a.version)return;r.version=a.version;const[m,v]=r.tl;d.update(a.data,void 0,{x:m,y:v})}}gn(_0,"ImagePosition"),gn(A1,"ImageAtlas");const _l={horizontal:1,vertical:2,horizontalOnly:3},I1=-17;class tg{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,a){const d=new tg;return d.scale=r||1,d.fontStack=a,d}static forImage(r){const a=new tg;return a.imageName=r,a}}class Tf{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,a){const d=new Tf;for(let m=0;m<r.sections.length;m++){const v=r.sections[m];v.image?d.addImageSection(v):d.addTextSection(v,a)}return d}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSections(){return this.sections}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(r){this.text=(function(a,d){let m="";for(let v=0;v<a.length;v++){const w=a.charCodeAt(v+1)||null,C=a.charCodeAt(v-1)||null;m+=!d&&(w&&Jd(w)&&!bf[a[v+1]]||C&&Jd(C)&&!bf[a[v-1]])||!bf[a[v]]?a[v]:bf[a[v]]}return m})(this.text,r)}trim(){let r=0;for(let d=0;d<this.text.length&&td[this.text.charCodeAt(d)];d++)r++;let a=this.text.length;for(let d=this.text.length-1;d>=0&&d>=r&&td[this.text.charCodeAt(d)];d--)a--;this.text=this.text.substring(r,a),this.sectionIndex=this.sectionIndex.slice(r,a)}substring(r,a){const d=new Tf;return d.text=this.text.substring(r,a),d.sectionIndex=this.sectionIndex.slice(r,a),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((r,a)=>Math.max(r,this.sections[a].scale)),0)}addTextSection(r,a){this.text+=r.text,this.sections.push(tg.forText(r.scale,r.fontStack||a));const d=this.sections.length-1;for(let m=0;m<r.text.length;++m)this.sectionIndex.push(d)}addImageSection(r){const a=r.image?r.image.name:"";if(a.length===0)return void Rn("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(tg.forImage(a)),this.sectionIndex.push(this.sections.length-1)):Rn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ed(s,r,a,d,m,v,w,C,I,P,B,F,$,X,J){const oe=Tf.fromFeature(s,m);F===_l.vertical&&oe.verticalizePunctuation($);let _e=[];const Re=(function(Fe,ut,ot,bt,$t,pt){if(!Fe)return[];const Rt=[],Mt=(function(dn,wn,fn,lr,Yt,Vn){let cr=0;for(let Wr=0;Wr<dn.length();Wr++){const ur=dn.getSection(Wr);cr+=M1(dn.getCharCode(Wr),ur,lr,Yt,wn,Vn)}return cr/Math.max(1,Math.ceil(cr/fn))})(Fe,ut,ot,bt,$t,pt),Nt=Fe.text.indexOf("")>=0;let Zt=0;for(let dn=0;dn<Fe.length();dn++){const wn=Fe.getSection(dn),fn=Fe.getCharCode(dn);if(td[fn]||(Zt+=M1(fn,wn,bt,$t,ut,pt)),dn<Fe.length()-1){const lr=!((xt=fn)<11904||!(un["Bopomofo Extended"](xt)||un.Bopomofo(xt)||un["CJK Compatibility Forms"](xt)||un["CJK Compatibility Ideographs"](xt)||un["CJK Compatibility"](xt)||un["CJK Radicals Supplement"](xt)||un["CJK Strokes"](xt)||un["CJK Symbols and Punctuation"](xt)||un["CJK Unified Ideographs Extension A"](xt)||un["CJK Unified Ideographs"](xt)||un["Enclosed CJK Letters and Months"](xt)||un["Halfwidth and Fullwidth Forms"](xt)||un.Hiragana(xt)||un["Ideographic Description Characters"](xt)||un["Kangxi Radicals"](xt)||un["Katakana Phonetic Extensions"](xt)||un.Katakana(xt)||un["Vertical Forms"](xt)||un["Yi Radicals"](xt)||un["Yi Syllables"](xt)));(R1[fn]||lr||wn.imageName)&&Rt.push(v0(dn+1,Zt,Mt,Rt,ng(fn,Fe.getCharCode(dn+1),lr&&Nt),!1))}}var xt;return rg(v0(Fe.length(),Zt,Mt,Rt,0,!0))})(oe,P,v,r,d,X),{processBidirectionalText:Be,processStyledBidirectionalText:Pe}=L;if(Be&&oe.sections.length===1){const Fe=Be(oe.toString(),Re);for(const ut of Fe){const ot=new Tf;ot.text=ut,ot.sections=oe.sections;for(let bt=0;bt<ut.length;bt++)ot.sectionIndex.push(0);_e.push(ot)}}else if(Pe){const Fe=Pe(oe.text,oe.sectionIndex,Re);for(const ut of Fe){const ot=new Tf;ot.text=ut[0],ot.sectionIndex=ut[1],ot.sections=oe.sections,_e.push(ot)}}else _e=(function(Fe,ut){const ot=[],bt=Fe.text;let $t=0;for(const pt of ut)ot.push(Fe.substring($t,pt)),$t=pt;return $t<bt.length&&ot.push(Fe.substring($t,bt.length)),ot})(oe,Re);const ze=[],Ue={positionedLines:ze,text:oe.toString(),top:B[1],bottom:B[1],left:B[0],right:B[0],writingMode:F,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return(function(Fe,ut,ot,bt,$t,pt,Rt,Mt,Nt,Zt,xt,dn){let wn=0,fn=0,lr=0;const Yt=Mt==="right"?1:Mt==="left"?0:.5;let Vn=!1;for(const dr of $t){const fr=dr.getSections();for(const Ai of fr){if(Ai.imageName)continue;const Li=ut[Ai.fontStack];if(Li&&(Vn=Li.ascender!==void 0&&Li.descender!==void 0,!Vn))break}if(!Vn)break}let cr=0;for(const dr of $t){dr.trim();const fr=dr.getMaxScale(),Ai=(fr-1)*Zs,Li={positionedGlyphs:[],lineOffset:0};Fe.positionedLines[cr]=Li;const Oi=Li.positionedGlyphs;let Ii=0;if(!dr.length()){fn+=pt,++cr;continue}let ls=0,ps=0;for(let Ri=0;Ri<dr.length();Ri++){const zs=dr.getSection(Ri),As=dr.getSectionIndex(Ri),us=dr.getCharCode(Ri);let Jr=zs.scale,Is=null,zi=null,Ga=null,Rs=Zs,Bo=0;const ho=!(Nt===_l.horizontal||!xt&&!Qd(us)||xt&&(td[us]||(Wr=us,un.Arabic(Wr)||un["Arabic Supplement"](Wr)||un["Arabic Extended-A"](Wr)||un["Arabic Presentation Forms-A"](Wr)||un["Arabic Presentation Forms-B"](Wr))));if(zs.imageName){const Ha=bt[zs.imageName];if(!Ha)continue;Ga=zs.imageName,Fe.iconsInText=Fe.iconsInText||!0,zi=Ha.paddedRect;const fo=Ha.displaySize;Jr=Jr*Zs/dn,Is={width:fo[0],height:fo[1],left:ma,top:-g0,advance:ho?fo[1]:fo[0],localGlyph:!1},Bo=Vn?-Is.height*Jr:I1+fr*Zs-fo[1]*Jr,Rs=Is.advance;const oh=(ho?fo[0]:fo[1])*Jr-Zs*fr;oh>0&&oh>Ii&&(Ii=oh)}else{const Ha=ot[zs.fontStack];if(!Ha)continue;Ha[us]&&(zi=Ha[us]);const fo=ut[zs.fontStack];if(!fo)continue;const oh=fo.glyphs[us];if(!oh)continue;if(Is=oh.metrics,Rs=us!==8203?Zs:0,Vn){const Ky=fo.ascender!==void 0?Math.abs(fo.ascender):0,R0=fo.descender!==void 0?Math.abs(fo.descender):0,M0=(Ky+R0)*Jr;ls<M0&&(ls=M0,ps=(Ky-R0)/2*Jr),Bo=-Ky*Jr}else Bo=I1+(fr-Jr)*Zs}ho?(Fe.verticalizable=!0,Oi.push({glyph:us,imageName:Ga,x:wn,y:fn+Bo,vertical:ho,scale:Jr,localGlyph:Is.localGlyph,fontStack:zs.fontStack,sectionIndex:As,metrics:Is,rect:zi}),wn+=Rs*Jr+Zt):(Oi.push({glyph:us,imageName:Ga,x:wn,y:fn+Bo,vertical:ho,scale:Jr,localGlyph:Is.localGlyph,fontStack:zs.fontStack,sectionIndex:As,metrics:Is,rect:zi}),wn+=Is.advance*Jr+Zt)}Oi.length!==0&&(lr=Math.max(wn-Zt,lr),Vn?Ny(Oi,Yt,Ii,ps,pt*fr/2):Ny(Oi,Yt,Ii,0,pt/2)),wn=0;const Cs=pt*fr+Ii;Li.lineOffset=Math.max(Ii,Ai),fn+=Cs,++cr}var Wr;const ur=fn,{horizontalAlign:Gn,verticalAlign:ji}=ig(Rt);(function(dr,fr,Ai,Li,Oi,Ii){const ls=(fr-Ai)*Oi,ps=-Ii*Li;for(const Cs of dr)for(const Ri of Cs.positionedGlyphs)Ri.x+=ls,Ri.y+=ps})(Fe.positionedLines,Yt,Gn,ji,lr,ur),Fe.top+=-ji*ur,Fe.bottom=Fe.top+ur,Fe.left+=-Gn*lr,Fe.right=Fe.left+lr,Fe.hasBaseline=Vn})(Ue,r,a,d,_e,w,C,I,F,P,$,J),!(function(Fe){for(const ut of Fe)if(ut.positionedGlyphs.length!==0)return!1;return!0})(ze)&&Ue}const td={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},R1={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function M1(s,r,a,d,m,v){if(r.imageName){const w=d[r.imageName];return w?w.displaySize[0]*r.scale*Zs/v+m:0}{const w=a[r.fontStack],C=w&&w.glyphs[s];return C?C.metrics.advance*r.scale+m:0}}function Ef(s,r,a,d){const m=Math.pow(s-r,2);return d?s<r?m/2:2*m:m+Math.abs(a)*a}function ng(s,r,a){let d=0;return s===10&&(d-=1e4),a&&(d+=150),s!==40&&s!==65288||(d+=50),r!==41&&r!==65289||(d+=50),d}function v0(s,r,a,d,m,v){let w=null,C=Ef(r,a,m,v);for(const I of d){const P=Ef(r-I.x,a,m,v)+I.badness;P<=C&&(w=I,C=P)}return{index:s,x:r,priorBreak:w,badness:C}}function rg(s){return s?rg(s.priorBreak).concat(s.index):[]}function ig(s){let r=.5,a=.5;switch(s){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:r,verticalAlign:a}}function Ny(s,r,a,d,m){if(!(r||a||d||m))return;const v=s.length-1,w=s[v],C=(w.x+w.metrics.advance*w.scale)*r;for(let I=0;I<=v;I++)s[I].x-=C,s[I].y+=a+d+m}function Vy(s,r,a){const{horizontalAlign:d,verticalAlign:m}=ig(a),v=r[0]-s.displaySize[0]*d,w=r[1]-s.displaySize[1]*m;return{image:s,top:w,bottom:w+s.displaySize[1],left:v,right:v+s.displaySize[0]}}function x0(s,r,a,d,m,v){const w=s.image;let C;if(w.content){const _e=w.content,Re=w.pixelRatio||1;C=[_e[0]/Re,_e[1]/Re,w.displaySize[0]-_e[2]/Re,w.displaySize[1]-_e[3]/Re]}const I=r.left*v,P=r.right*v;let B,F,$,X;a==="width"||a==="both"?(X=m[0]+I-d[3],F=m[0]+P+d[1]):(X=m[0]+(I+P-w.displaySize[0])/2,F=X+w.displaySize[0]);const J=r.top*v,oe=r.bottom*v;return a==="height"||a==="both"?(B=m[1]+J-d[0],$=m[1]+oe+d[2]):(B=m[1]+(J+oe-w.displaySize[1])/2,$=B+w.displaySize[1]),{image:w,top:B,right:F,bottom:$,left:X,collisionPadding:C}}class Jc extends se{constructor(r,a,d,m,v){super(r,a),this.angle=m,this.z=d,v!==void 0&&(this.segment=v)}clone(){return new Jc(this.x,this.y,this.z,this.angle,this.segment)}}function P1(s,r,a,d,m){if(r.segment===void 0)return!0;let v=r,w=r.segment+1,C=0;for(;C>-a/2;){if(w--,w<0)return!1;C-=s[w].dist(v),v=s[w]}C+=s[w].dist(s[w+1]),w++;const I=[];let P=0;for(;C<a/2;){const B=s[w],F=s[w+1];if(!F)return!1;let $=s[w-1].angleTo(B)-B.angleTo(F);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:C,angleDelta:$}),P+=$;C-I[0].distance>d;)P-=I.shift().angleDelta;if(P>m)return!1;w++,C+=B.dist(F)}return!0}function b0(s){let r=0;for(let a=0;a<s.length-1;a++)r+=s[a].dist(s[a+1]);return r}function k1(s,r,a){return s?.6*r*a:0}function Fy(s,r){return Math.max(s?s.right-s.left:0,r?r.right-r.left:0)}function FE(s,r,a,d,m,v){const w=k1(a,m,v),C=Fy(a,d)*v;let I=0;const P=b0(s)/2;for(let B=0;B<s.length-1;B++){const F=s[B],$=s[B+1],X=F.dist($);if(I+X>P){const J=(P-I)/X,oe=nr(F.x,$.x,J),_e=nr(F.y,$.y,J),Re=new Jc(oe,_e,0,$.angleTo(F),B);return!w||P1(s,Re,C,w,r)?Re:void 0}I+=X}}function Uy(s,r,a,d,m,v,w,C,I){const P=k1(d,v,w),B=Fy(d,m),F=B*w,$=s[0].x===0||s[0].x===I||s[0].y===0||s[0].y===I;return r-F<r/4&&(r=F+r/4),sg(s,$?r/2*C%r:(B/2+2*v)*w*C%r,r,P,a,F,$,!1,I)}function sg(s,r,a,d,m,v,w,C,I){const P=v/2,B=b0(s);let F=0,$=r-a,X=[];for(let J=0;J<s.length-1;J++){const oe=s[J],_e=s[J+1],Re=oe.dist(_e),Be=_e.angleTo(oe);for(;$+a<F+Re;){$+=a;const Pe=($-F)/Re,ze=nr(oe.x,_e.x,Pe),Ue=nr(oe.y,_e.y,Pe);if(ze>=0&&ze<I&&Ue>=0&&Ue<I&&$-P>=0&&$+P<=B){const Fe=new Jc(ze,Ue,0,Be,J);Fe._round(),d&&!P1(s,Fe,v,d,m)||X.push(Fe)}}F+=Re}return C||X.length||w||(X=sg(s,F/2,a,d,m,v,w,!0,I)),X}function og(s,r,a,d,m){const v=[];for(let w=0;w<s.length;w++){const C=s[w];let I;for(let P=0;P<C.length-1;P++){let B=C[P],F=C[P+1];B.x<r&&F.x<r||(B.x<r?B=new se(r,B.y+(r-B.x)/(F.x-B.x)*(F.y-B.y))._round():F.x<r&&(F=new se(r,B.y+(r-B.x)/(F.x-B.x)*(F.y-B.y))._round()),B.y<a&&F.y<a||(B.y<a?B=new se(B.x+(a-B.y)/(F.y-B.y)*(F.x-B.x),a)._round():F.y<a&&(F=new se(B.x+(a-B.y)/(F.y-B.y)*(F.x-B.x),a)._round()),B.x>=d&&F.x>=d||(B.x>=d?B=new se(d,B.y+(d-B.x)/(F.x-B.x)*(F.y-B.y))._round():F.x>=d&&(F=new se(d,B.y+(d-B.x)/(F.x-B.x)*(F.y-B.y))._round()),B.y>=m&&F.y>=m||(B.y>=m?B=new se(B.x+(m-B.y)/(F.y-B.y)*(F.x-B.x),m)._round():F.y>=m&&(F=new se(B.x+(m-B.y)/(F.y-B.y)*(F.x-B.x),m)._round()),I&&B.equals(I[I.length-1])||(I=[B],v.push(I)),I.push(F)))))}}return v}gn(Jc,"Anchor");const ag=1e20;function zp(s,r,a,d,m,v,w,C,I){for(let P=r;P<r+d;P++)D1(s,a*v+P,v,m,w,C,I);for(let P=a;P<a+m;P++)D1(s,P*v+r,1,d,w,C,I)}function D1(s,r,a,d,m,v,w){v[0]=0,w[0]=-ag,w[1]=ag,m[0]=s[r];for(let C=1,I=0,P=0;C<d;C++){m[C]=s[r+C*a];const B=C*C;do{const F=v[I];P=(m[C]-m[F]+B-F*F)/(C-F)/2}while(P<=w[I]&&--I>-1);I++,v[I]=C,w[I]=P,w[I+1]=ag}for(let C=0,I=0;C<d;C++){for(;w[I+1]<C;)I++;const P=v[I],B=C-P;s[r+C*a]=m[P]+B*B}}const Bl=2,jy={none:0,ideographs:1,all:2};class Sf{constructor(r,a,d){this.requestManager=r,this.localGlyphMode=a,this.localFontFamily=d,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(r){this.url=r}getGlyphs(r,a){const d=[];for(const m in r)for(const v of r[m])d.push({stack:m,id:v});tt(d,(({stack:m,id:v},w)=>{let C=this.entries[m];C||(C=this.entries[m]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let I=C.glyphs[v];if(I!==void 0)return void w(null,{stack:m,id:v,glyph:I});if(I=this._tinySDF(C,m,v),I)return C.glyphs[v]=I,void w(null,{stack:m,id:v,glyph:I});const P=Math.floor(v/256);if(256*P>65535)return void w(new Error("glyphs > 65535 not supported"));if(C.ranges[P])return void w(null,{stack:m,id:v,glyph:I});let B=C.requests[P];B||(B=C.requests[P]=[],Sf.loadGlyphRange(m,P,this.url,this.requestManager,((F,$)=>{if($){C.ascender=$.ascender,C.descender=$.descender;for(const X in $.glyphs)this._doesCharSupportLocalGlyph(+X)||(C.glyphs[+X]=$.glyphs[+X]);C.ranges[P]=!0}for(const X of B)X(F,$);delete C.requests[P]}))),B.push(((F,$)=>{F?w(F):$&&w(null,{stack:m,id:v,glyph:$.glyphs[v]||null})}))}),((m,v)=>{if(m)a(m);else if(v){const w={};for(const{stack:C,id:I,glyph:P}of v)w[C]===void 0&&(w[C]={}),w[C].glyphs===void 0&&(w[C].glyphs={}),w[C].glyphs[I]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics},w[C].ascender=this.entries[C].ascender,w[C].descender=this.entries[C].descender;a(null,w)}}))}_doesCharSupportLocalGlyph(r){return this.localGlyphMode!==jy.none&&(this.localGlyphMode===jy.all?!!this.localFontFamily:!!this.localFontFamily&&(un["CJK Unified Ideographs"](r)||un["Hangul Syllables"](r)||un.Hiragana(r)||un.Katakana(r)||un["CJK Symbols and Punctuation"](r)))}_tinySDF(r,a,d){const m=this.localFontFamily;if(!m||!this._doesCharSupportLocalGlyph(d))return;let v=r.tinySDF;if(!v){let oe="400";/bold/i.test(a)?oe="900":/medium/i.test(a)?oe="500":/light/i.test(a)&&(oe="200"),v=r.tinySDF=new Sf.TinySDF({fontFamily:m,fontWeight:oe,fontSize:24*Bl,buffer:3*Bl,radius:8*Bl}),v.fontWeight=oe}if(this.localGlyphs[v.fontWeight][d])return this.localGlyphs[v.fontWeight][d];const w=String.fromCharCode(d),{data:C,width:I,height:P,glyphWidth:B,glyphHeight:F,glyphLeft:$,glyphTop:X,glyphAdvance:J}=v.draw(w);return this.localGlyphs[v.fontWeight][d]={id:d,bitmap:new fc({width:I,height:P},C),metrics:{width:B/Bl,height:F/Bl,left:$/Bl,top:X/Bl-27,advance:J/Bl,localGlyph:!0}}}}Sf.loadGlyphRange=function(s,r,a,d,m){const v=256*r,w=v+255,C=d.transformRequest(d.normalizeGlyphsURL(a).replace("{fontstack}",s).replace("{range}",`${v}-${w}`),_r.Glyphs);Gi(C,((I,P)=>{if(I)m(I);else if(P){const B={},F=(function($){return new wf($).readFields(NE,{})})(P);for(const $ of F.glyphs)B[$.id]=$;m(null,{glyphs:B,ascender:F.ascender,descender:F.descender})}}))},Sf.TinySDF=class{constructor({fontSize:s=24,buffer:r=3,radius:a=8,cutoff:d=.25,fontFamily:m="sans-serif",fontWeight:v="normal",fontStyle:w="normal"}={}){this.buffer=r,this.cutoff=d,this.radius=a;const C=this.size=s+4*r,I=this._createCanvas(C),P=this.ctx=I.getContext("2d",{willReadFrequently:!0});P.font=`${w} ${v} ${s}px ${m}`,P.textBaseline="alphabetic",P.textAlign="left",P.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(s){const r=document.createElement("canvas");return r.width=r.height=s,r}draw(s){const{width:r,actualBoundingBoxAscent:a,actualBoundingBoxDescent:d,actualBoundingBoxLeft:m,actualBoundingBoxRight:v}=this.ctx.measureText(s),w=Math.ceil(a),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-m))),I=Math.min(this.size-this.buffer,w+Math.ceil(d)),P=C+2*this.buffer,B=I+2*this.buffer,F=Math.max(P*B,0),$=new Uint8ClampedArray(F),X={data:$,width:P,height:B,glyphWidth:C,glyphHeight:I,glyphTop:w,glyphLeft:0,glyphAdvance:r};if(C===0||I===0)return X;const{ctx:J,buffer:oe,gridInner:_e,gridOuter:Re}=this;J.clearRect(oe,oe,C,I),J.fillText(s,oe,oe+w);const Be=J.getImageData(oe,oe,C,I);Re.fill(ag,0,F),_e.fill(0,0,F);for(let Pe=0;Pe<I;Pe++)for(let ze=0;ze<C;ze++){const Ue=Be.data[4*(Pe*C+ze)+3]/255;if(Ue===0)continue;const Fe=(Pe+oe)*P+ze+oe;if(Ue===1)Re[Fe]=0,_e[Fe]=ag;else{const ut=.5-Ue;Re[Fe]=ut>0?ut*ut:0,_e[Fe]=ut<0?ut*ut:0}}zp(Re,0,0,P,B,P,this.f,this.v,this.z),zp(_e,oe,oe,C,I,P,this.f,this.v,this.z);for(let Pe=0;Pe<F;Pe++){const ze=Math.sqrt(Re[Pe])-Math.sqrt(_e[Pe]);$[Pe]=Math.round(255-255*(ze/this.radius+this.cutoff))}return X}};const Cf=ma;function $y(s,r,a,d){const m=[],v=s.image,w=v.pixelRatio,C=v.paddedRect.w-2*Cf,I=v.paddedRect.h-2*Cf,P=s.right-s.left,B=s.bottom-s.top,F=v.stretchX||[[0,C]],$=v.stretchY||[[0,I]],X=(pt,Rt)=>pt+Rt[1]-Rt[0],J=F.reduce(X,0),oe=$.reduce(X,0),_e=C-J,Re=I-oe;let Be=0,Pe=J,ze=0,Ue=oe,Fe=0,ut=_e,ot=0,bt=Re;if(v.content&&d){const pt=v.content;Be=lg(F,0,pt[0]),ze=lg($,0,pt[1]),Pe=lg(F,pt[0],pt[2]),Ue=lg($,pt[1],pt[3]),Fe=pt[0]-Be,ot=pt[1]-ze,ut=pt[2]-pt[0]-Pe,bt=pt[3]-pt[1]-Ue}const $t=(pt,Rt,Mt,Nt)=>{const Zt=Af(pt.stretch-Be,Pe,P,s.left),xt=qy(pt.fixed-Fe,ut,pt.stretch,J),dn=Af(Rt.stretch-ze,Ue,B,s.top),wn=qy(Rt.fixed-ot,bt,Rt.stretch,oe),fn=Af(Mt.stretch-Be,Pe,P,s.left),lr=qy(Mt.fixed-Fe,ut,Mt.stretch,J),Yt=Af(Nt.stretch-ze,Ue,B,s.top),Vn=qy(Nt.fixed-ot,bt,Nt.stretch,oe),cr=new se(Zt,dn),Wr=new se(fn,dn),ur=new se(fn,Yt),Gn=new se(Zt,Yt),ji=new se(xt/w,wn/w),dr=new se(lr/w,Vn/w),fr=r*Math.PI/180;if(fr){const Oi=Math.sin(fr),Ii=Math.cos(fr),ls=[Ii,-Oi,Oi,Ii];cr._matMult(ls),Wr._matMult(ls),Gn._matMult(ls),ur._matMult(ls)}const Ai=pt.stretch+pt.fixed,Li=Rt.stretch+Rt.fixed;return{tl:cr,tr:Wr,bl:Gn,br:ur,tex:{x:v.paddedRect.x+Cf+Ai,y:v.paddedRect.y+Cf+Li,w:Mt.stretch+Mt.fixed-Ai,h:Nt.stretch+Nt.fixed-Li},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ji,pixelOffsetBR:dr,minFontScaleX:ut/w/P,minFontScaleY:bt/w/B,isSDF:a}};if(d&&(v.stretchX||v.stretchY)){const pt=w0(F,_e,J),Rt=w0($,Re,oe);for(let Mt=0;Mt<pt.length-1;Mt++){const Nt=pt[Mt],Zt=pt[Mt+1];for(let xt=0;xt<Rt.length-1;xt++)m.push($t(Nt,Rt[xt],Zt,Rt[xt+1]))}}else m.push($t({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:I+1}));return m}function lg(s,r,a){let d=0;for(const m of s)d+=Math.max(r,Math.min(a,m[1]))-Math.max(r,Math.min(a,m[0]));return d}function w0(s,r,a){const d=[{fixed:-Cf,stretch:0}];for(const[m,v]of s){const w=d[d.length-1];d.push({fixed:m-w.stretch,stretch:w.stretch}),d.push({fixed:m-w.stretch,stretch:w.stretch+(v-m)})}return d.push({fixed:r+Cf,stretch:a}),d}function Af(s,r,a,d){return s/r*a+d}function qy(s,r,a,d){return s-r*a/d}function UE(s,r,a,d){const m=r+s.positionedLines[d].lineOffset;return d===0?a+m/2:a+(m+(r+s.positionedLines[d-1].lineOffset))/2}class T0{constructor(r=[],a=E0){if(this.data=r,this.length=this.data.length,this.compare=a,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(r){this.data.push(r),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const r=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:a,compare:d}=this,m=a[r];for(;r>0;){const v=r-1>>1,w=a[v];if(d(m,w)>=0)break;a[r]=w,r=v}a[r]=m}_down(r){const{data:a,compare:d}=this,m=this.length>>1,v=a[r];for(;r<m;){let w=1+(r<<1),C=a[w];const I=w+1;if(I<this.length&&d(a[I],C)<0&&(w=I,C=a[I]),d(C,v)>=0)break;a[r]=C,r=w}a[r]=v}}function E0(s,r){return s<r?-1:s>r?1:0}function Gy(s,r=1,a=!1){let d=1/0,m=1/0,v=-1/0,w=-1/0;const C=s[0];for(let X=0;X<C.length;X++){const J=C[X];(!X||J.x<d)&&(d=J.x),(!X||J.y<m)&&(m=J.y),(!X||J.x>v)&&(v=J.x),(!X||J.y>w)&&(w=J.y)}const I=Math.min(v-d,w-m);let P=I/2;const B=new T0([],S0);if(I===0)return new se(d,m);for(let X=d;X<v;X+=I)for(let J=m;J<w;J+=I)B.push(new If(X+P,J+P,P,s));let F=(function(X){let J=0,oe=0,_e=0;const Re=X[0];for(let Be=0,Pe=Re.length,ze=Pe-1;Be<Pe;ze=Be++){const Ue=Re[Be],Fe=Re[ze],ut=Ue.x*Fe.y-Fe.x*Ue.y;oe+=(Ue.x+Fe.x)*ut,_e+=(Ue.y+Fe.y)*ut,J+=3*ut}return new If(oe/J,_e/J,0,X)})(s),$=B.length;for(;B.length;){const X=B.pop();(X.d>F.d||!F.d)&&(F=X,a&&console.log("found best %d after %d probes",Math.round(1e4*X.d)/1e4,$)),X.max-F.d<=r||(P=X.h/2,B.push(new If(X.p.x-P,X.p.y-P,P,s)),B.push(new If(X.p.x+P,X.p.y-P,P,s)),B.push(new If(X.p.x-P,X.p.y+P,P,s)),B.push(new If(X.p.x+P,X.p.y+P,P,s)),$+=4)}return a&&(console.log(`num probes: ${$}`),console.log(`best distance: ${F.d}`)),F.p}function S0(s,r){return r.max-s.max}class If{constructor(r,a,d,m){this.p=new se(r,a),this.h=d,this.d=(function(v,w){let C=!1,I=1/0;for(let P=0;P<w.length;P++){const B=w[P];for(let F=0,$=B.length,X=$-1;F<$;X=F++){const J=B[F],oe=B[X];J.y>v.y!=oe.y>v.y&&v.x<(oe.x-J.x)*(v.y-J.y)/(oe.y-J.y)+J.x&&(C=!C),I=Math.min(I,hf(v,J,oe))}}return(C?1:-1)*Math.sqrt(I)})(this.p,m),this.max=this.d+this.h*Math.SQRT2}}const nd=7,eu=Number.POSITIVE_INFINITY,rd=Math.sqrt(2);function nh(s,[r,a]){let d=0,m=0;if(a===eu){r<0&&(r=0);const v=r/rd;switch(s){case"top-right":case"top-left":m=v-nd;break;case"bottom-right":case"bottom-left":m=-v+nd;break;case"bottom":m=-r+nd;break;case"top":m=r-nd}switch(s){case"top-right":case"bottom-right":d=-v;break;case"top-left":case"bottom-left":d=v;break;case"left":d=r;break;case"right":d=-r}}else{switch(r=Math.abs(r),a=Math.abs(a),s){case"top-right":case"top-left":case"top":m=a-nd;break;case"bottom-right":case"bottom-left":case"bottom":m=-a+nd}switch(s){case"top-right":case"bottom-right":case"right":d=-r;break;case"top-left":case"bottom-left":case"left":d=r}}return[d,m]}function cg(s,r,a,d,m,v,w,C,I,P){s.createArrays(),s.tilePixelRatio=Dn/(512*s.overscaling),s.compareText={},s.iconsNeedLinear=!1;const B=s.layers[0].layout,F=s.layers[0]._unevaluatedLayout._values,$={};if(s.textSizeData.kind==="composite"){const{minZoom:oe,maxZoom:_e}=s.textSizeData;$.compositeTextSizes=[F["text-size"].possiblyEvaluate(new V(oe),C),F["text-size"].possiblyEvaluate(new V(_e),C)]}if(s.iconSizeData.kind==="composite"){const{minZoom:oe,maxZoom:_e}=s.iconSizeData;$.compositeIconSizes=[F["icon-size"].possiblyEvaluate(new V(oe),C),F["icon-size"].possiblyEvaluate(new V(_e),C)]}$.layoutTextSize=F["text-size"].possiblyEvaluate(new V(I+1),C),$.layoutIconSize=F["icon-size"].possiblyEvaluate(new V(I+1),C),$.textMaxSize=F["text-size"].possiblyEvaluate(new V(18),C);const X=B.get("text-rotation-alignment")==="map"&&B.get("symbol-placement")!=="point",J=B.get("text-size");for(const oe of s.features){const _e=B.get("text-font").evaluate(oe,{},C).join(","),Re=J.evaluate(oe,{},C),Be=$.layoutTextSize.evaluate(oe,{},C),Pe=($.layoutIconSize.evaluate(oe,{},C),{horizontal:{},vertical:void 0}),ze=oe.text;let Ue,Fe=[0,0];if(ze){const bt=ze.toString(),$t=B.get("text-letter-spacing").evaluate(oe,{},C)*Zs,pt=B.get("text-line-height").evaluate(oe,{},C)*Zs,Rt=sy(bt)?$t:0,Mt=B.get("text-anchor").evaluate(oe,{},C),Nt=B.get("text-variable-anchor");if(!Nt){const fn=B.get("text-radial-offset").evaluate(oe,{},C);Fe=fn?nh(Mt,[fn*Zs,eu]):B.get("text-offset").evaluate(oe,{},C).map((lr=>lr*Zs))}let Zt=X?"center":B.get("text-justify").evaluate(oe,{},C);const xt=B.get("symbol-placement")==="point",dn=xt?B.get("text-max-width").evaluate(oe,{},C)*Zs:1/0,wn=fn=>{s.allowVerticalPlacement&&Om(bt)&&(Pe.vertical=ed(ze,r,a,m,_e,dn,pt,Mt,fn,Rt,Fe,_l.vertical,!0,Be,Re))};if(!X&&Nt){const fn=Zt==="auto"?Nt.map((Yt=>Rf(Yt))):[Zt];let lr=!1;for(let Yt=0;Yt<fn.length;Yt++){const Vn=fn[Yt];if(!Pe.horizontal[Vn])if(lr)Pe.horizontal[Vn]=Pe.horizontal[0];else{const cr=ed(ze,r,a,m,_e,dn,pt,"center",Vn,Rt,Fe,_l.horizontal,!1,Be,Re);cr&&(Pe.horizontal[Vn]=cr,lr=cr.positionedLines.length===1)}}wn("left")}else{if(Zt==="auto"&&(Zt=Rf(Mt)),xt||B.get("text-writing-mode").indexOf("horizontal")>=0||!Om(bt)){const fn=ed(ze,r,a,m,_e,dn,pt,Mt,Zt,Rt,Fe,_l.horizontal,!1,Be,Re);fn&&(Pe.horizontal[Zt]=fn)}wn(xt?"left":Zt)}}let ut=!1;if(oe.icon&&oe.icon.name){const bt=d[oe.icon.name];bt&&(Ue=Vy(m[oe.icon.name],B.get("icon-offset").evaluate(oe,{},C),B.get("icon-anchor").evaluate(oe,{},C)),ut=bt.sdf,s.sdfIcons===void 0?s.sdfIcons=bt.sdf:s.sdfIcons!==bt.sdf&&Rn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(bt.pixelRatio!==s.pixelRatio||B.get("icon-rotate").constantOr(1)!==0)&&(s.iconsNeedLinear=!0))}const ot=L1(Pe.horizontal)||Pe.vertical;s.iconsInText||(s.iconsInText=!!ot&&ot.iconsInText),(ot||Ue)&&id(s,oe,Pe,Ue,d,$,Be,0,Fe,ut,w,C,P)}v&&s.generateCollisionDebugBuffers(I,s.collisionBoxArray)}function Rf(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function id(s,r,a,d,m,v,w,C,I,P,B,F,$){let X=v.textMaxSize.evaluate(r,{},F);X===void 0&&(X=w);const J=s.layers[0].layout,oe=J.get("icon-offset").evaluate(r,{},F),_e=L1(a.horizontal)||a.vertical,Re=$.name==="globe",Be=Zs,Pe=w/Be,ze=s.tilePixelRatio*X/Be,Ue=(Mt=s.overscaling,s.zoom>18&&Mt>2&&(Mt>>=1),Math.max(Dn/(512*Mt),1)*J.get("symbol-spacing")),Fe=J.get("text-padding")*s.tilePixelRatio,ut=J.get("icon-padding")*s.tilePixelRatio,ot=le(J.get("text-max-angle")),bt=J.get("text-rotation-alignment")==="map"&&J.get("symbol-placement")!=="point",$t=J.get("icon-rotation-alignment")==="map"&&J.get("symbol-placement")!=="point",pt=J.get("symbol-placement"),Rt=Ue/2;var Mt;const Nt=J.get("icon-text-fit");let Zt;d&&Nt!=="none"&&(s.allowVerticalPlacement&&a.vertical&&(Zt=x0(d,a.vertical,Nt,J.get("icon-text-fit-padding"),oe,Pe)),_e&&(d=x0(d,_e,Nt,J.get("icon-text-fit-padding"),oe,Pe)));const xt=(dn,wn,fn)=>{if(wn.x<0||wn.x>=Dn||wn.y<0||wn.y>=Dn)return;let lr=null;if(Re){const{x:Yt,y:Vn,z:cr}=$.projectTilePoint(wn.x,wn.y,fn);lr={anchor:new Jc(Yt,Vn,cr,0,void 0),up:$.upVector(fn,wn.x,wn.y)}}(function(Yt,Vn,cr,Wr,ur,Gn,ji,dr,fr,Ai,Li,Oi,Ii,ls,ps,Cs,Ri,zs,As,us,Jr,Is,zi,Ga,Rs){const Bo=Yt.addToLineVertexArray(Vn,Wr);let ho,Ha,fo,oh,Ky,R0,M0,HM=0,WM=0,XM=0,ZM=0,JE=-1,eS=-1;const ud={};let KM=oy("");const fg=cr?cr.anchor:Vn;let tS=0,nS=0;if(fr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[tS,nS]=fr.layout.get("text-offset").evaluate(Jr,{},Rs).map((Nl=>Nl*Zs)):(tS=fr.layout.get("text-radial-offset").evaluate(Jr,{},Rs)*Zs,nS=eu),Yt.allowVerticalPlacement&&ur.vertical){const Nl=ur.vertical;if(ps)R0=Np(Nl),dr&&(M0=Np(dr));else{const Vl=fr.layout.get("text-rotate").evaluate(Jr,{},Rs)+90;fo=hg(Ai,fg,Vn,Li,Oi,Ii,Nl,ls,Vl,Cs),dr&&(oh=hg(Ai,fg,Vn,Li,Oi,Ii,dr,zs,Vl))}}if(Gn){const Nl=fr.layout.get("icon-rotate").evaluate(Jr,{},Rs),Vl=fr.layout.get("icon-text-fit")!=="none",P0=$y(Gn,Nl,zi,Vl),iS=dr?$y(dr,Nl,zi,Vl):void 0;Ha=hg(Ai,fg,Vn,Li,Oi,Ii,Gn,zs,Nl),HM=4*P0.length;const YM=Yt.iconSizeData;let pg=null;YM.kind==="source"?(pg=[yl*fr.layout.get("icon-size").evaluate(Jr,{},Rs)],pg[0]>rh&&Rn(`${Yt.layerIds[0]}: Value for "icon-size" is >= ${ug}. Reduce your "icon-size".`)):YM.kind==="composite"&&(pg=[yl*Is.compositeIconSizes[0].evaluate(Jr,{},Rs),yl*Is.compositeIconSizes[1].evaluate(Jr,{},Rs)],(pg[0]>rh||pg[1]>rh)&&Rn(`${Yt.layerIds[0]}: Value for "icon-size" is >= ${ug}. Reduce your "icon-size".`)),Yt.addSymbols(Yt.icon,P0,pg,us,As,Jr,!1,cr,Vn,Bo.lineStartIndex,Bo.lineLength,-1,Ga,Rs),JE=Yt.icon.placedSymbolArray.length-1,iS&&(WM=4*iS.length,Yt.addSymbols(Yt.icon,iS,pg,us,As,Jr,_l.vertical,cr,Vn,Bo.lineStartIndex,Bo.lineLength,-1,Ga,Rs),eS=Yt.icon.placedSymbolArray.length-1)}for(const Nl in ur.horizontal){const Vl=ur.horizontal[Nl];ho||(KM=oy(Vl.text),ps?Ky=Np(Vl):ho=hg(Ai,fg,Vn,Li,Oi,Ii,Vl,ls,fr.layout.get("text-rotate").evaluate(Jr,{},Rs),Cs));const P0=Vl.positionedLines.length===1;if(XM+=Bp(Yt,cr,Vn,Vl,ji,fr,ps,Jr,Cs,Bo,ur.vertical?_l.horizontal:_l.horizontalOnly,P0?Object.keys(ur.horizontal):[Nl],ud,JE,Is,Ga,Rs),P0)break}ur.vertical&&(ZM+=Bp(Yt,cr,Vn,ur.vertical,ji,fr,ps,Jr,Cs,Bo,_l.vertical,["vertical"],ud,eS,Is,Ga,Rs));let Gp=-1;const rS=(Nl,Vl)=>Nl?Math.max(Nl,Vl):Vl;Gp=rS(Ky,Gp),Gp=rS(R0,Gp),Gp=rS(M0,Gp);const zV=Gp>-1?1:0;Yt.glyphOffsetArray.length>=kt.MAX_GLYPHS&&Rn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Jr.sortKey!==void 0&&Yt.addToSortKeyRanges(Yt.symbolInstances.length,Jr.sortKey),Yt.symbolInstances.emplaceBack(fg.x,fg.y,fg.z,Vn.x,Vn.y,ud.right>=0?ud.right:-1,ud.center>=0?ud.center:-1,ud.left>=0?ud.left:-1,ud.vertical>=0?ud.vertical:-1,JE,eS,KM,ho!==void 0?ho:Yt.collisionBoxArray.length,ho!==void 0?ho+1:Yt.collisionBoxArray.length,fo!==void 0?fo:Yt.collisionBoxArray.length,fo!==void 0?fo+1:Yt.collisionBoxArray.length,Ha!==void 0?Ha:Yt.collisionBoxArray.length,Ha!==void 0?Ha+1:Yt.collisionBoxArray.length,oh||Yt.collisionBoxArray.length,oh?oh+1:Yt.collisionBoxArray.length,Li,XM,ZM,HM,WM,zV,0,tS,nS,Gp)})(s,wn,lr,dn,a,d,m,Zt,s.layers[0],s.collisionBoxArray,r.index,r.sourceLayerIndex,s.index,Fe,bt,I,0,ut,$t,oe,r,v,P,B,F)};if(pt==="line")for(const dn of og(r.geometry,0,0,Dn,Dn)){const wn=Uy(dn,Ue,ot,a.vertical||_e,d,Be,ze,s.overscaling,Dn);for(const fn of wn)_e&&O1(s,_e.text,Rt,fn)||xt(dn,fn,F)}else if(pt==="line-center"){for(const dn of r.geometry)if(dn.length>1){const wn=FE(dn,ot,a.vertical||_e,d,Be,ze);wn&&xt(dn,wn,F)}}else if(r.type==="Polygon")for(const dn of Rp(r.geometry,0)){const wn=Gy(dn,16);xt(dn[0],new Jc(wn.x,wn.y,0,0,void 0),F)}else if(r.type==="LineString")for(const dn of r.geometry)xt(dn,new Jc(dn[0].x,dn[0].y,0,0,void 0),F);else if(r.type==="Point")for(const dn of r.geometry)for(const wn of dn)xt([wn],new Jc(wn.x,wn.y,0,0,void 0),F)}const ug=255,rh=ug*yl;function Bp(s,r,a,d,m,v,w,C,I,P,B,F,$,X,J,oe,_e){const Re=(function(ze,Ue,Fe,ut,ot,bt,$t,pt){const Rt=[];if(Ue.positionedLines.length===0)return Rt;const Mt=ut.layout.get("text-rotate").evaluate(bt,{})*Math.PI/180,Nt=(function(fn){const lr=fn[0],Yt=fn[1],Vn=lr*Yt;return Vn>0?[lr,-Yt]:Vn<0?[-lr,Yt]:lr===0?[Yt,lr]:[Yt,-lr]})(Fe);let Zt=Math.abs(Ue.top-Ue.bottom);for(const fn of Ue.positionedLines)Zt-=fn.lineOffset;const xt=Ue.positionedLines.length,dn=Zt/xt;let wn=Ue.top-Fe[1];for(let fn=0;fn<xt;++fn){const lr=Ue.positionedLines[fn];wn=UE(Ue,dn,wn,fn);for(const Yt of lr.positionedGlyphs){if(!Yt.rect)continue;const Vn=Yt.rect||{};let cr=g0+1,Wr=!0,ur=1,Gn=0;if(Yt.imageName){const zi=$t[Yt.imageName];if(!zi)continue;if(zi.sdf){Rn("SDF images are not supported in formatted text and will be ignored.");continue}Wr=!1,ur=zi.pixelRatio,cr=ma/ur}const ji=(ot||pt)&&Yt.vertical,dr=Yt.metrics.advance*Yt.scale/2,fr=Yt.metrics,Ai=Yt.rect;if(Ai===null)continue;pt&&Ue.verticalizable&&(Gn=Yt.imageName?dr-Yt.metrics.width*Yt.scale/2:0);const Li=ot?[Yt.x+dr,Yt.y]:[0,0];let Oi=[0,0],Ii=[0,0],ls=!1;ot||(ji?(Ii=[Yt.x+dr+Nt[0],Yt.y+Nt[1]-Gn],ls=!0):Oi=[Yt.x+dr+Fe[0],Yt.y+Fe[1]-Gn]);const ps=Ai.w*Yt.scale/(ur*(Yt.localGlyph?Bl:1)),Cs=Ai.h*Yt.scale/(ur*(Yt.localGlyph?Bl:1));let Ri,zs,As,us;if(ji){const zi=Yt.y-wn,Ga=new se(-dr,dr-zi),Rs=-Math.PI/2,Bo=new se(...Ii);Ri=new se(-dr+Oi[0],Oi[1]),Ri._rotateAround(Rs,Ga)._add(Bo),Ri.x+=-zi+dr,Ri.y-=(fr.left-cr)*Yt.scale;const ho=Yt.imageName?fr.advance*Yt.scale:Zs*Yt.scale,Ha=String.fromCharCode(Yt.glyph);zE(Ha)?Ri.x+=(1-cr)*Yt.scale:v1(Ha)?Ri.x+=ho-fr.height*Yt.scale+(-cr-1)*Yt.scale:Ri.x+=Yt.imageName||fr.width+2*cr===Ai.w&&fr.height+2*cr===Ai.h?(ho-Cs)/2:(ho-(fr.height+2*cr)*Yt.scale)/2,zs=new se(Ri.x,Ri.y-ps),As=new se(Ri.x+Cs,Ri.y),us=new se(Ri.x+Cs,Ri.y-ps)}else{const zi=(fr.left-cr)*Yt.scale-dr+Oi[0],Ga=(-fr.top-cr)*Yt.scale+Oi[1],Rs=zi+ps,Bo=Ga+Cs;Ri=new se(zi,Ga),zs=new se(Rs,Ga),As=new se(zi,Bo),us=new se(Rs,Bo)}if(Mt){let zi;zi=ot?new se(0,0):ls?new se(Nt[0],Nt[1]):new se(Fe[0],Fe[1]),Ri._rotateAround(Mt,zi),zs._rotateAround(Mt,zi),As._rotateAround(Mt,zi),us._rotateAround(Mt,zi)}const Jr=new se(0,0),Is=new se(0,0);Rt.push({tl:Ri,tr:zs,bl:As,br:us,tex:Vn,writingMode:Ue.writingMode,glyphOffset:Li,sectionIndex:Yt.sectionIndex,isSDF:Wr,pixelOffsetTL:Jr,pixelOffsetBR:Is,minFontScaleX:0,minFontScaleY:0})}}return Rt})(0,d,I,v,w,C,m,s.allowVerticalPlacement),Be=s.textSizeData;let Pe=null;Be.kind==="source"?(Pe=[yl*v.layout.get("text-size").evaluate(C,{},_e)],Pe[0]>rh&&Rn(`${s.layerIds[0]}: Value for "text-size" is >= ${ug}. Reduce your "text-size".`)):Be.kind==="composite"&&(Pe=[yl*J.compositeTextSizes[0].evaluate(C,{},_e),yl*J.compositeTextSizes[1].evaluate(C,{},_e)],(Pe[0]>rh||Pe[1]>rh)&&Rn(`${s.layerIds[0]}: Value for "text-size" is >= ${ug}. Reduce your "text-size".`)),s.addSymbols(s.text,Re,Pe,I,w,C,B,r,a,P.lineStartIndex,P.lineLength,X,oe,_e);for(const ze of F)$[ze]=s.text.placedSymbolArray.length-1;return 4*Re.length}function L1(s){for(const r in s)return s[r];return null}function hg(s,r,a,d,m,v,w,C,I,P){let B=w.top,F=w.bottom,$=w.left,X=w.right;const J=w.collisionPadding;if(J&&($-=J[0],B-=J[1],X+=J[2],F+=J[3]),I){const oe=new se($,B),_e=new se(X,B),Re=new se($,F),Be=new se(X,F),Pe=le(I);let ze=new se(0,0);P&&(ze=new se(P[0],P[1])),oe._rotateAround(Pe,ze),_e._rotateAround(Pe,ze),Re._rotateAround(Pe,ze),Be._rotateAround(Pe,ze),$=Math.min(oe.x,_e.x,Re.x,Be.x),X=Math.max(oe.x,_e.x,Re.x,Be.x),B=Math.min(oe.y,_e.y,Re.y,Be.y),F=Math.max(oe.y,_e.y,Re.y,Be.y)}return s.emplaceBack(r.x,r.y,r.z,a.x,a.y,$,B,X,F,C,d,m,v),s.length-1}function Np(s){s.collisionPadding&&(s.top-=s.collisionPadding[1],s.bottom+=s.collisionPadding[3]);const r=s.bottom-s.top;return r>0?Math.max(10,r):null}function O1(s,r,a,d){const m=s.compareText;if(r in m){const v=m[r];for(let w=v.length-1;w>=0;w--)if(d.dist(v[w])<a)return!0}else m[r]=[];return m[r].push(d),!1}function z1(s,r){const a=s.fovAboveCenter,d=s.elevation?s.elevation.getMinElevationBelowMSL()*r:0,m=(s._camera.position[2]*s.worldSize-d)/Math.cos(s._pitch),v=Math.sin(a)*m/Math.sin(Math.max(Math.PI/2-s._pitch-a,.01)),w=Math.sin(s._pitch)*v+m;return Math.min(1.01*w,m*(1/s._horizonShift))}function tu(s,r){if(!r.isReprojectedInTileSpace)return{scale:1<<s.z,x:s.x,y:s.y,x2:s.x+1,y2:s.y+1,projection:r};const a=Math.pow(2,-s.z),d=s.x*a,m=(s.x+1)*a,v=s.y*a,w=(s.y+1)*a,C=Ua(d),I=Ua(m),P=Qr(v),B=Qr(w),F=r.project(C,P),$=r.project(I,P),X=r.project(I,B),J=r.project(C,B);let oe=Math.min(F.x,$.x,X.x,J.x),_e=Math.min(F.y,$.y,X.y,J.y),Re=Math.max(F.x,$.x,X.x,J.x),Be=Math.max(F.y,$.y,X.y,J.y);const Pe=a/16;function ze(Fe,ut,ot,bt,$t,pt){const Rt=(ot+$t)/2,Mt=(bt+pt)/2,Nt=r.project(Ua(Rt),Qr(Mt)),Zt=Math.max(0,oe-Nt.x,_e-Nt.y,Nt.x-Re,Nt.y-Be);oe=Math.min(oe,Nt.x),Re=Math.max(Re,Nt.x),_e=Math.min(_e,Nt.y),Be=Math.max(Be,Nt.y),Zt>Pe&&(ze(Fe,Nt,ot,bt,Rt,Mt),ze(Nt,ut,Rt,Mt,$t,pt))}ze(F,$,d,v,m,v),ze($,X,m,v,m,w),ze(X,J,m,w,d,w),ze(J,F,d,w,d,v),oe-=Pe,_e-=Pe,Re+=Pe,Be+=Pe;const Ue=1/Math.max(Re-oe,Be-_e);return{scale:Ue,x:oe*Ue,y:_e*Ue,x2:Re*Ue,y2:Be*Ue,projection:r}}const Hy=dl(new Float32Array(16));class ih{constructor(r){this.spec=r,this.name=r.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(r,a){return{x:0,y:0,z:0}}unproject(r,a){return new Yr(0,0)}projectTilePoint(r,a,d){return{x:r,y:a,z:0}}locationPoint(r,a,d=!0){return r._coordinatePoint(r.locationCoordinate(a),d)}pixelsPerMeter(r,a){return ml(1,r)*a}pixelSpaceConversion(r,a,d){return 1}farthestPixelDistance(r){return z1(r,r.pixelsPerMeter)}pointCoordinate(r,a,d,m){const v=r.horizonLineFromTop(!1),w=new se(a,Math.max(v,d));return r.rayIntersectionCoordinate(r.pointRayIntersection(w,m))}pointCoordinate3D(r,a,d){const m=new se(a,d);if(r.elevation)return r.elevation.pointCoordinate(m);{const v=this.pointCoordinate(r,m.x,m.y,0);return[v.x,v.y,v.z]}}isPointAboveHorizon(r,a){if(r.elevation)return!this.pointCoordinate3D(r,a.x,a.y);const d=r.horizonLineFromTop();return a.y<d}createInversionMatrix(r,a){return Hy}createTileMatrix(r,a,d){let m,v,w;const C=d.canonical,I=dl(new Float64Array(16));if(this.isReprojectedInTileSpace){const P=tu(C,this);m=1,v=P.x+d.wrap*P.scale,w=P.y,Fh(I,I,[m/P.scale,m/P.scale,r.pixelsPerMeter/a])}else m=a/r.zoomScale(C.z),v=(C.x+Math.pow(2,C.z)*d.wrap)*m,w=C.y*m;return nf(I,I,[v,w,0]),Fh(I,I,[m/Dn,m/Dn,1]),I}upVector(r,a,d){return[0,0,1]}upVectorScale(r,a,d){return{metersToTile:1}}}class Vp extends ih{constructor(r){super(r),this.range=[4,7],this.center=r.center||[-96,37.5];const[a,d]=this.parallels=r.parallels||[29.5,45.5],m=Math.sin(le(a));this.n=(m+Math.sin(le(d)))/2,this.c=1+m*(2*this.n-m),this.r0=Math.sqrt(this.c)/this.n}project(r,a){const{n:d,c:m,r0:v}=this,w=le(r-this.center[0]),C=le(a),I=Math.sqrt(m-2*d*Math.sin(C))/d;return{x:I*Math.sin(w*d),y:I*Math.cos(w*d)-v,z:0}}unproject(r,a){const{n:d,c:m,r0:v}=this,w=v+a;let C=Math.atan2(r,Math.abs(w))*Math.sign(w);w*d<0&&(C-=Math.PI*Math.sign(r)*Math.sign(w));const I=le(this.center[0])*d;C=De(C,-Math.PI-I,Math.PI-I);const P=et(Ne(C/d)+this.center[0],-180,180),B=Math.asin(et((m-(r*r+w*w)*d*d)/(2*d),-1,1)),F=et(Ne(B),-Ws,Ws);return new Yr(P,F)}}const Fp=1.340264,Mf=-.081106,sd=893e-6,Up=.003796,Wy=Math.sqrt(3)/2;class Xy extends ih{project(r,a){a=a/180*Math.PI,r=r/180*Math.PI;const d=Math.asin(Wy*Math.sin(a)),m=d*d,v=m*m*m;return{x:.5*(r*Math.cos(d)/(Wy*(Fp+3*Mf*m+v*(7*sd+9*Up*m)))/Math.PI+.5),y:1-.5*(d*(Fp+Mf*m+v*(sd+Up*m))/Math.PI+1),z:0}}unproject(r,a){r=(2*r-.5)*Math.PI;let d=a=(2*(1-a)-1)*Math.PI,m=d*d,v=m*m*m;for(let B,F,$,X=0;X<12&&(F=d*(Fp+Mf*m+v*(sd+Up*m))-a,$=Fp+3*Mf*m+v*(7*sd+9*Up*m),B=F/$,d=et(d-B,-Math.PI/3,Math.PI/3),m=d*d,v=m*m*m,!(Math.abs(B)<1e-12));++X);const w=Wy*r*(Fp+3*Mf*m+v*(7*sd+9*Up*m))/Math.cos(d),C=Math.asin(Math.sin(d)/Wy),I=et(180*w/Math.PI,-180,180),P=et(180*C/Math.PI,-Ws,Ws);return new Yr(I,P)}}class c extends ih{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0}project(r,a){return{x:.5+r/360,y:.5-a/360,z:0}}unproject(r,a){const d=360*(r-.5),m=et(360*(.5-a),-Ws,Ws);return new Yr(d,m)}}const h=Math.PI/2;function y(s){return Math.tan((h+s)/2)}class T extends ih{constructor(r){super(r),this.center=r.center||[0,30];const[a,d]=this.parallels=r.parallels||[30,30];let m=le(a),v=le(d);this.southernCenter=m+v<0,this.southernCenter&&(m=-m,v=-v);const w=Math.cos(m),C=y(m);this.n=m===v?Math.sin(m):Math.log(w/Math.cos(v))/Math.log(y(v)/C),this.f=w*Math.pow(y(m),this.n)/this.n}project(r,a){a=le(a),this.southernCenter&&(a=-a),r=le(r-this.center[0]);const d=1e-6,{n:m,f:v}=this;v>0?a<-h+d&&(a=-h+d):a>h-d&&(a=h-d);const w=v/Math.pow(y(a),m);let C=w*Math.sin(m*r),I=v-w*Math.cos(m*r);return C=.5*(C/Math.PI+.5),I=.5*(I/Math.PI+.5),{x:C,y:this.southernCenter?I:1-I,z:0}}unproject(r,a){r=(2*r-.5)*Math.PI,this.southernCenter&&(a=1-a),a=(2*(1-a)-.5)*Math.PI;const{n:d,f:m}=this,v=m-a,w=Math.sign(v),C=Math.sign(d)*Math.sqrt(r*r+v*v);let I=Math.atan2(r,Math.abs(v))*w;v*d<0&&(I-=Math.PI*Math.sign(r)*w);const P=et(Ne(I/d)+this.center[0],-180,180),B=et(Ne(2*Math.atan(Math.pow(m/C,1/d))-h),-Ws,Ws);return new Yr(P,this.southernCenter?-B:B)}}class k extends ih{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(r,a){return{x:uo(r),y:ki(a),z:0}}unproject(r,a){const d=Ua(r),m=Qr(a);return new Yr(d,m)}}const z=le(Ws);class ee extends ih{project(r,a){const d=(a=le(a))*a,m=d*d;return{x:.5*((r=le(r))*(.8707-.131979*d+m*(m*(.003971*d-.001529*m)-.013791))/Math.PI+.5),y:1-.5*(a*(1.007226+d*(.015085+m*(.028874*d-.044475-.005916*m)))/Math.PI+1),z:0}}unproject(r,a){r=(2*r-.5)*Math.PI;let d=a=(2*(1-a)-1)*Math.PI,m=25,v=0,w=d*d;do{w=d*d;const P=w*w;v=(d*(1.007226+w*(.015085+P*(.028874*w-.044475-.005916*P)))-a)/(1.007226+w*(.045255+P*(.259866*w-.311325-.005916*11*P))),d=et(d-v,-z,z)}while(Math.abs(v)>1e-6&&--m>0);w=d*d;const C=et(Ne(r/(.8707+w*(w*(w*w*w*(.003971-.001529*w)-.013791)-.131979))),-180,180),I=Ne(d);return new Yr(C,I)}}const xe=le(Ws);class We extends ih{project(r,a){a=le(a),r=le(r);const d=Math.cos(a),m=2/Math.PI,v=Math.acos(d*Math.cos(r/2)),w=Math.sin(v)/v,C=.5*(r*m+2*d*Math.sin(r/2)/w)||0,I=.5*(a+Math.sin(a)/w)||0;return{x:.5*(C/Math.PI+.5),y:1-.5*(I/Math.PI+1),z:0}}unproject(r,a){let d=r=(2*r-.5)*Math.PI,m=a=(2*(1-a)-1)*Math.PI,v=25;const w=1e-6;let C=0,I=0;do{const P=Math.cos(m),B=Math.sin(m),F=2*B*P,$=B*B,X=P*P,J=Math.cos(d/2),oe=Math.sin(d/2),_e=2*J*oe,Re=oe*oe,Be=1-X*J*J,Pe=Be?1/Be:0,ze=Be?Math.acos(P*J)*Math.sqrt(1/Be):0,Ue=.5*(2*ze*P*oe+2*d/Math.PI)-r,Fe=.5*(ze*B+m)-a,ut=.5*Pe*(X*Re+ze*P*J*$)+1/Math.PI,ot=Pe*(_e*F/4-ze*B*oe),bt=.125*Pe*(F*oe-ze*B*X*_e),$t=.5*Pe*($*J+ze*Re*P)+.5,pt=ot*bt-$t*ut;C=(Fe*ot-Ue*$t)/pt,I=(Ue*bt-Fe*ut)/pt,d=et(d-C,-Math.PI,Math.PI),m=et(m-I,-xe,xe)}while((Math.abs(C)>w||Math.abs(I)>w)&&--v>0);return new Yr(Ne(d),Ne(m))}}class mt extends ih{constructor(r){super(r),this.center=r.center||[0,0],this.parallels=r.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(le(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(r,a){const{scale:d,cosPhi:m}=this;return{x:le(r)*m*d+.5,y:-Math.sin(le(a))/m*d+.5,z:0}}unproject(r,a){const{scale:d,cosPhi:m}=this,v=-(a-.5)/d,w=et(Ne((r-.5)/d)/m,-180,180),C=Math.asin(et(v*m,-1,1)),I=et(Ne(C),-Ws,Ws);return new Yr(w,I)}}class Pt extends k{constructor(r){super(r),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(r,a,d){const m=Pi(r,a,d);return as(m,m,bp(co(d))),{x:m[0],y:m[1],z:m[2]}}locationPoint(r,a){const d=Gc(a.lat,a.lng),m=Po([],d),v=r.elevation?r.elevation.getAtPointOrZero(r.locationCoordinate(a),r._centerAltitude):r._centerAltitude;gp(d,d,m,ml(1,0)*Dn*v);const w=dl(new Float64Array(16));return Vh(w,r.pixelMatrix,r.globeMatrix),as(d,d,w),new se(d[0],d[1])}pixelsPerMeter(r,a){return ml(1,0)*a}pixelSpaceConversion(r,a,d){const m=ml(1,r)*a,v=nr(ml(1,45)*a,m,d);return this.pixelsPerMeter(r,a)/v}createTileMatrix(r,a,d){const m=af(co(d.canonical));return Vh(new Float64Array(16),r.globeMatrix,m)}createInversionMatrix(r,a){const{center:d}=r,m=bp(co(a));return hy(m,m,le(d.lng)),uy(m,m,le(d.lat)),Fh(m,m,[r._pixelsPerMercatorPixel,r._pixelsPerMercatorPixel,1]),Float32Array.from(m)}pointCoordinate(r,a,d,m){return Lv(r,a,d,!0)||new Di(0,0)}pointCoordinate3D(r,a,d){const m=this.pointCoordinate(r,a,d,0);return[m.x,m.y,m.z]}isPointAboveHorizon(r,a){return!Lv(r,a.x,a.y,!1)}farthestPixelDistance(r){const a=(function(m,v){const w=m.cameraToCenterDistance,C=m._centerAltitude*v,I=m._camera,P=m._camera.forward(),B=fl([],fa([],P,-w),[0,0,C]),F=m.worldSize/(2*Math.PI),$=[0,0,-F],X=m.width/m.height,J=Math.tan(m.fovAboveCenter),oe=fa([],I.up(),J),_e=fa([],I.right(),J*X),Re=Po([],fl([],fl([],P,oe),_e)),Be=[];let Pe;if(new my(B,Re).closestPointOnSphere($,F,Be)){const ze=fl([],Be,$),Ue=Ll([],ze,B);Pe=Math.cos(m.fovAboveCenter)*pp(Ue)}else{const ze=Ll([],B,$),Ue=Ll([],$,B);Po(Ue,Ue);const Fe=pp(ze)-F;Pe=Math.sqrt(Fe*(Fe+2*F));const ut=Math.acos(Pe/(F+Fe))-Math.acos(oo(P,Ue));Pe*=Math.cos(ut)}return 1.01*Pe})(r,this.pixelsPerMeter(r.center.lat,r.worldSize)),d=lf(r.zoom);if(d>0){const m=z1(r,ml(1,r.center.lat)*r.worldSize),v=r.worldSize/(2*Math.PI),w=Math.max(r.width,r.height)/r.worldSize*Math.PI;return nr(a,m+v*(1-Math.cos(w)),Math.pow(d,10))}return a}upVector(r,a,d){return Pi(a,d,r,1)}upVectorScale(r){return{metersToTile:vp(xy(co(r)))}}}function Ft(s){const r=s.parallels,a=!!r&&Math.abs(r[0]+r[1])<.01;switch(s.name){case"mercator":return new k(s);case"equirectangular":return new c(s);case"naturalEarth":return new ee(s);case"equalEarth":return new Xy(s);case"winkelTripel":return new We(s);case"albers":return a?new mt(s):new Vp(s);case"lambertConformalConic":return a?new mt(s):new T(s);case"globe":return new Pt(s)}throw new Error(`Invalid projection name: ${s.name}`)}const gt=Ly.types,Tt=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Mn(s,r,a,d,m,v,w,C,I,P,B,F,$){const X=C?Math.min(rh,Math.round(C[0])):0,J=C?Math.min(rh,Math.round(C[1])):0;s.emplaceBack(r,a,Math.round(32*d),Math.round(32*m),v,w,(X<<1)+(I?1:0),J,16*P,16*B,256*F,256*$)}function Yn(s,r,a,d,m,v,w){s.emplaceBack(r,a,d,m,v,w)}function wi(s,r,a,d,m){s.emplaceBack(r,a,d,m),s.emplaceBack(r,a,d,m),s.emplaceBack(r,a,d,m),s.emplaceBack(r,a,d,m)}function it(s){for(const r of s.sections)if(Bm(r.text))return!0;return!1}class Ke{constructor(r){this.layoutVertexArray=new Ct,this.indexArray=new Tn,this.programConfigurations=r,this.segments=new os,this.dynamicLayoutVertexArray=new Ot,this.opacityVertexArray=new Sn,this.placedSymbolArray=new ss,this.globeExtVertexArray=new It}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(r,a,d,m){this.isEmpty()||(d&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,p1.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,Ui.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,Tt,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,m1.members,!0)),this.opacityVertexBuffer.itemSize=1),(d||m)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}gn(Ke,"SymbolBuffers");class ft{constructor(r,a,d){this.layoutVertexArray=new r,this.layoutAttributes=a,this.indexArray=new d,this.segments=new os,this.collisionVertexArray=new Fn,this.collisionVertexArrayExt=new ar}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,a0.members,!0),this.collisionVertexBufferExt=r.createVertexBuffer(this.collisionVertexArrayExt,Oo.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}gn(ft,"CollisionBuffers");class kt{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((w=>w.id)),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=dl([]),this.placementViewportMatrix=dl([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=eg(this.zoom,a["text-size"]),this.iconSizeData=eg(this.zoom,a["icon-size"]);const d=this.layers[0].layout,m=d.get("symbol-sort-key"),v=d.get("symbol-z-order");this.canOverlap=d.get("text-allow-overlap")||d.get("icon-allow-overlap")||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&m.constantOr(1)!==void 0,this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=d.get("text-writing-mode").map((w=>_l[w])),this.stateDependentLayerIds=this.layers.filter((w=>w.isStateDependent())).map((w=>w.id)),this.sourceID=r.sourceID,this.projection=r.projection}createArrays(){this.text=new Ke(new qc(this.layers,this.zoom,(r=>/^text/.test(r)))),this.icon=new Ke(new qc(this.layers,this.zoom,(r=>/^icon/.test(r)))),this.glyphOffsetArray=new Ei,this.lineVertexArray=new Ji,this.symbolInstances=new vi}calculateGlyphDependencies(r,a,d,m,v){for(let w=0;w<r.length;w++)if(a[r.charCodeAt(w)]=!0,m&&v){const C=bf[r.charAt(w)];C&&(a[C.charCodeAt(0)]=!0)}}populate(r,a,d,m){const v=this.layers[0],w=v.layout,C=this.projection.name==="globe",I=w.get("text-font"),P=w.get("text-field"),B=w.get("icon-image"),F=(P.value.kind!=="constant"||P.value.value instanceof Yi&&!P.value.value.isEmpty()||P.value.value.toString().length>0)&&(I.value.kind!=="constant"||I.value.value.length>0),$=B.value.kind!=="constant"||!!B.value.value||Object.keys(B.parameters).length>0,X=w.get("symbol-sort-key");if(this.features=[],!F&&!$)return;const J=a.iconDependencies,oe=a.glyphDependencies,_e=a.availableImages,Re=new V(this.zoom);for(const{feature:Be,id:Pe,index:ze,sourceLayerIndex:Ue}of r){const Fe=v._featureFilter.needGeometry,ut=ko(Be,Fe);if(!v._featureFilter.filter(Re,ut,d))continue;if(Fe||(ut.geometry=_s(Be,d,m)),C&&Be.type!==1&&d.z<=5){const pt=ut.geometry,Rt=.98078528056,Mt=(Nt,Zt)=>oo(Pi(Nt.x,Nt.y,d,1),Pi(Zt.x,Zt.y,d,1))<Rt;for(let Nt=0;Nt<pt.length;Nt++)pt[Nt]=$b(pt[Nt],Mt)}let ot,bt;if(F){const pt=v.getValueAndResolveTokens("text-field",ut,d,_e),Rt=Yi.factory(pt);it(Rt)&&(this.hasRTLText=!0),(!this.hasRTLText||A()==="unavailable"||this.hasRTLText&&L.isParsed())&&(ot=l0(Rt,v,ut))}if($){const pt=v.getValueAndResolveTokens("icon-image",ut,d,_e);bt=pt instanceof rs?pt:rs.fromString(pt)}if(!ot&&!bt)continue;const $t=this.sortFeaturesByKey?X.evaluate(ut,{},d):void 0;if(this.features.push({id:Pe,text:ot,icon:bt,index:ze,sourceLayerIndex:Ue,geometry:ut.geometry,properties:Be.properties,type:gt[Be.type],sortKey:$t}),bt&&(J[bt.name]=!0),ot){const pt=I.evaluate(ut,{},d).join(","),Rt=w.get("text-rotation-alignment")==="map"&&w.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(_l.vertical)>=0;for(const Mt of ot.sections)if(Mt.image)J[Mt.image.name]=!0;else{const Nt=Om(ot.toString()),Zt=Mt.fontStack||pt,xt=oe[Zt]=oe[Zt]||{};this.calculateGlyphDependencies(Mt.text,xt,Rt,this.allowVerticalPlacement,Nt)}}}w.get("symbol-placement")==="line"&&(this.features=(function(Be){const Pe={},ze={},Ue=[];let Fe=0;function ut(pt){Ue.push(Be[pt]),Fe++}function ot(pt,Rt,Mt){const Nt=ze[pt];return delete ze[pt],ze[Rt]=Nt,Ue[Nt].geometry[0].pop(),Ue[Nt].geometry[0]=Ue[Nt].geometry[0].concat(Mt[0]),Nt}function bt(pt,Rt,Mt){const Nt=Pe[Rt];return delete Pe[Rt],Pe[pt]=Nt,Ue[Nt].geometry[0].shift(),Ue[Nt].geometry[0]=Mt[0].concat(Ue[Nt].geometry[0]),Nt}function $t(pt,Rt,Mt){const Nt=Mt?Rt[0][Rt[0].length-1]:Rt[0][0];return`${pt}:${Nt.x}:${Nt.y}`}for(let pt=0;pt<Be.length;pt++){const Rt=Be[pt],Mt=Rt.geometry,Nt=Rt.text?Rt.text.toString():null;if(!Nt){ut(pt);continue}const Zt=$t(Nt,Mt),xt=$t(Nt,Mt,!0);if(Zt in ze&&xt in Pe&&ze[Zt]!==Pe[xt]){const dn=bt(Zt,xt,Mt),wn=ot(Zt,xt,Ue[dn].geometry);delete Pe[Zt],delete ze[xt],ze[$t(Nt,Ue[wn].geometry,!0)]=wn,Ue[dn].geometry=null}else Zt in ze?ot(Zt,xt,Mt):xt in Pe?bt(Zt,xt,Mt):(ut(pt),Pe[Zt]=Fe-1,ze[xt]=Fe-1)}return Ue.filter((pt=>pt.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((Be,Pe)=>Be.sortKey-Pe.sortKey))}update(r,a,d,m){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,a,this.layers,d,m),this.icon.programConfigurations.updatePaintArrays(r,a,this.layers,d,m))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Ft(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,a){const d=this.lineVertexArray.length;if(r.segment!==void 0)for(const{x:m,y:v}of a)this.lineVertexArray.emplaceBack(m,v);return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(r,a,d,m,v,w,C,I,P,B,F,$,X,J){const oe=r.indexArray,_e=r.layoutVertexArray,Re=r.globeExtVertexArray,Be=r.segments.prepareSegment(4*a.length,_e,oe,this.canOverlap?w.sortKey:void 0),Pe=this.glyphOffsetArray.length,ze=Be.vertexLength,Ue=this.allowVerticalPlacement&&C===_l.vertical?Math.PI/2:0,Fe=w.text&&w.text.sections;for(let ot=0;ot<a.length;ot++){const{tl:bt,tr:$t,bl:pt,br:Rt,tex:Mt,pixelOffsetTL:Nt,pixelOffsetBR:Zt,minFontScaleX:xt,minFontScaleY:dn,glyphOffset:wn,isSDF:fn,sectionIndex:lr}=a[ot],Yt=Be.vertexLength,Vn=wn[1];if(Mn(_e,P.x,P.y,bt.x,Vn+bt.y,Mt.x,Mt.y,d,fn,Nt.x,Nt.y,xt,dn),Mn(_e,P.x,P.y,$t.x,Vn+$t.y,Mt.x+Mt.w,Mt.y,d,fn,Zt.x,Nt.y,xt,dn),Mn(_e,P.x,P.y,pt.x,Vn+pt.y,Mt.x,Mt.y+Mt.h,d,fn,Nt.x,Zt.y,xt,dn),Mn(_e,P.x,P.y,Rt.x,Vn+Rt.y,Mt.x+Mt.w,Mt.y+Mt.h,d,fn,Zt.x,Zt.y,xt,dn),I){const{x:cr,y:Wr,z:ur}=I.anchor,[Gn,ji,dr]=I.up;Yn(Re,cr,Wr,ur,Gn,ji,dr),Yn(Re,cr,Wr,ur,Gn,ji,dr),Yn(Re,cr,Wr,ur,Gn,ji,dr),Yn(Re,cr,Wr,ur,Gn,ji,dr),wi(r.dynamicLayoutVertexArray,cr,Wr,ur,Ue)}else wi(r.dynamicLayoutVertexArray,P.x,P.y,P.z,Ue);oe.emplaceBack(Yt,Yt+1,Yt+2),oe.emplaceBack(Yt+1,Yt+2,Yt+3),Be.vertexLength+=4,Be.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(wn[0]),ot!==a.length-1&&lr===a[ot+1].sectionIndex||r.programConfigurations.populatePaintArrays(_e.length,w,w.index,{},X,J,Fe&&Fe[lr])}const ut=I?I.anchor:P;r.placedSymbolArray.emplaceBack(ut.x,ut.y,ut.z,P.x,P.y,Pe,this.glyphOffsetArray.length-Pe,ze,B,F,P.segment,d?d[0]:0,d?d[1]:0,m[0],m[1],C,0,!1,0,$,0)}_commitLayoutVertex(r,a,d,m,v,w,C){r.emplaceBack(a,d,m,v,w,Math.round(C.x),Math.round(C.y))}_addCollisionDebugVertices(r,a,d,m,v,w,C){const I=d.segments.prepareSegment(4,d.layoutVertexArray,d.indexArray),P=I.vertexLength,B=C.tileAnchorX,F=C.tileAnchorY;for(let X=0;X<4;X++)d.collisionVertexArray.emplaceBack(0,0,0,0);d.collisionVertexArrayExt.emplaceBack(a,-r.padding,-r.padding),d.collisionVertexArrayExt.emplaceBack(a,r.padding,-r.padding),d.collisionVertexArrayExt.emplaceBack(a,r.padding,r.padding),d.collisionVertexArrayExt.emplaceBack(a,-r.padding,r.padding),this._commitLayoutVertex(d.layoutVertexArray,m,v,w,B,F,new se(r.x1,r.y1)),this._commitLayoutVertex(d.layoutVertexArray,m,v,w,B,F,new se(r.x2,r.y1)),this._commitLayoutVertex(d.layoutVertexArray,m,v,w,B,F,new se(r.x2,r.y2)),this._commitLayoutVertex(d.layoutVertexArray,m,v,w,B,F,new se(r.x1,r.y2)),I.vertexLength+=4;const $=d.indexArray;$.emplaceBack(P,P+1),$.emplaceBack(P+1,P+2),$.emplaceBack(P+2,P+3),$.emplaceBack(P+3,P),I.primitiveLength+=4}_addTextDebugCollisionBoxes(r,a,d,m,v,w){for(let C=m;C<v;C++){const I=d.get(C),P=this.getSymbolInstanceTextSize(r,w,a,C);this._addCollisionDebugVertices(I,P,this.textCollisionBox,I.projectedAnchorX,I.projectedAnchorY,I.projectedAnchorZ,w)}}_addIconDebugCollisionBoxes(r,a,d,m,v,w){for(let C=m;C<v;C++){const I=d.get(C),P=this.getSymbolInstanceIconSize(r,a,w.placedIconSymbolIndex);this._addCollisionDebugVertices(I,P,this.iconCollisionBox,I.projectedAnchorX,I.projectedAnchorY,I.projectedAnchorZ,w)}}generateCollisionDebugBuffers(r,a){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ft(Bt,g1.members,kr),this.iconCollisionBox=new ft(Bt,g1.members,kr);const d=xf(this.iconSizeData,r),m=xf(this.textSizeData,r);for(let v=0;v<this.symbolInstances.length;v++){const w=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(m,r,a,w.textBoxStartIndex,w.textBoxEndIndex,w),this._addTextDebugCollisionBoxes(m,r,a,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._addIconDebugCollisionBoxes(d,r,a,w.iconBoxStartIndex,w.iconBoxEndIndex,w),this._addIconDebugCollisionBoxes(d,r,a,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w)}}getSymbolInstanceTextSize(r,a,d,m){const v=this.text.placedSymbolArray.get(a.rightJustifiedTextSymbolIndex>=0?a.rightJustifiedTextSymbolIndex:a.centerJustifiedTextSymbolIndex>=0?a.centerJustifiedTextSymbolIndex:a.leftJustifiedTextSymbolIndex>=0?a.leftJustifiedTextSymbolIndex:a.verticalPlacedTextSymbolIndex>=0?a.verticalPlacedTextSymbolIndex:m),w=vf(this.textSizeData,r,v)/Zs;return this.tilePixelRatio*w}getSymbolInstanceIconSize(r,a,d){const m=this.icon.placedSymbolArray.get(d),v=vf(this.iconSizeData,r,m);return this.tilePixelRatio*v}_commitDebugCollisionVertexUpdate(r,a,d){r.emplaceBack(a,-d,-d),r.emplaceBack(a,d,-d),r.emplaceBack(a,d,d),r.emplaceBack(a,-d,d)}_updateTextDebugCollisionBoxes(r,a,d,m,v,w){for(let C=m;C<v;C++){const I=d.get(C),P=this.getSymbolInstanceTextSize(r,w,a,C);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,P,I.padding)}}_updateIconDebugCollisionBoxes(r,a,d,m,v,w){for(let C=m;C<v;C++){const I=d.get(C),P=this.getSymbolInstanceIconSize(r,a,w);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,P,I.padding)}}updateCollisionDebugBuffers(r,a){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const d=xf(this.iconSizeData,r),m=xf(this.textSizeData,r);for(let v=0;v<this.symbolInstances.length;v++){const w=this.symbolInstances.get(v);this._updateTextDebugCollisionBoxes(m,r,a,w.textBoxStartIndex,w.textBoxEndIndex,w),this._updateTextDebugCollisionBoxes(m,r,a,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._updateIconDebugCollisionBoxes(d,r,a,w.iconBoxStartIndex,w.iconBoxEndIndex,w.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(d,r,a,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(r,a,d,m,v,w,C,I,P){const B={};if(a<d){const{x1:F,y1:$,x2:X,y2:J,padding:oe,projectedAnchorX:_e,projectedAnchorY:Re,projectedAnchorZ:Be,tileAnchorX:Pe,tileAnchorY:ze,featureIndex:Ue}=r.get(a);B.textBox={x1:F,y1:$,x2:X,y2:J,padding:oe,projectedAnchorX:_e,projectedAnchorY:Re,projectedAnchorZ:Be,tileAnchorX:Pe,tileAnchorY:ze},B.textFeatureIndex=Ue}if(m<v){const{x1:F,y1:$,x2:X,y2:J,padding:oe,projectedAnchorX:_e,projectedAnchorY:Re,projectedAnchorZ:Be,tileAnchorX:Pe,tileAnchorY:ze,featureIndex:Ue}=r.get(m);B.verticalTextBox={x1:F,y1:$,x2:X,y2:J,padding:oe,projectedAnchorX:_e,projectedAnchorY:Re,projectedAnchorZ:Be,tileAnchorX:Pe,tileAnchorY:ze},B.verticalTextFeatureIndex=Ue}if(w<C){const{x1:F,y1:$,x2:X,y2:J,padding:oe,projectedAnchorX:_e,projectedAnchorY:Re,projectedAnchorZ:Be,tileAnchorX:Pe,tileAnchorY:ze,featureIndex:Ue}=r.get(w);B.iconBox={x1:F,y1:$,x2:X,y2:J,padding:oe,projectedAnchorX:_e,projectedAnchorY:Re,projectedAnchorZ:Be,tileAnchorX:Pe,tileAnchorY:ze},B.iconFeatureIndex=Ue}if(I<P){const{x1:F,y1:$,x2:X,y2:J,padding:oe,projectedAnchorX:_e,projectedAnchorY:Re,projectedAnchorZ:Be,tileAnchorX:Pe,tileAnchorY:ze,featureIndex:Ue}=r.get(I);B.verticalIconBox={x1:F,y1:$,x2:X,y2:J,padding:oe,projectedAnchorX:_e,projectedAnchorY:Re,projectedAnchorZ:Be,tileAnchorX:Pe,tileAnchorY:ze},B.verticalIconFeatureIndex=Ue}return B}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const d=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,a){const d=r.placedSymbolArray.get(a),m=d.vertexStartIndex+4*d.numGlyphs;for(let v=d.vertexStartIndex;v<m;v+=4)r.indexArray.emplaceBack(v,v+1,v+2),r.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(r),d=Math.cos(r),m=[],v=[],w=[];for(let C=0;C<this.symbolInstances.length;++C){w.push(C);const I=this.symbolInstances.get(C);m.push(0|Math.round(a*I.tileAnchorX+d*I.tileAnchorY)),v.push(I.featureIndex)}return w.sort(((C,I)=>m[C]-m[I]||v[I]-v[C])),w}addToSortKeyRanges(r,a){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===a?d.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const d=this.symbolInstances.get(a);this.featureSortOrder.push(d.featureIndex);const{rightJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:v,leftJustifiedTextSymbolIndex:w,verticalPlacedTextSymbolIndex:C,placedIconSymbolIndex:I,verticalPlacedIconSymbolIndex:P}=d;m>=0&&this.addIndicesForPlacedSymbol(this.text,m),v>=0&&v!==m&&this.addIndicesForPlacedSymbol(this.text,v),w>=0&&w!==v&&w!==m&&this.addIndicesForPlacedSymbol(this.text,w),C>=0&&this.addIndicesForPlacedSymbol(this.text,C),I>=0&&this.addIndicesForPlacedSymbol(this.icon,I),P>=0&&this.addIndicesForPlacedSymbol(this.icon,P)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}gn(kt,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),kt.MAX_GLYPHS=65535,kt.addDynamicAttributes=wi;const Zn=new Le({"symbol-placement":new ne(vt.layout_symbol["symbol-placement"]),"symbol-spacing":new ne(vt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ne(vt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new be(vt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ne(vt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ne(vt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ne(vt.layout_symbol["icon-ignore-placement"]),"icon-optional":new ne(vt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ne(vt.layout_symbol["icon-rotation-alignment"]),"icon-size":new be(vt.layout_symbol["icon-size"]),"icon-text-fit":new ne(vt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ne(vt.layout_symbol["icon-text-fit-padding"]),"icon-image":new be(vt.layout_symbol["icon-image"]),"icon-rotate":new be(vt.layout_symbol["icon-rotate"]),"icon-padding":new ne(vt.layout_symbol["icon-padding"]),"icon-keep-upright":new ne(vt.layout_symbol["icon-keep-upright"]),"icon-offset":new be(vt.layout_symbol["icon-offset"]),"icon-anchor":new be(vt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ne(vt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ne(vt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ne(vt.layout_symbol["text-rotation-alignment"]),"text-field":new be(vt.layout_symbol["text-field"]),"text-font":new be(vt.layout_symbol["text-font"]),"text-size":new be(vt.layout_symbol["text-size"]),"text-max-width":new be(vt.layout_symbol["text-max-width"]),"text-line-height":new be(vt.layout_symbol["text-line-height"]),"text-letter-spacing":new be(vt.layout_symbol["text-letter-spacing"]),"text-justify":new be(vt.layout_symbol["text-justify"]),"text-radial-offset":new be(vt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ne(vt.layout_symbol["text-variable-anchor"]),"text-anchor":new be(vt.layout_symbol["text-anchor"]),"text-max-angle":new ne(vt.layout_symbol["text-max-angle"]),"text-writing-mode":new ne(vt.layout_symbol["text-writing-mode"]),"text-rotate":new be(vt.layout_symbol["text-rotate"]),"text-padding":new ne(vt.layout_symbol["text-padding"]),"text-keep-upright":new ne(vt.layout_symbol["text-keep-upright"]),"text-transform":new be(vt.layout_symbol["text-transform"]),"text-offset":new be(vt.layout_symbol["text-offset"]),"text-allow-overlap":new ne(vt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ne(vt.layout_symbol["text-ignore-placement"]),"text-optional":new ne(vt.layout_symbol["text-optional"])});var ii={paint:new Le({"icon-opacity":new be(vt.paint_symbol["icon-opacity"]),"icon-color":new be(vt.paint_symbol["icon-color"]),"icon-halo-color":new be(vt.paint_symbol["icon-halo-color"]),"icon-halo-width":new be(vt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new be(vt.paint_symbol["icon-halo-blur"]),"icon-translate":new ne(vt.paint_symbol["icon-translate"]),"icon-translate-anchor":new ne(vt.paint_symbol["icon-translate-anchor"]),"text-opacity":new be(vt.paint_symbol["text-opacity"]),"text-color":new be(vt.paint_symbol["text-color"],{runtimeType:Ds,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new be(vt.paint_symbol["text-halo-color"]),"text-halo-width":new be(vt.paint_symbol["text-halo-width"]),"text-halo-blur":new be(vt.paint_symbol["text-halo-blur"]),"text-translate":new ne(vt.paint_symbol["text-translate"]),"text-translate-anchor":new ne(vt.paint_symbol["text-translate-anchor"])}),layout:Zn};class jn{constructor(r){this.type=r.property.overrides?r.property.overrides.runtimeType:Sa,this.defaultValue=r}evaluate(r){if(r.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(r.formattedSection))return a.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}gn(jn,"FormatSectionOverride",{omit:["defaultValue"]});class xr extends Dl{constructor(r){super(r,ii)}recalculate(r,a){super.recalculate(r,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const d=this.layout.get("text-writing-mode");if(d){const m=[];for(const v of d)m.indexOf(v)<0&&m.push(v);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(r,a,d,m){const v=this.layout.get(r).evaluate(a,{},d,m),w=this._unevaluatedLayout._values[r];return w.isDataDriven()||Ou(w.value)||!v?v:(function(C,I){return I.replace(/{([^{}]+)}/g,((P,B)=>B in C?String(C[B]):""))})(a.properties,v)}createBucket(r){return new kt(r)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const r of ii.paint.overridableProperties){if(!xr.hasPaintOverride(this.layout,r))continue;const a=this.paint.get(r),d=new jn(a),m=new La(d,a.property.specification);let v=null;v=a.value.kind==="constant"||a.value.kind==="source"?new nc("source",m):new zu("composite",m,a.value.zoomStops,a.value._interpolationType),this.paint._values[r]=new Ee(a.property,v,a.parameters)}}_handleOverridablePaintPropertyUpdate(r,a,d){return!(!this.layout||a.isDataDriven()||d.isDataDriven())&&xr.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,a){const d=r.get("text-field"),m=ii.paint.properties[a];let v=!1;const w=C=>{for(const I of C)if(m.overrides&&m.overrides.hasOverride(I))return void(v=!0)};if(d.value.kind==="constant"&&d.value.value instanceof Yi)w(d.value.value.sections);else if(d.value.kind==="source"){const C=P=>{v||(P instanceof nl&&ri(P.value)===Ac?w(P.value.sections):P instanceof to?w(P.sections):P.eachChild(C))},I=d.value;I._styleExpression&&C(I._styleExpression.expression)}return v}getProgramConfiguration(r){return new Gu(this,r)}}var Hr={paint:new Le({"background-color":new ne(vt.paint_background["background-color"]),"background-pattern":new ne(vt.paint_background["background-pattern"]),"background-opacity":new ne(vt.paint_background["background-opacity"])})},di={paint:new Le({"raster-opacity":new ne(vt.paint_raster["raster-opacity"]),"raster-hue-rotate":new ne(vt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ne(vt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ne(vt.paint_raster["raster-brightness-max"]),"raster-saturation":new ne(vt.paint_raster["raster-saturation"]),"raster-contrast":new ne(vt.paint_raster["raster-contrast"]),"raster-resampling":new ne(vt.paint_raster["raster-resampling"]),"raster-fade-duration":new ne(vt.paint_raster["raster-fade-duration"])})};class od extends Dl{constructor(r){super(r,{}),this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)}onRemove(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)}}var jE={paint:new Le({"sky-type":new ne(vt.paint_sky["sky-type"]),"sky-atmosphere-sun":new ne(vt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ne(vt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ne(vt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ne(vt.paint_sky["sky-gradient-radius"]),"sky-gradient":new ke(vt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ne(vt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ne(vt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ne(vt.paint_sky["sky-opacity"])})};function $E(s,r,a){const d=[0,0,1],m=ao([]);return Rv(m,m,a?-le(s)+Math.PI:le(s)),Iv(m,m,-le(r)),Sv(d,d,m),Po(d,d)}const CV={circle:class extends Dl{constructor(s){super(s,PE)}createBucket(s){return new Cy(s)}queryRadius(s){const r=s;return ff("circle-radius",this,r)+ff("circle-stroke-width",this,r)+$h(this.paint.get("circle-translate"))}queryIntersectsFeature(s,r,a,d,m,v,w,C){const I=Wm(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,s.pixelToTileUnitsFactor),P=this.paint.get("circle-radius").evaluate(r,a)+this.paint.get("circle-stroke-width").evaluate(r,a);return Wb(s,d,v,w,C,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",I,P)}getProgramIds(){return["circle"]}getProgramConfiguration(s){return new Gu(this,s)}},heatmap:class extends Dl{createBucket(s){return new Si(s)}constructor(s){super(s,xs),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Kc({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(s){return ff("heatmap-radius",this,s)}queryIntersectsFeature(s,r,a,d,m,v,w,C){const I=this.paint.get("heatmap-radius").evaluate(r,a);return Wb(s,d,v,w,C,!0,!0,new se(0,0),I)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(s){return new Gu(this,s)}},hillshade:class extends Dl{constructor(s){super(s,pf)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Dl{constructor(s){super(s,e1)}getProgramIds(){const s=this.paint.get("fill-pattern"),r=s&&s.constantOr(1),a=[r?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&a.push(r&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),a}getProgramConfiguration(s){return new Gu(this,s)}recalculate(s,r){super.recalculate(s,r);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new My(s)}queryRadius(){return $h(this.paint.get("fill-translate"))}queryIntersectsFeature(s,r,a,d,m,v){return!s.queryGeometry.isAboveHorizon&&Zc(Uv(s.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,s.pixelToTileUnitsFactor),d)}isTileClipped(){return!0}},"fill-extrusion":class extends Dl{constructor(s){super(s,c1)}createBucket(s){return new qa(s)}queryRadius(){return $h(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(s){return new Gu(this,s)}queryIntersectsFeature(s,r,a,d,m,v,w,C,I){const P=Wm(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,s.pixelToTileUnitsFactor),B=this.paint.get("fill-extrusion-height").evaluate(r,a),F=this.paint.get("fill-extrusion-base").evaluate(r,a),$=[0,0],X=C&&v.elevation,J=v.elevation?v.elevation.exaggeration():1,oe=s.tile.getBucket(this);if(X&&oe instanceof qa){const ze=oe.centroidVertexArray,Ue=I+1;Ue<ze.length&&($[0]=ze.geta_centroid_pos0(Ue),$[1]=ze.geta_centroid_pos1(Ue))}if($[0]===0&&$[1]===1)return!1;v.projection.name==="globe"&&(d=Oy([d],[new se(0,0),new se(Dn,Dn)],s.tileID.canonical).map((ze=>ze.polygon)).flat());const _e=X?C:null,[Re,Be]=(function(ze,Ue,Fe,ut,ot,bt,$t,pt,Rt,Mt,Nt){return ze.projection.name==="globe"?(function(Zt,xt,dn,wn,fn,lr,Yt,Vn,cr,Wr,ur){const Gn=[],ji=[],dr=Zt.projection.upVectorScale(ur,Zt.center.lat,Zt.worldSize).metersToTile,fr=[0,0,0,1],Ai=[0,0,0,1],Li=(Ii,ls,ps,Cs)=>{Ii[0]=ls,Ii[1]=ps,Ii[2]=Cs,Ii[3]=1},Oi=a1();dn>0&&(dn+=Oi),wn+=Oi;for(const Ii of xt){const ls=[],ps=[];for(const Cs of Ii){const Ri=Cs.x+fn.x,zs=Cs.y+fn.y,As=Zt.projection.projectTilePoint(Ri,zs,ur),us=Zt.projection.upVector(ur,Cs.x,Cs.y);let Jr=dn,Is=wn;if(Yt){const zi=zr(Ri,zs,dn,wn,Yt,Vn,cr,Wr);Jr+=zi.base,Is+=zi.top}dn!==0?Li(fr,As.x+us[0]*dr*Jr,As.y+us[1]*dr*Jr,As.z+us[2]*dr*Jr):Li(fr,As.x,As.y,As.z),Li(Ai,As.x+us[0]*dr*Is,As.y+us[1]*dr*Is,As.z+us[2]*dr*Is),as(fr,fr,lr),as(Ai,Ai,lr),ls.push(new Yc(fr[0],fr[1],fr[2])),ps.push(new Yc(Ai[0],Ai[1],Ai[2]))}Gn.push(ls),ji.push(ps)}return[Gn,ji]})(ze,Ue,Fe,ut,ot,bt,$t,pt,Rt,Mt,Nt):$t?(function(Zt,xt,dn,wn,fn,lr,Yt,Vn,cr){const Wr=[],ur=[],Gn=[0,0,0,1];for(const ji of Zt){const dr=[],fr=[];for(const Ai of ji){const Li=Ai.x+wn.x,Oi=Ai.y+wn.y,Ii=zr(Li,Oi,xt,dn,lr,Yt,Vn,cr);Gn[0]=Li,Gn[1]=Oi,Gn[2]=Ii.base,Gn[3]=1,Wu(Gn,Gn,fn),Gn[3]=Math.max(Gn[3],1e-5);const ls=new Yc(Gn[0]/Gn[3],Gn[1]/Gn[3],Gn[2]/Gn[3]);Gn[0]=Li,Gn[1]=Oi,Gn[2]=Ii.top,Gn[3]=1,Wu(Gn,Gn,fn),Gn[3]=Math.max(Gn[3],1e-5);const ps=new Yc(Gn[0]/Gn[3],Gn[1]/Gn[3],Gn[2]/Gn[3]);dr.push(ls),fr.push(ps)}Wr.push(dr),ur.push(fr)}return[Wr,ur]})(Ue,Fe,ut,ot,bt,$t,pt,Rt,Mt):(function(Zt,xt,dn,wn,fn){const lr=[],Yt=[],Vn=fn[8]*xt,cr=fn[9]*xt,Wr=fn[10]*xt,ur=fn[11]*xt,Gn=fn[8]*dn,ji=fn[9]*dn,dr=fn[10]*dn,fr=fn[11]*dn;for(const Ai of Zt){const Li=[],Oi=[];for(const Ii of Ai){const ls=Ii.x+wn.x,ps=Ii.y+wn.y,Cs=fn[0]*ls+fn[4]*ps+fn[12],Ri=fn[1]*ls+fn[5]*ps+fn[13],zs=fn[2]*ls+fn[6]*ps+fn[14],As=fn[3]*ls+fn[7]*ps+fn[15],us=Cs+Vn,Jr=Ri+cr,Is=zs+Wr,zi=Math.max(As+ur,1e-5),Ga=Cs+Gn,Rs=Ri+ji,Bo=zs+dr,ho=Math.max(As+fr,1e-5);Li.push(new Yc(us/zi,Jr/zi,Is/zi)),Oi.push(new Yc(Ga/ho,Rs/ho,Bo/ho))}lr.push(Li),Yt.push(Oi)}return[lr,Yt]})(Ue,Fe,ut,ot,bt)})(v,d,F,B,P,w,_e,$,J,v.center.lat,s.tileID.canonical),Pe=s.queryGeometry;return(function(ze,Ue,Fe){let ut=1/0;Zc(Fe,Ue)&&(ut=n0(Fe,Ue[0]));for(let ot=0;ot<Ue.length;ot++){const bt=Ue[ot],$t=ze[ot];for(let pt=0;pt<bt.length-1;pt++){const Rt=bt[pt],Mt=[Rt,bt[pt+1],$t[pt+1],$t[pt],Rt];Xc(Fe,Mt)&&(ut=Math.min(ut,n0(Fe,Mt)))}}return ut!==1/0&&ut})(Re,Be,Pe.isPointQuery()?Pe.screenBounds:Pe.screenGeometry)}},line:class extends Dl{constructor(s){super(s,o0),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(s){if(s==="line-gradient"){const r=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=r._styleExpression&&r._styleExpression.expression instanceof Vi,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(s,r){super.recalculate(s,r),this.paint._values["line-floorwidth"]=d1.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new _f(s)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(s){return new Gu(this,s)}queryRadius(s){const r=s,a=f1(ff("line-width",this,r),ff("line-gap-width",this,r)),d=ff("line-offset",this,r);return a/2+Math.abs(d)+$h(this.paint.get("line-translate"))}queryIntersectsFeature(s,r,a,d,m,v){if(s.queryGeometry.isAboveHorizon)return!1;const w=Uv(s.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,s.pixelToTileUnitsFactor),C=s.pixelToTileUnitsFactor/2*f1(this.paint.get("line-width").evaluate(r,a),this.paint.get("line-gap-width").evaluate(r,a)),I=this.paint.get("line-offset").evaluate(r,a);return I&&(d=(function(P,B){const F=[],$=new se(0,0);for(let X=0;X<P.length;X++){const J=P[X],oe=[];for(let _e=0;_e<J.length;_e++){const Re=J[_e],Be=J[_e+1],Pe=_e===0?$:Re.sub(J[_e-1])._unit()._perp(),ze=_e===J.length-1?$:Be.sub(Re)._unit()._perp(),Ue=Pe._add(ze)._unit();Ue._mult(1/(Ue.x*ze.x+Ue.y*ze.y)),oe.push(Ue._mult(B)._add(Re))}F.push(oe)}return F})(d,I*s.pixelToTileUnitsFactor)),(function(P,B,F){for(let $=0;$<B.length;$++){const X=B[$];if(P.length>=3){for(let J=0;J<X.length;J++)if(dc(P,X[J]))return!0}if(Fv(P,X,F))return!0}return!1})(w,d,C)}isTileClipped(){return!0}},symbol:xr,background:class extends Dl{constructor(s){super(s,Hr)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Dl{constructor(s){super(s,di)}getProgramIds(){return["raster"]}},sky:class extends Dl{constructor(s){super(s,jE),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="sky-gradient"?this._updateColorRamp():s!=="sky-atmosphere-sun"&&s!=="sky-atmosphere-halo-color"&&s!=="sky-atmosphere-color"&&s!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Kc({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(s){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const r=s.style.light.properties.get("position");return this._lightPosition.azimuthal!==r.azimuthal||this._lightPosition.polar!==r.polar}return!1}getCenter(s,r){if(this.paint.get("sky-type")==="atmosphere"){const d=this.paint.get("sky-atmosphere-sun"),m=!d,v=s.style.light,w=v.properties.get("position");return m&&v.properties.get("anchor")==="viewport"&&Rn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),m?$E(w.azimuthal,90-w.polar,r):$E(d[0],90-d[1],r)}const a=this.paint.get("sky-gradient-center");return $E(a[0],90-a[1],r)}is3D(){return!1}isSky(){return!0}markSkyboxValid(s){this._skyboxInvalidated=!1,this._lightPosition=s.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const s=this.paint.get("sky-type");return s==="atmosphere"?["skyboxCapture","skybox"]:s==="gradient"?["skyboxGradient"]:null}}};class C0{constructor(r,a,d,m){this.context=r,this.format=d,this.texture=r.gl.createTexture(),this.update(a,m)}update(r,a,d){const{width:m,height:v}=r,{context:w}=this,{gl:C}=w,{HTMLImageElement:I,HTMLCanvasElement:P,HTMLVideoElement:B,ImageData:F,ImageBitmap:$}=S;if(C.bindTexture(C.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!a||a.premultiply!==!1)),d||this.size&&this.size[0]===m&&this.size[1]===v){const{x:X,y:J}=d||{x:0,y:0};r instanceof I||r instanceof P||r instanceof B||r instanceof F||$&&r instanceof $?C.texSubImage2D(C.TEXTURE_2D,0,X,J,C.RGBA,C.UNSIGNED_BYTE,r):C.texSubImage2D(C.TEXTURE_2D,0,X,J,m,v,C.RGBA,C.UNSIGNED_BYTE,r.data)}else this.size=[m,v],r instanceof I||r instanceof P||r instanceof B||r instanceof F||$&&r instanceof $?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,r):C.texImage2D(C.TEXTURE_2D,0,this.format,m,v,0,this.format,C.UNSIGNED_BYTE,r.data);this.useMipmap=!!(a&&a.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&C.generateMipmap(C.TEXTURE_2D)}bind(r,a){const{context:d}=this,{gl:m}=d;m.bindTexture(m.TEXTURE_2D,this.texture),r!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,r),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap?r===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_NEAREST:r),this.filter=r),a!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,a),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}class AV{constructor(r){this._callback=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){this._channel=void 0,this._callback=()=>{}}}class IV{constructor(){this.tasks={},this.taskQueue=[],Wt(["process"],this),this.invoker=new AV(this.process),this.nextId=0}add(r,a){const d=this.nextId++,m=(function({type:v,isSymbolTile:w,zoom:C}){return C=C||0,v==="message"?0:v!=="maybePrepare"||w?v!=="parseTile"||w?v==="parseTile"&&w?300-C:v==="maybePrepare"&&w?400-C:500:200-C:100-C})(a);if(m===0){En();try{r()}finally{}return{cancel:()=>{}}}return this.tasks[d]={fn:r,metadata:a,priority:m,id:d},this.taskQueue.push(d),this.invoker.trigger(),{cancel:()=>{delete this.tasks[d]}}}process(){En();try{if(this.taskQueue=this.taskQueue.filter((d=>!!this.tasks[d])),!this.taskQueue.length)return;const r=this.pick();if(r===null)return;const a=this.tasks[r];if(delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),!a)return;a.fn()}finally{}}pick(){let r=null,a=1/0;for(let m=0;m<this.taskQueue.length;m++){const v=this.tasks[this.taskQueue[m]];v.priority<a&&(a=v.priority,r=m)}if(r===null)return null;const d=this.taskQueue[r];return this.taskQueue.splice(r,1),d}remove(){this.invoker.remove()}}class bM{constructor(r){this._stringToNumber={},this._numberToString=[];for(let a=0;a<r.length;a++){const d=r[a];this._stringToNumber[d]=a,this._numberToString[a]=d}}encode(r){return this._stringToNumber[r]}decode(r){return this._numberToString[r]}}const RV=["tile","layer","source","sourceLayer","state"];class wM{constructor(r,a,d,m,v){this.type="Feature",this._vectorTileFeature=r,this._z=a,this._x=d,this._y=m,this.properties=r.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(r.id=this.id);for(const a of RV)this[a]!==void 0&&(r[a]=this[a]);return r}}const nu=32,ad=33,jp=new Uint16Array(8184);for(let s=0;s<2046;s++){let r=s+2,a=0,d=0,m=0,v=0,w=0,C=0;for(1&r?m=v=w=nu:a=d=C=nu;(r>>=1)>1;){const P=a+m>>1,B=d+v>>1;1&r?(m=a,v=d,a=w,d=C):(a=m,d=v,m=w,v=C),w=P,C=B}const I=4*s;jp[I+0]=a,jp[I+1]=d,jp[I+2]=m,jp[I+3]=v}const ld=new Uint16Array(2178),$p=new Uint8Array(1089),B1=new Uint16Array(1089);function TM(s){return s===0?-.03125:s===32?.03125:0}var EM=Ye([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const SM={type:2,extent:Dn,loadGeometry:()=>[[new se(0,0),new se(Dn+1,0),new se(Dn+1,Dn+1),new se(0,Dn+1),new se(0,0)]]};class qE{constructor(r,a,d,m,v){this.tileID=r,this.uid=Ut(),this.uses=0,this.tileSize=a,this.tileZoom=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=v,this.expiredRequestCount=0,this.state="loading",m&&m.transform&&(this.projection=m.transform.projection)}registerFadeDuration(r){const a=r+this.timeAdded;a<ea.now()||this.fadeEndTime&&a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=tu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,a,d){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=(function(m,v){const w={};if(!v)return w;for(const C of m){const I=C.layerIds.map((P=>v.getLayer(P))).filter(Boolean);if(I.length!==0){C.layers=I,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map((P=>I.filter((B=>B.id===P))[0])));for(const P of I)w[P.id]=C}}return w})(r.buckets,a.style),this.hasSymbolBuckets=!1;for(const m in this.buckets){const v=this.buckets[m];if(v instanceof kt){if(this.hasSymbolBuckets=!0,!d)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const m in this.buckets){const v=this.buckets[m];if(v instanceof kt&&v.hasRTLText){this.hasRTLText=!0,L.isLoading()||L.isLoaded()||A()!=="deferred"||D();break}}this.queryPadding=0;for(const m in this.buckets){const v=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(m).queryRadius(v))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas)}else this.collisionBoxArray=new li}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(r){return this.buckets[r.id]}upload(r){for(const d in this.buckets){const m=this.buckets[d];m.uploadPending()&&m.upload(r)}const a=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new C0(r,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new C0(r,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new C0(r,this.lineAtlas.image,a.ALPHA),this.lineAtlas.uploaded=!0)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,a,d,m,v,w,C,I){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:m,pixelPosMatrix:C,transform:w,params:v,tileTransform:this.tileTransform},r,a,d):{}}querySourceFeatures(r,a){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const m=d.loadVTLayers(),v=a?a.sourceLayer:"",w=m._geojsonTileLayer||m[v];if(!w)return;const C=ua(a&&a.filter),{z:I,x:P,y:B}=this.tileID.canonical,F={z:I,x:P,y:B};for(let $=0;$<w.length;$++){const X=w.feature($);if(C.needGeometry){const _e=ko(X,!0);if(!C.filter(new V(this.tileID.overscaledZ),_e,this.tileID.canonical))continue}else if(!C.filter(new V(this.tileID.overscaledZ),X))continue;const J=d.getId(X,v),oe=new wM(X,I,P,B,J);oe.tile=F,r.push(oe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const a=this.expirationTime;if(r.cacheControl){const d=bn(r.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const d=Date.now();let m=!1;if(this.expirationTime>d)m=!1;else if(a)if(this.expirationTime<a)m=!0;else{const v=this.expirationTime-a;v?this.expirationTime=d+Math.max(v,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(r).length===0||!a)return;const d=this.latestFeatureIndex.loadVTLayers(),m=a.style.listImages();for(const v in this.buckets){if(!a.style.hasLayer(v))continue;const w=this.buckets[v],C=w.layers[0].sourceLayer||"_geojsonTileLayer",I=d[C],P=r[C];if(!I||!P||Object.keys(P).length===0)continue;if(w.update(P,I,m,this.imageAtlas&&this.imageAtlas.patternPositions||{}),w instanceof _f||w instanceof My){const F=a.style._getSourceCache(w.layers[0].source);a._terrain&&a._terrain.enabled&&F&&w.programConfigurations.needsUpload&&a._terrain._clearRenderCacheForTile(F.id,this.tileID)}const B=a&&a.style&&a.style.getLayer(v);B&&(this.queryPadding=Math.max(this.queryPadding,B.queryRadius(w)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ea.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=ea.now()+r}setTexture(r,a){const d=a.context,m=d.gl;this.texture=this.texture||a.getTileTexture(r.width),this.texture?this.texture.update(r,{useMipmap:!0}):(this.texture=new C0(d,r,m.RGBA,{useMipmap:!0}),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE))}setDependencies(r,a){const d={};for(const m of a)d[m]=!0;this.dependencies[r]=d}hasDependency(r,a){for(const d of r){const m=this.dependencies[d];if(m){for(const v of a)if(m[v])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,a){if(!a||a.name==="mercator"||this._tileDebugBuffer)return;const d=_s(SM,this.tileID.canonical,this.tileTransform)[0],m=new Vt,v=new Zo;for(let w=0;w<d.length;w++){const{x:C,y:I}=d[w];m.emplaceBack(C,I),v.emplaceBack(w)}v.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(v),this._tileDebugBuffer=r.createVertexBuffer(m,jh.members),this._tileDebugSegments=os.simpleSegment(0,0,m.length,v.length)}_makeTileBoundsBuffers(r,a){if(this._tileBoundsBuffer||!a||a.name==="mercator")return;const d=_s(SM,this.tileID.canonical,this.tileTransform)[0];let m,v;if(this.isRaster){const w=(function(C,I){const P=tu(C,I),B=Math.pow(2,C.z);for(let _e=0;_e<ad;_e++)for(let Re=0;Re<ad;Re++){const Be=Ua((C.x+(Re+TM(Re))/nu)/B),Pe=Qr((C.y+(_e+TM(_e))/nu)/B),ze=I.project(Be,Pe),Ue=_e*ad+Re;ld[2*Ue+0]=Math.round((ze.x*P.scale-P.x)*Dn),ld[2*Ue+1]=Math.round((ze.y*P.scale-P.y)*Dn)}$p.fill(0),B1.fill(0);for(let _e=2045;_e>=0;_e--){const Re=4*_e,Be=jp[Re+0],Pe=jp[Re+1],ze=jp[Re+2],Ue=jp[Re+3],Fe=Be+ze>>1,ut=Pe+Ue>>1,ot=Fe+ut-Pe,bt=ut+Be-Fe,$t=Pe*ad+Be,pt=Ue*ad+ze,Rt=ut*ad+Fe,Mt=Math.hypot((ld[2*$t+0]+ld[2*pt+0])/2-ld[2*Rt+0],(ld[2*$t+1]+ld[2*pt+1])/2-ld[2*Rt+1])>=16;$p[Rt]=$p[Rt]||(Mt?1:0),_e<1022&&($p[Rt]=$p[Rt]||$p[(Pe+bt>>1)*ad+(Be+ot>>1)]||$p[(Ue+bt>>1)*ad+(ze+ot>>1)])}const F=new _t,$=new Tn;let X=0;function J(_e,Re){const Be=Re*ad+_e;return B1[Be]===0&&(F.emplaceBack(ld[2*Be+0],ld[2*Be+1],_e*Dn/nu,Re*Dn/nu),B1[Be]=++X),B1[Be]-1}function oe(_e,Re,Be,Pe,ze,Ue){const Fe=_e+Be>>1,ut=Re+Pe>>1;if(Math.abs(_e-ze)+Math.abs(Re-Ue)>1&&$p[ut*ad+Fe])oe(ze,Ue,_e,Re,Fe,ut),oe(Be,Pe,ze,Ue,Fe,ut);else{const ot=J(_e,Re),bt=J(Be,Pe),$t=J(ze,Ue);$.emplaceBack(ot,bt,$t)}}return oe(0,0,nu,nu,nu,0),oe(nu,nu,0,0,0,nu),{vertices:F,indices:$}})(this.tileID.canonical,a);m=w.vertices,v=w.indices}else{m=new _t,v=new Tn;for(const{x:C,y:I}of d)m.emplaceBack(C,I,0,0);const w=Yh(m.int16,void 0,4);for(let C=0;C<w.length;C+=3)v.emplaceBack(w[C],w[C+1],w[C+2])}this._tileBoundsBuffer=r.createVertexBuffer(m,EM.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(v),this._tileBoundsSegments=os.simpleSegment(0,0,m.length,v.length)}_makeGlobeTileDebugBuffers(r,a){const d=a.projection;if(!d||d.name!=="globe"||a.freezeTileCoverage)return;const m=this.tileID.canonical,v=bp(Vb(m,a)),w=lf(a.zoom);let C;w>0&&(C=cy(new Float64Array(16),a.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,m,a,v,C,w),this._makeGlobeTileDebugTextBuffer(r,m,a,v,C,w)}_globePoint(r,a,d,m,v,w,C){let I=Pi(r,a,d);if(w){const P=1<<d.z,B=uo(m.center.lng),F=ki(m.center.lat),$=(d.x+.5)/P-B;let X=0;$>.5?X=-1:$<-.5&&(X=1);let J=(r/Dn+d.x)/P+X,oe=(a/Dn+d.y)/P;J=(J-B)*m._pixelsPerMercatorPixel+B,oe=(oe-F)*m._pixelsPerMercatorPixel+F;const _e=[J*m.worldSize,oe*m.worldSize,0];as(_e,_e,w),I=Zu(I,_e,C)}return as(I,I,v)}_makeGlobeTileDebugBorderBuffer(r,a,d,m,v,w){const C=new Vt,I=new Zo,P=new rt,B=($,X,J,oe,_e)=>{const Re=(J-$)/(_e-1),Be=(oe-X)/(_e-1),Pe=C.length;for(let ze=0;ze<_e;ze++){const Ue=$+ze*Re,Fe=X+ze*Be;C.emplaceBack(Ue,Fe);const ut=this._globePoint(Ue,Fe,a,d,m,v,w);P.emplaceBack(ut[0],ut[1],ut[2]),I.emplaceBack(Pe+ze)}},F=Dn;B(0,0,F,0,16),B(F,0,F,F,16),B(F,F,0,F,16),B(0,F,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(I),this._tileDebugBuffer=r.createVertexBuffer(C,jh.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer(P,Mv.members),this._tileDebugSegments=os.simpleSegment(0,0,C.length,I.length)}_makeGlobeTileDebugTextBuffer(r,a,d,m,v,w){const C=Dn/4,I=new Vt,P=new Tn,B=new rt,F=25;P.reserve(32),I.reserve(F),B.reserve(F);const $=(X,J)=>F*X+J;for(let X=0;X<F;X++){const J=X*C;for(let oe=0;oe<F;oe++){const _e=oe*C;I.emplaceBack(_e,J);const Re=this._globePoint(_e,J,a,d,m,v,w);B.emplaceBack(Re[0],Re[1],Re[2])}}for(let X=0;X<4;X++)for(let J=0;J<4;J++){const oe=$(X,J),_e=$(X,J+1),Re=$(X+1,J),Be=$(X+1,J+1);P.emplaceBack(oe,_e,Re),P.emplaceBack(Re,_e,Be)}this._tileDebugTextIndexBuffer=r.createIndexBuffer(P),this._tileDebugTextBuffer=r.createVertexBuffer(I,jh.members),this._globeTileDebugTextBuffer=r.createVertexBuffer(B,Mv.members),this._tileDebugTextSegments=os.simpleSegment(0,0,F,32)}}class MV{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,a,d){const m=String(a);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][m]=this.stateChanges[r][m]||{},wt(this.stateChanges[r][m],d),this.deletedStates[r]===null){this.deletedStates[r]={};for(const v in this.state[r])v!==m&&(this.deletedStates[r][v]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][m]===null){this.deletedStates[r][m]={};for(const v in this.state[r][m])d[v]||(this.deletedStates[r][m][v]=null)}else for(const v in d)this.deletedStates[r]&&this.deletedStates[r][m]&&this.deletedStates[r][m][v]===null&&delete this.deletedStates[r][m][v]}removeFeatureState(r,a,d){if(this.deletedStates[r]===null)return;const m=String(a);if(this.deletedStates[r]=this.deletedStates[r]||{},d&&a!==void 0)this.deletedStates[r][m]!==null&&(this.deletedStates[r][m]=this.deletedStates[r][m]||{},this.deletedStates[r][m][d]=null);else if(a!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][m])for(d in this.deletedStates[r][m]={},this.stateChanges[r][m])this.deletedStates[r][m][d]=null;else this.deletedStates[r][m]=null;else this.deletedStates[r]=null}getState(r,a){const d=String(a),m=wt({},(this.state[r]||{})[d],(this.stateChanges[r]||{})[d]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){const v=this.deletedStates[r][a];if(v===null)return{};for(const w in v)delete m[w]}return m}initializeTileState(r,a){r.setFeatureState(this.state,a)}coalesceChanges(r,a){const d={};for(const m in this.stateChanges){this.state[m]=this.state[m]||{};const v={};for(const w in this.stateChanges[m])this.state[m][w]||(this.state[m][w]={}),wt(this.state[m][w],this.stateChanges[m][w]),v[w]=this.state[m][w];d[m]=v}for(const m in this.deletedStates){this.state[m]=this.state[m]||{};const v={};if(this.deletedStates[m]===null)for(const w in this.state[m])v[w]={},this.state[m][w]={};else for(const w in this.deletedStates[m]){if(this.deletedStates[m][w]===null)this.state[m][w]={};else if(this.state[m][w])for(const C of Object.keys(this.deletedStates[m][w]))delete this.state[m][w][C];v[w]=this.state[m][w]}d[m]=d[m]||{},wt(d[m],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const m in r)r[m].setFeatureState(d,a)}}class CM{constructor(r){this.size=r,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(r,a){const d=this.toIdx(r,a);return{min:this.minimums[d],max:this.maximums[d]}}isLeaf(r,a){return this.leaves[this.toIdx(r,a)]}toIdx(r,a){return a*this.size+r}}function AM(s,r,a,d){let m=0,v=Number.MAX_VALUE;for(let w=0;w<3;w++)if(Math.abs(d[w])<1e-15){if(a[w]<s[w]||a[w]>r[w])return null}else{const C=1/d[w];let I=(s[w]-a[w])*C,P=(r[w]-a[w])*C;if(I>P){const B=I;I=P,P=B}if(I>m&&(m=I),P<v&&(v=P),m>v)return null}return m}function IM(s,r,a,d,m,v,w,C,I,P,B){const F=d-s,$=m-r,X=v-a,J=w-s,oe=C-r,_e=I-a,Re=B[1]*_e-B[2]*oe,Be=B[2]*J-B[0]*_e,Pe=B[0]*oe-B[1]*J,ze=F*Re+$*Be+X*Pe;if(Math.abs(ze)<1e-15)return null;const Ue=1/ze,Fe=P[0]-s,ut=P[1]-r,ot=P[2]-a,bt=(Fe*Re+ut*Be+ot*Pe)*Ue;if(bt<0||bt>1)return null;const $t=ut*X-ot*$,pt=ot*F-Fe*X,Rt=Fe*$-ut*F,Mt=(B[0]*$t+B[1]*pt+B[2]*Rt)*Ue;return Mt<0||bt+Mt>1?null:(J*$t+oe*pt+_e*Rt)*Ue}function RM(s,r,a){return(s-r)/(a-r)}function MM(s,r,a,d,m,v,w,C,I){const P=1<<a,B=v-d,F=w-m,$=(s+1)/P*B+d,X=(r+0)/P*F+m,J=(r+1)/P*F+m;C[0]=(s+0)/P*B+d,C[1]=X,I[0]=$,I[1]=J}class PM{constructor(r){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=r,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const a=(function(v){const w=Math.ceil(Math.log2(v.dim/8)),C=[];let I=Math.ceil(Math.pow(2,w));const P=1/I,B=(X,J,oe,_e,Re)=>{const Be=_e?1:0,Pe=(X+1)*oe-Be,ze=J*oe,Ue=(J+1)*oe-Be;Re[0]=X*oe,Re[1]=ze,Re[2]=Pe,Re[3]=Ue};let F=new CM(I);const $=[];for(let X=0;X<I*I;X++){B(X%I,Math.floor(X/I),P,!1,$);const J=qp($[0],$[1],v),oe=qp($[2],$[1],v),_e=qp($[2],$[3],v),Re=qp($[0],$[3],v);F.minimums.push(Math.min(J,oe,_e,Re)),F.maximums.push(Math.max(J,oe,_e,Re)),F.leaves.push(1)}for(C.push(F),I/=2;I>=1;I/=2){const X=C[C.length-1];F=new CM(I);for(let J=0;J<I*I;J++){B(J%I,Math.floor(J/I),2,!0,$);const oe=X.getElevation($[0],$[1]),_e=X.getElevation($[2],$[1]),Re=X.getElevation($[2],$[3]),Be=X.getElevation($[0],$[3]),Pe=X.isLeaf($[0],$[1]),ze=X.isLeaf($[2],$[1]),Ue=X.isLeaf($[2],$[3]),Fe=X.isLeaf($[0],$[3]),ut=Math.min(oe.min,_e.min,Re.min,Be.min),ot=Math.max(oe.max,_e.max,Re.max,Be.max),bt=Pe&&ze&&Ue&&Fe;F.maximums.push(ot),F.minimums.push(ut),F.leaves.push(ot-ut<=5&&bt?1:0)}C.push(F)}return C})(this.dem),d=a.length-1,m=a[d];this._addNode(m.minimums[0],m.maximums[0],m.leaves[0]),this._construct(a,0,0,d,0)}raycastRoot(r,a,d,m,v,w,C=1){return AM([r,a,-100],[d,m,this.maximums[0]*C],v,w)}raycast(r,a,d,m,v,w,C=1){if(!this.nodeCount)return null;const I=this.raycastRoot(r,a,d,m,v,w,C);if(I==null)return null;const P=[],B=[],F=[],$=[],X=[{idx:0,t:I,nodex:0,nodey:0,depth:0}];for(;X.length>0;){const{idx:J,t:oe,nodex:_e,nodey:Re,depth:Be}=X.pop();if(this.leaves[J]){MM(_e,Re,Be,r,a,d,m,F,$);const ze=1<<Be,Ue=(_e+0)/ze,Fe=(_e+1)/ze,ut=(Re+0)/ze,ot=(Re+1)/ze,bt=qp(Ue,ut,this.dem)*C,$t=qp(Fe,ut,this.dem)*C,pt=qp(Fe,ot,this.dem)*C,Rt=qp(Ue,ot,this.dem)*C,Mt=IM(F[0],F[1],bt,$[0],F[1],$t,$[0],$[1],pt,v,w),Nt=IM($[0],$[1],pt,F[0],$[1],Rt,F[0],F[1],bt,v,w),Zt=Math.min(Mt!==null?Mt:Number.MAX_VALUE,Nt!==null?Nt:Number.MAX_VALUE);if(Zt!==Number.MAX_VALUE)return Zt;{const xt=gp([],v,w,oe);if(kM(bt,$t,Rt,pt,RM(xt[0],F[0],$[0]),RM(xt[1],F[1],$[1]))>=xt[2])return oe}continue}let Pe=0;for(let ze=0;ze<this._siblingOffset.length;ze++){MM((_e<<1)+this._siblingOffset[ze][0],(Re<<1)+this._siblingOffset[ze][1],Be+1,r,a,d,m,F,$),F[2]=-100,$[2]=this.maximums[this.childOffsets[J]+ze]*C;const Ue=AM(F,$,v,w);if(Ue!=null){const Fe=Ue;P[ze]=Fe;let ut=!1;for(let ot=0;ot<Pe&&!ut;ot++)Fe>=P[B[ot]]&&(B.splice(ot,0,ze),ut=!0);ut||(B[Pe]=ze),Pe++}}for(let ze=0;ze<Pe;ze++){const Ue=B[ze];X.push({idx:this.childOffsets[J]+Ue,t:P[Ue],nodex:(_e<<1)+this._siblingOffset[Ue][0],nodey:(Re<<1)+this._siblingOffset[Ue][1],depth:Be+1})}}return null}_addNode(r,a,d){return this.minimums.push(r),this.maximums.push(a),this.leaves.push(d),this.childOffsets.push(0),this.nodeCount++}_construct(r,a,d,m,v){if(r[m].isLeaf(a,d)===1)return;this.childOffsets[v]||(this.childOffsets[v]=this.nodeCount);const w=m-1,C=r[w];let I=0,P=0;for(let B=0;B<this._siblingOffset.length;B++){const F=2*a+this._siblingOffset[B][0],$=2*d+this._siblingOffset[B][1],X=C.getElevation(F,$),J=C.isLeaf(F,$),oe=this._addNode(X.min,X.max,J);J&&(I|=1<<B),P||(P=oe)}for(let B=0;B<this._siblingOffset.length;B++)I&1<<B||this._construct(r,2*a+this._siblingOffset[B][0],2*d+this._siblingOffset[B][1],w,P+B)}}function kM(s,r,a,d,m,v){return nr(nr(s,a,v),nr(r,d,v),m)}function qp(s,r,a){const d=a.dim,m=et(s*d-.5,0,d-1),v=et(r*d-.5,0,d-1),w=Math.floor(m),C=Math.floor(v),I=Math.min(w+1,d-1),P=Math.min(C+1,d-1);return kM(a.get(w,C),a.get(I,C),a.get(w,P),a.get(I,P),m-w,v-C)}const DM={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function PV(s,r,a){return(256*s*256+256*r+a)/10-1e4}function kV(s,r,a){return 256*s+r+a/256-32768}class N1{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(r,a,d,m=!1,v=!1){if(this.uid=r,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(d&&d!=="mapbox"&&d!=="terrarium")return Rn(`"${d}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=a.height;const w=this.dim=a.height-2,C=new Uint32Array(a.data.buffer);if(this.pixels=new Uint8Array(a.data.buffer),this.encoding=d||"mapbox",this.borderReady=m,!m){for(let I=0;I<w;I++)C[this._idx(-1,I)]=C[this._idx(0,I)],C[this._idx(w,I)]=C[this._idx(w-1,I)],C[this._idx(I,-1)]=C[this._idx(I,0)],C[this._idx(I,w)]=C[this._idx(I,w-1)];C[this._idx(-1,-1)]=C[this._idx(0,0)],C[this._idx(w,-1)]=C[this._idx(w-1,0)],C[this._idx(-1,w)]=C[this._idx(0,w-1)],C[this._idx(w,w)]=C[this._idx(w-1,w-1)],v&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new PM(this)}get(r,a,d=!1){d&&(r=et(r,-1,this.dim),a=et(a,-1,this.dim));const m=4*this._idx(r,a);return(this.encoding==="terrarium"?kV:PV)(this.pixels[m],this.pixels[m+1],this.pixels[m+2])}static getUnpackVector(r){return DM[r]}get unpackVector(){return DM[this.encoding]}_idx(r,a){if(r<-1||r>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(r+1)}static pack(r,a){const d=[0,0,0,0],m=N1.getUnpackVector(a);let v=Math.floor((r+m[3])/m[2]);return d[2]=v%256,v=Math.floor(v/256),d[1]=v%256,v=Math.floor(v/256),d[0]=v,d}getPixels(){return new vs({width:this.stride,height:this.stride},this.pixels)}backfillBorder(r,a,d){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let m=a*this.dim,v=a*this.dim+this.dim,w=d*this.dim,C=d*this.dim+this.dim;switch(a){case-1:m=v-1;break;case 1:v=m+1}switch(d){case-1:w=C-1;break;case 1:C=w+1}const I=-a*this.dim,P=-d*this.dim;for(let B=w;B<C;B++)for(let F=m;F<v;F++){const $=4*this._idx(F,B),X=4*this._idx(F+I,B+P);this.pixels[$+0]=r.pixels[X+0],this.pixels[$+1]=r.pixels[X+1],this.pixels[$+2]=r.pixels[X+2],this.pixels[$+3]=r.pixels[X+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}gn(N1,"DEMData"),gn(PM,"DemMinMaxQuadTree",{omit:["dem"]});class DV{constructor(r,a){this.max=r,this.onRemove=a,this.reset()}reset(){for(const r in this.data)for(const a of this.data[r])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(r,a,d){const m=r.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);const v={value:a,timeout:void 0};if(d!==void 0&&(v.timeout=setTimeout((()=>{this.remove(r,v)}),d)),this.data[m].push(v),this.order.push(m),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const a=this.data[r].shift();return a.timeout&&clearTimeout(a.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),a.value}getByKey(r){const a=this.data[r];return a?a[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,a){if(!this.has(r))return this;const d=r.wrapped().key,m=a===void 0?0:this.data[d].indexOf(a),v=this.data[d][m];return this.data[d].splice(m,1),v.timeout&&clearTimeout(v.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(v.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(r){const a=[];for(const d in this.data)for(const m of this.data[d])r(m.value)||a.push(m);for(const d of a)this.remove(d.value.tileID,d)}}class Zy{constructor(r,a,d){this.func=r,this.mask=a,this.range=d}}Zy.ReadOnly=!1,Zy.ReadWrite=!0,Zy.disabled=new Zy(519,Zy.ReadOnly,[0,1]);const GE=7680;class HE{constructor(r,a,d,m,v,w){this.test=r,this.ref=a,this.mask=d,this.fail=m,this.depthFail=v,this.pass=w}}HE.disabled=new HE({func:519,mask:0},0,0,GE,GE,GE);class cd{constructor(r,a,d){this.blendFunction=r,this.blendColor=a,this.mask=d}}cd.Replace=[1,0],cd.disabled=new cd(cd.Replace,Ti.transparent,[!1,!1,!1,!1]),cd.unblended=new cd(cd.Replace,Ti.transparent,[!0,!0,!0,!0]),cd.alphaBlended=new cd([1,771],Ti.transparent,[!0,!0,!0,!0]);const WE=1029,XE=2305;class sh{constructor(r,a,d){this.enable=r,this.mode=a,this.frontFace=d}}sh.disabled=new sh(!1,WE,XE),sh.backCCW=new sh(!0,WE,XE),sh.backCW=new sh(!0,WE,2304),sh.frontCW=new sh(!0,1028,2304),sh.frontCCW=new sh(!0,1028,XE);class dg extends Wl{constructor(r,a,d){super(),this.id=r,this._onlySymbols=d,a.on("data",(m=>{m.dataType==="source"&&m.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&m.dataType==="source"&&m.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))})),a.on("error",(()=>{this._sourceErrored=!0})),this._source=a,this._tiles={},this._cache=new DV(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=a.minTileCacheSize,this._maxTileCacheSize=a.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new MV,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(r){this.map=r,this._minTileCacheSize=this._minTileCacheSize===void 0&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const a=this._tiles[r];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,a){return r.isSymbolTile=this._onlySymbols,this._source.loadTile(r,a)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r,(()=>{}))}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r,(()=>{}))}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const d=this._tiles[a];d.upload(r),d.prepare(this.map.style.imageManager)}}getIds(){return Et(this._tiles).map((r=>r.tileID)).sort(LM).map((r=>r.key))}getRenderableIds(r){const a=[];for(const d in this._tiles)this._isIdRenderable(+d,r)&&a.push(this._tiles[d]);return r?a.sort(((d,m)=>{const v=d.tileID,w=m.tileID,C=new se(v.canonical.x,v.canonical.y)._rotate(this.transform.angle),I=new se(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return v.overscaledZ-w.overscaledZ||I.y-C.y||I.x-C.x})).map((d=>d.tileID.key)):a.map((d=>d.tileID)).sort(LM).map((d=>d.key))}hasRenderableParent(r){const a=this.findLoadedParent(r,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(r,a){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(a||!this._tiles[r].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(+r,"reloading")}}_reloadTile(r,a){const d=this._tiles[r];d&&(d.state!=="loading"&&(d.state=a),this._loadTile(d,this._tileLoaded.bind(this,d,r,a)))}_tileLoaded(r,a,d,m){if(m)if(r.state="errored",m.status!==404)this._source.fire(new ta(m,{tile:r}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const v=this.map.painter.terrain;this.update(this.transform,v.getScaledDemTileSize(),!0),v.resetTileLookupCache(this.id)}else this.update(this.transform);else r.timeAdded=ea.now(),d==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(a,r),this._source.type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new tl("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const a=this.getRenderableIds();for(let m=0;m<a.length;m++){const v=a[m];if(r.neighboringTiles&&r.neighboringTiles[v]){const w=this.getTileByID(v);d(r,w),d(w,r)}}function d(m,v){if(!m.dem||m.dem.borderReady)return;m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0;let w=v.tileID.canonical.x-m.tileID.canonical.x;const C=v.tileID.canonical.y-m.tileID.canonical.y,I=Math.pow(2,m.tileID.canonical.z),P=v.tileID.key;w===0&&C===0||Math.abs(C)>1||(Math.abs(w)>1&&(Math.abs(w+I)===1?w+=I:Math.abs(w-I)===1&&(w-=I)),v.dem&&m.dem&&(m.dem.backfillBorder(v.dem,w,C),m.neighboringTiles&&m.neighboringTiles[P]&&(m.neighboringTiles[P].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,a,d,m){for(const v in this._tiles){let w=this._tiles[v];if(m[v]||!w.hasData()||w.tileID.overscaledZ<=a||w.tileID.overscaledZ>d)continue;let C=w.tileID;for(;w&&w.tileID.overscaledZ>a+1;){const P=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[P.key],w&&w.hasData()&&(C=P)}let I=C;for(;I.overscaledZ>a;)if(I=I.scaledTo(I.overscaledZ-1),r[I.key]){m[C.key]=C;break}}}findLoadedParent(r,a){if(r.key in this._loadedParentTiles){const d=this._loadedParentTiles[r.key];return d&&d.tileID.overscaledZ>=a?d:null}for(let d=r.overscaledZ-1;d>=a;d--){const m=r.scaledTo(d),v=this._getLoadedTile(m);if(v)return v}}_getLoadedTile(r){const a=this._tiles[r.key];return a&&a.hasData()?a:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,a){a=a||this._source.tileSize;const d=Math.ceil(r.width/a)+1,m=Math.ceil(r.height/a)+1,v=Math.floor(d*m*5),w=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,v):v,C=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(C)}handleWrapJump(r){const a=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,a){const d={};for(const m in this._tiles){const v=this._tiles[m];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+a),d[v.tileID.key]=v}this._tiles=d;for(const m in this._timers)clearTimeout(this._timers[m]),delete this._timers[m];for(const m in this._tiles)this._setTileReloadTimer(+m,this._tiles[m])}}update(r,a,d){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!d)return;let m;this.updateCacheSize(r,a),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?m=r.getVisibleUnwrappedCoordinates(this._source.tileID).map((C=>new Yo(C.canonical.z,C.wrap,C.canonical.z,C.canonical.x,C.canonical.y))):(m=r.coveringTiles({tileSize:a||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!d,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(m=m.filter((C=>this._source.hasTile(C))))):m=[];const v=this._updateRetainedTiles(m);if(OM(this._source.type)&&m.length!==0){const C={},I={},P=Object.keys(v);for(const F of P){const $=v[F],X=this._tiles[F];if(!X||X.fadeEndTime&&X.fadeEndTime<=ea.now())continue;const J=this.findLoadedParent($,Math.max($.overscaledZ-dg.maxOverzooming,this._source.minzoom));J&&(this._addTile(J.tileID),C[J.tileID.key]=J.tileID),I[F]=$}const B=m[m.length-1].overscaledZ;for(const F in this._tiles){const $=this._tiles[F];if(v[F]||!$.hasData())continue;let X=$.tileID;for(;X.overscaledZ>B;){X=X.scaledTo(X.overscaledZ-1);const J=this._tiles[X.key];if(J&&J.hasData()&&I[X.key]){v[F]=$.tileID;break}}}for(const F in C)v[F]||(this._coveredTiles[F]=!0,v[F]=C[F])}for(const C in v)this._tiles[C].clearFadeHold();const w=(function(C,I){const P=[];for(const B in C)B in I||P.push(B);return P})(this._tiles,v);for(const C of w){const I=this._tiles[C];I.hasSymbolBuckets&&!I.holdingForFade()?I.setHoldDuration(this.map._fadeDuration):I.hasSymbolBuckets&&!I.symbolFadeFinished()||this._removeTile(+C)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const a={};if(r.length===0)return a;const d={},m=r.reduce(((P,B)=>Math.min(P,B.overscaledZ)),1/0),v=r[0].overscaledZ,w=Math.max(v-dg.maxOverzooming,this._source.minzoom),C=Math.max(v+dg.maxUnderzooming,this._source.minzoom),I={};for(const P of r){const B=this._addTile(P);a[P.key]=P,B.hasData()||m<this._source.maxzoom&&(I[P.key]=P)}this._retainLoadedChildren(I,m,C,a);for(const P of r){let B=this._tiles[P.key];if(B.hasData())continue;if(P.canonical.z>=this._source.maxzoom){const $=P.children(this._source.maxzoom)[0],X=this.getTile($);if(X&&X.hasData()){a[$.key]=$;continue}}else{const $=P.children(this._source.maxzoom);if(a[$[0].key]&&a[$[1].key]&&a[$[2].key]&&a[$[3].key])continue}let F=B.wasRequested();for(let $=P.overscaledZ-1;$>=w;--$){const X=P.scaledTo($);if(d[X.key]||(d[X.key]=!0,B=this.getTile(X),!B&&F&&(B=this._addTile(X)),B&&(a[X.key]=X,F=B.wasRequested(),B.hasData())))break}}return a}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const a=[];let d,m=this._tiles[r].tileID;for(;m.overscaledZ>0;){if(m.key in this._loadedParentTiles){d=this._loadedParentTiles[m.key];break}a.push(m.key);const v=m.scaledTo(m.overscaledZ-1);if(d=this._getLoadedTile(v),d)break;m=v}for(const v of a)this._loadedParentTiles[v]=d}}_addTile(r){let a=this._tiles[r.key];if(a)return a;a=this._cache.getAndRemove(r),a&&(this._setTileReloadTimer(r.key,a),a.tileID=r,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,a)));const d=!!a;if(!d){const m=this.map?this.map.painter:null;a=new qE(r,this._source.tileSize*r.overscaleFactor(),this.transform.tileZoom,m,this._isRaster),this._loadTile(a,this._tileLoaded.bind(this,a,r.key,a.state))}return a?(a.uses++,this._tiles[r.key]=a,d||this._source.fire(new tl("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a):null}_setTileReloadTimer(r,a){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const d=a.getExpiryTimeout();d&&(this._timers[r]=setTimeout((()=>{this._reloadTile(r,"expired"),delete this._timers[r]}),d))}_removeTile(r){const a=this._tiles[r];a&&(a.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,a,d){const m=[],v=this.transform;if(!v)return m;const w=v.projection.name==="globe",C=uo(v.center.lng);for(const I in this._tiles){const P=this._tiles[I];if(d&&P.clearQueryDebugViz(),P.holdingForFade())continue;let B;if(w){const F=P.tileID.canonical;if(F.z===0){const $=[Math.abs(et(C,...A0(F,-1))-C),Math.abs(et(C,...A0(F,1))-C)];B=[0,2*$.indexOf(Math.min(...$))-1]}else{const $=[Math.abs(et(C,...A0(F,-1))-C),Math.abs(et(C,...A0(F,0))-C),Math.abs(et(C,...A0(F,1))-C)];B=[$.indexOf(Math.min(...$))-1]}}else B=[0];for(const F of B){const $=r.containsTile(P,v,a,F);$&&m.push($)}}return m}getVisibleCoordinates(r){const a=this.getRenderableIds(r).map((d=>this._tiles[d].tileID));for(const d of a)d.projMatrix=this.transform.calculateProjMatrix(d.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(OM(this._source.type))for(const r in this._tiles){const a=this._tiles[r];if(a.fadeEndTime!==void 0&&a.fadeEndTime>=ea.now())return!0}return!1}setFeatureState(r,a,d){this._state.updateState(r=r||"_geojsonTileLayer",a,d)}removeFeatureState(r,a,d){this._state.removeFeatureState(r=r||"_geojsonTileLayer",a,d)}getFeatureState(r,a){return this._state.getState(r=r||"_geojsonTileLayer",a)}setDependencies(r,a,d){const m=this._tiles[r];m&&m.setDependencies(a,d)}reloadTilesForDependencies(r,a){for(const d in this._tiles)this._tiles[d].hasDependency(r,a)&&this._reloadTile(+d,"reloading");this._cache.filter((d=>!d.hasDependency(r,a)))}_preloadTiles(r,a){if(!this._sourceLoaded){const C=()=>{this._sourceLoaded&&(this._source.off("data",C),this._preloadTiles(r,a))};return void this._source.on("data",C)}const d=new Map,m=Array.isArray(r)?r:[r],v=this.map.painter.terrain,w=this.usedForTerrain&&v?v.getScaledDemTileSize():this._source.tileSize;for(const C of m){const I=C.coveringTiles({tileSize:w,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const P of I)d.set(P.key,P);this.usedForTerrain&&C.updateElevation(!1)}tt(Array.from(d.values()),((C,I)=>{const P=new qE(C,this._source.tileSize*C.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(P,(B=>{this._source.type==="raster-dem"&&P.dem&&this._backfillDEM(P),I(B,P)}))}),a)}}function LM(s,r){const a=Math.abs(2*s.wrap)-+(s.wrap<0),d=Math.abs(2*r.wrap)-+(r.wrap<0);return s.overscaledZ-r.overscaledZ||d-a||r.canonical.y-s.canonical.y||r.canonical.x-s.canonical.x}function OM(s){return s==="raster"||s==="image"||s==="video"||s==="custom"}function A0(s,r){const a=1<<s.z;return[s.x/a+r,(s.x+1)/a+r]}dg.maxOverzooming=10,dg.maxUnderzooming=3;class V1{constructor(r,a,d){this._demTile=r,this._dem=this._demTile.dem,this._scale=a,this._offset=d}static create(r,a,d){const m=d||r.findDEMTileFor(a);if(!m||!m.dem)return;const v=m.dem,w=m.tileID,C=1<<a.canonical.z-w.canonical.z;return new V1(m,m.tileSize/Dn/C,[(a.canonical.x/C-w.canonical.x)*v.dim,(a.canonical.y/C-w.canonical.y)*v.dim])}tileCoordToPixel(r,a){const d=a*this._scale+this._offset[1],m=Math.floor(r*this._scale+this._offset[0]),v=Math.floor(d);return new se(m,v)}getElevationAt(r,a,d,m){const v=r*this._scale+this._offset[0],w=a*this._scale+this._offset[1],C=Math.floor(v),I=Math.floor(w),P=this._dem;return m=!!m,d?nr(nr(P.get(C,I,m),P.get(C,I+1,m),w-I),nr(P.get(C+1,I,m),P.get(C+1,I+1,m),w-I),v-C):P.get(C,I,m)}getElevationAtPixel(r,a,d){return this._dem.get(r,a,!!d)}getMeterToDEM(r){return(1<<this._demTile.tileID.canonical.z)*ml(1,r)*this._dem.stride}}class zM{constructor(r,a){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new ac(Dn,16,0),this.featureIndexArray=new lc,this.promoteId=a}insert(r,a,d,m,v,w=0){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,m,v,w);const I=this.grid;for(let P=0;P<a.length;P++){const B=a[P],F=[1/0,1/0,-1/0,-1/0];for(let $=0;$<B.length;$++){const X=B[$];F[0]=Math.min(F[0],X.x),F[1]=Math.min(F[1],X.y),F[2]=Math.max(F[2],X.x),F[3]=Math.max(F[3],X.y)}F[0]<Dn&&F[1]<Dn&&F[2]>=0&&F[3]>=0&&I.insert(C,F[0],F[1],F[2],F[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Kv(new wf(this.rawTileData)).layers,this.sourceLayerCoder=new bM(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const r in this.vtLayers)this.vtFeatures[r]=[]}return this.vtLayers}query(r,a,d,m){this.loadVTLayers();const v=r.params||{},w=ua(v.filter),C=r.tileResult,I=r.transform,P=C.bufferedTilespaceBounds,B=this.grid.query(P.min.x,P.min.y,P.max.x,P.max.y,((J,oe,_e,Re)=>df(C.bufferedTilespaceGeometry,J,oe,_e,Re)));B.sort(LV);let F=null;I.elevation&&B.length>0&&(F=V1.create(I.elevation,this.tileID));const $={};let X;for(let J=0;J<B.length;J++){const oe=B[J];if(oe===X)continue;X=oe;const _e=this.featureIndexArray.get(oe);let Re=null;this.loadMatchingFeature($,_e,w,v.layers,v.availableImages,a,d,m,((Be,Pe,ze,Ue=0)=>(Re||(Re=_s(Be,this.tileID.canonical,r.tileTransform)),Pe.queryIntersectsFeature(C,Be,ze,Re,this.z,r.transform,r.pixelPosMatrix,F,Ue))))}return $}loadMatchingFeature(r,a,d,m,v,w,C,I,P){const{featureIndex:B,bucketIndex:F,sourceLayerIndex:$,layoutVertexArrayOffset:X}=a,J=this.bucketLayerIDs[F];if(m&&!(function(Be,Pe){for(let ze=0;ze<Be.length;ze++)if(Pe.indexOf(Be[ze])>=0)return!0;return!1})(m,J))return;const oe=this.sourceLayerCoder.decode($),_e=this.vtLayers[oe].feature(B);if(d.needGeometry){const Be=ko(_e,!0);if(!d.filter(new V(this.tileID.overscaledZ),Be,this.tileID.canonical))return}else if(!d.filter(new V(this.tileID.overscaledZ),_e))return;const Re=this.getId(_e,oe);for(let Be=0;Be<J.length;Be++){const Pe=J[Be];if(m&&m.indexOf(Pe)<0)continue;const ze=w[Pe];if(!ze)continue;let Ue={};Re!==void 0&&I&&(Ue=I.getState(ze.sourceLayer||"_geojsonTileLayer",Re));const Fe=wt({},C[Pe]);Fe.paint=BM(Fe.paint,ze.paint,_e,Ue,v),Fe.layout=BM(Fe.layout,ze.layout,_e,Ue,v);const ut=!P||P(_e,ze,Ue,X);if(!ut)continue;const ot=new wM(_e,this.z,this.x,this.y,Re);ot.layer=Fe;let bt=r[Pe];bt===void 0&&(bt=r[Pe]=[]),bt.push({featureIndex:B,feature:ot,intersectionZ:ut})}}lookupSymbolFeatures(r,a,d,m,v,w,C,I){const P={};this.loadVTLayers();const B=ua(v);for(const F of r)this.loadMatchingFeature(P,{bucketIndex:d,sourceLayerIndex:m,featureIndex:F,layoutVertexArrayOffset:0},B,w,C,I,a);return P}loadFeature(r){const{featureIndex:a,sourceLayerIndex:d}=r;this.loadVTLayers();const m=this.sourceLayerCoder.decode(d),v=this.vtFeatures[m];if(v[a])return v[a];const w=this.vtLayers[m].feature(a);return v[a]=w,w}hasLayer(r){for(const a of this.bucketLayerIDs)for(const d of a)if(r===d)return!0;return!1}getId(r,a){let d=r.id;if(this.promoteId){const m=typeof this.promoteId=="string"?this.promoteId:this.promoteId[a];m!=null&&(d=r.properties[m]),typeof d=="boolean"&&(d=Number(d))}return d}}function BM(s,r,a,d,m){return Gt(s,((v,w)=>{const C=r instanceof Ce?r.get(w):null;return C&&C.evaluate?C.evaluate(a,d,m):C}))}function LV(s,r){return r-s}gn(zM,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class NM{constructor(r,a){this.width=r,this.height=a,this.nextRow=0,this.image=new fc({width:r,height:a}),this.positions={},this.uploaded=!1}getDash(r,a){const d=this.getKey(r,a);return this.positions[d]}trim(){const r=this.width,a=this.height=At(this.nextRow);this.image.resize({width:r,height:a})}getKey(r,a){return r.join(",")+a}getDashRanges(r,a,d){const m=[];let v=r.length%2==1?-r[r.length-1]*d:0,w=r[0]*d,C=!0;m.push({left:v,right:w,isDash:C,zeroLength:r[0]===0});let I=r[0];for(let P=1;P<r.length;P++){C=!C;const B=r[P];v=I*d,I+=B,w=I*d,m.push({left:v,right:w,isDash:C,zeroLength:B===0})}return m}addRoundDash(r,a,d){const m=a/2;for(let v=-d;v<=d;v++){const w=this.width*(this.nextRow+d+v);let C=0,I=r[C];for(let P=0;P<this.width;P++){P/I.right>1&&(I=r[++C]);const B=Math.abs(P-I.left),F=Math.abs(P-I.right),$=Math.min(B,F);let X;const J=v/d*(m+1);if(I.isDash){const oe=m-Math.abs(J);X=Math.sqrt($*$+oe*oe)}else X=m-Math.sqrt($*$+J*J);this.image.data[w+P]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(r,a){for(let I=r.length-1;I>=0;--I){const P=r[I],B=r[I+1];P.zeroLength?r.splice(I,1):B&&B.isDash===P.isDash&&(B.left=P.left,r.splice(I,1))}const d=r[0],m=r[r.length-1];d.isDash===m.isDash&&(d.left=m.left-this.width,m.right=d.right+this.width);const v=this.width*this.nextRow;let w=0,C=r[w];for(let I=0;I<this.width;I++){I/C.right>1&&(C=r[++w]);const P=Math.abs(I-C.left),B=Math.abs(I-C.right),F=Math.min(P,B);this.image.data[v+I]=Math.max(0,Math.min(255,(C.isDash?F:-F)+a+128))}}addDash(r,a){const d=this.getKey(r,a);if(this.positions[d])return this.positions[d];const m=a==="round",v=m?7:0,w=2*v+1;if(this.nextRow+w>this.height)return Rn("LineAtlas out of space"),null;r.length===0&&r.push(1);let C=0;for(let B=0;B<r.length;B++)r[B]<0&&(Rn("Negative value is found in line dasharray, replacing values with 0"),r[B]=0),C+=r[B];if(C!==0){const B=this.width/C,F=this.getDashRanges(r,this.width,B);m?this.addRoundDash(F,B,v):this.addRegularDash(F,a==="square"?.5*B:0)}const I=this.nextRow+v;this.nextRow+=w;const P={tl:[I,v],br:[C,0]};return this.positions[d]=P,P}}gn(NM,"LineAtlas");const VM=1*Bl;class FM{constructor(r){const a={},d=[];for(const C in r){const I=r[C],P=a[C]={};for(const B in I.glyphs){const F=I.glyphs[+B];if(!F||F.bitmap.width===0||F.bitmap.height===0)continue;const $=F.metrics.localGlyph?VM:1,X={x:0,y:0,w:F.bitmap.width+2*$,h:F.bitmap.height+2*$};d.push(X),P[B]=X}}const{w:m,h:v}=y0(d),w=new fc({width:m||1,height:v||1});for(const C in r){const I=r[C];for(const P in I.glyphs){const B=I.glyphs[+P];if(!B||B.bitmap.width===0||B.bitmap.height===0)continue;const F=a[C][P],$=B.metrics.localGlyph?VM:1;fc.copy(B.bitmap,w,{x:0,y:0},{x:F.x+$,y:F.y+$},B.bitmap)}}this.image=w,this.positions=a}}gn(FM,"GlyphAtlas");class OV{constructor(r){this.tileID=new Yo(r.tileID.overscaledZ,r.tileID.wrap,r.tileID.canonical.z,r.tileID.canonical.x,r.tileID.canonical.y),this.tileZoom=r.tileZoom,this.uid=r.uid,this.zoom=r.zoom,this.canonical=r.tileID.canonical,this.pixelRatio=r.pixelRatio,this.tileSize=r.tileSize,this.source=r.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=r.showCollisionBoxes,this.collectResourceTiming=!!r.collectResourceTiming,this.returnDependencies=!!r.returnDependencies,this.promoteId=r.promoteId,this.enableTerrain=!!r.enableTerrain,this.isSymbolTile=r.isSymbolTile,this.tileTransform=tu(r.tileID.canonical,r.projection),this.projection=r.projection}parse(r,a,d,m,v){this.status="parsing",this.data=r,this.collisionBoxArray=new li;const w=new bM(Object.keys(r.layers).sort()),C=new zM(this.tileID,this.promoteId);C.bucketLayerIDs=[];const I={},P=new NM(256,256),B={featureIndex:C,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:P,availableImages:d},F=a.familiesBySource[this.source];for(const Ue in F){const Fe=r.layers[Ue];if(!Fe)continue;let ut=!1,ot=!1;for(const pt of F[Ue])pt[0].type==="symbol"?ut=!0:ot=!0;if(this.isSymbolTile===!0&&!ut||this.isSymbolTile===!1&&!ot)continue;Fe.version===1&&Rn(`Vector tile source "${this.source}" layer "${Ue}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const bt=w.encode(Ue),$t=[];for(let pt=0;pt<Fe.length;pt++){const Rt=Fe.feature(pt),Mt=C.getId(Rt,Ue);$t.push({feature:Rt,id:Mt,index:pt,sourceLayerIndex:bt})}for(const pt of F[Ue]){const Rt=pt[0];this.isSymbolTile!==void 0&&Rt.type==="symbol"!==this.isSymbolTile||Rt.minzoom&&this.zoom<Math.floor(Rt.minzoom)||Rt.maxzoom&&this.zoom>=Rt.maxzoom||Rt.visibility!=="none"&&(ZE(pt,this.zoom,d),(I[Rt.id]=Rt.createBucket({index:C.bucketLayerIDs.length,layers:pt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:bt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:d})).populate($t,B,this.tileID.canonical,this.tileTransform),C.bucketLayerIDs.push(pt.map((Mt=>Mt.id))))}}let $,X,J,oe;P.trim();const _e={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Re=()=>{if($)return v($);if(X&&J&&oe){const Ue=new FM(X),Fe=new A1(J,oe);for(const ut in I){const ot=I[ut];ot instanceof kt?(ZE(ot.layers,this.zoom,d),cg(ot,X,Ue.positions,J,Fe.iconPositions,this.showCollisionBoxes,d,this.tileID.canonical,this.tileZoom,this.projection)):ot.hasPattern&&(ot instanceof _f||ot instanceof My||ot instanceof qa)&&(ZE(ot.layers,this.zoom,d),ot.addFeatures(B,this.tileID.canonical,Fe.patternPositions,d,this.tileTransform))}this.status="done",v(null,{buckets:Et(I).filter((ut=>!ut.isEmpty())),featureIndex:C,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ue.image,lineAtlas:P,imageAtlas:Fe,glyphMap:this.returnDependencies?X:null,iconMap:this.returnDependencies?J:null,glyphPositions:this.returnDependencies?Ue.positions:null})}},Be=Gt(B.glyphDependencies,(Ue=>Object.keys(Ue).map(Number)));Object.keys(Be).length?m.send("getGlyphs",{uid:this.uid,stacks:Be},((Ue,Fe)=>{$||($=Ue,X=Fe,Re())}),void 0,!1,_e):X={};const Pe=Object.keys(B.iconDependencies);Pe.length?m.send("getImages",{icons:Pe,source:this.source,tileID:this.tileID,type:"icons"},((Ue,Fe)=>{$||($=Ue,J=Fe,Re())}),void 0,!1,_e):J={};const ze=Object.keys(B.patternDependencies);ze.length?m.send("getImages",{icons:ze,source:this.source,tileID:this.tileID,type:"patterns"},((Ue,Fe)=>{$||($=Ue,oe=Fe,Re())}),void 0,!1,_e):oe={},Re()}}function ZE(s,r,a){const d=new V(r);for(const m of s)m.recalculate(d,a)}class UM{constructor(r){this.entries={},this.scheduler=r}request(r,a,d,m){const v=this.entries[r]=this.entries[r]||{callbacks:[]};if(v.result){const[w,C]=v.result;return this.scheduler?this.scheduler.add((()=>{m(w,C)}),a):m(w,C),()=>{}}return v.callbacks.push(m),v.cancel||(v.cancel=d(((w,C)=>{v.result=[w,C];for(const I of v.callbacks)this.scheduler?this.scheduler.add((()=>{I(w,C)}),a):I(w,C);setTimeout((()=>delete this.entries[r]),3e3)}))),()=>{v.result||(v.callbacks=v.callbacks.filter((w=>w!==m)),v.callbacks.length||(v.cancel(),delete this.entries[r]))}}}function jM(s,r,a){const d=JSON.stringify(s.request);return s.data&&(this.deduped.entries[d]={result:[null,s.data]}),this.deduped.request(d,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom},(m=>{const v=Gi(s.request,((w,C,I,P)=>{w?m(w):C&&m(null,{vectorTile:a?void 0:new Kv(new wf(C)),rawData:C,cacheControl:I,expires:P})}));return()=>{v.cancel(),m()}}),r)}const $M=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class KE{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,d]=new Uint8Array(r,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=d>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const v=$M[15&d];if(!v)throw new Error("Unrecognized array type.");const[w]=new Uint16Array(r,2,1),[C]=new Uint32Array(r,4,1);return new KE(C,w,v,r)}constructor(r,a=64,d=Float64Array,m){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=d,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const v=$M.indexOf(this.ArrayType),w=2*r*this.ArrayType.BYTES_PER_ELEMENT,C=r*this.IndexArrayType.BYTES_PER_ELEMENT,I=(8-C%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${d}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+C+I,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+w+C+I),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+C+I,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=r)}add(r,a){const d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=r,this.coords[this._pos++]=a,d}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return YE(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,a,d,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:w,nodeSize:C}=this,I=[0,v.length-1,0],P=[];for(;I.length;){const B=I.pop()||0,F=I.pop()||0,$=I.pop()||0;if(F-$<=C){for(let _e=$;_e<=F;_e++){const Re=w[2*_e],Be=w[2*_e+1];Re>=r&&Re<=d&&Be>=a&&Be<=m&&P.push(v[_e])}continue}const X=$+F>>1,J=w[2*X],oe=w[2*X+1];J>=r&&J<=d&&oe>=a&&oe<=m&&P.push(v[X]),(B===0?r<=J:a<=oe)&&(I.push($),I.push(X-1),I.push(1-B)),(B===0?d>=J:m>=oe)&&(I.push(X+1),I.push(F),I.push(1-B))}return P}within(r,a,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:v,nodeSize:w}=this,C=[0,m.length-1,0],I=[],P=d*d;for(;C.length;){const B=C.pop()||0,F=C.pop()||0,$=C.pop()||0;if(F-$<=w){for(let _e=$;_e<=F;_e++)GM(v[2*_e],v[2*_e+1],r,a)<=P&&I.push(m[_e]);continue}const X=$+F>>1,J=v[2*X],oe=v[2*X+1];GM(J,oe,r,a)<=P&&I.push(m[X]),(B===0?r-d<=J:a-d<=oe)&&(C.push($),C.push(X-1),C.push(1-B)),(B===0?r+d>=J:a+d>=oe)&&(C.push(X+1),C.push(F),C.push(1-B))}return I}}function YE(s,r,a,d,m,v){if(m-d<=a)return;const w=d+m>>1;qM(s,r,w,d,m,v),YE(s,r,a,d,w-1,1-v),YE(s,r,a,w+1,m,1-v)}function qM(s,r,a,d,m,v){for(;m>d;){if(m-d>600){const P=m-d+1,B=a-d+1,F=Math.log(P),$=.5*Math.exp(2*F/3),X=.5*Math.sqrt(F*$*(P-$)/P)*(B-P/2<0?-1:1);qM(s,r,a,Math.max(d,Math.floor(a-B*$/P+X)),Math.min(m,Math.floor(a+(P-B)*$/P+X)),v)}const w=r[2*a+v];let C=d,I=m;for(I0(s,r,d,a),r[2*m+v]>w&&I0(s,r,d,m);C<I;){for(I0(s,r,C,I),C++,I--;r[2*C+v]<w;)C++;for(;r[2*I+v]>w;)I--}r[2*d+v]===w?I0(s,r,d,I):(I++,I0(s,r,I,m)),I<=a&&(d=I+1),a<=I&&(m=I-1)}}function I0(s,r,a,d){QE(s,a,d),QE(r,2*a,2*d),QE(r,2*a+1,2*d+1)}function QE(s,r,a){const d=s[r];s[r]=s[a],s[a]=d}function GM(s,r,a,d){const m=s-a,v=r-d;return m*m+v*v}o.ARRAY_TYPE=da,o.AUTH_ERR_MSG=Ve,o.Aabb=lo,o.Actor=class{constructor(s,r,a){this.target=s,this.parent=r,this.mapId=a,this.callbacks={},this.cancelCallbacks={},Wt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=En()?s:S,this.scheduler=new IV}send(s,r,a,d,m=!1,v){const w=Math.round(1e18*Math.random()).toString(36).substring(0,10);a&&(a.metadata=v,this.callbacks[w]=a);const C=mn(this.globalScope)?void 0:[];return this.target.postMessage({id:w,type:s,hasCallback:!!a,targetMapId:d,mustQueue:m,sourceMapId:this.mapId,data:ul(r,C)},C),{cancel:()=>{a&&delete this.callbacks[w],this.target.postMessage({id:w,type:"<cancel>",targetMapId:d,sourceMapId:this.mapId})}}}receive(s){const r=s.data,a=r.id;if(a&&(!r.targetMapId||this.mapId===r.targetMapId))if(r.type==="<cancel>"){const d=this.cancelCallbacks[a];delete this.cancelCallbacks[a],d&&d.cancel()}else if(r.mustQueue||En()){const d=this.callbacks[a];this.cancelCallbacks[a]=this.scheduler.add((()=>this.processTask(a,r)),d&&d.metadata||{type:"message"})}else this.processTask(a,r)}processTask(s,r){if(r.type==="<response>"){const a=this.callbacks[s];delete this.callbacks[s],a&&(r.error?a(Vu(r.error)):a(null,Vu(r.data)))}else{const a=mn(this.globalScope)?void 0:[],d=r.hasCallback?(v,w)=>{delete this.cancelCallbacks[s],this.target.postMessage({id:s,type:"<response>",sourceMapId:this.mapId,error:v?ul(v):null,data:ul(w,a)},a)}:v=>{},m=Vu(r.data);if(this.parent[r.type])this.parent[r.type](r.sourceMapId,m,d);else if(this.parent.getWorkerSource){const v=r.type.split(".");this.parent.getWorkerSource(r.sourceMapId,v[0],m.source)[v[1]](m,d)}else d(new Error(`Could not find function ${r.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.CanonicalTileID=Dp,o.Color=Ti,o.ColorMode=cd,o.CullFaceMode=sh,o.DEMData=N1,o.DataConstantProperty=ne,o.DedupedRequest=UM,o.DepthMode=Zy,o.EXTENT=Dn,o.Elevation=class{isDataAvailableAtPoint(s){const r=this._source();if(this.isUsingMockSource()||!r||s.y<0||s.y>1)return!1;const a=r.getSource().maxzoom,d=1<<a,m=Math.floor(s.x),v=Math.floor((s.x-m)*d),w=Math.floor(s.y*d),C=this.findDEMTileFor(new Yo(a,m,a,v,w));return!(!C||!C.dem)}getAtPointOrZero(s,r=0){return this.getAtPoint(s,r)||0}getAtPoint(s,r,a=!0){if(this.isUsingMockSource())return null;r==null&&(r=null);const d=this._source();if(!d||s.y<0||s.y>1)return r;const m=d.getSource().maxzoom,v=1<<m,w=Math.floor(s.x),C=s.x-w,I=new Yo(m,w,m,Math.floor(C*v),Math.floor(s.y*v)),P=this.findDEMTileFor(I);if(!P||!P.dem)return r;const B=P.dem,F=1<<P.tileID.canonical.z,$=(C*F-P.tileID.canonical.x)*B.dim,X=(s.y*F-P.tileID.canonical.y)*B.dim,J=Math.floor($),oe=Math.floor(X);return(a?this.exaggeration():1)*nr(nr(B.get(J,oe),B.get(J,oe+1),X-oe),nr(B.get(J+1,oe),B.get(J+1,oe+1),X-oe),$-J)}getAtTileOffset(s,r,a){const d=1<<s.canonical.z;return this.getAtPointOrZero(new Di(s.wrap+(s.canonical.x+r/Dn)/d,(s.canonical.y+a/Dn)/d))}getAtTileOffsetFunc(s,r,a,d){return m=>{const v=this.getAtTileOffset(s,m.x,m.y),w=d.upVector(s.canonical,m.x,m.y);return fa(w,w,v*d.upVectorScale(s.canonical,r,a).metersToTile),w}}getForTilePoints(s,r,a,d){if(this.isUsingMockSource())return!1;const m=V1.create(this,s,d);return!!m&&(r.forEach((v=>{v[2]=this.exaggeration()*m.getElevationAt(v[0],v[1],a)})),!0)}getMinMaxForTile(s){if(this.isUsingMockSource())return null;const r=this.findDEMTileFor(s);if(!r||!r.dem)return null;const a=r.dem.tree,d=r.tileID,m=1<<s.canonical.z-d.canonical.z;let v=s.canonical.x/m-d.canonical.x,w=s.canonical.y/m-d.canonical.y,C=0;for(let I=0;I<s.canonical.z-d.canonical.z&&!a.leaves[C];I++){v*=2,w*=2;const P=2*Math.floor(w)+Math.floor(v);C=a.childOffsets[C]+P,v%=1,w%=1}return{min:this.exaggeration()*a.minimums[C],max:this.exaggeration()*a.maximums[C]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(s,r,a){throw new Error("Pure virtual method called.")}pointCoordinate(s){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(s){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},o.ErrorEvent=ta,o.EvaluationParameters=V,o.Event=tl,o.Evented=Wl,o.FillExtrusionBucket=qa,o.Frustum=_p,o.FrustumCorners=Pv,o.GLOBE_RADIUS=cc,o.GLOBE_SCALE_MATCH_LATITUDE=45,o.GLOBE_ZOOM_THRESHOLD_MAX=kv,o.GLOBE_ZOOM_THRESHOLD_MIN=gy,o.GlobeSharedBuffers=class{constructor(s){this._createGrid(s),this._createPoles(s)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const s of this._poleSegments)s.destroy();for(const s of this._gridSegments)s.withSkirts.destroy(),s.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const s of this._wireframeSegments)s.destroy()}}_fillGridMeshWithLods(s,r){const a=new Vt,d=new Tn,m=[],v=s+1+2,w=r[0]+1,C=r[0]+1+(1+r.length),I=(P,B,F)=>{let $=P===v-1?P-2:P===0?P:P-1;return $+=F?24575:0,[$,B]};for(let P=0;P<v;++P)a.emplaceBack(...I(P,0,!0));for(let P=0;P<w;++P)for(let B=0;B<v;++B)a.emplaceBack(...I(B,P,(B===0||B===v-1)&&!0));for(let P=0;P<r.length;++P){const B=r[P];for(let F=0;F<v;++F)a.emplaceBack(...I(F,B,!0))}for(let P=0;P<r.length;++P){const B=d.length,F=r[P]+1+2,$=new Tn;for(let oe=0;oe<F-1;oe++){const _e=oe===F-2,Re=_e?v*(C-r.length+P-oe):v;for(let Be=0;Be<v-1;Be++){const Pe=oe*v+Be;oe===0||_e||Be===0||Be===v-2?($.emplaceBack(Pe+1,Pe,Pe+Re),$.emplaceBack(Pe+Re,Pe+Re+1,Pe+1)):(d.emplaceBack(Pe+1,Pe,Pe+Re),d.emplaceBack(Pe+Re,Pe+Re+1,Pe+1))}}const X=os.simpleSegment(0,B,a.length,d.length-B);for(let oe=0;oe<$.uint16.length;oe+=3)d.emplaceBack($.uint16[oe],$.uint16[oe+1],$.uint16[oe+2]);const J=os.simpleSegment(0,B,a.length,d.length-B);m.push({withoutSkirts:X,withSkirts:J})}return{vertices:a,indices:d,segments:m}}_createGrid(s){const r=this._fillGridMeshWithLods(Xu,of);this._gridSegments=r.segments,this._gridBuffer=s.createVertexBuffer(r.vertices,jh.members),this._gridIndexBuffer=s.createIndexBuffer(r.indices,!0)}_createPoles(s){const r=new Tn;for(let m=0;m<=Xu;m++)r.emplaceBack(0,m+1,m+2);this._poleIndexBuffer=s.createIndexBuffer(r,!0);const a=new Vr,d=new Vr;this._poleSegments=[];for(let m=0,v=0;m<gy;m++){const w=360/(1<<m);a.emplaceBack(0,-cc,0,.5,0),d.emplaceBack(0,-cc,0,.5,1);for(let C=0;C<=Xu;C++){const I=C/Xu,P=nr(0,w,I),[B,F,$]=Yu(Ub,Nv,P,cc);a.emplaceBack(B,F,$,I,0),d.emplaceBack(B,F,$,I,1)}this._poleSegments.push(os.simpleSegment(v,0,66,64)),v+=66}this._poleNorthVertexBuffer=s.createVertexBuffer(a,yp,!1),this._poleSouthVertexBuffer=s.createVertexBuffer(d,yp,!1)}getGridBuffers(s,r){return[this._gridBuffer,this._gridIndexBuffer,r?this._gridSegments[s].withSkirts:this._gridSegments[s].withoutSkirts]}getPoleBuffers(s){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[s]]}getWirefameBuffers(s,r){if(!this._wireframeSegments){const a=new kr,d=Xu,m=d+1+2,v=1;this._wireframeSegments=[];for(let w=0,C=0;w<of.length;w++){const I=of[w];for(let B=v;B<I+v;B++)for(let F=v;F<d+v;F++){const $=B*m+F;a.emplaceBack($,$+1),a.emplaceBack($,$+m),a.emplaceBack($,$+m+1)}const P=I*d*3;this._wireframeSegments.push(os.simpleSegment(0,C,(I+1)*m,P)),C+=P}this._wireframeIndexBuffer=s.createIndexBuffer(a)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[r]]}},o.GlyphManager=Sf,o.ImagePosition=_0,o.KDBush=KE,o.LivePerformanceUtils=wl,o.LngLat=Yr,o.LngLatBounds=Hu,o.LocalGlyphMode=jy,o.MAX_MERCATOR_LATITUDE=Ws,o.MercatorCoordinate=Di,o.ONE_EM=Zs,o.OverscaledTileID=Yo,o.PerformanceMarkers=Hl,o.Point=se,o.Properties=Le,o.RGBAImage=vs,o.Ray=my,o.RequestManager=class{constructor(s,r,a){this._transformRequestFn=s,this._customAccessToken=r,this._silenceAuthErrors=!!a,this._createSkuToken()}_createSkuToken(){const s=(function(){let r="";for(let a=0;a<10;a++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ue,r].join(""),tokenExpiresAt:Date.now()+432e5}})();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(s,r){return this._transformRequestFn&&this._transformRequestFn(s,r)||{url:s}}normalizeStyleURL(s,r){if(!Ge(s))return s;const a=en(s);return a.path=`/styles/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||r)}normalizeGlyphsURL(s,r){if(!Ge(s))return s;const a=en(s);return a.path=`/fonts/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||r)}normalizeSourceURL(s,r,a,d){if(!Ge(s))return s;const m=en(s);return m.path=`/v4/${m.authority}.json`,m.params.push("secure"),a&&m.params.push(`language=${a}`),d&&m.params.push(`worldview=${d}`),this._makeAPIURL(m,this._customAccessToken||r)}normalizeSpriteURL(s,r,a,d){const m=en(s);return Ge(s)?(m.path=`/styles/v1${m.path}/sprite${r}${a}`,this._makeAPIURL(m,this._customAccessToken||d)):(m.path+=`${r}${a}`,jt(m))}normalizeTileURL(s,r,a){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!Ge(s))return s;const d=en(s);d.path=d.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${r||a&&d.authority!=="raster"&&a===512?"@2x":""}${j.supported?".webp":"$1"}`),d.authority==="raster"?d.path=`/${N.RASTER_URL_PREFIX}${d.path}`:(d.path=d.path.replace(/^.+\/v4\//,"/"),d.path=`/${N.TILE_URL_VERSION}${d.path}`);const m=this._customAccessToken||(function(v){for(const w of v){const C=w.match(/^access_token=(.*)$/);if(C)return C[1]}return null})(d.params)||N.ACCESS_TOKEN;return N.REQUIRE_ACCESS_TOKEN&&m&&this._skuToken&&d.params.push(`sku=${this._skuToken}`),this._makeAPIURL(d,m)}canonicalizeTileURL(s,r){const a=en(s);if(!a.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!a.path.match(/\.[\w]+$/))return s;let d="mapbox://";a.path.match(/^\/raster\/v1\//)?d+=`raster/${a.path.replace(`/${N.RASTER_URL_PREFIX}/`,"")}`:d+=`tiles/${a.path.replace(`/${N.TILE_URL_VERSION}/`,"")}`;let m=a.params;return r&&(m=m.filter((v=>!v.match(/^access_token=/)))),m.length&&(d+=`?${m.join("&")}`),d}canonicalizeTileset(s,r){const a=!!r&&Ge(r),d=[];for(const m of s.tiles||[])nt(m)?d.push(this.canonicalizeTileURL(m,a)):d.push(m);return d}_makeAPIURL(s,r){const a="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",d=en(N.API_URL);if(s.protocol=d.protocol,s.authority=d.authority,s.protocol==="http"){const m=s.params.indexOf("secure");m>=0&&s.params.splice(m,1)}if(d.path!=="/"&&(s.path=`${d.path}${s.path}`),!N.REQUIRE_ACCESS_TOKEN)return jt(s);if(r=r||N.ACCESS_TOKEN,!this._silenceAuthErrors){if(!r)throw new Error(`An API access token is required to use Mapbox GL. ${a}`);if(r[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${a}`)}return s.params=s.params.filter((m=>m.indexOf("access_token")===-1)),s.params.push(`access_token=${r||""}`),jt(s)}},o.ResourceType=_r,o.SegmentVector=os,o.SourceCache=dg,o.StencilMode=HE,o.StructArrayLayout1ui2=Zo,o.StructArrayLayout2f1f2i16=hn,o.StructArrayLayout2i4=Vt,o.StructArrayLayout2ui4=kr,o.StructArrayLayout3f12=ar,o.StructArrayLayout3ui6=Tn,o.StructArrayLayout4i8=_t,o.StructArrayLayout5f20=Vr,o.Texture=C0,o.Tile=qE,o.Transitionable=te,o.Uniform1f=Um,o.Uniform1i=class extends $u{constructor(s){super(s),this.current=0}set(s,r,a){this.fetchUniformLocation(s,r)&&this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},o.Uniform2f=class extends $u{constructor(s){super(s),this.current=[0,0]}set(s,r,a){this.fetchUniformLocation(s,r)&&(a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1])))}},o.Uniform3f=class extends $u{constructor(s){super(s),this.current=[0,0,0]}set(s,r,a){this.fetchUniformLocation(s,r)&&(a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2])))}},o.Uniform4f=yv,o.UniformColor=_v,o.UniformMatrix2f=class extends $u{constructor(s){super(s),this.current=Rb}set(s,r,a){if(this.fetchUniformLocation(s,r)){for(let d=0;d<4;d++)if(a[d]!==this.current[d]){this.current=a,this.gl.uniformMatrix2fv(this.location,!1,a);break}}}},o.UniformMatrix3f=class extends $u{constructor(s){super(s),this.current=Ib}set(s,r,a){if(this.fetchUniformLocation(s,r)){for(let d=0;d<9;d++)if(a[d]!==this.current[d]){this.current=a,this.gl.uniformMatrix3fv(this.location,!1,a);break}}}},o.UniformMatrix4f=class extends $u{constructor(s){super(s),this.current=vv}set(s,r,a){if(this.fetchUniformLocation(s,r)){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let d=1;d<16;d++)if(a[d]!==this.current[d]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}}},o.UnwrappedTileID=zy,o.ValidationError=rn,o.VectorTileFeature=Ly,o.VectorTileWorkerSource=class extends Wl{constructor(s,r,a,d,m){super(),this.actor=s,this.layerIndex=r,this.availableImages=a,this.loadVectorData=m||jM,this.loading={},this.loaded={},this.deduped=new UM(s.scheduler),this.isSpriteLoaded=d,this.scheduler=s.scheduler}loadTile(s,r){const a=s.uid,d=s&&s.request,m=d&&d.collectResourceTiming,v=this.loading[a]=new OV(s);v.abort=this.loadVectorData(s,((w,C)=>{const I=!this.loading[a];if(delete this.loading[a],I||w||!C)return v.status="done",I||(this.loaded[a]=v),r(w);const P=C.rawData,B={};C.expires&&(B.expires=C.expires),C.cacheControl&&(B.cacheControl=C.cacheControl),v.vectorTile=C.vectorTile||new Kv(new wf(P));const F=()=>{v.parse(v.vectorTile,this.layerIndex,this.availableImages,this.actor,(($,X)=>{if($||!X)return r($);const J={};if(m){const oe=Uo(d);oe.length>0&&(J.resourceTiming=JSON.parse(JSON.stringify(oe)))}r(null,wt({rawTileData:P.slice(0)},X,B,J))}))};this.isSpriteLoaded?F():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(F,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom}):F()})),this.loaded=this.loaded||{},this.loaded[a]=v}))}reloadTile(s,r){const a=this.loaded,d=s.uid,m=this;if(a&&a[d]){const v=a[d];v.showCollisionBoxes=s.showCollisionBoxes,v.enableTerrain=!!s.enableTerrain,v.projection=s.projection,v.tileTransform=tu(s.tileID.canonical,s.projection);const w=(C,I)=>{const P=v.reloadCallback;P&&(delete v.reloadCallback,v.parse(v.vectorTile,m.layerIndex,this.availableImages,m.actor,P)),r(C,I)};v.status==="parsing"?v.reloadCallback=w:v.status==="done"&&(v.vectorTile?v.parse(v.vectorTile,this.layerIndex,this.availableImages,this.actor,w):w())}}abortTile(s,r){const a=s.uid,d=this.loading[a];d&&(d.abort&&d.abort(),delete this.loading[a]),r()}removeTile(s,r){const a=this.loaded,d=s.uid;a&&a[d]&&delete a[d],r()}},o.WritingMode=_l,o.ZoomDependentExpression=zu,o.add=fl,o.addDynamicAttributes=wi,o.adjoint=function(s,r){var a=r[0],d=r[1],m=r[2],v=r[3],w=r[4],C=r[5],I=r[6],P=r[7],B=r[8];return s[0]=w*B-C*P,s[1]=m*P-d*B,s[2]=d*C-m*w,s[3]=C*I-v*B,s[4]=a*B-m*I,s[5]=m*v-a*C,s[6]=v*P-w*I,s[7]=d*I-a*P,s[8]=a*w-d*v,s},o.asyncAll=tt,o.bezier=Je,o.bindAll=Wt,o.boundsAttributes=EM,o.bufferConvexPolygon=function(s,r){const a=[];for(let d=0;d<s.length;d++){const m=De(d-1,-1,s.length-1),v=De(d+1,-1,s.length-1),w=s[d],C=s[v],I=s[m].sub(w).unit(),P=C.sub(w).unit(),B=P.angleWithSep(I.x,I.y),F=I.add(P).unit().mult(-1*r/Math.sin(B/2));a.push(w.add(F))}return a},o.cacheEntryPossiblyAdded=function(s){tr++,tr>yn&&(s.getActor().send("enforceCacheSizeLimit",Jt),tr=0)},o.calculateGlobeLabelMatrix=function(s,r){const{x:a,y:d}=s.point,m=Qu(a,d,s.worldSize/s._pixelsPerMercatorPixel,0,0);return Vh(m,m,af(co(r)))},o.calculateGlobeMatrix=function(s){const{x:r,y:a}=s.point,{lng:d,lat:m}=s._center;return Qu(r,a,s.worldSize,d,m)},o.calculateGlobeMercatorMatrix=function(s){const r=s.pixelsPerMeter,a=r/ml(1,s.center.lat),d=dl(new Float64Array(16));return nf(d,d,[s.point.x,s.point.y,0]),Fh(d,d,[a,a,r]),Float32Array.from(d)},o.circumferenceAtLatitude=wy,o.clamp=et,o.clearTileCache=function(s){if(!Bn())return;const r=S.caches.delete(on);s&&r.catch(s).then((()=>s()))},o.clipLine=og,o.clone=function(s){var r=new da(16);return r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=s[3],r[4]=s[4],r[5]=s[5],r[6]=s[6],r[7]=s[7],r[8]=s[8],r[9]=s[9],r[10]=s[10],r[11]=s[11],r[12]=s[12],r[13]=s[13],r[14]=s[14],r[15]=s[15],r},o.clone$1=ln,o.collisionCircleLayout=y1,o.config=N,o.conjugate=function(s,r){return s[0]=-r[0],s[1]=-r[1],s[2]=-r[2],s[3]=r[3],s},o.create=function(){var s=new da(16);return da!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},o.create$1=Tv,o.createExpression=tc,o.createLayout=Ye,o.createStyleLayer=function(s){return s.type==="custom"?new od(s):new CV[s.type](s)},o.cross=py,o.degToRad=le,o.distance=function(s,r){return Math.hypot(r[0]-s[0],r[1]-s[1],r[2]-s[2])},o.div=function(s,r,a){return s[0]=r[0]/a[0],s[1]=r[1]/a[1],s[2]=r[2]/a[2],s},o.dot=oo,o.earthRadius=wp,o.ease=dt,o.easeCubicInOut=Ie,o.ecefToLatLng=function([s,r,a]){const d=Math.hypot(s,r,a),m=Math.atan2(s,a),v=.5*Math.PI-Math.acos(-r/d);return new Yr(Ne(m),Ne(v))},o.emitValidationErrors=iy,o.endsWith=vn,o.enforceCacheSizeLimit=function(s){Nn(),_n&&_n.then((r=>{r.keys().then((a=>{for(let d=0;d<a.length-s;d++)r.delete(a[d])}))}))},o.evaluateSizeForFeature=vf,o.evaluateSizeForZoom=xf,o.evaluateVariableOffset=nh,o.evented=E,o.exactEquals=function(s,r){return s[0]===r[0]&&s[1]===r[1]&&s[2]===r[2]&&s[3]===r[3]},o.exactEquals$1=function(s,r){return s[0]===r[0]&&s[1]===r[1]&&s[2]===r[2]},o.exported=ea,o.exported$1=j,o.extend=wt,o.extend$1=$o,o.fillExtrusionHeightLift=a1,o.filterObject=Cn,o.fromMat4=function(s,r){return s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[4],s[4]=r[5],s[5]=r[6],s[6]=r[8],s[7]=r[9],s[8]=r[10],s},o.fromQuat=function(s,r){var a=r[0],d=r[1],m=r[2],v=r[3],w=a+a,C=d+d,I=m+m,P=a*w,B=d*w,F=d*C,$=m*w,X=m*C,J=m*I,oe=v*w,_e=v*C,Re=v*I;return s[0]=1-F-J,s[1]=B+Re,s[2]=$-_e,s[3]=0,s[4]=B-Re,s[5]=1-P-J,s[6]=X+oe,s[7]=0,s[8]=$+_e,s[9]=X-oe,s[10]=1-P-F,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},o.fromRotation=function(s,r){var a=Math.sin(r),d=Math.cos(r);return s[0]=d,s[1]=a,s[2]=0,s[3]=-a,s[4]=d,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},o.fromScaling=Lb,o.furthestTileCorner=function(s){const r=Math.round((s+45+360)%360/90)%4;return Ze[r]},o.getAABBPointSquareDist=function(s,r,a){let d=0;for(let m=0;m<2;++m){const v=a?a[m]:0;s[m]>v&&(d+=(s[m]-v)*(s[m]-v)),r[m]<v&&(d+=(v-r[m])*(v-r[m]))}return d},o.getAnchorAlignment=ig,o.getAnchorJustification=Rf,o.getBounds=function(s){let r=1/0,a=1/0,d=-1/0,m=-1/0;for(const v of s)r=Math.min(r,v.x),a=Math.min(a,v.y),d=Math.max(d,v.x),m=Math.max(m,v.y);return{min:new se(r,a),max:new se(d,m)}},o.getColumn=Xn,o.getDefaultExportFromCjs=pe,o.getGridMatrix=function(s,r,a,d){const m=r.getNorth(),v=r.getSouth(),w=r.getWest(),C=r.getEast(),I=1<<s.z,P=C-w,B=m-v,F=P/Xu,$=-B/of[a],X=[0,F,0,$,0,0,m,w,0];if(s.z>0){const J=180/d;Db(X,X,[J/P+1,0,0,0,J/B+1,0,-.5*J/F,.5*J/$,1])}return X[2]=I,X[5]=s.x,X[8]=s.y,X},o.getImage=Me,o.getJSON=function(s,r){return jr(wt(s,{type:"json"}),r)},o.getLatitudinalLod=function(s){const r=Ws-5;s=et(s,-r,r)/r*90;const a=Math.pow(Math.abs(Math.sin(le(s))),3);return Math.round(a*(of.length-1))},o.getMapSessionAPI=gs,o.getPerformanceMeasurement=Uo,o.getProjection=Ft,o.getRTLTextPluginStatus=A,o.getReferrer=$n,o.getTilePoint=function(s,{x:r,y:a},d=0){return new se(((r-d)*s.scale-s.x)*Dn,(a*s.scale-s.y)*Dn)},o.getTileVec3=function(s,r,a=0){return rf(((r.x-a)*s.scale-s.x)*Dn,(r.y*s.scale-s.y)*Dn,jb(r.z,r.y))},o.getVideo=function(s,r){const a=S.document.createElement("video");a.muted=!0,a.onloadstart=function(){r(null,a)};for(let d=0;d<s.length;d++){const m=S.document.createElement("source");eo(s[d])||(a.crossOrigin="Anonymous"),m.src=s[d],a.appendChild(m)}return{cancel:()=>{}}},o.globeCenterToScreenPoint=function(s){const r=[0,0,0],a=dl(new Float64Array(16));return Vh(a,s.pixelMatrix,s.globeMatrix),as(r,r,a),new se(r[0],r[1])},o.globeDenormalizeECEF=af,o.globeECEFOrigin=function(s,r){const a=[0,0,0];return as(a,a,bp(co(r.canonical))),as(a,a,s),a},o.globeMetersToEcef=vp,o.globeNormalizeECEF=bp,o.globePixelsToTileUnits=function(s,r){return Dn/(512*Math.pow(2,s))*xy(co(r))},o.globePoleMatrixForTile=function(s,r,a){const d=dl(new Float64Array(16)),m=(r/(1<<s)-.5)*Math.PI*2;return hy(d,a.globeMatrix,m),Float32Array.from(d)},o.globeTileBounds=co,o.globeTiltAtLngLat=Bv,o.globeToMercatorTransition=lf,o.globeUseCustomAntiAliasing=function(s,r,a){const d=lf(a.zoom),m=s.style.map._antialias,v=!!r.extStandardDerivatives,w=r.extStandardDerivativesForceOff||s.terrain&&s.terrain.exaggeration()>0;return d===0&&!m&&!w&&v},o.identity=dl,o.identity$1=ao,o.invert=cy,o.isFullscreen=function(){return!!S.document.fullscreenElement||!!S.document.webkitFullscreenElement},o.isLngLatBehindGlobe=cf,o.isMapAuthenticated=function(s){return ks.has(s)},o.isMapboxURL=Ge,o.isSafariWithAntialiasingBug=function(s){const r=s.navigator?s.navigator.userAgent:null;return!!mn(s)&&r&&(r.match("Version/15.4")||r.match("Version/15.5")||r.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.latFromMercatorY=Qr,o.latLngToECEF=Gc,o.len=Ob,o.length=pp,o.length$1=function(s){return Math.hypot(s[0],s[1],s[2],s[3])},o.lngFromMercatorX=Ua,o.loadVectorTile=jM,o.makeRequest=jr,o.mapValue=function(s,r,a,d,m){return et((s-r)/(a-r)*(m-d)+d,d,m)},o.mercatorScale=Vv,o.mercatorXfromLng=uo,o.mercatorYfromLat=ki,o.mercatorZfromAltitude=ml,o.mul=jm,o.mul$1=Cv,o.multiply=Vh,o.multiply$1=Db,o.multiply$2=fy,o.nextPowerOfTwo=At,o.normalize=Po,o.normalize$1=Bb,o.normalize$2=zb,o.number=nr,o.ortho=function(s,r,a,d,m,v,w){var C=1/(r-a),I=1/(d-m),P=1/(v-w);return s[0]=-2*C,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*I,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*P,s[11]=0,s[12]=(r+a)*C,s[13]=(m+d)*I,s[14]=(w+v)*P,s[15]=1,s},o.pbf=x1,o.perspective=function(s,r,a,d,m){var v,w=1/Math.tan(r/2);return s[0]=w/a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=w,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,m!=null&&m!==1/0?(s[10]=(m+d)*(v=1/(d-m)),s[14]=2*m*d*v):(s[10]=-1,s[14]=-2*d),s},o.pick=function(s,r){const a={};for(let d=0;d<r.length;d++){const m=r[d];m in s&&(a[m]=s[m])}return a},o.plugin=L,o.pointGeometry=re,o.polesInViewport=function(s){const r=dl(new Float64Array(16));Vh(r,s.pixelMatrix,s.globeMatrix);const a=[0,pl,0],d=[0,Fa,0];return as(a,a,r),as(d,d,r),[a[0]>0&&a[0]<=s.width&&a[1]>0&&a[1]<=s.height&&!cf(s,new Yr(s.center.lat,90)),d[0]>0&&d[0]<=s.width&&d[1]>0&&d[1]<=s.height&&!cf(s,new Yr(s.center.lat,-90))]},o.polygonContainsPoint=dc,o.polygonIntersectsBox=df,o.polygonIntersectsPolygon=Xc,o.polygonizeBounds=function(s,r,a=0,d=!0){const m=new se(a,a),v=s.sub(m),w=r.add(m),C=[v,new se(w.x,v.y),w,new se(v.x,w.y)];return d&&C.push(v.clone()),C},o.posAttributes=jh,o.postMapLoadEvent=Cr,o.postPerformanceEvent=mi,o.postTurnstileEvent=er,o.potpack=y0,o.prevPowerOfTwo=function(s){return s<=1?1:Math.pow(2,Math.floor(Math.log(s)/Math.LN2))},o.radToDeg=Ne,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.registerForPluginStateChange=function(s){return s({pluginStatus:_,pluginURL:l}),E.on("pluginStateChange",s),s},o.removeAuthState=function(s){ks.delete(s)},o.renderColorRamp=Kc,o.resample=Wc,o.rotateX=uy,o.rotateX$1=Iv,o.rotateY=hy,o.rotateY$1=Rv,o.rotateZ=function(s,r,a){var d=Math.sin(a),m=Math.cos(a),v=r[0],w=r[1],C=r[2],I=r[3],P=r[4],B=r[5],F=r[6],$=r[7];return r!==s&&(s[8]=r[8],s[9]=r[9],s[10]=r[10],s[11]=r[11],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[0]=v*m+P*d,s[1]=w*m+B*d,s[2]=C*m+F*d,s[3]=I*m+$*d,s[4]=P*m-v*d,s[5]=B*m-w*d,s[6]=F*m-C*d,s[7]=$*m-I*d,s},o.rotateZ$1=function(s,r,a){a*=.5;var d=r[0],m=r[1],v=r[2],w=r[3],C=Math.sin(a),I=Math.cos(a);return s[0]=d*I+m*C,s[1]=m*I-d*C,s[2]=v*I+w*C,s[3]=w*I-v*C,s},o.scale=Fh,o.scale$1=Av,o.scale$2=fa,o.scaleAndAdd=gp,o.set=function(s,r,a,d){return s[0]=r,s[1]=a,s[2]=d,s},o.setCacheLimits=function(s,r){Jt=s,yn=r},o.setColumn=function(s,r,a){s[4*r+0]=a[0],s[4*r+1]=a[1],s[4*r+2]=a[2],s[4*r+3]=a[3]},o.setRTLTextPlugin=function(s,r,a=!1){if(_===Bh||_===Nh||_===hp)throw new Error("setRTLTextPlugin cannot be called multiple times.");l=ea.resolveURL(s),_=Bh,Fu=r,x(),a||D()},o.smoothstep=Kt,o.spec=vt,o.squaredLength=function(s){var r=s[0],a=s[1],d=s[2];return r*r+a*a+d*d},o.storeAuthState=function(s,r){r?ks.add(s):ks.delete(s)},o.sub=Ll,o.subtract=dy,o.symbolSize=_1,o.tileAABB=function(s,r,a,d,m,v,w,C,I){if(I.name==="globe")return Ku(s,r,new Dp(a,d,m));const P=tu({z:a,x:d,y:m},I);return new lo([(v+P.x/P.scale)*r,r*(P.y/P.scale),w],[(v+P.x2/P.scale)*r,r*(P.y2/P.scale),C])},o.tileCornersToBounds=xp,o.tileTransform=tu,o.transformMat3=function(s,r,a){var d=r[0],m=r[1],v=r[2];return s[0]=d*a[0]+m*a[3]+v*a[6],s[1]=d*a[1]+m*a[4]+v*a[7],s[2]=d*a[2]+m*a[5]+v*a[8],s},o.transformMat4=as,o.transformMat4$1=Wu,o.transformQuat=Sv,o.transitionTileAABBinECEF=Vb,o.translate=nf,o.transpose=function(s,r){if(s===r){var a=r[1],d=r[2],m=r[5];s[1]=r[3],s[2]=r[6],s[3]=a,s[5]=r[7],s[6]=d,s[7]=m}else s[0]=r[0],s[1]=r[3],s[2]=r[6],s[3]=r[1],s[4]=r[4],s[5]=r[7],s[6]=r[2],s[7]=r[5],s[8]=r[8];return s},o.triggerPluginCompletionEvent=p,o.uniqueId=Ut,o.updateGlobeVertexNormal=function(s,r,a,d,m){const v=5*r+2;s.float32[v+0]=a,s.float32[v+1]=d,s.float32[v+2]=m},o.validateCustomStyleLayer=function(s){const r=[],a=s.id;return a===void 0&&r.push({message:`layers.${a}: missing required property "id"`}),s.render===void 0&&r.push({message:`layers.${a}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&r.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),r},o.validateFilter=s=>ha(za(s)),o.validateFog=s=>ha(ap(s)),o.validateLayer=s=>ha(sp(s)),o.validateLight=s=>ha(oc(s)),o.validateSource=s=>ha(Vc(s)),o.validateStyle=Fc,o.validateTerrain=s=>ha(ll(s)),o.values=Et,o.vectorTile=Km,o.version=M,o.warnOnce=Rn,o.window=S,o.wrap=De})),g(["./shared"],(function(o){function S(Oe){if(typeof Oe=="number"||typeof Oe=="boolean"||typeof Oe=="string"||Oe==null)return JSON.stringify(Oe);if(Array.isArray(Oe)){let de="[";for(const Me of Oe)de+=`${S(Me)},`;return`${de}]`}let fe="{";for(const de of Object.keys(Oe).sort())fe+=`${de}:${S(Oe[de])},`;return`${fe}}`}function M(Oe){let fe="";for(const de of o.refProperties)fe+=`/${S(Oe[de])}`;return fe}class O{constructor(fe){this.keyCache={},fe&&this.replace(fe)}replace(fe){this._layerConfigs={},this._layers={},this.update(fe,[])}update(fe,de){for(const Ve of fe)this._layerConfigs[Ve.id]=Ve,(this._layers[Ve.id]=o.createStyleLayer(Ve)).compileFilter(),this.keyCache[Ve.id]&&delete this.keyCache[Ve.id];for(const Ve of de)delete this.keyCache[Ve],delete this._layerConfigs[Ve],delete this._layers[Ve];this.familiesBySource={};const Me=(function(Ve,Ge){const nt={};for(let $e=0;$e<Ve.length;$e++){const ct=Ge&&Ge[Ve[$e].id]||M(Ve[$e]);Ge&&(Ge[Ve[$e].id]=ct);let Xt=nt[ct];Xt||(Xt=nt[ct]=[]),Xt.push(Ve[$e])}const Xe=[];for(const $e in nt)Xe.push(nt[$e]);return Xe})(o.values(this._layerConfigs),this.keyCache);for(const Ve of Me){const Ge=Ve.map((en=>this._layers[en.id])),nt=Ge[0];if(nt.visibility==="none")continue;const Xe=nt.source||"";let $e=this.familiesBySource[Xe];$e||($e=this.familiesBySource[Xe]={});const ct=nt.sourceLayer||"_geojsonTileLayer";let Xt=$e[ct];Xt||(Xt=$e[ct]=[]),Xt.push(Ge)}}}class N{loadTile(fe,de){const{uid:Me,encoding:Ve,rawImageData:Ge,padding:nt,buildQuadTree:Xe}=fe,$e=o.window.ImageBitmap&&Ge instanceof o.window.ImageBitmap?this.getImageData(Ge,nt):Ge;de(null,new o.DEMData(Me,$e,Ve,nt<1,Xe))}getImageData(fe,de){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(fe.width,fe.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=fe.width,this.offscreenCanvas.height=fe.height,this.offscreenCanvasContext.drawImage(fe,0,0,fe.width,fe.height);const Me=this.offscreenCanvasContext.getImageData(-de,-de,fe.width+2*de,fe.height+2*de);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Me}}function j(Oe,fe){if(Oe.length!==0){Z(Oe[0],fe);for(var de=1;de<Oe.length;de++)Z(Oe[de],!fe)}}function Z(Oe,fe){for(var de=0,Me=0,Ve=0,Ge=Oe.length,nt=Ge-1;Ve<Ge;nt=Ve++){var Xe=(Oe[Ve][0]-Oe[nt][0])*(Oe[nt][1]+Oe[Ve][1]),$e=de+Xe;Me+=Math.abs(de)>=Math.abs(Xe)?de-$e+Xe:Xe-$e+de,de=$e}de+Me>=0!=!!fe&&Oe.reverse()}var K=o.getDefaultExportFromCjs((function Oe(fe,de){var Me,Ve=fe&&fe.type;if(Ve==="FeatureCollection")for(Me=0;Me<fe.features.length;Me++)Oe(fe.features[Me],de);else if(Ve==="GeometryCollection")for(Me=0;Me<fe.geometries.length;Me++)Oe(fe.geometries[Me],de);else if(Ve==="Feature")Oe(fe.geometry,de);else if(Ve==="Polygon")j(fe.coordinates,de);else if(Ve==="MultiPolygon")for(Me=0;Me<fe.coordinates.length;Me++)j(fe.coordinates[Me],de);return fe}));const Q=o.VectorTileFeature.prototype.toGeoJSON;var ce={exports:{}},ge=o.pointGeometry,ue=o.vectorTile.VectorTileFeature,pe=me;function me(Oe,fe){this.options=fe||{},this.features=Oe,this.length=Oe.length}function Te(Oe,fe){this.id=typeof Oe.id=="number"?Oe.id:void 0,this.type=Oe.type,this.rawGeometry=Oe.type===1?[Oe.geometry]:Oe.geometry,this.properties=Oe.tags,this.extent=fe||4096}me.prototype.feature=function(Oe){return new Te(this.features[Oe],this.options.extent)},Te.prototype.loadGeometry=function(){var Oe=this.rawGeometry;this.geometry=[];for(var fe=0;fe<Oe.length;fe++){for(var de=Oe[fe],Me=[],Ve=0;Ve<de.length;Ve++)Me.push(new ge(de[Ve][0],de[Ve][1]));this.geometry.push(Me)}return this.geometry},Te.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Oe=this.geometry,fe=1/0,de=-1/0,Me=1/0,Ve=-1/0,Ge=0;Ge<Oe.length;Ge++)for(var nt=Oe[Ge],Xe=0;Xe<nt.length;Xe++){var $e=nt[Xe];fe=Math.min(fe,$e.x),de=Math.max(de,$e.x),Me=Math.min(Me,$e.y),Ve=Math.max(Ve,$e.y)}return[fe,Me,de,Ve]},Te.prototype.toGeoJSON=ue.prototype.toGeoJSON;var ae=o.pbf,re=pe;function he(Oe){var fe=new ae;return(function(de,Me){for(var Ve in de.layers)Me.writeMessage(3,se,de.layers[Ve])})(Oe,fe),fe.finish()}function se(Oe,fe){var de;fe.writeVarintField(15,Oe.version||1),fe.writeStringField(1,Oe.name||""),fe.writeVarintField(5,Oe.extent||4096);var Me={keys:[],values:[],keycache:{},valuecache:{}};for(de=0;de<Oe.length;de++)Me.feature=Oe.feature(de),fe.writeMessage(2,ve,Me);var Ve=Me.keys;for(de=0;de<Ve.length;de++)fe.writeStringField(3,Ve[de]);var Ge=Me.values;for(de=0;de<Ge.length;de++)fe.writeMessage(4,Ie,Ge[de])}function ve(Oe,fe){var de=Oe.feature;de.id!==void 0&&fe.writeVarintField(1,de.id),fe.writeMessage(2,Y,Oe),fe.writeVarintField(3,de.type),fe.writeMessage(4,Ze,de)}function Y(Oe,fe){var de=Oe.feature,Me=Oe.keys,Ve=Oe.values,Ge=Oe.keycache,nt=Oe.valuecache;for(var Xe in de.properties){var $e=de.properties[Xe],ct=Ge[Xe];if($e!==null){ct===void 0&&(Me.push(Xe),Ge[Xe]=ct=Me.length-1),fe.writeVarint(ct);var Xt=typeof $e;Xt!=="string"&&Xt!=="boolean"&&Xt!=="number"&&($e=JSON.stringify($e));var en=Xt+":"+$e,jt=nt[en];jt===void 0&&(Ve.push($e),nt[en]=jt=Ve.length-1),fe.writeVarint(jt)}}}function le(Oe,fe){return(fe<<3)+(7&Oe)}function Ne(Oe){return Oe<<1^Oe>>31}function Ze(Oe,fe){for(var de=Oe.loadGeometry(),Me=Oe.type,Ve=0,Ge=0,nt=de.length,Xe=0;Xe<nt;Xe++){var $e=de[Xe],ct=1;Me===1&&(ct=$e.length),fe.writeVarint(le(1,ct));for(var Xt=Me===3?$e.length-1:$e.length,en=0;en<Xt;en++){en===1&&Me!==1&&fe.writeVarint(le(2,Xt-1));var jt=$e[en].x-Ve,Kn=$e[en].y-Ge;fe.writeVarint(Ne(jt)),fe.writeVarint(Ne(Kn)),Ve+=jt,Ge+=Kn}Me===3&&fe.writeVarint(le(7,1))}}function Ie(Oe,fe){var de=typeof Oe;de==="string"?fe.writeStringField(1,Oe):de==="boolean"?fe.writeBooleanField(7,Oe):de==="number"&&(Oe%1!=0?fe.writeDoubleField(3,Oe):Oe<0?fe.writeSVarintField(6,Oe):fe.writeVarintField(5,Oe))}ce.exports=he,ce.exports.fromVectorTileJs=he,ce.exports.fromGeojsonVt=function(Oe,fe){fe=fe||{};var de={};for(var Me in Oe)de[Me]=new re(Oe[Me].features,fe),de[Me].name=Me,de[Me].version=fe.version,de[Me].extent=fe.extent;return he({layers:de})},ce.exports.GeoJSONWrapper=re;var Je=o.getDefaultExportFromCjs(ce.exports);const dt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Oe=>Oe},et=Math.fround||(Kt=new Float32Array(1),Oe=>(Kt[0]=+Oe,Kt[0]));var Kt;const De=3,tt=5,Et=6;class wt{constructor(fe){this.options=Object.assign(Object.create(dt),fe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(fe){const{log:de,minZoom:Me,maxZoom:Ve}=this.options;de&&console.time("total time");const Ge=`prepare ${fe.length} points`;de&&console.time(Ge),this.points=fe;const nt=[];for(let $e=0;$e<fe.length;$e++){const ct=fe[$e];if(!ct.geometry)continue;const[Xt,en]=ct.geometry.coordinates,jt=et(an(Xt)),Kn=et(At(en));nt.push(jt,Kn,1/0,$e,-1,1),this.options.reduce&&nt.push(0)}let Xe=this.trees[Ve+1]=this._createTree(nt);de&&console.timeEnd(Ge);for(let $e=Ve;$e>=Me;$e--){const ct=+Date.now();Xe=this.trees[$e]=this._createTree(this._cluster(Xe,$e)),de&&console.log("z%d: %d clusters in %dms",$e,Xe.numItems,+Date.now()-ct)}return de&&console.timeEnd("total time"),this}getClusters(fe,de){let Me=((fe[0]+180)%360+360)%360-180;const Ve=Math.max(-90,Math.min(90,fe[1]));let Ge=fe[2]===180?180:((fe[2]+180)%360+360)%360-180;const nt=Math.max(-90,Math.min(90,fe[3]));if(fe[2]-fe[0]>=360)Me=-180,Ge=180;else if(Me>Ge){const en=this.getClusters([Me,Ve,180,nt],de),jt=this.getClusters([-180,Ve,Ge,nt],de);return en.concat(jt)}const Xe=this.trees[this._limitZoom(de)],$e=Xe.range(an(Me),At(nt),an(Ge),At(Ve)),ct=Xe.data,Xt=[];for(const en of $e){const jt=this.stride*en;Xt.push(ct[jt+tt]>1?Lt(ct,jt,this.clusterProps):this.points[ct[jt+De]])}return Xt}getChildren(fe){const de=this._getOriginId(fe),Me=this._getOriginZoom(fe),Ve="No cluster with the specified id.",Ge=this.trees[Me];if(!Ge)throw new Error(Ve);const nt=Ge.data;if(de*this.stride>=nt.length)throw new Error(Ve);const Xe=this.options.radius/(this.options.extent*Math.pow(2,Me-1)),$e=Ge.within(nt[de*this.stride],nt[de*this.stride+1],Xe),ct=[];for(const Xt of $e){const en=Xt*this.stride;nt[en+4]===fe&&ct.push(nt[en+tt]>1?Lt(nt,en,this.clusterProps):this.points[nt[en+De]])}if(ct.length===0)throw new Error(Ve);return ct}getLeaves(fe,de,Me){const Ve=[];return this._appendLeaves(Ve,fe,de=de||10,Me=Me||0,0),Ve}getTile(fe,de,Me){const Ve=this.trees[this._limitZoom(fe)],Ge=Math.pow(2,fe),{extent:nt,radius:Xe}=this.options,$e=Xe/nt,ct=(Me-$e)/Ge,Xt=(Me+1+$e)/Ge,en={features:[]};return this._addTileFeatures(Ve.range((de-$e)/Ge,ct,(de+1+$e)/Ge,Xt),Ve.data,de,Me,Ge,en),de===0&&this._addTileFeatures(Ve.range(1-$e/Ge,ct,1,Xt),Ve.data,Ge,Me,Ge,en),de===Ge-1&&this._addTileFeatures(Ve.range(0,ct,$e/Ge,Xt),Ve.data,-1,Me,Ge,en),en.features.length?en:null}getClusterExpansionZoom(fe){let de=this._getOriginZoom(fe)-1;for(;de<=this.options.maxZoom;){const Me=this.getChildren(fe);if(de++,Me.length!==1)break;fe=Me[0].properties.cluster_id}return de}_appendLeaves(fe,de,Me,Ve,Ge){const nt=this.getChildren(de);for(const Xe of nt){const $e=Xe.properties;if($e&&$e.cluster?Ge+$e.point_count<=Ve?Ge+=$e.point_count:Ge=this._appendLeaves(fe,$e.cluster_id,Me,Ve,Ge):Ge<Ve?Ge++:fe.push(Xe),fe.length===Me)break}return Ge}_createTree(fe){const de=new o.KDBush(fe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Me=0;Me<fe.length;Me+=this.stride)de.add(fe[Me],fe[Me+1]);return de.finish(),de.data=fe,de}_addTileFeatures(fe,de,Me,Ve,Ge,nt){for(const Xe of fe){const $e=Xe*this.stride,ct=de[$e+tt]>1;let Xt,en,jt;if(ct)Xt=Ut(de,$e,this.clusterProps),en=de[$e],jt=de[$e+1];else{const Hn=this.points[de[$e+De]];Xt=Hn.properties;const[ir,er]=Hn.geometry.coordinates;en=an(ir),jt=At(er)}const Kn={type:1,geometry:[[Math.round(this.options.extent*(en*Ge-Me)),Math.round(this.options.extent*(jt*Ge-Ve))]],tags:Xt};let Jn;Jn=ct||this.options.generateId?de[$e+De]:this.points[de[$e+De]].id,Jn!==void 0&&(Kn.id=Jn),nt.features.push(Kn)}}_limitZoom(fe){return Math.max(this.options.minZoom,Math.min(Math.floor(+fe),this.options.maxZoom+1))}_cluster(fe,de){const{radius:Me,extent:Ve,reduce:Ge,minPoints:nt}=this.options,Xe=Me/(Ve*Math.pow(2,de)),$e=fe.data,ct=[],Xt=this.stride;for(let en=0;en<$e.length;en+=Xt){if($e[en+2]<=de)continue;$e[en+2]=de;const jt=$e[en],Kn=$e[en+1],Jn=fe.within($e[en],$e[en+1],Xe),Hn=$e[en+tt];let ir=Hn;for(const er of Jn){const Nr=er*Xt;$e[Nr+2]>de&&(ir+=$e[Nr+tt])}if(ir>Hn&&ir>=nt){let er,Nr=jt*Hn,Cr=Kn*Hn,Xr=-1;const mi=((en/Xt|0)<<5)+(de+1)+this.points.length;for(const Eo of Jn){const gs=Eo*Xt;if($e[gs+2]<=de)continue;$e[gs+2]=de;const ks=$e[gs+tt];Nr+=$e[gs]*ks,Cr+=$e[gs+1]*ks,$e[gs+4]=mi,Ge&&(er||(er=this._map($e,en,!0),Xr=this.clusterProps.length,this.clusterProps.push(er)),Ge(er,this._map($e,gs)))}$e[en+4]=mi,ct.push(Nr/ir,Cr/ir,1/0,mi,-1,ir),Ge&&ct.push(Xr)}else{for(let er=0;er<Xt;er++)ct.push($e[en+er]);if(ir>1)for(const er of Jn){const Nr=er*Xt;if(!($e[Nr+2]<=de)){$e[Nr+2]=de;for(let Cr=0;Cr<Xt;Cr++)ct.push($e[Nr+Cr])}}}}return ct}_getOriginId(fe){return fe-this.points.length>>5}_getOriginZoom(fe){return(fe-this.points.length)%32}_map(fe,de,Me){if(fe[de+tt]>1){const nt=this.clusterProps[fe[de+Et]];return Me?Object.assign({},nt):nt}const Ve=this.points[fe[de+De]].properties,Ge=this.options.map(Ve);return Me&&Ge===Ve?Object.assign({},Ge):Ge}}function Lt(Oe,fe,de){return{type:"Feature",id:Oe[fe+De],properties:Ut(Oe,fe,de),geometry:{type:"Point",coordinates:[(Me=Oe[fe],360*(Me-.5)),Qt(Oe[fe+1])]}};var Me}function Ut(Oe,fe,de){const Me=Oe[fe+tt],Ve=Me>=1e4?`${Math.round(Me/1e3)}k`:Me>=1e3?Math.round(Me/100)/10+"k":Me,Ge=Oe[fe+Et],nt=Ge===-1?{}:Object.assign({},de[Ge]);return Object.assign(nt,{cluster:!0,cluster_id:Oe[fe+De],point_count:Me,point_count_abbreviated:Ve})}function an(Oe){return Oe/360+.5}function At(Oe){const fe=Math.sin(Oe*Math.PI/180),de=.5-.25*Math.log((1+fe)/(1-fe))/Math.PI;return de<0?0:de>1?1:de}function Qt(Oe){const fe=(180-360*Oe)*Math.PI/180;return 360*Math.atan(Math.exp(fe))/Math.PI-90}function Wt(Oe,fe,de,Me){for(var Ve,Ge=Me,nt=de-fe>>1,Xe=de-fe,$e=Oe[fe],ct=Oe[fe+1],Xt=Oe[de],en=Oe[de+1],jt=fe+3;jt<de;jt+=3){var Kn=vn(Oe[jt],Oe[jt+1],$e,ct,Xt,en);if(Kn>Ge)Ve=jt,Ge=Kn;else if(Kn===Ge){var Jn=Math.abs(jt-nt);Jn<Xe&&(Ve=jt,Xe=Jn)}}Ge>Me&&(Ve-fe>3&&Wt(Oe,fe,Ve,Me),Oe[Ve+2]=Ge,de-Ve>3&&Wt(Oe,Ve,de,Me))}function vn(Oe,fe,de,Me,Ve,Ge){var nt=Ve-de,Xe=Ge-Me;if(nt!==0||Xe!==0){var $e=((Oe-de)*nt+(fe-Me)*Xe)/(nt*nt+Xe*Xe);$e>1?(de=Ve,Me=Ge):$e>0&&(de+=nt*$e,Me+=Xe*$e)}return(nt=Oe-de)*nt+(Xe=fe-Me)*Xe}function Gt(Oe,fe,de,Me){var Ve={id:Oe===void 0?null:Oe,type:fe,geometry:de,tags:Me,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return(function(Ge){var nt=Ge.geometry,Xe=Ge.type;if(Xe==="Point"||Xe==="MultiPoint"||Xe==="LineString")Cn(Ge,nt);else if(Xe==="Polygon"||Xe==="MultiLineString")for(var $e=0;$e<nt.length;$e++)Cn(Ge,nt[$e]);else if(Xe==="MultiPolygon")for($e=0;$e<nt.length;$e++)for(var ct=0;ct<nt[$e].length;ct++)Cn(Ge,nt[$e][ct])})(Ve),Ve}function Cn(Oe,fe){for(var de=0;de<fe.length;de+=3)Oe.minX=Math.min(Oe.minX,fe[de]),Oe.minY=Math.min(Oe.minY,fe[de+1]),Oe.maxX=Math.max(Oe.maxX,fe[de]),Oe.maxY=Math.max(Oe.maxY,fe[de+1])}function ln(Oe,fe,de,Me){if(fe.geometry){var Ve=fe.geometry.coordinates,Ge=fe.geometry.type,nt=Math.pow(de.tolerance/((1<<de.maxZoom)*de.extent),2),Xe=[],$e=fe.id;if(de.promoteId?$e=fe.properties[de.promoteId]:de.generateId&&($e=Me||0),Ge==="Point")qn(Ve,Xe);else if(Ge==="MultiPoint")for(var ct=0;ct<Ve.length;ct++)qn(Ve[ct],Xe);else if(Ge==="LineString")Rn(Ve,Xe,nt,!1);else if(Ge==="MultiLineString"){if(de.lineMetrics){for(ct=0;ct<Ve.length;ct++)Rn(Ve[ct],Xe=[],nt,!1),Oe.push(Gt($e,"LineString",Xe,fe.properties));return}An(Ve,Xe,nt,!1)}else if(Ge==="Polygon")An(Ve,Xe,nt,!0);else{if(Ge!=="MultiPolygon"){if(Ge==="GeometryCollection"){for(ct=0;ct<fe.geometry.geometries.length;ct++)ln(Oe,{id:$e,geometry:fe.geometry.geometries[ct],properties:fe.properties},de,Me);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ct=0;ct<Ve.length;ct++){var Xt=[];An(Ve[ct],Xt,nt,!0),Xe.push(Xt)}}Oe.push(Gt($e,Ge,Xe,fe.properties))}}function qn(Oe,fe){fe.push(rr(Oe[0])),fe.push(En(Oe[1])),fe.push(0)}function Rn(Oe,fe,de,Me){for(var Ve,Ge,nt=0,Xe=0;Xe<Oe.length;Xe++){var $e=rr(Oe[Xe][0]),ct=En(Oe[Xe][1]);fe.push($e),fe.push(ct),fe.push(0),Xe>0&&(nt+=Me?(Ve*ct-$e*Ge)/2:Math.sqrt(Math.pow($e-Ve,2)+Math.pow(ct-Ge,2))),Ve=$e,Ge=ct}var Xt=fe.length-3;fe[2]=1,Wt(fe,0,Xt,de),fe[Xt+2]=1,fe.size=Math.abs(nt),fe.start=0,fe.end=fe.size}function An(Oe,fe,de,Me){for(var Ve=0;Ve<Oe.length;Ve++){var Ge=[];Rn(Oe[Ve],Ge,de,Me),fe.push(Ge)}}function rr(Oe){return Oe/360+.5}function En(Oe){var fe=Math.sin(Oe*Math.PI/180),de=.5-.25*Math.log((1+fe)/(1-fe))/Math.PI;return de<0?0:de>1?1:de}function bn(Oe,fe,de,Me,Ve,Ge,nt,Xe){if(Me/=fe,Ge>=(de/=fe)&&nt<Me)return Oe;if(nt<de||Ge>=Me)return null;for(var $e=[],ct=0;ct<Oe.length;ct++){var Xt=Oe[ct],en=Xt.geometry,jt=Xt.type,Kn=Ve===0?Xt.minX:Xt.minY,Jn=Ve===0?Xt.maxX:Xt.maxY;if(Kn>=de&&Jn<Me)$e.push(Xt);else if(!(Jn<de||Kn>=Me)){var Hn=[];if(jt==="Point"||jt==="MultiPoint")zn(en,Hn,de,Me,Ve);else if(jt==="LineString")mn(en,Hn,de,Me,Ve,!1,Xe.lineMetrics);else if(jt==="MultiLineString")Xn(en,Hn,de,Me,Ve,!1);else if(jt==="Polygon")Xn(en,Hn,de,Me,Ve,!0);else if(jt==="MultiPolygon")for(var ir=0;ir<en.length;ir++){var er=[];Xn(en[ir],er,de,Me,Ve,!0),er.length&&Hn.push(er)}if(Hn.length){if(Xe.lineMetrics&&jt==="LineString"){for(ir=0;ir<Hn.length;ir++)$e.push(Gt(Xt.id,jt,Hn[ir],Xt.tags));continue}jt!=="LineString"&&jt!=="MultiLineString"||(Hn.length===1?(jt="LineString",Hn=Hn[0]):jt="MultiLineString"),jt!=="Point"&&jt!=="MultiPoint"||(jt=Hn.length===3?"Point":"MultiPoint"),$e.push(Gt(Xt.id,jt,Hn,Xt.tags))}}}return $e.length?$e:null}function zn(Oe,fe,de,Me,Ve){for(var Ge=0;Ge<Oe.length;Ge+=3){var nt=Oe[Ge+Ve];nt>=de&&nt<=Me&&(fe.push(Oe[Ge]),fe.push(Oe[Ge+1]),fe.push(Oe[Ge+2]))}}function mn(Oe,fe,de,Me,Ve,Ge,nt){for(var Xe,$e,ct=ti(Oe),Xt=Ve===0?Jt:yn,en=Oe.start,jt=0;jt<Oe.length-3;jt+=3){var Kn=Oe[jt],Jn=Oe[jt+1],Hn=Oe[jt+2],ir=Oe[jt+3],er=Oe[jt+4],Nr=Ve===0?Kn:Jn,Cr=Ve===0?ir:er,Xr=!1;nt&&(Xe=Math.sqrt(Math.pow(Kn-ir,2)+Math.pow(Jn-er,2))),Nr<de?Cr>de&&($e=Xt(ct,Kn,Jn,ir,er,de),nt&&(ct.start=en+Xe*$e)):Nr>Me?Cr<Me&&($e=Xt(ct,Kn,Jn,ir,er,Me),nt&&(ct.start=en+Xe*$e)):on(ct,Kn,Jn,Hn),Cr<de&&Nr>=de&&($e=Xt(ct,Kn,Jn,ir,er,de),Xr=!0),Cr>Me&&Nr<=Me&&($e=Xt(ct,Kn,Jn,ir,er,Me),Xr=!0),!Ge&&Xr&&(nt&&(ct.end=en+Xe*$e),fe.push(ct),ct=ti(Oe)),nt&&(en+=Xe)}var mi=Oe.length-3;Kn=Oe[mi],Jn=Oe[mi+1],Hn=Oe[mi+2],(Nr=Ve===0?Kn:Jn)>=de&&Nr<=Me&&on(ct,Kn,Jn,Hn),mi=ct.length-3,Ge&&mi>=3&&(ct[mi]!==ct[0]||ct[mi+1]!==ct[1])&&on(ct,ct[0],ct[1],ct[2]),ct.length&&fe.push(ct)}function ti(Oe){var fe=[];return fe.size=Oe.size,fe.start=Oe.start,fe.end=Oe.end,fe}function Xn(Oe,fe,de,Me,Ve,Ge){for(var nt=0;nt<Oe.length;nt++)mn(Oe[nt],fe,de,Me,Ve,Ge,!1)}function on(Oe,fe,de,Me){Oe.push(fe),Oe.push(de),Oe.push(Me)}function Jt(Oe,fe,de,Me,Ve,Ge){var nt=(Ge-fe)/(Me-fe);return Oe.push(Ge),Oe.push(de+(Ve-de)*nt),Oe.push(1),nt}function yn(Oe,fe,de,Me,Ve,Ge){var nt=(Ge-de)/(Ve-de);return Oe.push(fe+(Me-fe)*nt),Oe.push(Ge),Oe.push(1),nt}function _n(Oe,fe){for(var de=[],Me=0;Me<Oe.length;Me++){var Ve,Ge=Oe[Me],nt=Ge.type;if(nt==="Point"||nt==="MultiPoint"||nt==="LineString")Ve=In(Ge.geometry,fe);else if(nt==="MultiLineString"||nt==="Polygon"){Ve=[];for(var Xe=0;Xe<Ge.geometry.length;Xe++)Ve.push(In(Ge.geometry[Xe],fe))}else if(nt==="MultiPolygon")for(Ve=[],Xe=0;Xe<Ge.geometry.length;Xe++){for(var $e=[],ct=0;ct<Ge.geometry[Xe].length;ct++)$e.push(In(Ge.geometry[Xe][ct],fe));Ve.push($e)}de.push(Gt(Ge.id,nt,Ve,Ge.tags))}return de}function In(Oe,fe){var de=[];de.size=Oe.size,Oe.start!==void 0&&(de.start=Oe.start,de.end=Oe.end);for(var Me=0;Me<Oe.length;Me+=3)de.push(Oe[Me]+fe,Oe[Me+1],Oe[Me+2]);return de}function Bn(Oe,fe){if(Oe.transformed)return Oe;var de,Me,Ve,Ge=1<<Oe.z,nt=Oe.x,Xe=Oe.y;for(de=0;de<Oe.features.length;de++){var $e=Oe.features[de],ct=$e.geometry,Xt=$e.type;if($e.geometry=[],Xt===1)for(Me=0;Me<ct.length;Me+=2)$e.geometry.push(Nn(ct[Me],ct[Me+1],fe,Ge,nt,Xe));else for(Me=0;Me<ct.length;Me++){var en=[];for(Ve=0;Ve<ct[Me].length;Ve+=2)en.push(Nn(ct[Me][Ve],ct[Me][Ve+1],fe,Ge,nt,Xe));$e.geometry.push(en)}}return Oe.transformed=!0,Oe}function Nn(Oe,fe,de,Me,Ve,Ge){return[Math.round(de*(Oe*Me-Ve)),Math.round(de*(fe*Me-Ge))]}function Br(Oe,fe,de,Me,Ve){for(var Ge=fe===Ve.maxZoom?0:Ve.tolerance/((1<<fe)*Ve.extent),nt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:de,y:Me,z:fe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Xe=0;Xe<Oe.length;Xe++){nt.numFeatures++,tr(nt,Oe[Xe],Ge,Ve);var $e=Oe[Xe].minX,ct=Oe[Xe].minY,Xt=Oe[Xe].maxX,en=Oe[Xe].maxY;$e<nt.minX&&(nt.minX=$e),ct<nt.minY&&(nt.minY=ct),Xt>nt.maxX&&(nt.maxX=Xt),en>nt.maxY&&(nt.maxY=en)}return nt}function tr(Oe,fe,de,Me){var Ve=fe.geometry,Ge=fe.type,nt=[];if(Ge==="Point"||Ge==="MultiPoint")for(var Xe=0;Xe<Ve.length;Xe+=3)nt.push(Ve[Xe]),nt.push(Ve[Xe+1]),Oe.numPoints++,Oe.numSimplified++;else if(Ge==="LineString")_r(nt,Ve,Oe,de,!1,!1);else if(Ge==="MultiLineString"||Ge==="Polygon")for(Xe=0;Xe<Ve.length;Xe++)_r(nt,Ve[Xe],Oe,de,Ge==="Polygon",Xe===0);else if(Ge==="MultiPolygon")for(var $e=0;$e<Ve.length;$e++){var ct=Ve[$e];for(Xe=0;Xe<ct.length;Xe++)_r(nt,ct[Xe],Oe,de,!0,Xe===0)}if(nt.length){var Xt=fe.tags||null;if(Ge==="LineString"&&Me.lineMetrics){for(var en in Xt={},fe.tags)Xt[en]=fe.tags[en];Xt.mapbox_clip_start=Ve.start/Ve.size,Xt.mapbox_clip_end=Ve.end/Ve.size}var jt={geometry:nt,type:Ge==="Polygon"||Ge==="MultiPolygon"?3:Ge==="LineString"||Ge==="MultiLineString"?2:1,tags:Xt};fe.id!==null&&(jt.id=fe.id),Oe.features.push(jt)}}function _r(Oe,fe,de,Me,Ve,Ge){var nt=Me*Me;if(Me>0&&fe.size<(Ve?nt:Me))de.numPoints+=fe.length/3;else{for(var Xe=[],$e=0;$e<fe.length;$e+=3)(Me===0||fe[$e+2]>nt)&&(de.numSimplified++,Xe.push(fe[$e]),Xe.push(fe[$e+1])),de.numPoints++;Ve&&(function(ct,Xt){for(var en=0,jt=0,Kn=ct.length,Jn=Kn-2;jt<Kn;Jn=jt,jt+=2)en+=(ct[jt]-ct[Jn])*(ct[jt+1]+ct[Jn+1]);if(en>0===Xt)for(jt=0,Kn=ct.length;jt<Kn/2;jt+=2){var Hn=ct[jt],ir=ct[jt+1];ct[jt]=ct[Kn-2-jt],ct[jt+1]=ct[Kn-1-jt],ct[Kn-2-jt]=Hn,ct[Kn-1-jt]=ir}})(Xe,Ge),Oe.push(Xe)}}function xn(Oe,fe){var de=(fe=this.options=(function(Ve,Ge){for(var nt in Ge)Ve[nt]=Ge[nt];return Ve})(Object.create(this.options),fe)).debug;if(de&&console.time("preprocess data"),fe.maxZoom<0||fe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(fe.promoteId&&fe.generateId)throw new Error("promoteId and generateId cannot be used together.");var Me=(function(Ve,Ge){var nt=[];if(Ve.type==="FeatureCollection")for(var Xe=0;Xe<Ve.features.length;Xe++)ln(nt,Ve.features[Xe],Ge,Xe);else ln(nt,Ve.type==="Feature"?Ve:{geometry:Ve},Ge);return nt})(Oe,fe);this.tiles={},this.tileCoords=[],de&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",fe.indexMaxZoom,fe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Me=(function(Ve,Ge){var nt=Ge.buffer/Ge.extent,Xe=Ve,$e=bn(Ve,1,-1-nt,nt,0,-1,2,Ge),ct=bn(Ve,1,1-nt,2+nt,0,-1,2,Ge);return($e||ct)&&(Xe=bn(Ve,1,-nt,1+nt,0,-1,2,Ge)||[],$e&&(Xe=_n($e,1).concat(Xe)),ct&&(Xe=Xe.concat(_n(ct,-1)))),Xe})(Me,fe),Me.length&&this.splitTile(Me,0,0,0),de&&(Me.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function $n(Oe,fe,de){return 32*((1<<Oe)*de+fe)+Oe}function jr(Oe,fe){const de=Oe.tileID.canonical;if(!this._geoJSONIndex)return fe(null,null);const Me=this._geoJSONIndex.getTile(de.z,de.x,de.y);if(!Me)return fe(null,null);const Ve=new class{constructor(nt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=nt.length,this._features=nt}feature(nt){return new class{constructor(Xe){this._feature=Xe,this.extent=o.EXTENT,this.type=Xe.type,this.properties=Xe.tags,"id"in Xe&&!isNaN(Xe.id)&&(this.id=parseInt(Xe.id,10))}loadGeometry(){if(this._feature.type===1){const Xe=[];for(const $e of this._feature.geometry)Xe.push([new o.Point($e[0],$e[1])]);return Xe}{const Xe=[];for(const $e of this._feature.geometry){const ct=[];for(const Xt of $e)ct.push(new o.Point(Xt[0],Xt[1]));Xe.push(ct)}return Xe}}toGeoJSON(Xe,$e,ct){return Q.call(this,Xe,$e,ct)}}(this._features[nt])}}(Me.features);let Ge=Je(Ve);Ge.byteOffset===0&&Ge.byteLength===Ge.buffer.byteLength||(Ge=new Uint8Array(Ge)),fe(null,{vectorTile:Ve,rawData:Ge.buffer})}xn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},xn.prototype.splitTile=function(Oe,fe,de,Me,Ve,Ge,nt){for(var Xe=[Oe,fe,de,Me],$e=this.options,ct=$e.debug;Xe.length;){Me=Xe.pop(),de=Xe.pop(),fe=Xe.pop(),Oe=Xe.pop();var Xt=1<<fe,en=$n(fe,de,Me),jt=this.tiles[en];if(!jt&&(ct>1&&console.time("creation"),jt=this.tiles[en]=Br(Oe,fe,de,Me,$e),this.tileCoords.push({z:fe,x:de,y:Me}),ct)){ct>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",fe,de,Me,jt.numFeatures,jt.numPoints,jt.numSimplified),console.timeEnd("creation"));var Kn="z"+fe;this.stats[Kn]=(this.stats[Kn]||0)+1,this.total++}if(jt.source=Oe,Ve){if(fe===$e.maxZoom||fe===Ve)continue;var Jn=1<<Ve-fe;if(de!==Math.floor(Ge/Jn)||Me!==Math.floor(nt/Jn))continue}else if(fe===$e.indexMaxZoom||jt.numPoints<=$e.indexMaxPoints)continue;if(jt.source=null,Oe.length!==0){ct>1&&console.time("clipping");var Hn,ir,er,Nr,Cr,Xr,mi=.5*$e.buffer/$e.extent,Eo=.5-mi,gs=.5+mi,ks=1+mi;Hn=ir=er=Nr=null,Cr=bn(Oe,Xt,de-mi,de+gs,0,jt.minX,jt.maxX,$e),Xr=bn(Oe,Xt,de+Eo,de+ks,0,jt.minX,jt.maxX,$e),Oe=null,Cr&&(Hn=bn(Cr,Xt,Me-mi,Me+gs,1,jt.minY,jt.maxY,$e),ir=bn(Cr,Xt,Me+Eo,Me+ks,1,jt.minY,jt.maxY,$e),Cr=null),Xr&&(er=bn(Xr,Xt,Me-mi,Me+gs,1,jt.minY,jt.maxY,$e),Nr=bn(Xr,Xt,Me+Eo,Me+ks,1,jt.minY,jt.maxY,$e),Xr=null),ct>1&&console.timeEnd("clipping"),Xe.push(Hn||[],fe+1,2*de,2*Me),Xe.push(ir||[],fe+1,2*de,2*Me+1),Xe.push(er||[],fe+1,2*de+1,2*Me),Xe.push(Nr||[],fe+1,2*de+1,2*Me+1)}}},xn.prototype.getTile=function(Oe,fe,de){var Me=this.options,Ve=Me.extent,Ge=Me.debug;if(Oe<0||Oe>24)return null;var nt=1<<Oe,Xe=$n(Oe,fe=(fe%nt+nt)%nt,de);if(this.tiles[Xe])return Bn(this.tiles[Xe],Ve);Ge>1&&console.log("drilling down to z%d-%d-%d",Oe,fe,de);for(var $e,ct=Oe,Xt=fe,en=de;!$e&&ct>0;)ct--,Xt=Math.floor(Xt/2),en=Math.floor(en/2),$e=this.tiles[$n(ct,Xt,en)];return $e&&$e.source?(Ge>1&&console.log("found parent tile z%d-%d-%d",ct,Xt,en),Ge>1&&console.time("drilling down"),this.splitTile($e.source,ct,Xt,en,Oe,fe,de),Ge>1&&console.timeEnd("drilling down"),this.tiles[Xe]?Bn(this.tiles[Xe],Ve):null):null};class Gi extends o.VectorTileWorkerSource{constructor(fe,de,Me,Ve,Ge){super(fe,de,Me,Ve,jr),Ge&&(this.loadGeoJSON=Ge)}loadData(fe,de){const Me=fe&&fe.request,Ve=Me&&Me.collectResourceTiming;this.loadGeoJSON(fe,((Ge,nt)=>{if(Ge||!nt)return de(Ge);if(typeof nt!="object")return de(new Error(`Input data given to '${fe.source}' is not a valid GeoJSON object.`));{K(nt,!0);try{if(fe.filter){const $e=o.createExpression(fe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if($e.result==="error")throw new Error($e.value.map((Xt=>`${Xt.key}: ${Xt.message}`)).join(", "));nt={type:"FeatureCollection",features:nt.features.filter((Xt=>$e.value.evaluate({zoom:0},Xt)))}}this._geoJSONIndex=fe.cluster?new wt((function({superclusterOptions:$e,clusterProperties:ct}){if(!ct||!$e)return $e;const Xt={},en={},jt={accumulated:null,zoom:0},Kn={properties:null},Jn=Object.keys(ct);for(const Hn of Jn){const[ir,er]=ct[Hn],Nr=o.createExpression(er),Cr=o.createExpression(typeof ir=="string"?[ir,["accumulated"],["get",Hn]]:ir);Xt[Hn]=Nr.value,en[Hn]=Cr.value}return $e.map=Hn=>{Kn.properties=Hn;const ir={};for(const er of Jn)ir[er]=Xt[er].evaluate(jt,Kn);return ir},$e.reduce=(Hn,ir)=>{Kn.properties=ir;for(const er of Jn)jt.accumulated=Hn[er],Hn[er]=en[er].evaluate(jt,Kn)},$e})(fe)).load(nt.features):(function($e,ct){return new xn($e,ct)})(nt,fe.geojsonVtOptions)}catch($e){return de($e)}this.loaded={};const Xe={};if(Ve){const $e=o.getPerformanceMeasurement(Me);$e&&(Xe.resourceTiming={},Xe.resourceTiming[fe.source]=JSON.parse(JSON.stringify($e)))}de(null,Xe)}}))}reloadTile(fe,de){const Me=this.loaded;return Me&&Me[fe.uid]?super.reloadTile(fe,de):this.loadTile(fe,de)}loadGeoJSON(fe,de){if(fe.request)o.getJSON(fe.request,de);else{if(typeof fe.data!="string")return de(new Error(`Input data given to '${fe.source}' is not a valid GeoJSON object.`));try{return de(null,JSON.parse(fe.data))}catch{return de(new Error(`Input data given to '${fe.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(fe,de){try{de(null,this._geoJSONIndex.getClusterExpansionZoom(fe.clusterId))}catch(Me){de(Me)}}getClusterChildren(fe,de){try{de(null,this._geoJSONIndex.getChildren(fe.clusterId))}catch(Me){de(Me)}}getClusterLeaves(fe,de){try{de(null,this._geoJSONIndex.getLeaves(fe.clusterId,fe.limit,fe.offset))}catch(Me){de(Me)}}}class eo{constructor(fe){this.self=fe,this.actor=new o.Actor(fe,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.getProjection({name:"mercator"}),this.workerSourceTypes={vector:o.VectorTileWorkerSource,geojson:Gi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(de,Me)=>{if(this.workerSourceTypes[de])throw new Error(`Worker source with name "${de}" already registered.`);this.workerSourceTypes[de]=Me},this.self.registerRTLTextPlugin=de=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=de.applyArabicShaping,o.plugin.processBidirectionalText=de.processBidirectionalText,o.plugin.processStyledBidirectionalText=de.processStyledBidirectionalText}}clearCaches(fe,de,Me){delete this.layerIndexes[fe],delete this.availableImages[fe],delete this.workerSources[fe],delete this.demWorkerSources[fe],Me()}checkIfReady(fe,de,Me){Me()}setReferrer(fe,de){this.referrer=de}spriteLoaded(fe,de){this.isSpriteLoaded[fe]=de;for(const Me in this.workerSources[fe]){const Ve=this.workerSources[fe][Me];for(const Ge in Ve)Ve[Ge]instanceof o.VectorTileWorkerSource&&(Ve[Ge].isSpriteLoaded=de,Ve[Ge].fire(new o.Event("isSpriteLoaded")))}}setImages(fe,de,Me){this.availableImages[fe]=de;for(const Ve in this.workerSources[fe]){const Ge=this.workerSources[fe][Ve];for(const nt in Ge)Ge[nt].availableImages=de}Me()}enableTerrain(fe,de,Me){this.terrain=de,Me()}setProjection(fe,de){this.projections[fe]=o.getProjection(de)}setLayers(fe,de,Me){this.getLayerIndex(fe).replace(de),Me()}updateLayers(fe,de,Me){this.getLayerIndex(fe).update(de.layers,de.removedIds),Me()}loadTile(fe,de,Me){const Ve=this.enableTerrain?o.extend({enableTerrain:this.terrain},de):de;Ve.projection=this.projections[fe]||this.defaultProjection,this.getWorkerSource(fe,de.type,de.source).loadTile(Ve,Me)}loadDEMTile(fe,de,Me){const Ve=this.enableTerrain?o.extend({buildQuadTree:this.terrain},de):de;this.getDEMWorkerSource(fe,de.source).loadTile(Ve,Me)}reloadTile(fe,de,Me){const Ve=this.enableTerrain?o.extend({enableTerrain:this.terrain},de):de;Ve.projection=this.projections[fe]||this.defaultProjection,this.getWorkerSource(fe,de.type,de.source).reloadTile(Ve,Me)}abortTile(fe,de,Me){this.getWorkerSource(fe,de.type,de.source).abortTile(de,Me)}removeTile(fe,de,Me){this.getWorkerSource(fe,de.type,de.source).removeTile(de,Me)}removeSource(fe,de,Me){if(!this.workerSources[fe]||!this.workerSources[fe][de.type]||!this.workerSources[fe][de.type][de.source])return;const Ve=this.workerSources[fe][de.type][de.source];delete this.workerSources[fe][de.type][de.source],Ve.removeSource!==void 0?Ve.removeSource(de,Me):Me()}loadWorkerSource(fe,de,Me){try{this.self.importScripts(de.url),Me()}catch(Ve){Me(Ve.toString())}}syncRTLPluginState(fe,de,Me){try{o.plugin.setState(de);const Ve=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&Ve!=null){this.self.importScripts(Ve);const Ge=o.plugin.isParsed();Me(Ge?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ve}`),Ge)}}catch(Ve){Me(Ve.toString())}}getAvailableImages(fe){let de=this.availableImages[fe];return de||(de=[]),de}getLayerIndex(fe){let de=this.layerIndexes[fe];return de||(de=this.layerIndexes[fe]=new O),de}getWorkerSource(fe,de,Me){if(this.workerSources[fe]||(this.workerSources[fe]={}),this.workerSources[fe][de]||(this.workerSources[fe][de]={}),!this.workerSources[fe][de][Me]){const Ve={send:(Ge,nt,Xe,$e,ct,Xt)=>{this.actor.send(Ge,nt,Xe,fe,ct,Xt)},scheduler:this.actor.scheduler};this.workerSources[fe][de][Me]=new this.workerSourceTypes[de](Ve,this.getLayerIndex(fe),this.getAvailableImages(fe),this.isSpriteLoaded[fe])}return this.workerSources[fe][de][Me]}getDEMWorkerSource(fe,de){return this.demWorkerSources[fe]||(this.demWorkerSources[fe]={}),this.demWorkerSources[fe][de]||(this.demWorkerSources[fe][de]=new N),this.demWorkerSources[fe][de]}enforceCacheSizeLimit(fe,de){o.enforceCacheSizeLimit(de)}getWorkerPerformanceMetrics(fe,de,Me){Me(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new eo(self)),eo})),g(["./shared"],(function(o){function S(_,l){if(Array.isArray(_)){if(!Array.isArray(l)||_.length!==l.length)return!1;for(let p=0;p<_.length;p++)if(!S(_[p],l[p]))return!1;return!0}if(typeof _=="object"&&_!==null&&l!==null){if(typeof l!="object"||Object.keys(_).length!==Object.keys(l).length)return!1;for(const p in _)if(!S(_[p],l[p]))return!1;return!0}return _===l}var M=O;function O(_){return!(function(l){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?(function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var x,E,A=new Blob([""],{type:"text/javascript"}),D=URL.createObjectURL(A);try{E=new Worker(D),x=!0}catch{x=!1}return E&&E.terminate(),URL.revokeObjectURL(D),x})()?"Uint8ClampedArray"in window?ArrayBuffer.isView?(function(){var x=document.createElement("canvas");x.width=x.height=1;var E=x.getContext("2d");if(!E)return!1;var A=E.getImageData(0,0,1,1);return A&&A.width===x.width})()?(N[p=l&&l.failIfMajorPerformanceCaveat]===void 0&&(N[p]=(function(x){var E,A=(function(D){var L=document.createElement("canvas"),V=Object.create(O.webGLContextAttributes);return V.failIfMajorPerformanceCaveat=D,L.getContext("webgl",V)||L.getContext("experimental-webgl",V)})(x);if(!A)return!1;try{E=A.createShader(A.VERTEX_SHADER)}catch{return!1}return!(!E||A.isContextLost())&&(A.shaderSource(E,"void main() {}"),A.compileShader(E),A.getShaderParameter(E,A.COMPILE_STATUS)===!0)})(p)),N[p]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var p})(_)}var N={};function j(_,l,p){const x=o.window.document.createElement(_);return l!==void 0&&(x.className=l),p&&p.appendChild(x),x}function Z(_,l,p){const x=o.window.document.createElementNS("http://www.w3.org/2000/svg",_);for(const E of Object.keys(l))x.setAttributeNS(null,E,l[E]);return p&&p.appendChild(x),x}O.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const K=o.window.document&&o.window.document.documentElement.style,Q=K&&K.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ce;function ge(){K&&Q&&(ce=K[Q],K[Q]="none")}function ue(){K&&Q&&(K[Q]=ce)}function pe(_){_.preventDefault(),_.stopPropagation(),o.window.removeEventListener("click",pe,!0)}function me(){o.window.addEventListener("click",pe,!0),o.window.setTimeout((()=>{o.window.removeEventListener("click",pe,!0)}),0)}function Te(_,l){const p=_.getBoundingClientRect();return he(_,p,l)}function ae(_,l){const p=_.getBoundingClientRect(),x=[];for(let E=0;E<l.length;E++)x.push(he(_,p,l[E]));return x}function re(_){return o.window.InstallTrigger!==void 0&&_.button===2&&_.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:_.button}function he(_,l,p){const x=_.offsetWidth===l.width?1:_.offsetWidth/l.width;return new o.Point((p.clientX-l.left)*x,(p.clientY-l.top)*x)}function se(_,l){var p=l[0],x=l[1],E=l[2],A=l[3],D=p*A-E*x;return D?(_[0]=A*(D=1/D),_[1]=-x*D,_[2]=-E*D,_[3]=p*D,_):null}function ve(_){const{userImage:l}=_;return!!(l&&l.render&&l.render())&&(_.data.replace(new Uint8Array(l.data.buffer)),!0)}class Y extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:p,callback:x}of this.requestors)this._notify(p,x);this.requestors=[]}}hasImage(l){return!!this.getImage(l)}getImage(l){return this.images[l]}addImage(l,p){this._validate(l,p)&&(this.images[l]=p)}_validate(l,p){let x=!0;return this._validateStretch(p.stretchX,p.data&&p.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${l}" has invalid "stretchX" value`))),x=!1),this._validateStretch(p.stretchY,p.data&&p.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${l}" has invalid "stretchY" value`))),x=!1),this._validateContent(p.content,p)||(this.fire(new o.ErrorEvent(new Error(`Image "${l}" has invalid "content" value`))),x=!1),x}_validateStretch(l,p){if(!l)return!0;let x=0;for(const E of l){if(E[0]<x||E[1]<E[0]||p<E[1])return!1;x=E[1]}return!0}_validateContent(l,p){return!(l&&(l.length!==4||l[0]<0||p.data.width<l[0]||l[1]<0||p.data.height<l[1]||l[2]<0||p.data.width<l[2]||l[3]<0||p.data.height<l[3]||l[2]<l[0]||l[3]<l[1]))}updateImage(l,p){p.version=this.images[l].version+1,this.images[l]=p,this.updatedImages[l]=!0}removeImage(l){const p=this.images[l];delete this.images[l],delete this.patterns[l],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l,p){let x=!0;if(!this.isLoaded())for(const E of l)this.images[E]||(x=!1);this.isLoaded()||x?this._notify(l,p):this.requestors.push({ids:l,callback:p})}_notify(l,p){const x={};for(const E of l){this.images[E]||this.fire(new o.Event("styleimagemissing",{id:E}));const A=this.images[E];A?x[E]={data:A.data.clone(),pixelRatio:A.pixelRatio,sdf:A.sdf,version:A.version,stretchX:A.stretchX,stretchY:A.stretchY,content:A.content,hasRenderCallback:!!(A.userImage&&A.userImage.render)}:o.warnOnce(`Image "${E}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}p(null,x)}getPixelSize(){const{width:l,height:p}=this.atlasImage;return{width:l,height:p}}getPattern(l){const p=this.patterns[l],x=this.getImage(l);if(!x)return null;if(p&&p.position.version===x.version)return p.position;if(p)p.position.version=x.version;else{const E={w:x.data.width+2,h:x.data.height+2,x:0,y:0},A=new o.ImagePosition(E,x);this.patterns[l]={bin:E,position:A}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const p=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(l,this.atlasImage,p.RGBA),this.atlasTexture&&this.atlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const A in this.patterns)l.push(this.patterns[A].bin);const{w:p,h:x}=o.potpack(l),E=this.atlasImage;E.resize({width:p||1,height:x||1});for(const A in this.patterns){const{bin:D}=this.patterns[A],L=D.x+1,V=D.y+1,G=this.images[A].data,q=G.width,te=G.height;o.RGBAImage.copy(G,E,{x:0,y:0},{x:L,y:V},{width:q,height:te}),o.RGBAImage.copy(G,E,{x:0,y:te-1},{x:L,y:V-1},{width:q,height:1}),o.RGBAImage.copy(G,E,{x:0,y:0},{x:L,y:V+te},{width:q,height:1}),o.RGBAImage.copy(G,E,{x:q-1,y:0},{x:L-1,y:V},{width:1,height:te}),o.RGBAImage.copy(G,E,{x:0,y:0},{x:L+q,y:V},{width:1,height:te})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const p of l){if(this.callbackDispatchedThisFrame[p])continue;this.callbackDispatchedThisFrame[p]=!0;const x=this.images[p];ve(x)&&this.updateImage(p,x)}}}const le=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(_,l){return(function([p,x,E]){const A=o.degToRad(x+90),D=o.degToRad(E);return{x:p*Math.cos(A)*Math.sin(D),y:p*Math.sin(A)*Math.sin(D),z:p*Math.cos(D),azimuthal:x,polar:E}})(_.expression.evaluate(l))}interpolate(_,l,p){return{x:o.number(_.x,l.x,p),y:o.number(_.y,l.y,p),z:o.number(_.z,l.z,p),azimuthal:o.number(_.azimuthal,l.azimuthal,p),polar:o.number(_.polar,l.polar,p)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)});class Ne extends o.Evented{constructor(l){super(),this._transitionable=new o.Transitionable(le),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,p={}){if(!this._validate(o.validateLight,l,p))for(const x in l){const E=l[x];o.endsWith(x,"-transition")?this._transitionable.setTransition(x.slice(0,-11),E):this._transitionable.setValue(x,E)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,p,x){return(!x||x.validate!==!1)&&o.emitValidationErrors(this,l.call(o.validateStyle,o.extend({value:p,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}const Ze=new o.Properties({source:new o.DataConstantProperty(o.spec.terrain.source),exaggeration:new o.DataConstantProperty(o.spec.terrain.exaggeration)});let Ie=class extends o.Evented{constructor(_,l){super(),this._transitionable=new o.Transitionable(Ze),this.set(_),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=l}get(){return this._transitionable.serialize()}set(_){for(const l in _){const p=_[l];o.endsWith(l,"-transition")?this._transitionable.setTransition(l.slice(0,-11),p):this._transitionable.setValue(l,p)}}updateTransitions(_){this._transitioning=this._transitionable.transitioned(_,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(_){this.properties=this._transitioning.possiblyEvaluate(_)}};function Je(_,l,p,x){const E=o.smoothstep(45,65,p),[A,D]=dt(_,x),L=o.length(l);let V=1-Math.min(1,Math.exp((L-A)/(D-A)*-6));return V*=V*V,V=Math.min(1,1.00747*V),V*E*_.alpha}function dt(_,l){const p=.5/Math.tan(.5*l);return[_.range[0]+p,_.range[1]+p]}const et=new o.Properties({range:new o.DataConstantProperty(o.spec.fog.range),color:new o.DataConstantProperty(o.spec.fog.color),"high-color":new o.DataConstantProperty(o.spec.fog["high-color"]),"space-color":new o.DataConstantProperty(o.spec.fog["space-color"]),"horizon-blend":new o.DataConstantProperty(o.spec.fog["horizon-blend"]),"star-intensity":new o.DataConstantProperty(o.spec.fog["star-intensity"])});class Kt extends o.Evented{constructor(l,p){super(),this._transitionable=new o.Transitionable(et),this.set(l),this._transitioning=this._transitionable.untransitioned(),this._transform=p}get state(){const l=this._transform,p=l.projection.name==="globe",x=o.globeToMercatorTransition(l.zoom),E=this.properties.get("range"),A=[.5,3];return{range:p?[o.number(A[0],E[0],x),o.number(A[1],E[1],x)]:E,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(l,p={}){if(!this._validate(o.validateFog,l,p)){for(const x of Object.keys(o.spec.fog))l&&l[x]===void 0&&(l[x]=o.spec.fog[x].default);for(const x in l){const E=l[x];o.endsWith(x,"-transition")?this._transitionable.setTransition(x.slice(0,-11),E):this._transitionable.setValue(x,E)}}}getOpacity(l){if(!this._transform.projection.supportsFog)return 0;const p=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.smoothstep(45,65,l))*p.a}getOpacityAtLatLng(l,p){return this._transform.projection.supportsFog?(function(x,E,A){const D=o.MercatorCoordinate.fromLngLat(E),L=A.elevation?A.elevation.getAtPointOrZero(D):0,V=[D.x,D.y,L];return o.transformMat4(V,V,A.mercatorFogMatrix),Je(x,V,A.pitch,A._fov)})(this.state,l,p):0}getFovAdjustedRange(l){return this._transform.projection.supportsFog?dt(this.state,l):[0,1]}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,p,x){return(!x||x.validate!==!1)&&o.emitValidationErrors(this,l.call(o.validateStyle,o.extend({value:p,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class De{constructor(l,p){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const x=this.workerPool.acquire(this.id);for(let E=0;E<x.length;E++){const A=new De.Actor(x[E],p,this.id);A.name=`Worker ${E}`,this.actors.push(A)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(l,p,x){o.asyncAll(this.actors,((E,A)=>{E.send(l,p,A)}),x=x||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((l=>{l.remove()})),this.actors=[],this.workerPool.release(this.id)}}function tt(_,l,p){return l*(o.EXTENT/(_.tileSize*Math.pow(2,p-_.tileID.overscaledZ)))}De.Actor=o.Actor;class Et{constructor(l,p,x,E){this.screenBounds=l,this.cameraPoint=p,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=x,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,E)}static createFromScreenPoints(l,p){let x,E;if(l instanceof o.Point||typeof l[0]=="number"){const A=o.Point.convert(l);x=[A],E=p.isPointAboveHorizon(A)}else{const A=o.Point.convert(l[0]),D=o.Point.convert(l[1]);x=[A,D],E=o.polygonizeBounds(A,D).every((L=>p.isPointAboveHorizon(L)))}return new Et(x,p.getCameraPoint(),E,p)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(l){return o.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],l)}bufferedCameraGeometry(l){const p=this.screenBounds[0],x=this.screenBounds.length===1?this.screenBounds[0].add(new o.Point(1,1)):this.screenBounds[1],E=o.polygonizeBounds(p,x,0,!1);return this.cameraPoint.y>x.y&&(this.cameraPoint.x>p.x&&this.cameraPoint.x<x.x?E.splice(3,0,this.cameraPoint):this.cameraPoint.x>=x.x?E[2]=this.cameraPoint:this.cameraPoint.x<=p.x&&(E[3]=this.cameraPoint)),o.bufferConvexPolygon(E,l)}bufferedCameraGeometryGlobe(l){const p=this.screenBounds[0],x=this.screenBounds.length===1?this.screenBounds[0].add(new o.Point(1,1)):this.screenBounds[1],E=o.polygonizeBounds(p,x,l),A=this.cameraPoint.clone();switch(3*((A.y>p.y)+(A.y>x.y))+((A.x>p.x)+(A.x>x.x))){case 0:E[0]=A,E[4]=A.clone();break;case 1:E.splice(1,0,A);break;case 2:E[1]=A;break;case 3:E.splice(4,0,A);break;case 5:E.splice(2,0,A);break;case 6:E[3]=A;break;case 7:E.splice(3,0,A);break;case 8:E[2]=A}return E}containsTile(l,p,x,E=0){const A=l.queryPadding/p._pixelsPerMercatorPixel+1,D=x?this._bufferedCameraMercator(A,p):this._bufferedScreenMercator(A,p);let L=l.tileID.wrap+(D.unwrapped?E:0);const V=D.polygon.map((Ce=>o.getTilePoint(l.tileTransform,Ce,L)));if(!o.polygonIntersectsBox(V,0,0,o.EXTENT,o.EXTENT))return;L=l.tileID.wrap+(this.screenGeometryMercator.unwrapped?E:0);const G=this.screenGeometryMercator.polygon.map((Ce=>o.getTileVec3(l.tileTransform,Ce,L))),q=G.map((Ce=>new o.Point(Ce[0],Ce[1]))),te=p.getFreeCameraOptions().position||new o.MercatorCoordinate(0,0,0),ye=o.getTileVec3(l.tileTransform,te,L),we=G.map((Ce=>{const ne=o.sub(Ce,Ce,ye);return o.normalize(ne,ne),new o.Ray(ye,ne)})),Se=tt(l,1,p.zoom)*p._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:q,tilespaceRays:we,bufferedTilespaceGeometry:V,bufferedTilespaceBounds:(Ee=o.getBounds(V),Ee.min.x=o.clamp(Ee.min.x,0,o.EXTENT),Ee.min.y=o.clamp(Ee.min.y,0,o.EXTENT),Ee.max.x=o.clamp(Ee.max.x,0,o.EXTENT),Ee.max.y=o.clamp(Ee.max.y,0,o.EXTENT),Ee),tile:l,tileID:l.tileID,pixelToTileUnitsFactor:Se};var Ee}_bufferedScreenMercator(l,p){const x=Ut(l);if(this._screenRaycastCache[x])return this._screenRaycastCache[x];{let E;return E=p.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(l),p):{polygon:this.bufferedScreenGeometry(l).map((A=>p.pointCoordinate3D(A))),unwrapped:!0},this._screenRaycastCache[x]=E,E}}_bufferedCameraMercator(l,p){const x=Ut(l);if(this._cameraRaycastCache[x])return this._cameraRaycastCache[x];{let E;return E=p.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(l),p):{polygon:this.bufferedCameraGeometry(l).map((A=>p.pointCoordinate3D(A))),unwrapped:!0},this._cameraRaycastCache[x]=E,E}}_projectAndResample(l,p){const x=(function(A,D){const L=o.multiply([],D.pixelMatrix,D.globeMatrix),V=[0,-o.GLOBE_RADIUS,0,1],G=[0,o.GLOBE_RADIUS,0,1],q=[0,0,0,1];o.transformMat4$1(V,V,L),o.transformMat4$1(G,G,L),o.transformMat4$1(q,q,L);const te=new o.Point(V[0]/V[3],V[1]/V[3]),ye=new o.Point(G[0]/G[3],G[1]/G[3]),we=o.polygonContainsPoint(A,te)&&V[3]<q[3],Se=o.polygonContainsPoint(A,ye)&&G[3]<q[3];if(!we&&!Se)return null;const Ee=(function(qe,Qe,Ye){for(let lt=1;lt<qe.length;lt++){const Vt=Lt(Qe.pointCoordinate3D(qe[lt-1]).x),rt=Lt(Qe.pointCoordinate3D(qe[lt]).x);if(Ye<0){if(Vt<rt)return{idx:lt,t:-Vt/(rt-1-Vt)}}else if(rt<Vt)return{idx:lt,t:(1-Vt)/(rt+1-Vt)}}return null})(A,D,we?-1:1);if(!Ee)return null;const{idx:Ce,t:ne}=Ee;let be=Ce>1?wt(A.slice(0,Ce),D):[],ke=Ce<A.length?wt(A.slice(Ce),D):[];be=be.map((qe=>new o.Point(Lt(qe.x),qe.y))),ke=ke.map((qe=>new o.Point(Lt(qe.x),qe.y)));const Le=[...be];Le.length===0&&Le.push(ke[ke.length-1]);const je=o.number(Le[Le.length-1].y,(ke.length===0?be[0]:ke[0]).y,ne);let He;return He=we?[new o.Point(0,je),new o.Point(0,0),new o.Point(1,0),new o.Point(1,je)]:[new o.Point(1,je),new o.Point(1,1),new o.Point(0,1),new o.Point(0,je)],Le.push(...He),ke.length===0?Le.push(be[0]):Le.push(...ke),{polygon:Le.map((qe=>new o.MercatorCoordinate(qe.x,qe.y))),unwrapped:!1}})(l,p);if(x)return x;const E=(function(A,D){let L=!1,V=-1/0,G=0;for(let te=0;te<A.length-1;te++)A[te].x>V&&(V=A[te].x,G=te);for(let te=0;te<A.length-1;te++){const ye=(G+te)%(A.length-1),we=A[ye],Se=A[ye+1];Math.abs(we.x-Se.x)>.5&&(we.x<Se.x?(we.x+=1,ye===0&&(A[A.length-1].x+=1)):(Se.x+=1,ye+1===A.length-1&&(A[0].x+=1)),L=!0)}const q=o.mercatorXfromLng(D.center.lng);return L&&q<Math.abs(q-1)&&A.forEach((te=>{te.x-=1})),{polygon:A,unwrapped:L}})(wt(l,p).map((A=>new o.Point(Lt(A.x),A.y))),p);return{polygon:E.polygon.map((A=>new o.MercatorCoordinate(A.x,A.y))),unwrapped:E.unwrapped}}}function wt(_,l){return o.resample(_,(p=>{const x=l.pointCoordinate3D(p);p.x=x.x,p.y=x.y}),1/256)}function Lt(_){return _<0?1+_%1:_%1}function Ut(_){return 100*_|0}function an(_,l,p,x,E){const A=function(D,L){if(D)return E(D);if(L){_.url&&L.tiles&&_.tiles&&delete _.tiles;const V=o.pick(o.extend(L,_),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);L.vector_layers&&(V.vectorLayers=L.vector_layers,V.vectorLayerIds=V.vectorLayers.map((G=>G.id))),V.tiles=l.canonicalizeTileset(V,_.url),E(null,V)}};return _.url?o.getJSON(l.transformRequest(l.normalizeSourceURL(_.url,null,p,x),o.ResourceType.Source),A):o.exported.frame((()=>A(null,_)))}class At{constructor(l,p,x){this.bounds=o.LngLatBounds.convert(this.validateBounds(l)),this.minzoom=p||0,this.maxzoom=x||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const p=Math.pow(2,l.z),x=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*p),E=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*p),A=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*p),D=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*p);return l.x>=x&&l.x<A&&l.y>=E&&l.y<D}}class Qt{constructor(l,p,x){this.context=l;const E=l.gl;this.buffer=E.createBuffer(),this.dynamicDraw=!!x,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),E.bufferData(E.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||p.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const p=this.context.gl;this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Wt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class vn{constructor(l,p,x,E){this.length=p.length,this.attributes=x,this.itemSize=p.bytesPerElement,this.dynamicDraw=E,this.context=l;const A=l.gl;this.buffer=A.createBuffer(),l.bindVertexBuffer.set(this.buffer),A.bufferData(A.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||p.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){const p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,p){for(let x=0;x<this.attributes.length;x++){const E=p.attributes[this.attributes[x].name];E!==void 0&&l.enableVertexAttribArray(E)}}setVertexAttribPointers(l,p,x){for(let E=0;E<this.attributes.length;E++){const A=this.attributes[E],D=p.attributes[A.name];D!==void 0&&l.vertexAttribPointer(D,A.components,l[Wt[A.type]],!1,this.itemSize,A.offset+this.itemSize*(x||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Gt{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Cn extends Gt{getDefault(){return o.Color.transparent}set(l){const p=this.current;(l.r!==p.r||l.g!==p.g||l.b!==p.b||l.a!==p.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class ln extends Gt{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class qn extends Gt{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class Rn extends Gt{getDefault(){return[!0,!0,!0,!0]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||l[2]!==p[2]||l[3]!==p[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class An extends Gt{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class rr extends Gt{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class En extends Gt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const p=this.current;(l.func!==p.func||l.ref!==p.ref||l.mask!==p.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class bn extends Gt{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||l[2]!==p[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class zn extends Gt{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST),this.current=l,this.dirty=!1}}class mn extends Gt{getDefault(){return[0,1]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class ti extends Gt{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST),this.current=l,this.dirty=!1}}class Xn extends Gt{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class on extends Gt{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.BLEND):p.disable(p.BLEND),this.current=l,this.dirty=!1}}class Jt extends Gt{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class yn extends Gt{getDefault(){return o.Color.transparent}set(l){const p=this.current;(l.r!==p.r||l.g!==p.g||l.b!==p.b||l.a!==p.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class _n extends Gt{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class In extends Gt{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE),this.current=l,this.dirty=!1}}class Bn extends Gt{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class Nn extends Gt{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}let Br,tr=class extends Gt{getDefault(){return null}set(_){(_!==this.current||this.dirty)&&(this.gl.useProgram(_),this.current=_,this.dirty=!1)}};class _r extends Gt{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class xn extends Gt{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||l[2]!==p[2]||l[3]!==p[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class $n extends Gt{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindFramebuffer(p.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class jr extends Gt{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindRenderbuffer(p.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Gi extends Gt{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindTexture(p.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class eo extends Gt{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindBuffer(p.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Oe extends Gt{getDefault(){return null}set(l){const p=this.gl;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class fe extends Gt{constructor(l){super(l),this.vao=l.extVertexArrayObject}getDefault(){return null}set(l){this.vao&&(l!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(l),this.current=l,this.dirty=!1)}}class de extends Gt{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class Me extends Gt{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class Ve extends Gt{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class Ge extends Gt{constructor(l,p){super(l),this.context=l,this.parent=p}getDefault(){return null}}class nt extends Ge{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class Xe extends Ge{attachment(){return this.gl.DEPTH_ATTACHMENT}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,this.attachment(),p.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class $e extends Xe{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class ct{constructor(l,p,x,E){this.context=l,this.width=p,this.height=x;const A=this.framebuffer=l.gl.createFramebuffer();this.colorAttachment=new nt(l,A),E&&(this.depthAttachment=new Xe(l,A))}destroy(){const l=this.context.gl,p=this.colorAttachment.get();if(p&&l.deleteTexture(p),this.depthAttachment){const x=this.depthAttachment.get();x&&l.deleteRenderbuffer(x)}l.deleteFramebuffer(this.framebuffer)}}class Xt{constructor(l,p=!1){if(this.gl=l,this.isWebGL2=p,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),p){const x=l;this.extVertexArrayObject={createVertexArrayOES:x.createVertexArray.bind(l),deleteVertexArrayOES:x.deleteVertexArray.bind(l),bindVertexArrayOES:x.bindVertexArray.bind(l)}}this.clearColor=new Cn(this),this.clearDepth=new ln(this),this.clearStencil=new qn(this),this.colorMask=new Rn(this),this.depthMask=new An(this),this.stencilMask=new rr(this),this.stencilFunc=new En(this),this.stencilOp=new bn(this),this.stencilTest=new zn(this),this.depthRange=new mn(this),this.depthTest=new ti(this),this.depthFunc=new Xn(this),this.blend=new on(this),this.blendFunc=new Jt(this),this.blendColor=new yn(this),this.blendEquation=new _n(this),this.cullFace=new In(this),this.cullFaceSide=new Bn(this),this.frontFace=new Nn(this),this.program=new tr(this),this.activeTexture=new _r(this),this.viewport=new xn(this),this.bindFramebuffer=new $n(this),this.bindRenderbuffer=new jr(this),this.bindTexture=new Gi(this),this.bindVertexBuffer=new eo(this),this.bindElementBuffer=new Oe(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new fe(this),this.pixelStoreUnpack=new de(this),this.pixelStoreUnpackPremultiplyAlpha=new Me(this),this.pixelStoreUnpackFlipY=new Ve(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=l.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=l.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=l.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),p||(this.extTextureHalfFloat=l.getExtension("OES_texture_half_float")),(p||this.extTextureHalfFloat&&l.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=p||l.getExtension("OES_standard_derivatives"),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,p){return new Qt(this,l,p)}createVertexBuffer(l,p,x){return new vn(this,l,p,x)}createRenderbuffer(l,p,x){const E=this.gl,A=E.createRenderbuffer();return this.bindRenderbuffer.set(A),E.renderbufferStorage(E.RENDERBUFFER,l,p,x),this.bindRenderbuffer.set(null),A}createFramebuffer(l,p,x){return new ct(this,l,p,x)}clear({color:l,depth:p,stencil:x}){const E=this.gl;let A=0;l&&(A|=E.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),p!==void 0&&(A|=E.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(p),this.depthMask.set(!0)),x!==void 0&&(A|=E.STENCIL_BUFFER_BIT,this.clearStencil.set(x),this.stencilMask.set(255)),E.clear(A)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){S(l.blendFunction,o.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class en extends o.Evented{constructor(l,p,x,E){if(super(),this.id=l,this.dispatcher=x,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(p,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},p),this._collectResourceTiming=p.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(E),this._tileWorkers={},this._deduped=new o.DedupedRequest}load(l){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"}));const p=Array.isArray(this.map._language)?this.map._language.join():this.map._language,x=this.map._worldview;this._tileJSONRequest=an(this._options,this.map._requestManager,p,x,((E,A)=>{this._tileJSONRequest=null,this._loaded=!0,E?(p&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${p}`),x&&x.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${x}`),this.fire(new o.ErrorEvent(E))):A&&(o.extend(this,A),A.bounds&&(this.tileBounds=new At(A.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(A.tiles,this.map._requestManager._customAccessToken),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))),l&&l(E)}))}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest(),this.load((()=>this.map.style._clearSource(this.id)))}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return o.extend({},this._options)}loadTile(l,p){const x=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme)),E={request:this.map._requestManager.transformRequest(x,o.ResourceType.Tile),data:void 0,uid:l.uid,tileID:l.tileID,tileZoom:l.tileZoom,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:l.isSymbolTile};if(E.request.collectResourceTiming=this._collectResourceTiming,l.actor&&l.state!=="expired")l.state==="loading"?l.reloadCallback=p:l.request=l.actor.send("reloadTile",E,A.bind(this));else if(l.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)l.request=l.actor.send("loadTile",E,A.bind(this),void 0,!0);else{const D=o.loadVectorTile.call({deduped:this._deduped},E,((L,V)=>{L||!V?A.call(this,L):(E.data={cacheControl:V.cacheControl,expires:V.expires,rawData:V.rawData.slice(0)},l.actor&&l.actor.send("loadTile",E,A.bind(this),void 0,!0))}),!0);l.request={cancel:D}}function A(D,L){return delete l.request,l.aborted?p(null):D&&D.status!==404?p(D):(L&&L.resourceTiming&&(l.resourceTiming=L.resourceTiming),this.map._refreshExpiredTiles&&L&&l.setExpiryData(L),l.loadVectorData(L,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),p(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id})}unloadTile(l){l.unloadVectorData(),l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class jt extends o.Evented{constructor(l,p,x,E){super(),this.id=l,this.dispatcher=x,this.setEventedParent(E),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},p),o.extend(this,o.pick(p,["url","scheme","tileSize"]))}load(l){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=an(this._options,this.map._requestManager,null,null,((p,x)=>{this._tileJSONRequest=null,this._loaded=!0,p?this.fire(new o.ErrorEvent(p)):x&&(o.extend(this,x),x.bounds&&(this.tileBounds=new At(x.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(x.tiles),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))),l&&l(p)}))}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest(),this.load((()=>this.map.style._clearSource(this.id)))}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return o.extend({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,p){const x=o.exported.devicePixelRatio>=2,E=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),x,this.tileSize);l.request=o.getImage(this.map._requestManager.transformRequest(E,o.ResourceType.Tile),((A,D,L,V)=>(delete l.request,l.aborted?(l.state="unloaded",p(null)):A?(l.state="errored",p(A)):D?(this.map._refreshExpiredTiles&&l.setExpiryData({cacheControl:L,expires:V}),l.setTexture(D,this.map.painter),l.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),void p(null)):p(null))))}static loadTileData(l,p,x){l.setTexture(p,x)}static unloadTileData(l,p){l.texture&&p.saveTileTexture(l.texture)}abortTile(l,p){l.request&&(l.request.cancel(),delete l.request),p()}unloadTile(l,p){l.texture&&this.map.painter.saveTileTexture(l.texture),p()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Kn(_,l,p,x,E,A,D,L){const V=[_,p,E,l,x,A,1,1,1],G=[D,L,1],q=o.adjoint([],V),[te,ye,we]=o.transformMat3(G,G,o.transpose(q,q));return o.multiply$1(V,[te,0,0,0,ye,0,0,0,we],V)}class Jn extends o.Evented{constructor(l,p,x,E){super(),this.id=l,this.dispatcher=x,this.coordinates=p.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(E),this.options=p,this._dirty=!1}load(l,p){this._loaded=p||!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),((x,E)=>{if(this._imageRequest=null,this._loaded=!0,x)this.fire(new o.ErrorEvent(x));else if(E){const{HTMLImageElement:A}=o.window;this.image=E instanceof A?o.exported.getImageData(E):E,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,l&&(this.coordinates=l),this._finishLoading()}}))}loaded(){return this._loaded}updateImage(l){return this.image&&l.url?(this._imageRequest&&l.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=l.url,this.load(l.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(l){this.coordinates=l,this._boundsArray=void 0;const p=l.map(o.MercatorCoordinate.fromLngLat);return this.tileID=(function(x){let E=1/0,A=1/0,D=-1/0,L=-1/0;for(const te of x)E=Math.min(E,te.x),A=Math.min(A,te.y),D=Math.max(D,te.x),L=Math.max(L,te.y);const V=Math.max(D-E,L-A),G=Math.max(0,Math.floor(-Math.log(V)/Math.LN2)),q=Math.pow(2,G);return new o.CanonicalTileID(G,Math.floor((E+D)/2*q),Math.floor((A+L)/2*q))})(p),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(l){for(const V in this.tiles){const G=this.tiles[V];G.state!=="loaded"&&(G.state="loaded",G.texture=this.texture)}if(this._boundsArray)return;const p=o.tileTransform(this.tileID,this.map.transform.projection),[x,E,A,D]=this.coordinates.map((V=>{const G=p.projection.project(V[0],V[1]);return o.getTilePoint(p,G)._round()}));this.perspectiveTransform=(function(V,G,q,te,ye,we,Se,Ee,Ce,ne){const be=Kn(0,0,V,0,0,G,V,G),ke=Kn(q,te,ye,we,Se,Ee,Ce,ne);return o.multiply$1(ke,o.adjoint(be,be),ke),[ke[6]/ke[8]*V/o.EXTENT,ke[7]/ke[8]*G/o.EXTENT]})(this.width,this.height,x.x,x.y,E.x,E.y,D.x,D.y,A.x,A.y);const L=this._boundsArray=new o.StructArrayLayout4i8;L.emplaceBack(x.x,x.y,0,0),L.emplaceBack(E.x,E.y,o.EXTENT,0),L.emplaceBack(D.x,D.y,0,o.EXTENT),L.emplaceBack(A.x,A.y,o.EXTENT,o.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=l.createVertexBuffer(L,o.boundsAttributes.members),this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const l=this.map.painter.context,p=l.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new o.Texture(l,this.image,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(l)}loadTile(l,p){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={},p(null)):(l.state="errored",p(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Hn={vector:en,raster:jt,"raster-dem":class extends jt{constructor(_,l,p,x){super(_,l,p,x),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}loadTile(_,l){const p=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function x(E,A){E&&(_.state="errored",l(E)),A&&(_.dem=A,_.dem.onDeserialize(),_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0,_.state="loaded",l(null))}_.request=o.getImage(this.map._requestManager.transformRequest(p,o.ResourceType.Tile),(function(E,A,D,L){if(delete _.request,_.aborted)_.state="unloaded",l(null);else if(E)_.state="errored",l(E);else if(A){this.map._refreshExpiredTiles&&_.setExpiryData({cacheControl:D,expires:L});const V=o.window.ImageBitmap&&A instanceof o.window.ImageBitmap&&(Br==null&&(Br=o.window.OffscreenCanvas&&new o.window.OffscreenCanvas(1,1).getContext("2d")&&typeof o.window.createImageBitmap=="function"),Br),G=1-(A.width-o.prevPowerOfTwo(A.width))/2;G<1||_.neighboringTiles||(_.neighboringTiles=this._getNeighboringTiles(_.tileID));const q=V?A:o.exported.getImageData(A,G),te={uid:_.uid,coord:_.tileID,source:this.id,rawImageData:q,encoding:this.encoding,padding:G};_.actor&&_.state!=="expired"||(_.actor=this.dispatcher.getActor(),_.actor.send("loadDEMTile",te,x.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(_){const l=_.canonical,p=Math.pow(2,l.z),x=(l.x-1+p)%p,E=l.x===0?_.wrap-1:_.wrap,A=(l.x+1+p)%p,D=l.x+1===p?_.wrap+1:_.wrap,L={};return L[new o.OverscaledTileID(_.overscaledZ,E,l.z,x,l.y).key]={backfilled:!1},L[new o.OverscaledTileID(_.overscaledZ,D,l.z,A,l.y).key]={backfilled:!1},l.y>0&&(L[new o.OverscaledTileID(_.overscaledZ,E,l.z,x,l.y-1).key]={backfilled:!1},L[new o.OverscaledTileID(_.overscaledZ,_.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},L[new o.OverscaledTileID(_.overscaledZ,D,l.z,A,l.y-1).key]={backfilled:!1}),l.y+1<p&&(L[new o.OverscaledTileID(_.overscaledZ,E,l.z,x,l.y+1).key]={backfilled:!1},L[new o.OverscaledTileID(_.overscaledZ,_.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},L[new o.OverscaledTileID(_.overscaledZ,D,l.z,A,l.y+1).key]={backfilled:!1}),L}unloadTile(_){_.demTexture&&this.map.painter.saveTileTexture(_.demTexture),_.fbo&&(_.fbo.destroy(),delete _.fbo),_.dem&&delete _.dem,delete _.neighboringTiles,_.state="unloaded"}},geojson:class extends o.Evented{constructor(_,l,p,x){super(),this.id=_,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=p.getActor(),this.setEventedParent(x),this._data=l.data,this._options=o.extend({},l),this._collectResourceTiming=l.collectResourceTiming,l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;const E=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*E,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*E,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?l.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:o.EXTENT,radius:(l.clusterRadius!==void 0?l.clusterRadius:50)*E,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}onAdd(_){this.map=_,this.setData(this._data)}setData(_){return this._data=_,this._updateWorkerData(),this}getClusterExpansionZoom(_,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:_,source:this.id},l),this}getClusterChildren(_,l){return this.actor.send("geojson.getClusterChildren",{clusterId:_,source:this.id},l),this}getClusterLeaves(_,l,p,x){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:_,limit:l,offset:p},x),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.Event("dataloading",{dataType:"source"})),this._loaded=!1;const _=o.extend({},this.workerOptions),l=this._data;typeof l=="string"?(_.request=this.map._requestManager.transformRequest(o.exported.resolveURL(l),o.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,_,((p,x)=>{if(this._loaded=!0,this._pendingLoad=null,p)this.fire(new o.ErrorEvent(p));else{const E={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(E.resourceTiming=x.resourceTiming[this.id]),this.fire(new o.Event("data",E)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)}))}loaded(){return this._loaded}loadTile(_,l){const p=_.actor?"reloadTile":"loadTile";_.actor=this.actor,_.request=this.actor.send(p,{type:this.type,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},((x,E)=>(delete _.request,_.unloadVectorData(),_.aborted?l(null):x?l(x):(_.loadVectorData(E,this.map.painter,p==="reloadTile"),l(null)))),void 0,p==="loadTile")}abortTile(_){_.request&&(_.request.cancel(),delete _.request),_.aborted=!0}unloadTile(_){_.unloadVectorData(),this.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Jn{constructor(_,l,p,x){super(_,l,p,x),this.roundZoom=!0,this.type="video",this.options=l}load(){this._loaded=!1;const _=this.options;this.urls=[];for(const l of _.urls)this.urls.push(this.map._requestManager.transformRequest(l,o.ResourceType.Source).url);o.getVideo(this.urls,((l,p)=>{this._loaded=!0,l?this.fire(new o.ErrorEvent(l)):p&&(this.video=p,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(_){if(this.video){const l=this.video.seekable;_<l.start(0)||_>l.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${l.start(0)} and ${l.end(0)}-second mark.`))):this.video.currentTime=_}}getVideo(){return this.video}onAdd(_){this.map||(this.map=_,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const _=this.map.painter.context,l=_.gl;this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(_,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(_)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Jn,canvas:class extends Jn{constructor(_,l,p,x){super(_,l,p,x),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some((E=>!Array.isArray(E)||E.length!==2||E.some((A=>typeof A!="number"))))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${_}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${_}`,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${_}`,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${_}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${_}`,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(_){this.map=_,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let _=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,_=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,_=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const l=this.map.painter.context;this.texture?(_||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(l,this.canvas,l.gl.RGBA,{premultiply:!0}),this._prepareData(l)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const _ of[this.canvas.width,this.canvas.height])if(isNaN(_)||_<=0)return!0;return!1}},custom:class extends o.Evented{constructor(_,l,p,x){super(),this.id=_,this.type="custom",this._dataType="raster",this._dispatcher=p,this._implementation=l,this.setEventedParent(x),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new At(this._implementation.bounds,this.minzoom,this.maxzoom)),l.update=this._update.bind(this),l.clearTiles=this._clearTiles.bind(this),l.coveringTiles=this._coveringTiles.bind(this),o.extend(this,o.pick(l,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(_){this._map=_,this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(_),this.load()}onRemove(_){this._implementation.onRemove&&this._implementation.onRemove(_)}hasTile(_){if(this._implementation.hasTile){const{x:l,y:p,z:x}=_.canonical;return this._implementation.hasTile({x:l,y:p,z:x})}return!this.tileBounds||this.tileBounds.contains(_.canonical)}loadTile(_,l){const{x:p,y:x,z:E}=_.tileID.canonical,A=new o.window.AbortController;_.request=Promise.resolve(this._implementation.loadTile({x:p,y:x,z:E},{signal:A.signal})).then((function(D){return delete _.request,_.aborted?(_.state="unloaded",l(null)):D===void 0?(_.state="errored",l(null)):D===null?(this.loadTileData(_,{width:this.tileSize,height:this.tileSize,data:null}),_.state="loaded",l(null)):(function(L){return L instanceof o.window.ImageData||L instanceof o.window.HTMLCanvasElement||L instanceof o.window.ImageBitmap||L instanceof o.window.HTMLImageElement})(D)?(this.loadTileData(_,D),_.state="loaded",void l(null)):(_.state="errored",l(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch((D=>{D.code!==20&&(_.state="errored",l(D))})),_.request.cancel=()=>A.abort()}loadTileData(_,l){jt.loadTileData(_,l,this._map.painter)}unloadTileData(_){jt.unloadTileData(_,this._map.painter)}unloadTile(_,l){if(this.unloadTileData(_),this._implementation.unloadTile){const{x:p,y:x,z:E}=_.tileID.canonical;this._implementation.unloadTile({x:p,y:x,z:E})}l()}abortTile(_,l){_.request&&_.request.cancel&&(_.request.cancel(),delete _.request),l()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((_=>({x:_.canonical.x,y:_.canonical.y,z:_.canonical.z})))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}}},ir=function(_,l,p,x){const E=new Hn[l.type](_,l,p,x);if(E.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${E.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],E),E};function er(_,l){const p=o.identity([]);return o.scale(p,p,[.5*_.width,.5*-_.height,1]),o.translate(p,p,[1,-1,0]),o.multiply(p,p,_.calculateProjMatrix(l.toUnwrapped())),Float32Array.from(p)}function Nr(_,l,p,x,E,A,D,L=!1){const V=_.tilesIn(x,D,L);V.sort(Xr);const G=[];for(const te of V)G.push({wrappedTileID:te.tile.tileID.wrapped().key,queryResults:te.tile.queryRenderedFeatures(l,p,_._state,te,E,A,er(_.transform,te.tile.tileID),L)});const q=(function(te){const ye={},we={};for(const Se of te){const Ee=Se.queryResults,Ce=Se.wrappedTileID,ne=we[Ce]=we[Ce]||{};for(const be in Ee){const ke=Ee[be],Le=ne[be]=ne[be]||{},je=ye[be]=ye[be]||[];for(const He of ke)Le[He.featureIndex]||(Le[He.featureIndex]=!0,je.push(He))}}return ye})(G);for(const te in q)q[te].forEach((ye=>{const we=ye.feature,Se=we.layer;Se&&Se.type!=="background"&&Se.type!=="sky"&&(we.source=Se.source,Se["source-layer"]&&(we.sourceLayer=Se["source-layer"]),we.state=we.id!==void 0?_.getFeatureState(Se["source-layer"],we.id):{})}));return q}function Cr(_,l){const p=_.getRenderableIds().map((A=>_.getTileByID(A))),x=[],E={};for(let A=0;A<p.length;A++){const D=p[A],L=D.tileID.canonical.key;E[L]||(E[L]=!0,D.querySourceFeatures(x,l))}return x}function Xr(_,l){const p=_.tileID,x=l.tileID;return p.overscaledZ-x.overscaledZ||p.canonical.y-x.canonical.y||p.wrap-x.wrap||p.canonical.x-x.canonical.x}function mi(){return Fu.workerClass!=null?new Fu.workerClass:new o.window.Worker(Fu.workerUrl)}const Eo="mapboxgl_preloaded_worker_pool";class gs{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<gs.workerCount;)this.workers.push(new mi);return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach((p=>{p.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Eo]}numActive(){return Object.keys(this.active).length}}let ks;function Hl(){return ks||(ks=new gs),ks}function wl(_,l){const p={};for(const x in _)x!=="ref"&&(p[x]=_[x]);return o.refProperties.forEach((x=>{x in l&&(p[x]=l[x])})),p}function wu(_){_=_.slice();const l=Object.create(null);for(let p=0;p<_.length;p++)l[_[p].id]=_[p];for(let p=0;p<_.length;p++)"ref"in _[p]&&(_[p]=wl(_[p],l[_[p].ref]));return _}gs.workerCount=2;const vr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Uo(_,l,p){p.push({command:vr.addSource,args:[_,l[_]]})}function $s(_,l,p){l.push({command:vr.removeSource,args:[_]}),p[_]=!0}function wa(_,l,p,x){$s(_,p,x),Uo(_,l,p)}function ts(_,l,p){let x;for(x in _[p])if(_[p].hasOwnProperty(x)&&x!=="data"&&!S(_[p][x],l[p][x]))return!1;for(x in l[p])if(l[p].hasOwnProperty(x)&&x!=="data"&&!S(_[p][x],l[p][x]))return!1;return!0}function jo(_,l,p,x,E,A){let D;for(D in l=l||{},_=_||{})_.hasOwnProperty(D)&&(S(_[D],l[D])||p.push({command:A,args:[x,D,l[D],E]}));for(D in l)l.hasOwnProperty(D)&&!_.hasOwnProperty(D)&&(S(_[D],l[D])||p.push({command:A,args:[x,D,l[D],E]}))}function ea(_){return _.id}function Ta(_,l){return _[l.id]=l,_}class Ea{constructor(l,p){this.reset(l,p)}reset(l,p){this.points=l||[],this._distances=[0];for(let x=1;x<this.points.length;x++)this._distances[x]=this._distances[x-1]+this.points[x].dist(this.points[x-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=o.clamp(l,0,1);let p=1,x=this._distances[p];const E=l*this.paddedLength+this.padding;for(;x<E&&p<this._distances.length;)x=this._distances[++p];const A=p-1,D=this._distances[A],L=x-D,V=L>0?(E-D)/L:0;return this.points[A].mult(1-V).add(this.points[p].mult(V))}}class tl{constructor(l,p,x){const E=this.boxCells=[],A=this.circleCells=[];this.xCellCount=Math.ceil(l/x),this.yCellCount=Math.ceil(p/x);for(let D=0;D<this.xCellCount*this.yCellCount;D++)E.push([]),A.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=p,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,p,x,E,A){this._forEachCell(p,x,E,A,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(p),this.bboxes.push(x),this.bboxes.push(E),this.bboxes.push(A)}insertCircle(l,p,x,E){this._forEachCell(p-E,x-E,p+E,x+E,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(p),this.circles.push(x),this.circles.push(E)}_insertBoxCell(l,p,x,E,A,D){this.boxCells[A].push(D)}_insertCircleCell(l,p,x,E,A,D){this.circleCells[A].push(D)}_query(l,p,x,E,A,D){if(x<0||l>this.width||E<0||p>this.height)return!A&&[];const L=[];if(l<=0&&p<=0&&this.width<=x&&this.height<=E){if(A)return!0;for(let V=0;V<this.boxKeys.length;V++)L.push({key:this.boxKeys[V],x1:this.bboxes[4*V],y1:this.bboxes[4*V+1],x2:this.bboxes[4*V+2],y2:this.bboxes[4*V+3]});for(let V=0;V<this.circleKeys.length;V++){const G=this.circles[3*V],q=this.circles[3*V+1],te=this.circles[3*V+2];L.push({key:this.circleKeys[V],x1:G-te,y1:q-te,x2:G+te,y2:q+te})}return D?L.filter(D):L}return this._forEachCell(l,p,x,E,this._queryCell,L,{hitTest:A,seenUids:{box:{},circle:{}}},D),A?L.length>0:L}_queryCircle(l,p,x,E,A){const D=l-x,L=l+x,V=p-x,G=p+x;if(L<0||D>this.width||G<0||V>this.height)return!E&&[];const q=[];return this._forEachCell(D,V,L,G,this._queryCellCircle,q,{hitTest:E,circle:{x:l,y:p,radius:x},seenUids:{box:{},circle:{}}},A),E?q.length>0:q}query(l,p,x,E,A){return this._query(l,p,x,E,!1,A)}hitTest(l,p,x,E,A){return this._query(l,p,x,E,!0,A)}hitTestCircle(l,p,x,E){return this._queryCircle(l,p,x,!0,E)}_queryCell(l,p,x,E,A,D,L,V){const G=L.seenUids,q=this.boxCells[A];if(q!==null){const ye=this.bboxes;for(const we of q)if(!G.box[we]){G.box[we]=!0;const Se=4*we;if(l<=ye[Se+2]&&p<=ye[Se+3]&&x>=ye[Se+0]&&E>=ye[Se+1]&&(!V||V(this.boxKeys[we]))){if(L.hitTest)return D.push(!0),!0;D.push({key:this.boxKeys[we],x1:ye[Se],y1:ye[Se+1],x2:ye[Se+2],y2:ye[Se+3]})}}}const te=this.circleCells[A];if(te!==null){const ye=this.circles;for(const we of te)if(!G.circle[we]){G.circle[we]=!0;const Se=3*we;if(this._circleAndRectCollide(ye[Se],ye[Se+1],ye[Se+2],l,p,x,E)&&(!V||V(this.circleKeys[we]))){if(L.hitTest)return D.push(!0),!0;{const Ee=ye[Se],Ce=ye[Se+1],ne=ye[Se+2];D.push({key:this.circleKeys[we],x1:Ee-ne,y1:Ce-ne,x2:Ee+ne,y2:Ce+ne})}}}}}_queryCellCircle(l,p,x,E,A,D,L,V){const G=L.circle,q=L.seenUids,te=this.boxCells[A];if(te!==null){const we=this.bboxes;for(const Se of te)if(!q.box[Se]){q.box[Se]=!0;const Ee=4*Se;if(this._circleAndRectCollide(G.x,G.y,G.radius,we[Ee+0],we[Ee+1],we[Ee+2],we[Ee+3])&&(!V||V(this.boxKeys[Se])))return D.push(!0),!0}}const ye=this.circleCells[A];if(ye!==null){const we=this.circles;for(const Se of ye)if(!q.circle[Se]){q.circle[Se]=!0;const Ee=3*Se;if(this._circlesCollide(we[Ee],we[Ee+1],we[Ee+2],G.x,G.y,G.radius)&&(!V||V(this.circleKeys[Se])))return D.push(!0),!0}}}_forEachCell(l,p,x,E,A,D,L,V){const G=this._convertToXCellCoord(l),q=this._convertToYCellCoord(p),te=this._convertToXCellCoord(x),ye=this._convertToYCellCoord(E);for(let we=G;we<=te;we++)for(let Se=q;Se<=ye;Se++)if(A.call(this,l,p,x,E,this.xCellCount*Se+we,D,L,V))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,p,x,E,A,D){const L=E-l,V=A-p,G=x+D;return G*G>L*L+V*V}_circleAndRectCollide(l,p,x,E,A,D,L){const V=(D-E)/2,G=Math.abs(l-(E+V));if(G>V+x)return!1;const q=(L-A)/2,te=Math.abs(p-(A+q));if(te>q+x)return!1;if(G<=V||te<=q)return!0;const ye=G-V,we=te-q;return ye*ye+we*we<=x*x}}const ta={unknown:0,flipRequired:1,flipNotRequired:2},Wl=Math.tan(85*Math.PI/180);function vt(_,l,p,x,E,A,D){const L=o.create();if(p)if(A.name==="globe"){const V=o.calculateGlobeLabelMatrix(E,l);o.multiply(L,L,V)}else{const V=se([],D);L[0]=V[0],L[1]=V[1],L[4]=V[2],L[5]=V[3],x||o.rotateZ(L,L,E.angle)}else o.multiply(L,E.labelPlaneMatrix,_);return L}function $o(_,l,p,x,E,A,D){const L=vt(_,l,p,x,E,A,D);return A.name==="globe"&&p||(L[2]=L[6]=L[10]=L[14]=0),L}function Zr(_,l,p,x,E,A,D){if(p){if(A.name==="globe"){const L=vt(_,l,p,x,E,A,D);return o.invert(L,L),o.multiply(L,_,L),L}{const L=o.clone(_),V=o.identity([]);return V[0]=D[0],V[1]=D[1],V[4]=D[2],V[5]=D[3],o.multiply(L,L,V),x||o.rotateZ(L,L,-E.angle),L}}return E.glCoordMatrix}function Dr(_,l,p,x){const E=[_,l,p,1];p?o.transformMat4$1(E,E,x):or(E,E,x);const A=E[3];return E[0]/=A,E[1]/=A,E[2]/=A,E}function Es(_,l){return Math.min(.5+_/l*.5,1.5)}function qs(_,l){const p=_[0]/_[3],x=_[1]/_[3];return p>=-l[0]&&p<=l[0]&&x>=-l[1]&&x<=l[1]}function Tu(_,l,p,x,E,A,D,L,V,G){const q=p.transform,te=x?_.textSizeData:_.iconSizeData,ye=o.evaluateSizeForZoom(te,p.transform.zoom),we=q.projection.name==="globe",Se=[256/p.width*2+1,256/p.height*2+1],Ee=x?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;Ee.clear();let Ce=null;we&&(Ce=x?_.text.globeExtVertexArray:_.icon.globeExtVertexArray);const ne=_.lineVertexArray,be=x?_.text.placedSymbolArray:_.icon.placedSymbolArray,ke=p.transform.width/p.transform.height;let Le,je=!1;for(let He=0;He<be.length;He++){const qe=be.get(He),{numGlyphs:Qe,writingMode:Ye}=qe;if(Ye!==o.WritingMode.vertical||je||Le===o.WritingMode.horizontal||(je=!0),Le=Ye,(qe.hidden||Ye===o.WritingMode.vertical)&&!je){qo(Qe,Ee);continue}je=!1;const lt=new o.Point(qe.tileAnchorX,qe.tileAnchorY);let{x:Vt,y:rt,z:_t}=q.projection.projectTilePoint(lt.x,lt.y,G.canonical);if(V){const[Un,Bt,hn]=V(lt);Vt+=Un,rt+=Bt,_t+=hn}const at=[Vt,rt,_t,1];if(o.transformMat4$1(at,at,l),!qs(at,Se)){qo(Qe,Ee);continue}const Ot=Es(p.transform.cameraToCenterDistance,at[3]),st=o.evaluateSizeForFeature(te,ye,qe),St=D?st/Ot:st*Ot,zt=Dr(Vt,rt,_t,E);if(zt[3]<=0){qo(Qe,Ee);continue}let Ct={};const It=D?null:V,Sn=nn(qe,St,!1,L,l,E,A,_.glyphOffsetArray,ne,Ee,Ce,zt,lt,Ct,ke,It,q.projection,G,D);je=Sn.useVertical,It&&Sn.needsFlipping&&(Ct={}),(Sn.notEnoughRoom||je||Sn.needsFlipping&&nn(qe,St,!0,L,l,E,A,_.glyphOffsetArray,ne,Ee,Ce,zt,lt,Ct,ke,It,q.projection,G,D).notEnoughRoom)&&qo(Qe,Ee)}x?(_.text.dynamicLayoutVertexBuffer.updateData(Ee),Ce&&_.text.globeExtVertexBuffer.updateData(Ce)):(_.icon.dynamicLayoutVertexBuffer.updateData(Ee),Ce&&_.icon.globeExtVertexBuffer.updateData(Ce))}function ui(_,l,p,x,E,A,D,L,V,G,q,te,ye,we,Se,Ee){const{lineStartIndex:Ce,glyphStartIndex:ne,segment:be}=L,ke=ne+L.numGlyphs,Le=Ce+L.lineLength,je=l.getoffsetX(ne),He=l.getoffsetX(ke-1),qe=Ds(_*je,p,x,E,A,D,be,Ce,Le,V,G,q,te,ye,!0,we,Se,Ee);if(!qe)return null;const Qe=Ds(_*He,p,x,E,A,D,be,Ce,Le,V,G,q,te,ye,!0,we,Se,Ee);return Qe?{first:qe,last:Qe}:null}function Sa(_,l,p,x){return _===o.WritingMode.horizontal&&Math.abs(x)>Math.abs(p)?{useVertical:!0}:_===o.WritingMode.vertical?x>0?{needsFlipping:!0}:null:l!==ta.unknown&&(function(E,A){return E===0||Math.abs(A/E)>Wl})(p,x)?l===ta.flipRequired?{needsFlipping:!0}:null:p<0?{needsFlipping:!0}:null}function nn(_,l,p,x,E,A,D,L,V,G,q,te,ye,we,Se,Ee,Ce,ne,be){const ke=l/24,Le=_.lineOffsetX*ke,je=_.lineOffsetY*ke,{lineStartIndex:He,glyphStartIndex:qe,numGlyphs:Qe,segment:Ye,writingMode:lt,flipState:Vt}=_,rt=He+_.lineLength,_t=at=>{if(q){const[zt,Ct,It]=at.up,Sn=G.length;o.updateGlobeVertexNormal(q,Sn+0,zt,Ct,It),o.updateGlobeVertexNormal(q,Sn+1,zt,Ct,It),o.updateGlobeVertexNormal(q,Sn+2,zt,Ct,It),o.updateGlobeVertexNormal(q,Sn+3,zt,Ct,It)}const[Ot,st,St]=at.point;o.addDynamicAttributes(G,Ot,st,St,at.angle)};if(Qe>1){const at=ui(ke,L,Le,je,p,te,ye,_,V,A,we,Ee,!1,Ce,ne,be);if(!at)return{notEnoughRoom:!0};if(x&&!p){let[Ot,st,St]=at.first.point,[zt,Ct,It]=at.last.point;[Ot,st]=Dr(Ot,st,St,D),[zt,Ct]=Dr(zt,Ct,It,D);const Sn=Sa(lt,Vt,(zt-Ot)*Se,Ct-st);if(_.flipState=Sn&&Sn.needsFlipping?ta.flipRequired:ta.flipNotRequired,Sn)return Sn}_t(at.first);for(let Ot=qe+1;Ot<qe+Qe-1;Ot++){const st=Ds(ke*L.getoffsetX(Ot),Le,je,p,te,ye,Ye,He,rt,V,A,we,Ee,!1,!1,Ce,ne,be);if(!st)return G.length-=4*(Ot-qe),{notEnoughRoom:!0};_t(st)}_t(at.last)}else{if(x&&!p){const Ot=Dr(ye.x,ye.y,0,E),st=He+Ye+1,St=new o.Point(V.getx(st),V.gety(st)),zt=Dr(St.x,St.y,0,E),Ct=zt[3]>0?zt:Wn(ye,St,Ot,1,E,void 0,Ce,ne.canonical),It=Sa(lt,Vt,(Ct[0]-Ot[0])*Se,Ct[1]-Ot[1]);if(_.flipState=It&&It.needsFlipping?ta.flipRequired:ta.flipNotRequired,It)return It}const at=Ds(ke*L.getoffsetX(qe),Le,je,p,te,ye,Ye,He,rt,V,A,we,Ee,!1,!1,Ce,ne,be);if(!at)return{notEnoughRoom:!0};_t(at)}return{}}function sr(_,l,p,x,E){const{x:A,y:D,z:L}=x.projectTilePoint(_.x,_.y,l);if(!E)return Dr(A,D,L,p);const[V,G,q]=E(_);return Dr(A+V,D+G,L+q,p)}function Wn(_,l,p,x,E,A,D,L){const V=sr(_.sub(l)._unit()._add(_),L,E,D,A);return o.sub(V,p,V),o.normalize(V,V),o.scaleAndAdd(V,p,V,x)}function Ds(_,l,p,x,E,A,D,L,V,G,q,te,ye,we,Se,Ee,Ce,ne){const be=x?_-l:_+l;let ke=be>0?1:-1,Le=0;x&&(ke*=-1,Le=Math.PI),ke<0&&(Le+=Math.PI);let je=L+D+(ke>0?0:1)|0,He=E,qe=E,Qe=0,Ye=0;const lt=Math.abs(be),Vt=[],rt=[];let _t=A,at=_t;const Ot=()=>Wn(at,_t,qe,lt-Qe+1,q,ye,Ee,Ce.canonical);for(;Qe+Ye<=lt;){if(je+=ke,je<L||je>=V)return null;if(qe=He,at=_t,Vt.push(qe),we&&rt.push(at),_t=new o.Point(G.getx(je),G.gety(je)),He=te[je],!He){const hn=sr(_t,Ce.canonical,q,Ee,ye);He=hn[3]>0?te[je]=hn:Ot()}Qe+=Ye,Ye=o.distance(qe,He)}Se&&ye&&(te[je]&&(He=Ot(),Ye=o.distance(qe,He)),te[je]=He);const st=(lt-Qe)/Ye,St=_t.sub(at)._mult(st)._add(at),zt=o.sub([],He,qe),Ct=o.scaleAndAdd([],qe,zt,st);let It=[0,0,1],Sn=zt[0],Un=zt[1];if(ne&&(It=Ee.upVector(Ce.canonical,St.x,St.y),It[0]!==0||It[1]!==0||It[2]!==1)){const hn=[It[2],0,-It[0]],Fn=o.cross([],It,hn);o.normalize(hn,hn),o.normalize(Fn,Fn),Sn=o.dot(zt,hn),Un=o.dot(zt,Fn)}if(p){const hn=o.cross([],It,zt);o.normalize(hn,hn),o.scaleAndAdd(Ct,Ct,hn,p*ke)}const Bt=Le+Math.atan2(Un,Sn);return Vt.push(Ct),we&&rt.push(St),{point:Ct,angle:Bt,path:Vt,tilePath:rt,up:It}}function qo(_,l){const p=l.length,x=p+4*_;l.resize(x),l.float32.fill(-1/0,4*p,4*x)}function or(_,l,p){const x=l[0],E=l[1];return _[0]=p[0]*x+p[4]*E+p[12],_[1]=p[1]*x+p[5]*E+p[13],_[3]=p[3]*x+p[7]*E+p[15],_}const ys=100;class Ac{constructor(l,p,x=new tl(l.width+200,l.height+200,25),E=new tl(l.width+200,l.height+200,25)){this.transform=l,this.grid=x,this.ignoredGrid=E,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+ys,this.screenBottomBoundary=l.height+ys,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.fogState=p}placeCollisionBox(l,p,x,E,A,D,L,V){let G=x.projectedAnchorX,q=x.projectedAnchorY,te=x.projectedAnchorZ;const ye=x.elevation,we=x.tileID,Se=l.getProjection();if(ye&&we){const[He,qe,Qe]=Se.upVector(we.canonical,x.tileAnchorX,x.tileAnchorY),Ye=Se.upVectorScale(we.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;G+=He*ye*Ye,q+=qe*ye*Ye,te+=Qe*ye*Ye}const Ee=this.projectAndGetPerspectiveRatio(L,G,q,te,x.tileID,Se.name==="globe"||!!ye||this.transform.pitch>0,Se),Ce=D*Ee.perspectiveRatio,ne=(x.x1*p+E.x-x.padding)*Ce+Ee.point.x,be=(x.y1*p+E.y-x.padding)*Ce+Ee.point.y,ke=(x.x2*p+E.x+x.padding)*Ce+Ee.point.x,Le=(x.y2*p+E.y+x.padding)*Ce+Ee.point.y,je=Ee.perspectiveRatio<=.55||Ee.occluded;return!this.isInsideGrid(ne,be,ke,Le)||!A&&this.grid.hitTest(ne,be,ke,Le,V)||je?{box:[],offscreen:!1,occluded:Ee.occluded}:{box:[ne,be,ke,Le],offscreen:this.isOffscreen(ne,be,ke,Le),occluded:!1}}placeCollisionCircles(l,p,x,E,A,D,L,V,G,q,te,ye,we,Se,Ee){const Ce=[],ne=this.transform.elevation,be=l.getProjection(),ke=ne?ne.getAtTileOffsetFunc(Ee,this.transform.center.lat,this.transform.worldSize,be):null,Le=new o.Point(x.tileAnchorX,x.tileAnchorY);let{x:je,y:He,z:qe}=be.projectTilePoint(Le.x,Le.y,Ee.canonical);if(ke){const[St,zt,Ct]=ke(Le);je+=St,He+=zt,qe+=Ct}const Qe=be.name==="globe",Ye=this.projectAndGetPerspectiveRatio(L,je,He,qe,Ee,Qe||!!ne||this.transform.pitch>0,be),{perspectiveRatio:lt}=Ye,Vt=(te?D/lt:D*lt)/o.ONE_EM,rt=Dr(je,He,qe,V),_t=Ye.signedDistanceFromCamera>0?ui(Vt,A,x.lineOffsetX*Vt,x.lineOffsetY*Vt,!1,rt,Le,x,E,V,{},ne&&!te?ke:null,te&&!!ne,be,Ee,te):null;let at=!1,Ot=!1,st=!0;if(_t&&!Ye.occluded){const St=.5*we*lt+Se,zt=new o.Point(-100,-100),Ct=new o.Point(this.screenRightBoundary,this.screenBottomBoundary),It=new Ea,{first:Sn,last:Un}=_t,Bt=Sn.path.length;let hn=[];for(let Tn=Bt-1;Tn>=1;Tn--)hn.push(Sn.path[Tn]);for(let Tn=1;Tn<Un.path.length;Tn++)hn.push(Un.path[Tn]);const Fn=2.5*St;G&&(hn=hn.map((([Tn,Pr,Kr],qr)=>(ke&&!Qe&&(Kr=ke(qr<Bt-1?Sn.tilePath[Bt-1-qr]:Un.tilePath[qr-Bt+2])[2]),Dr(Tn,Pr,Kr,G)))),hn.some((Tn=>Tn[3]<=0))&&(hn=[]));let ar=[];if(hn.length>0){let Tn=1/0,Pr=-1/0,Kr=1/0,qr=-1/0;for(const Vr of hn)Tn=Math.min(Tn,Vr[0]),Kr=Math.min(Kr,Vr[1]),Pr=Math.max(Pr,Vr[0]),qr=Math.max(qr,Vr[1]);Pr>=zt.x&&Tn<=Ct.x&&qr>=zt.y&&Kr<=Ct.y&&(ar=[hn.map((Vr=>new o.Point(Vr[0],Vr[1])))],(Tn<zt.x||Pr>Ct.x||Kr<zt.y||qr>Ct.y)&&(ar=o.clipLine(ar,zt.x,zt.y,Ct.x,Ct.y)))}for(const Tn of ar){It.reset(Tn,.25*St);let Pr=0;Pr=It.length<=.5*St?1:Math.ceil(It.paddedLength/Fn)+1;for(let Kr=0;Kr<Pr;Kr++){const qr=Kr/Math.max(Pr-1,1),Vr=It.lerp(qr),so=Vr.x+ys,kr=Vr.y+ys;Ce.push(so,kr,St,0);const Zo=so-St,Na=kr-St,Mi=so+St,li=kr+St;if(st=st&&this.isOffscreen(Zo,Na,Mi,li),Ot=Ot||this.isInsideGrid(Zo,Na,Mi,li),!p&&this.grid.hitTestCircle(so,kr,St,ye)&&(at=!0,!q))return{circles:[],offscreen:!1,collisionDetected:at,occluded:!1}}}}return{circles:!q&&at||!Ot?[]:Ce,offscreen:st,collisionDetected:at,occluded:Ye.occluded}}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const p=[];let x=1/0,E=1/0,A=-1/0,D=-1/0;for(const q of l){const te=new o.Point(q.x+ys,q.y+ys);x=Math.min(x,te.x),E=Math.min(E,te.y),A=Math.max(A,te.x),D=Math.max(D,te.y),p.push(te)}const L=this.grid.query(x,E,A,D).concat(this.ignoredGrid.query(x,E,A,D)),V={},G={};for(const q of L){const te=q.key;if(V[te.bucketInstanceId]===void 0&&(V[te.bucketInstanceId]={}),V[te.bucketInstanceId][te.featureIndex])continue;const ye=[new o.Point(q.x1,q.y1),new o.Point(q.x2,q.y1),new o.Point(q.x2,q.y2),new o.Point(q.x1,q.y2)];o.polygonIntersectsPolygon(p,ye)&&(V[te.bucketInstanceId][te.featureIndex]=!0,G[te.bucketInstanceId]===void 0&&(G[te.bucketInstanceId]=[]),G[te.bucketInstanceId].push(te.featureIndex))}return G}insertCollisionBox(l,p,x,E,A){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:x,featureIndex:E,collisionGroupID:A},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,p,x,E,A){const D=p?this.ignoredGrid:this.grid,L={bucketInstanceId:x,featureIndex:E,collisionGroupID:A};for(let V=0;V<l.length;V+=4)D.insertCircle(L,l[V],l[V+1],l[V+2])}projectAndGetPerspectiveRatio(l,p,x,E,A,D,L){const V=[p,x,E,1];let G=!1;E||this.transform.pitch>0?(o.transformMat4$1(V,V,l),this.fogState&&A&&L.name!=="globe"&&(G=(function(ye,we,Se,Ee,Ce,ne){const be=ne.calculateFogTileMatrix(Ce),ke=[we,Se,Ee];return o.transformMat4(ke,ke,be),Je(ye,ke,ne.pitch,ne._fov)})(this.fogState,p,x,E,A.toUnwrapped(),this.transform)>.9)):or(V,V,l);const q=V[3];return{point:new o.Point((V[0]/q+1)/2*this.transform.width+ys,(-V[1]/q+1)/2*this.transform.height+ys),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(L)/q*.5,1.5),signedDistanceFromCamera:q,occluded:D&&V[2]>q||G}}isOffscreen(l,p,x,E){return x<ys||l>=this.screenRightBoundary||E<ys||p>this.screenBottomBoundary}isInsideGrid(l,p,x,E){return x>=0&&l<this.gridRightBoundary&&E>=0&&p<this.gridBottomBoundary}getViewportMatrix(){const l=o.identity([]);return o.translate(l,l,[-100,-100,0]),l}}function Go(_,l,p){const x=l.createTileMatrix(_,_.worldSize,p.toUnwrapped());return o.multiply(new Float32Array(16),_.projMatrix,x)}function Hi(_,l,p){if(l.projection.name===p.projection.name)return _.projMatrix;const x=p.clone();return x.setProjection(l.projection),Go(x,l.getProjection(),_)}function gi(_,l,p){return l.name===p.projection.name?_.projMatrix:Go(p,l,_)}class vh{constructor(l,p,x,E){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?p:-p))):E&&x?1:0,this.placed=x}isHidden(){return this.opacity===0&&!this.placed}}class na{constructor(l,p,x,E,A,D=!1){this.text=new vh(l?l.text:null,p,x,A),this.icon=new vh(l?l.icon:null,p,E,A),this.clipped=D}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Tl{constructor(l,p,x,E=!1){this.text=l,this.icon=p,this.skipFade=x,this.clipped=E}}class Ic{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class El{constructor(l,p,x,E,A){this.bucketInstanceId=l,this.featureIndex=p,this.sourceLayerIndex=x,this.bucketIndex=E,this.tileID=A}}class Eu{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const p=++this.maxGroupID;this.collisionGroups[l]={ID:p,predicate:x=>x.collisionGroupID===p}}return this.collisionGroups[l]}}function So(_,l,p,x,E){const{horizontalAlign:A,verticalAlign:D}=o.getAnchorAlignment(_),L=-(A-.5)*l,V=-(D-.5)*p,G=o.evaluateVariableOffset(_,x);return new o.Point(L+G[0]*E,V+G[1]*E)}function Xl(_,l,p,x,E){const A=new o.Point(_,l);return p&&A._rotate(x?E:-E),A}class Co{constructor(l,p,x,E,A){this.transform=l.clone(),this.projection=l.projection.name,this.collisionIndex=new Ac(this.transform,A),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Eu(x),this.collisionCircleArrays={},this.prevPlacement=E,E&&(E.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,p,x,E){const A=x.getBucket(p),D=x.latestFeatureIndex;if(!A||!D||p.id!==A.layerIds[0])return;const L=A.layers[0].layout,V=x.collisionBoxArray,G=Math.pow(2,this.transform.zoom-x.tileID.overscaledZ),q=x.tileSize/o.EXTENT,te=x.tileID.toUnwrapped();this.transform.setProjection(A.projection);const ye=(we=x.tileID,Se=A.getProjection(),Ee=this.transform,Se.name===this.projection?Ee.calculateProjMatrix(we.toUnwrapped()):Go(Ee,Se,we));var we,Se,Ee;const Ce=L.get("text-pitch-alignment")==="map",ne=L.get("text-rotation-alignment")==="map";p.compileFilter();const be=p.dynamicFilter(),ke=p.dynamicFilterNeedsFeature(),Le=this.transform.calculatePixelsToTileUnitsMatrix(x),je=$o(ye,x.tileID.canonical,Ce,ne,this.transform,A.getProjection(),Le);let He=null;if(Ce){const Ye=Zr(ye,x.tileID.canonical,Ce,ne,this.transform,A.getProjection(),Le);He=o.multiply([],this.transform.labelPlaneMatrix,Ye)}let qe=null;be&&x.latestFeatureIndex&&(qe={unwrappedTileID:te,dynamicFilter:be,dynamicFilterNeedsFeature:ke,featureIndex:x.latestFeatureIndex}),this.retainedQueryData[A.bucketInstanceId]=new El(A.bucketInstanceId,D,A.sourceLayerIndex,A.index,x.tileID);const Qe={bucket:A,layout:L,posMatrix:ye,textLabelPlaneMatrix:je,labelToScreenMatrix:He,clippingData:qe,scale:G,textPixelRatio:q,holdingForFade:x.holdingForFade(),collisionBoxArray:V,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(A.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:o.evaluateSizeForZoom(A.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(A.sourceID)};if(E)for(const Ye of A.sortKeyRanges){const{sortKey:lt,symbolInstanceStart:Vt,symbolInstanceEnd:rt}=Ye;l.push({sortKey:lt,symbolInstanceStart:Vt,symbolInstanceEnd:rt,parameters:Qe})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:A.symbolInstances.length,parameters:Qe})}attemptAnchorPlacement(l,p,x,E,A,D,L,V,G,q,te,ye,we,Se,Ee,Ce,ne,be){const{textOffset0:ke,textOffset1:Le,crossTileID:je}=ye,He=[ke,Le],qe=So(l,x,E,He,A),Qe=this.collisionIndex.placeCollisionBox(Se,A,p,Xl(qe.x,qe.y,D,L,this.transform.angle),te,V,G,q.predicate);if(Ce){const Ye=Se.getSymbolInstanceIconSize(be,this.transform.zoom,ye.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(Se,Ye,Ce,Xl(qe.x,qe.y,D,L,this.transform.angle),te,V,G,q.predicate).box.length===0)return}if(Qe.box.length>0){let Ye;return this.prevPlacement&&this.prevPlacement.variableOffsets[je]&&this.prevPlacement.placements[je]&&this.prevPlacement.placements[je].text&&(Ye=this.prevPlacement.variableOffsets[je].anchor),this.variableOffsets[je]={textOffset:He,width:x,height:E,anchor:l,textScale:A,prevAnchor:Ye},this.markUsedJustification(Se,l,ye,Ee),Se.allowVerticalPlacement&&(this.markUsedOrientation(Se,Ee,ye),this.placedOrientations[je]=Ee),{shift:qe,placedGlyphBoxes:Qe}}}placeLayerBucketPart(l,p,x,E){const{bucket:A,layout:D,posMatrix:L,textLabelPlaneMatrix:V,labelToScreenMatrix:G,clippingData:q,textPixelRatio:te,holdingForFade:ye,collisionBoxArray:we,partiallyEvaluatedTextSize:Se,partiallyEvaluatedIconSize:Ee,collisionGroup:Ce}=l.parameters,ne=D.get("text-optional"),be=D.get("icon-optional"),ke=D.get("text-allow-overlap"),Le=D.get("icon-allow-overlap"),je=D.get("text-rotation-alignment")==="map",He=D.get("text-pitch-alignment")==="map",qe=D.get("icon-text-fit")!=="none",Qe=D.get("symbol-z-order")==="viewport-y";this.transform.setProjection(A.projection);let Ye=ke&&(Le||!A.hasIconData()||be),lt=Le&&(ke||!A.hasTextData()||ne);!A.collisionArrays&&we&&A.deserializeCollisionBoxes(we),x&&E&&A.updateCollisionDebugBuffers(this.transform.zoom,we);const Vt=(rt,_t,at)=>{const{crossTileID:Ot,numVerticalGlyphVertices:st}=rt;if(q){const Mi={zoom:this.transform.zoom,pitch:this.transform.pitch};let li=null;if(q.dynamicFilterNeedsFeature){const Fr=this.retainedQueryData[A.bucketInstanceId];li=q.featureIndex.loadFeature({featureIndex:rt.featureIndex,bucketIndex:Fr.bucketIndex,sourceLayerIndex:Fr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,q.dynamicFilter)(Mi,li,this.retainedQueryData[A.bucketInstanceId].tileID.canonical,new o.Point(rt.tileAnchorX,rt.tileAnchorY),this.transform.calculateDistanceTileData(q.unwrappedTileID)))return this.placements[Ot]=new Tl(!1,!1,!1,!0),void p.add(Ot)}if(p.has(Ot))return;if(ye)return void(this.placements[Ot]=new Tl(!1,!1,!1));let St=!1,zt=!1,Ct=!0,It=!1,Sn=!1,Un=null,Bt={box:null,offscreen:null,occluded:null},hn={box:null},Fn=null,ar=null,Tn=null,Pr=0,Kr=0,qr=0;at.textFeatureIndex?Pr=at.textFeatureIndex:rt.useRuntimeCollisionCircles&&(Pr=rt.featureIndex),at.verticalTextFeatureIndex&&(Kr=at.verticalTextFeatureIndex);const Vr=Mi=>{Mi.tileID=this.retainedQueryData[A.bucketInstanceId].tileID;const li=this.transform.elevation;(li||Mi.elevation)&&(Mi.elevation=li?li.getAtTileOffset(Mi.tileID,Mi.tileAnchorX,Mi.tileAnchorY):0)},so=at.textBox;if(so){Vr(so);const Mi=Fr=>{let ss=o.WritingMode.horizontal;if(A.allowVerticalPlacement&&!Fr&&this.prevPlacement){const Hs=this.prevPlacement.placedOrientations[Ot];Hs&&(this.placedOrientations[Ot]=Hs,ss=Hs,this.markUsedOrientation(A,ss,rt))}return ss},li=(Fr,ss)=>{if(A.allowVerticalPlacement&&st>0&&at.verticalTextBox){for(const Hs of A.writingModes)if(Hs===o.WritingMode.vertical?(Bt=ss(),hn=Bt):Bt=Fr(),Bt&&Bt.box&&Bt.box.length)break}else Bt=Fr()};if(D.get("text-variable-anchor")){let Fr=D.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ot]){const vi=this.prevPlacement.variableOffsets[Ot];Fr.indexOf(vi.anchor)>0&&(Fr=Fr.filter((Ei=>Ei!==vi.anchor)),Fr.unshift(vi.anchor))}const ss=(vi,Ei,Ji)=>{const Ml=A.getSymbolInstanceTextSize(Se,rt,this.transform.zoom,_t),lc=(vi.x2-vi.x1)*Ml+2*vi.padding,Va=(vi.y2-vi.y1)*Ml+2*vi.padding,Pl=qe&&!Le?Ei:null;Pl&&Vr(Pl);let Mo={box:[],offscreen:!1,occluded:!1};const Uu=ke?2*Fr.length:Fr.length;for(let ju=0;ju<Uu;++ju){const ef=this.attemptAnchorPlacement(Fr[ju%Fr.length],vi,lc,Va,Ml,je,He,te,L,Ce,ju>=Fr.length,rt,_t,A,Ji,Pl,Se,Ee);if(ef&&(Mo=ef.placedGlyphBoxes,Mo&&Mo.box&&Mo.box.length)){St=!0,Un=ef.shift;break}}return Mo};li((()=>ss(so,at.iconBox,o.WritingMode.horizontal)),(()=>{const vi=at.verticalTextBox;return vi&&Vr(vi),A.allowVerticalPlacement&&!(Bt&&Bt.box&&Bt.box.length)&&st>0&&vi?ss(vi,at.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null,occluded:null}})),Bt&&(St=Bt.box,Ct=Bt.offscreen,It=Bt.occluded);const Hs=Mi(!(!Bt||!Bt.box));if(!St&&this.prevPlacement){const vi=this.prevPlacement.variableOffsets[Ot];vi&&(this.variableOffsets[Ot]=vi,this.markUsedJustification(A,vi.anchor,rt,Hs))}}else{const Fr=(ss,Hs)=>{const vi=A.getSymbolInstanceTextSize(Se,rt,this.transform.zoom,_t),Ei=this.collisionIndex.placeCollisionBox(A,vi,ss,new o.Point(0,0),ke,te,L,Ce.predicate);return Ei&&Ei.box&&Ei.box.length&&(this.markUsedOrientation(A,Hs,rt),this.placedOrientations[Ot]=Hs),Ei};li((()=>Fr(so,o.WritingMode.horizontal)),(()=>{const ss=at.verticalTextBox;return A.allowVerticalPlacement&&st>0&&ss?(Vr(ss),Fr(ss,o.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}})),Mi(!!(Bt&&Bt.box&&Bt.box.length))}}if(Fn=Bt,St=Fn&&Fn.box&&Fn.box.length>0,Ct=Fn&&Fn.offscreen,It=Fn&&Fn.occluded,rt.useRuntimeCollisionCircles){const Mi=A.text.placedSymbolArray.get(rt.centerJustifiedTextSymbolIndex>=0?rt.centerJustifiedTextSymbolIndex:rt.verticalPlacedTextSymbolIndex),li=o.evaluateSizeForFeature(A.textSizeData,Se,Mi),Fr=D.get("text-padding");ar=this.collisionIndex.placeCollisionCircles(A,ke,Mi,A.lineVertexArray,A.glyphOffsetArray,li,L,V,G,x,He,Ce.predicate,rt.collisionCircleDiameter*li/o.ONE_EM,Fr,this.retainedQueryData[A.bucketInstanceId].tileID),St=ke||ar.circles.length>0&&!ar.collisionDetected,Ct=Ct&&ar.offscreen,It=ar.occluded}if(at.iconFeatureIndex&&(qr=at.iconFeatureIndex),at.iconBox){const Mi=li=>{Vr(li);const Fr=qe&&Un?Xl(Un.x,Un.y,je,He,this.transform.angle):new o.Point(0,0),ss=A.getSymbolInstanceIconSize(Ee,this.transform.zoom,rt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(A,ss,li,Fr,Le,te,L,Ce.predicate)};hn&&hn.box&&hn.box.length&&at.verticalIconBox?(Tn=Mi(at.verticalIconBox),zt=Tn.box.length>0):(Tn=Mi(at.iconBox),zt=Tn.box.length>0),Ct=Ct&&Tn.offscreen,Sn=Tn.occluded}const kr=ne||rt.numHorizontalGlyphVertices===0&&st===0,Zo=be||rt.numIconVertices===0;if(kr||Zo?Zo?kr||(zt=zt&&St):St=zt&&St:zt=St=zt&&St,St&&Fn&&Fn.box&&this.collisionIndex.insertCollisionBox(Fn.box,D.get("text-ignore-placement"),A.bucketInstanceId,hn&&hn.box&&Kr?Kr:Pr,Ce.ID),zt&&Tn&&this.collisionIndex.insertCollisionBox(Tn.box,D.get("icon-ignore-placement"),A.bucketInstanceId,qr,Ce.ID),ar&&(St&&this.collisionIndex.insertCollisionCircles(ar.circles,D.get("text-ignore-placement"),A.bucketInstanceId,Pr,Ce.ID),x)){const Mi=A.bucketInstanceId;let li=this.collisionCircleArrays[Mi];li===void 0&&(li=this.collisionCircleArrays[Mi]=new Ic);for(let Fr=0;Fr<ar.circles.length;Fr+=4)li.circles.push(ar.circles[Fr+0]),li.circles.push(ar.circles[Fr+1]),li.circles.push(ar.circles[Fr+2]),li.circles.push(ar.collisionDetected?1:0)}const Na=A.projection.name!=="globe";Ye=Ye&&(Na||!It),lt=lt&&(Na||!Sn),this.placements[Ot]=new Tl(St||Ye,zt||lt,Ct||A.justReloaded),p.add(Ot)};if(Qe){const rt=A.getSortedSymbolIndexes(this.transform.angle);for(let _t=rt.length-1;_t>=0;--_t){const at=rt[_t];Vt(A.symbolInstances.get(at),at,A.collisionArrays[at])}}else for(let rt=l.symbolInstanceStart;rt<l.symbolInstanceEnd;rt++)Vt(A.symbolInstances.get(rt),rt,A.collisionArrays[rt]);if(x&&A.bucketInstanceId in this.collisionCircleArrays){const rt=this.collisionCircleArrays[A.bucketInstanceId];o.invert(rt.invProjMatrix,L),rt.viewportMatrix=this.collisionIndex.getViewportMatrix()}A.justReloaded=!1}markUsedJustification(l,p,x,E){const{leftJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:D,rightJustifiedTextSymbolIndex:L,verticalPlacedTextSymbolIndex:V,crossTileID:G}=x,q=o.getAnchorJustification(p),te=E===o.WritingMode.vertical?V:q==="left"?A:q==="center"?D:q==="right"?L:-1;A>=0&&(l.text.placedSymbolArray.get(A).crossTileID=te>=0&&A!==te?0:G),D>=0&&(l.text.placedSymbolArray.get(D).crossTileID=te>=0&&D!==te?0:G),L>=0&&(l.text.placedSymbolArray.get(L).crossTileID=te>=0&&L!==te?0:G),V>=0&&(l.text.placedSymbolArray.get(V).crossTileID=te>=0&&V!==te?0:G)}markUsedOrientation(l,p,x){const E=p===o.WritingMode.horizontal||p===o.WritingMode.horizontalOnly?p:0,A=p===o.WritingMode.vertical?p:0,{leftJustifiedTextSymbolIndex:D,centerJustifiedTextSymbolIndex:L,rightJustifiedTextSymbolIndex:V,verticalPlacedTextSymbolIndex:G}=x,q=l.text.placedSymbolArray;D>=0&&(q.get(D).placedOrientation=E),L>=0&&(q.get(L).placedOrientation=E),V>=0&&(q.get(V).placedOrientation=E),G>=0&&(q.get(G).placedOrientation=A)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const p=this.prevPlacement;let x=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;const E=p?p.symbolFadeChange(l):1,A=p?p.opacities:{},D=p?p.variableOffsets:{},L=p?p.placedOrientations:{};for(const V in this.placements){const G=this.placements[V],q=A[V];q?(this.opacities[V]=new na(q,E,G.text,G.icon,null,G.clipped),x=x||G.text!==q.text.placed||G.icon!==q.icon.placed):(this.opacities[V]=new na(null,E,G.text,G.icon,G.skipFade,G.clipped),x=x||G.text||G.icon)}for(const V in A){const G=A[V];if(!this.opacities[V]){const q=new na(G,E,!1,!1);q.isHidden()||(this.opacities[V]=q,x=x||G.text.placed||G.icon.placed)}}for(const V in D)this.variableOffsets[V]||!this.opacities[V]||this.opacities[V].isHidden()||(this.variableOffsets[V]=D[V]);for(const V in L)this.placedOrientations[V]||!this.opacities[V]||this.opacities[V].isHidden()||(this.placedOrientations[V]=L[V]);x?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:l)}updateLayerOpacities(l,p){const x=new Set;for(const E of p){const A=E.getBucket(l);A&&E.latestFeatureIndex&&l.id===A.layerIds[0]&&this.updateBucketOpacities(A,x,E.collisionBoxArray)}}updateBucketOpacities(l,p,x){l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const E=l.layers[0].layout,A=!!l.layers[0].dynamicFilter(),D=new na(null,0,!1,!1,!0),L=E.get("text-allow-overlap"),V=E.get("icon-allow-overlap"),G=E.get("text-variable-anchor"),q=E.get("text-rotation-alignment")==="map",te=E.get("text-pitch-alignment")==="map",ye=E.get("icon-text-fit")!=="none",we=new na(null,0,L&&(V||!l.hasIconData()||E.get("icon-optional")),V&&(L||!l.hasTextData()||E.get("text-optional")),!0);!l.collisionArrays&&x&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(x);const Se=(Ce,ne,be)=>{for(let ke=0;ke<ne/4;ke++)Ce.opacityVertexArray.emplaceBack(be)};let Ee=0;for(let Ce=0;Ce<l.symbolInstances.length;Ce++){const ne=l.symbolInstances.get(Ce),{numHorizontalGlyphVertices:be,numVerticalGlyphVertices:ke,crossTileID:Le,numIconVertices:je}=ne,He=p.has(Le);let qe=this.opacities[Le];He?qe=D:qe||(qe=we,this.opacities[Le]=qe),p.add(Le);const Qe=be>0||ke>0,Ye=je>0,lt=this.placedOrientations[Le],Vt=lt===o.WritingMode.vertical,rt=lt===o.WritingMode.horizontal||lt===o.WritingMode.horizontalOnly;if(!Qe&&!Ye||qe.isHidden()||Ee++,Qe){const _t=ni(qe.text);Se(l.text,be,Vt?ri:_t),Se(l.text,ke,rt?ri:_t);const at=qe.text.isHidden(),{leftJustifiedTextSymbolIndex:Ot,centerJustifiedTextSymbolIndex:st,rightJustifiedTextSymbolIndex:St,verticalPlacedTextSymbolIndex:zt}=ne,Ct=l.text.placedSymbolArray,It=at||Vt?1:0;Ot>=0&&(Ct.get(Ot).hidden=It),st>=0&&(Ct.get(st).hidden=It),St>=0&&(Ct.get(St).hidden=It),zt>=0&&(Ct.get(zt).hidden=at||rt?1:0);const Sn=this.variableOffsets[Le];Sn&&this.markUsedJustification(l,Sn.anchor,ne,lt);const Un=this.placedOrientations[Le];Un&&(this.markUsedJustification(l,"left",ne,Un),this.markUsedOrientation(l,Un,ne))}if(Ye){const _t=ni(qe.icon),{placedIconSymbolIndex:at,verticalPlacedIconSymbolIndex:Ot}=ne,st=l.icon.placedSymbolArray,St=qe.icon.isHidden()?1:0;at>=0&&(Se(l.icon,je,Vt?ri:_t),st.get(at).hidden=St),Ot>=0&&(Se(l.icon,ne.numVerticalIconVertices,rt?ri:_t),st.get(Ot).hidden=St)}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const _t=l.collisionArrays[Ce];if(_t){let at=new o.Point(0,0),Ot=!0;if(_t.textBox||_t.verticalTextBox){if(G){const St=this.variableOffsets[Le];St?(at=So(St.anchor,St.width,St.height,St.textOffset,St.textScale),q&&at._rotate(te?this.transform.angle:-this.transform.angle)):Ot=!1}A&&(Ot=!qe.clipped),_t.textBox&&ra(l.textCollisionBox.collisionVertexArray,qe.text.placed,!Ot||Vt,at.x,at.y),_t.verticalTextBox&&ra(l.textCollisionBox.collisionVertexArray,qe.text.placed,!Ot||rt,at.x,at.y)}const st=Ot&&!!(!rt&&_t.verticalIconBox);_t.iconBox&&ra(l.iconCollisionBox.collisionVertexArray,qe.icon.placed,st,ye?at.x:0,ye?at.y:0),_t.verticalIconBox&&ra(l.iconCollisionBox.collisionVertexArray,qe.icon.placed,!st,ye?at.x:0,ye?at.y:0)}}}if(l.fullyClipped=Ee===0,l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.bucketInstanceId in this.collisionCircleArrays){const Ce=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=Ce.invProjMatrix,l.placementViewportMatrix=Ce.viewportMatrix,l.collisionCircleArray=Ce.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,p){const x=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*x>l}setStale(){this.stale=!0}}function ra(_,l,p,x,E){_.emplaceBack(l?1:0,p?1:0,x||0,E||0),_.emplaceBack(l?1:0,p?1:0,x||0,E||0),_.emplaceBack(l?1:0,p?1:0,x||0,E||0),_.emplaceBack(l?1:0,p?1:0,x||0,E||0)}const ns=Math.pow(2,25),Ti=Math.pow(2,24),Rc=Math.pow(2,17),Sl=Math.pow(2,16),Yi=Math.pow(2,9),rs=Math.pow(2,8),Mc=Math.pow(2,1);function ni(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const l=_.placed?1:0,p=Math.floor(127*_.opacity);return p*ns+l*Ti+p*Rc+l*Sl+p*Yi+l*rs+p*Mc+l}const ri=0;class Zl{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&l.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(l,p,x,E,A){const D=this._bucketParts;for(;this._currentTileIndex<l.length;)if(p.getBucketParts(D,E,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,A())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort(((L,V)=>L.sortKey-V.sortKey)));this._currentPartIndex<D.length;){const L=D[this._currentPartIndex];if(p.placeLayerBucketPart(L,this._seenCrossTileIDs,x,L.symbolInstanceStart===0),this._currentPartIndex++,A())return!0}return!1}}class Kl{constructor(l,p,x,E,A,D,L,V){this.placement=new Co(l,A,D,L,V),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=x,this._showCollisionBoxes=E,this._done=!1}isDone(){return this._done}continuePlacement(l,p,x){const E=o.exported.now(),A=()=>{const D=o.exported.now()-E;return!this._forceFullPlacement&&D>2};for(;this._currentPlacementIndex>=0;){const D=p[l[this._currentPlacementIndex]],L=this.placement.collisionIndex.transform.zoom;if(D.type==="symbol"&&(!D.minzoom||D.minzoom<=L)&&(!D.maxzoom||D.maxzoom>L)){if(this._inProgressLayer||(this._inProgressLayer=new Zl(D)),this._inProgressLayer.continuePlacement(x[D.source],this.placement,this._showCollisionBoxes,D,A))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const nl=512/o.EXTENT/2;class is{constructor(l,p,x){this.tileID=l,this.bucketInstanceId=x,this.index=new o.KDBush(p.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const E=l.canonical.x*o.EXTENT,A=l.canonical.y*o.EXTENT;for(let D=0;D<p.length;D++){const{key:L,crossTileID:V,tileAnchorX:G,tileAnchorY:q}=p.get(D),te=Math.floor((E+G)*nl),ye=Math.floor((A+q)*nl);this.index.add(te,ye),this.keys.push(L),this.crossTileIDs.push(V)}this.index.finish()}findMatches(l,p,x){const E=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z),A=nl/Math.pow(2,p.canonical.z-this.tileID.canonical.z),D=p.canonical.x*o.EXTENT,L=p.canonical.y*o.EXTENT;for(let V=0;V<l.length;V++){const G=l.get(V);if(G.crossTileID)continue;const{key:q,tileAnchorX:te,tileAnchorY:ye}=G,we=Math.floor((D+te)*A),Se=Math.floor((L+ye)*A),Ee=this.index.range(we-E,Se-E,we+E,Se+E);for(const Ce of Ee){const ne=this.crossTileIDs[Ce];if(this.keys[Ce]===q&&!x.has(ne)){x.add(ne),G.crossTileID=ne;break}}}}}class rl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ia{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const p=Math.round((l-this.lng)/360);if(p!==0)for(const x in this.indexes){const E=this.indexes[x],A={};for(const D in E){const L=E[D];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+p),A[L.tileID.key]=L}this.indexes[x]=A}this.lng=l}addBucket(l,p,x){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let A=0;A<p.symbolInstances.length;A++)p.symbolInstances.get(A).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]=new Set);const E=this.usedCrossTileIDs[l.overscaledZ];for(const A in this.indexes){const D=this.indexes[A];if(Number(A)>l.overscaledZ)for(const L in D){const V=D[L];V.tileID.isChildOf(l)&&V.findMatches(p.symbolInstances,l,E)}else{const L=D[l.scaledTo(Number(A)).key];L&&L.findMatches(p.symbolInstances,l,E)}}for(let A=0;A<p.symbolInstances.length;A++){const D=p.symbolInstances.get(A);D.crossTileID||(D.crossTileID=x.generate(),E.add(D.crossTileID))}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new is(l,p.symbolInstances,p.bucketInstanceId),!0}removeBucketCrossTileIDs(l,p){for(const x of p.crossTileIDs)this.usedCrossTileIDs[l].delete(x)}removeStaleBuckets(l){let p=!1;for(const x in this.indexes){const E=this.indexes[x];for(const A in E)l[E[A].bucketInstanceId]||(this.removeBucketCrossTileIDs(x,E[A]),delete E[A],p=!0)}return p}}class Wi{constructor(){this.layerIndexes={},this.crossTileIDs=new rl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,p,x,E){let A=this.layerIndexes[l.id];A===void 0&&(A=this.layerIndexes[l.id]=new ia);let D=!1;const L={};E.name!=="globe"&&A.handleWrapJump(x);for(const V of p){const G=V.getBucket(l);G&&l.id===G.layerIds[0]&&(G.bucketInstanceId||(G.bucketInstanceId=++this.maxBucketInstanceId),A.addBucket(V.tileID,G,this.crossTileIDs)&&(D=!0),L[G.bucketInstanceId]=!0)}return A.removeStaleBuckets(L)&&(D=!0),D}pruneUnusedLayers(l){const p={};l.forEach((x=>{p[x]=!0}));for(const x in this.layerIndexes)p[x]||delete this.layerIndexes[x]}}const to=(_,l)=>o.emitValidationErrors(_,l&&l.filter((p=>p.identifier!=="source.canvas"))),sa=o.pick(vr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Pc=o.pick(vr,["setCenter","setZoom","setBearing","setPitch"]),Su={version:8,layers:[],sources:{}},oa={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Ao extends o.Evented{constructor(l,p={}){super(),this.map=l,this.dispatcher=new De(Hl(),this),this.imageManager=new Y,this.imageManager.setEventedParent(this),this.glyphManager=new o.GlyphManager(l._requestManager,p.localFontFamily?o.LocalGlyphMode.all:p.localIdeographFontFamily?o.LocalGlyphMode.ideographs:o.LocalGlyphMode.none,p.localFontFamily||p.localIdeographFontFamily),this.crossTileSymbolIndex=new Wi,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const x=this;this._rtlTextPluginCallback=Ao.registerForPluginStateChange((E=>{x.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:E.pluginStatus,pluginURL:E.pluginURL},((A,D)=>{if(o.triggerPluginCompletionEvent(A),D&&D.every((L=>L)))for(const L in x._sourceCaches){const V=x._sourceCaches[L],G=V.getSource().type;G!=="vector"&&G!=="geojson"||V.reload()}}))})),this.on("data",(E=>{if(E.dataType!=="source"||E.sourceDataType!=="metadata")return;const A=this.getSource(E.sourceId);if(A&&A.vectorLayerIds)for(const D in this._layers){const L=this._layers[D];L.source===A.id&&this._validateLayer(L)}}))}loadURL(l,p={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const x=typeof p.validate=="boolean"?p.validate:!o.isMapboxURL(l);l=this.map._requestManager.normalizeStyleURL(l,p.accessToken);const E=this.map._requestManager.transformRequest(l,o.ResourceType.Style);this._request=o.getJSON(E,((A,D)=>{this._request=null,A?this.fire(new o.ErrorEvent(A)):D&&this._load(D,x)}))}loadJSON(l,p={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame((()=>{this._request=null,this._load(l,p.validate!==!1)}))}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(Su,!1)}_updateLayerCount(l,p){const x=p?1:-1;l.is3D()&&(this._num3DLayers+=x),l.type==="circle"&&(this._numCircleLayers+=x),l.type==="symbol"&&(this._numSymbolLayers+=x)}_load(l,p){if(p&&to(this,o.validateStyle(l)))return;this._loaded=!0,this.stylesheet=o.clone$1(l),this._updateMapProjection();for(const E in l.sources)this.addSource(E,l.sources[E],{validate:!1});this._changed=!1,l.sprite?this._loadSprite(l.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(l.glyphs);const x=wu(this.stylesheet.layers);this._order=x.map((E=>E.id)),this._layers={},this._serializedLayers={};for(const E of x){const A=o.createStyleLayer(E);A.setEventedParent(this,{layer:{id:A.id}}),this._layers[A.id]=A,this._serializedLayers[A.id]=A.serialize(),this._updateLayerCount(A,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ne(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(l){l?this.stylesheet.projection=l:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(l){this._spriteRequest=(function(p,x,E){let A,D,L;const V=o.exported.devicePixelRatio>1?"@2x":"";let G=o.getJSON(x.transformRequest(x.normalizeSpriteURL(p,V,".json"),o.ResourceType.SpriteJSON),((ye,we)=>{G=null,L||(L=ye,A=we,te())})),q=o.getImage(x.transformRequest(x.normalizeSpriteURL(p,V,".png"),o.ResourceType.SpriteImage),((ye,we)=>{q=null,L||(L=ye,D=we,te())}));function te(){if(L)E(L);else if(A&&D){const ye=o.exported.getImageData(D),we={};for(const Se in A){const{width:Ee,height:Ce,x:ne,y:be,sdf:ke,pixelRatio:Le,stretchX:je,stretchY:He,content:qe}=A[Se],Qe=new o.RGBAImage({width:Ee,height:Ce});o.RGBAImage.copy(ye,Qe,{x:ne,y:be},{x:0,y:0},{width:Ee,height:Ce}),we[Se]={data:Qe,pixelRatio:Le,sdf:ke,stretchX:je,stretchY:He,content:qe}}E(null,we)}}return{cancel(){G&&(G.cancel(),G=null),q&&(q.cancel(),q=null)}}})(l,this.map._requestManager,((p,x)=>{if(this._spriteRequest=null,p)this.fire(new o.ErrorEvent(p));else if(x)for(const E in x)this.imageManager.addImage(E,x[E]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new o.Event("data",{dataType:"style"}))}))}_validateLayer(l){const p=this.getSource(l.source);if(!p)return;const x=l.sourceLayer;x&&(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(x)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${x}" does not exist on source "${p.id}" as specified by style layer "${l.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this._sourceCaches)if(!this._sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(l){const p=[];for(const x of l){const E=this._layers[x];E.type!=="custom"&&p.push(E.serialize())}return p}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const l in this._sourceCaches)if(this._sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(l){return!!this.terrain&&(typeof l.isLayerDraped=="function"?l.isLayerDraped():oa[l.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(l){if(!this._loaded)return;const p=this._changed;if(this._changed){const E=Object.keys(this._updatedLayers),A=Object.keys(this._removedLayers);(E.length||A.length)&&this._updateWorkerLayers(E,A);for(const D in this._updatedSources){const L=this._updatedSources[D];L==="reload"?this._reloadSource(D):L==="clear"&&this._clearSource(D)}this._updateTilesForChangedImages();for(const D in this._updatedPaintProps)this._layers[D].updateTransitions(l);this.light.updateTransitions(l),this.fog&&this.fog.updateTransitions(l),this._resetUpdates()}const x={};for(const E in this._sourceCaches){const A=this._sourceCaches[E];x[E]=A.used,A.used=!1}for(const E of this._order){const A=this._layers[E];if(A.recalculate(l,this._availableImages),!A.isHidden(l.zoom)){const L=this._getLayerSourceCache(A);L&&(L.used=!0)}const D=this.map.painter;if(D){const L=A.getProgramIds();if(!L)continue;const V=A.getProgramConfiguration(l.zoom);for(const G of L)D.useProgram(G,V)}}for(const E in x){const A=this._sourceCaches[E];x[E]!==A.used&&A.getSource().fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:A.getSource().id}))}this.light.recalculate(l),this.terrain&&this.terrain.recalculate(l),this.fog&&this.fog.recalculate(l),this.z=l.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),p&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const p in this._sourceCaches)this._sourceCaches[p].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateWorkerLayers(l,p){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(l),removedIds:p})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(l){if(this._checkLoaded(),to(this,o.validateStyle(l)))return!1;(l=o.clone$1(l)).layers=wu(l.layers);const p=(function(E,A){if(!E)return[{command:vr.setStyle,args:[A]}];let D=[];try{if(!S(E.version,A.version))return[{command:vr.setStyle,args:[A]}];S(E.center,A.center)||D.push({command:vr.setCenter,args:[A.center]}),S(E.zoom,A.zoom)||D.push({command:vr.setZoom,args:[A.zoom]}),S(E.bearing,A.bearing)||D.push({command:vr.setBearing,args:[A.bearing]}),S(E.pitch,A.pitch)||D.push({command:vr.setPitch,args:[A.pitch]}),S(E.sprite,A.sprite)||D.push({command:vr.setSprite,args:[A.sprite]}),S(E.glyphs,A.glyphs)||D.push({command:vr.setGlyphs,args:[A.glyphs]}),S(E.transition,A.transition)||D.push({command:vr.setTransition,args:[A.transition]}),S(E.light,A.light)||D.push({command:vr.setLight,args:[A.light]}),S(E.fog,A.fog)||D.push({command:vr.setFog,args:[A.fog]}),S(E.projection,A.projection)||D.push({command:vr.setProjection,args:[A.projection]});const L={},V=[];(function(te,ye,we,Se){let Ee;for(Ee in ye=ye||{},te=te||{})te.hasOwnProperty(Ee)&&(ye.hasOwnProperty(Ee)||$s(Ee,we,Se));for(Ee in ye){if(!ye.hasOwnProperty(Ee))continue;const Ce=ye[Ee];te.hasOwnProperty(Ee)?S(te[Ee],Ce)||(te[Ee].type==="geojson"&&Ce.type==="geojson"&&ts(te,ye,Ee)?we.push({command:vr.setGeoJSONSourceData,args:[Ee,Ce.data]}):wa(Ee,ye,we,Se)):Uo(Ee,ye,we)}})(E.sources,A.sources,V,L);const G=[];E.layers&&E.layers.forEach((te=>{te.source&&L[te.source]?D.push({command:vr.removeLayer,args:[te.id]}):G.push(te)}));let q=E.terrain;q&&L[q.source]&&(D.push({command:vr.setTerrain,args:[void 0]}),q=void 0),D=D.concat(V),S(q,A.terrain)||D.push({command:vr.setTerrain,args:[A.terrain]}),(function(te,ye,we){ye=ye||[];const Se=(te=te||[]).map(ea),Ee=ye.map(ea),Ce=te.reduce(Ta,{}),ne=ye.reduce(Ta,{}),be=Se.slice(),ke=Object.create(null);let Le,je,He,qe,Qe,Ye,lt;for(Le=0,je=0;Le<Se.length;Le++)He=Se[Le],ne.hasOwnProperty(He)?je++:(we.push({command:vr.removeLayer,args:[He]}),be.splice(be.indexOf(He,je),1));for(Le=0,je=0;Le<Ee.length;Le++)He=Ee[Ee.length-1-Le],be[be.length-1-Le]!==He&&(Ce.hasOwnProperty(He)?(we.push({command:vr.removeLayer,args:[He]}),be.splice(be.lastIndexOf(He,be.length-je),1)):je++,Ye=be[be.length-Le],we.push({command:vr.addLayer,args:[ne[He],Ye]}),be.splice(be.length-Le,0,He),ke[He]=!0);for(Le=0;Le<Ee.length;Le++)if(He=Ee[Le],qe=Ce[He],Qe=ne[He],!ke[He]&&!S(qe,Qe))if(S(qe.source,Qe.source)&&S(qe["source-layer"],Qe["source-layer"])&&S(qe.type,Qe.type)){for(lt in jo(qe.layout,Qe.layout,we,He,null,vr.setLayoutProperty),jo(qe.paint,Qe.paint,we,He,null,vr.setPaintProperty),S(qe.filter,Qe.filter)||we.push({command:vr.setFilter,args:[He,Qe.filter]}),S(qe.minzoom,Qe.minzoom)&&S(qe.maxzoom,Qe.maxzoom)||we.push({command:vr.setLayerZoomRange,args:[He,Qe.minzoom,Qe.maxzoom]}),qe)qe.hasOwnProperty(lt)&&lt!=="layout"&&lt!=="paint"&&lt!=="filter"&&lt!=="metadata"&&lt!=="minzoom"&&lt!=="maxzoom"&&(lt.indexOf("paint.")===0?jo(qe[lt],Qe[lt],we,He,lt.slice(6),vr.setPaintProperty):S(qe[lt],Qe[lt])||we.push({command:vr.setLayerProperty,args:[He,lt,Qe[lt]]}));for(lt in Qe)Qe.hasOwnProperty(lt)&&!qe.hasOwnProperty(lt)&&lt!=="layout"&&lt!=="paint"&&lt!=="filter"&&lt!=="metadata"&&lt!=="minzoom"&&lt!=="maxzoom"&&(lt.indexOf("paint.")===0?jo(qe[lt],Qe[lt],we,He,lt.slice(6),vr.setPaintProperty):S(qe[lt],Qe[lt])||we.push({command:vr.setLayerProperty,args:[He,lt,Qe[lt]]}))}else we.push({command:vr.removeLayer,args:[He]}),Ye=be[be.lastIndexOf(He)+1],we.push({command:vr.addLayer,args:[Qe,Ye]})})(G,A.layers,D)}catch(L){console.warn("Unable to compute style diff:",L),D=[{command:vr.setStyle,args:[A]}]}return D})(this.serialize(),l).filter((E=>!(E.command in Pc)));if(p.length===0)return!1;const x=p.filter((E=>!(E.command in sa)));if(x.length>0)throw new Error(`Unimplemented: ${x.map((E=>E.command)).join(", ")}.`);return p.forEach((E=>{E.command!=="setTransition"&&E.command!=="setProjection"&&this[E.command].apply(this,E.args)})),this.stylesheet=l,this._updateMapProjection(),!0}addImage(l,p){return this.getImage(l)?this.fire(new o.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(l,p),this._afterImageUpdated(l),this)}updateImage(l,p){this.imageManager.updateImage(l,p)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){return this.getImage(l)?(this.imageManager.removeImage(l),this._afterImageUpdated(l),this):this.fire(new o.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(l,p,x={}){if(this._checkLoaded(),this.getSource(l)!==void 0)throw new Error("There is already a source with this ID");if(!p.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(p).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(p.type)>=0&&this._validate(o.validateSource,`sources.${l}`,p,null,x))return;this.map&&this.map._collectResourceTiming&&(p.collectResourceTiming=!0);const E=ir(l,p,this.dispatcher,this);E.setEventedParent(this,(()=>({isSourceLoaded:this._isSourceCacheLoaded(l),source:E.serialize(),sourceId:l})));const A=D=>{const L=(D?"symbol:":"other:")+l,V=this._sourceCaches[L]=new o.SourceCache(L,E,D);(D?this._symbolSourceCaches:this._otherSourceCaches)[l]=V,V.style=this,V.onAdd(this.map)};A(!1),p.type!=="vector"&&p.type!=="geojson"||A(!0),E.onAdd&&E.onAdd(this.map),this._changed=!0}removeSource(l){this._checkLoaded();const p=this.getSource(l);if(!p)throw new Error("There is no source with this ID");for(const E in this._layers)if(this._layers[E].source===l)return this.fire(new o.ErrorEvent(new Error(`Source "${l}" cannot be removed while layer "${E}" is using it.`)));if(this.terrain&&this.terrain.get().source===l)return this.fire(new o.ErrorEvent(new Error(`Source "${l}" cannot be removed while terrain is using it.`)));const x=this._getSourceCaches(l);for(const E of x)delete this._sourceCaches[E.id],delete this._updatedSources[E.id],E.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:E.getSource().id})),E.setEventedParent(null),E.clearTiles();return delete this._otherSourceCaches[l],delete this._symbolSourceCaches[l],p.setEventedParent(null),p.onRemove&&p.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(l,p){this._checkLoaded(),this.getSource(l).setData(p),this._changed=!0}getSource(l){const p=this._getSourceCache(l);return p&&p.getSource()}_getSources(){const l=[];for(const p in this._otherSourceCaches){const x=this._getSourceCache(p);x&&l.push(x.getSource())}return l}addLayer(l,p,x={}){this._checkLoaded();const E=l.id;if(this.getLayer(E))return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${E}" already exists on this map`)));let A;if(l.type==="custom"){if(to(this,o.validateCustomStyleLayer(l)))return;A=o.createStyleLayer(l)}else{if(typeof l.source=="object"&&(this.addSource(E,l.source),l=o.clone$1(l),l=o.extend(l,{source:E})),this._validate(o.validateLayer,`layers.${E}`,l,{arrayIndex:-1},x))return;A=o.createStyleLayer(l),this._validateLayer(A),A.setEventedParent(this,{layer:{id:E}}),this._serializedLayers[A.id]=A.serialize(),this._updateLayerCount(A,!0)}const D=p?this._order.indexOf(p):this._order.length;if(p&&D===-1)return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${p}" does not exist on this map.`)));this._order.splice(D,0,E),this._layerOrderChanged=!0,this._layers[E]=A;const L=this._getLayerSourceCache(A);if(this._removedLayers[E]&&A.source&&L&&A.type!=="custom"){const V=this._removedLayers[E];delete this._removedLayers[E],V.type!==A.type?this._updatedSources[A.source]="clear":(this._updatedSources[A.source]="reload",L.pause())}this._updateLayer(A),A.onAdd&&A.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(l,p){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new o.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===p)return;const x=this._order.indexOf(l);this._order.splice(x,1);const E=p?this._order.indexOf(p):this._order.length;p&&E===-1?this.fire(new o.ErrorEvent(new Error(`Layer with id "${p}" does not exist on this map.`))):(this._order.splice(E,0,l),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(l){this._checkLoaded();const p=this._layers[l];if(!p)return void this.fire(new o.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be removed.`)));p.setEventedParent(null),this._updateLayerCount(p,!1);const x=this._order.indexOf(l);this._order.splice(x,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=p,delete this._layers[l],delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],p.onRemove&&p.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(l){return this._layers[l]}hasLayer(l){return l in this._layers}hasLayerType(l){for(const p in this._layers)if(this._layers[p].type===l)return!0;return!1}setLayerZoomRange(l,p,x){this._checkLoaded();const E=this.getLayer(l);E?E.minzoom===p&&E.maxzoom===x||(p!=null&&(E.minzoom=p),x!=null&&(E.maxzoom=x),this._updateLayer(E)):this.fire(new o.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(l,p,x={}){this._checkLoaded();const E=this.getLayer(l);if(E){if(!S(E.filter,p))return p==null?(E.filter=void 0,void this._updateLayer(E)):void(this._validate(o.validateFilter,`layers.${E.id}.filter`,p,{layerType:E.type},x)||(E.filter=o.clone$1(p),this._updateLayer(E)))}else this.fire(new o.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be filtered.`)))}getFilter(l){const p=this.getLayer(l);return p&&o.clone$1(p.filter)}setLayoutProperty(l,p,x,E={}){this._checkLoaded();const A=this.getLayer(l);A?S(A.getLayoutProperty(p),x)||(A.setLayoutProperty(p,x,E),this._updateLayer(A)):this.fire(new o.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(l,p){const x=this.getLayer(l);if(x)return x.getLayoutProperty(p);this.fire(new o.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style.`)))}setPaintProperty(l,p,x,E={}){this._checkLoaded();const A=this.getLayer(l);A?S(A.getPaintProperty(p),x)||(A.setPaintProperty(p,x,E)&&this._updateLayer(A),this._changed=!0,this._updatedPaintProps[l]=!0):this.fire(new o.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(l,p){const x=this.getLayer(l);return x&&x.getPaintProperty(p)}setFeatureState(l,p){this._checkLoaded();const x=l.source,E=l.sourceLayer,A=this.getSource(x);if(!A)return void this.fire(new o.ErrorEvent(new Error(`The source '${x}' does not exist in the map's style.`)));const D=A.type;if(D==="geojson"&&E)return void this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(D==="vector"&&!E)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));l.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided.")));const L=this._getSourceCaches(x);for(const V of L)V.setFeatureState(E,l.id,p)}removeFeatureState(l,p){this._checkLoaded();const x=l.source,E=this.getSource(x);if(!E)return void this.fire(new o.ErrorEvent(new Error(`The source '${x}' does not exist in the map's style.`)));const A=E.type,D=A==="vector"?l.sourceLayer:void 0;if(A==="vector"&&!D)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(p&&typeof l.id!="string"&&typeof l.id!="number")return void this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const L=this._getSourceCaches(x);for(const V of L)V.removeFeatureState(D,l.id,p)}getFeatureState(l){this._checkLoaded();const p=l.source,x=l.sourceLayer,E=this.getSource(p);if(E){if(E.type!=="vector"||x)return l.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(p)[0].getFeatureState(x,l.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const l={};for(const p in this._sourceCaches){const x=this._sourceCaches[p].getSource();l[x.id]||(l[x.id]=x.serialize())}return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:l,layers:this._serializeLayers(this._order)},(p=>p!==void 0))}_updateLayer(l){this._updatedLayers[l.id]=!0;const p=this._getLayerSourceCache(l);l.source&&!this._updatedSources[l.source]&&p&&p.getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",p.pause()),this._changed=!0,l.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(l){const p=D=>this._layers[D].type==="fill-extrusion",x={},E=[];for(let D=this._order.length-1;D>=0;D--){const L=this._order[D];if(p(L)){x[L]=D;for(const V of l){const G=V[L];if(G)for(const q of G)E.push(q)}}}E.sort(((D,L)=>L.intersectionZ-D.intersectionZ));const A=[];for(let D=this._order.length-1;D>=0;D--){const L=this._order[D];if(p(L))for(let V=E.length-1;V>=0;V--){const G=E[V].feature;if(x[G.layer.id]<D)break;A.push(G),E.pop()}else for(const V of l){const G=V[L];if(G)for(const q of G)A.push(q.feature)}}return A}queryRenderedFeatures(l,p,x){p&&p.filter&&this._validate(o.validateFilter,"queryRenderedFeatures.filter",p.filter,null,p);const E={};if(p&&p.layers){if(!Array.isArray(p.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const V of p.layers){const G=this._layers[V];if(!G)return this.fire(new o.ErrorEvent(new Error(`The layer '${V}' does not exist in the map's style and cannot be queried for features.`))),[];E[G.source]=!0}}const A=[];p.availableImages=this._availableImages;const D=p&&p.layers?p.layers.some((V=>{const G=this.getLayer(V);return G&&G.is3D()})):this.has3DLayers(),L=Et.createFromScreenPoints(l,x);for(const V in this._sourceCaches){const G=this._sourceCaches[V].getSource().id;p.layers&&!E[G]||A.push(Nr(this._sourceCaches[V],this._layers,this._serializedLayers,L,p,x,D,!!this.map._showQueryGeometry))}return this.placement&&A.push((function(V,G,q,te,ye,we,Se){const Ee={},Ce=we.queryRenderedSymbols(te),ne=[];for(const be of Object.keys(Ce).map(Number))ne.push(Se[be]);ne.sort(Xr);for(const be of ne){const ke=be.featureIndex.lookupSymbolFeatures(Ce[be.bucketInstanceId],G,be.bucketIndex,be.sourceLayerIndex,ye.filter,ye.layers,ye.availableImages,V);for(const Le in ke){const je=Ee[Le]=Ee[Le]||[],He=ke[Le];He.sort(((qe,Qe)=>{const Ye=be.featureSortOrder;if(Ye){const lt=Ye.indexOf(qe.featureIndex);return Ye.indexOf(Qe.featureIndex)-lt}return Qe.featureIndex-qe.featureIndex}));for(const qe of He)je.push(qe)}}for(const be in Ee)Ee[be].forEach((ke=>{const Le=ke.feature,je=q(V[be]);if(!je)return;const He=je.getFeatureState(Le.layer["source-layer"],Le.id);Le.source=Le.layer.source,Le.layer["source-layer"]&&(Le.sourceLayer=Le.layer["source-layer"]),Le.state=He}));return Ee})(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),L.screenGeometry,p,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(A)}querySourceFeatures(l,p){p&&p.filter&&this._validate(o.validateFilter,"querySourceFeatures.filter",p.filter,null,p);const x=this._getSourceCaches(l);let E=[];for(const A of x)E=E.concat(Cr(A,p));return E}addSourceType(l,p,x){return Ao.getSourceType(l)?x(new Error(`A source type called "${l}" already exists.`)):(Ao.setSourceType(l,p),p.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:p.workerSourceURL},x):x(null,null))}getLight(){return this.light.getLight()}setLight(l,p={}){this._checkLoaded();const x=this.light.getLight();let E=!1;for(const D in l)if(!S(l[D],x[D])){E=!0;break}if(!E)return;const A=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(l,p),this.light.updateTransitions(A)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(l,p=1){if(this._checkLoaded(),!l)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let x=l;if(p===1){if(typeof x.source=="object"){const E="terrain-dem-src";this.addSource(E,x.source),x=o.clone$1(x),x=o.extend(x,{source:E})}if(this._validate(o.validateTerrain,"terrain",x))return}if(!this.terrain||this.terrain&&p!==this.terrain.drapeRenderMode){if(!x)return;this._createTerrain(x,p)}else{const E=this.terrain,A=E.get();for(const D of Object.keys(o.spec.terrain))!x.hasOwnProperty(D)&&o.spec.terrain[D].default&&(x[D]=o.spec.terrain[D].default);for(const D in x)if(!S(x[D],A[D])){E.set(x),this.stylesheet.terrain=x;const L=this._setTransitionParameters({duration:0});E.updateTransitions(L);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(l){const p=this.fog=new Kt(l,this.map.transform);this.stylesheet.fog=l;const x=this._setTransitionParameters({duration:0});p.updateTransitions(x)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask((()=>{for(const l of this.map._markers)l._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(l){if(this._checkLoaded(),!l)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const p=this.fog,x=p.get();Object.keys(l).length===0&&p.set(l);for(const E in l)if(!S(l[E],x[E])){p.set(l),this.stylesheet.fog=l;const A=this._setTransitionParameters({duration:0});p.updateTransitions(A);break}}else this._createFog(l);this._markersNeedUpdate=!0}_setTransitionParameters(l){return{now:o.exported.now(),transition:o.extend(l,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const l=this._order.filter((x=>this.isLayerDraped(this._layers[x]))),p=this._order.filter((x=>!this.isLayerDraped(this._layers[x])));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...l),this._drapedFirstOrder.push(...p)}_createTerrain(l,p){const x=this.terrain=new Ie(l,p);this.stylesheet.terrain=l,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const E=this._setTransitionParameters({duration:0});x.updateTransitions(E)}_force3DLayerUpdate(){for(const l in this._layers){const p=this._layers[l];p.type==="fill-extrusion"&&this._updateLayer(p)}}_forceSymbolLayerUpdate(){for(const l in this._layers){const p=this._layers[l];p.type==="symbol"&&this._updateLayer(p)}}_validate(l,p,x,E,A={}){return(!A||A.validate!==!1)&&to(this,l.call(o.validateStyle,o.extend({key:p,style:this.serialize(),value:x,styleSpec:o.spec},E)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const l in this._layers)this._layers[l].setEventedParent(null);for(const l in this._sourceCaches)this._sourceCaches[l].clearTiles(),this._sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(l){const p=this._getSourceCaches(l);for(const x of p)x.clearTiles()}_reloadSource(l){const p=this._getSourceCaches(l);for(const x of p)x.resume(),x.reload()}_reloadSources(){for(const l of this._getSources())l.reload&&l.reload()}_updateSources(l){for(const p in this._sourceCaches)this._sourceCaches[p].update(l)}_generateCollisionBoxes(){for(const l in this._sourceCaches){const p=this._sourceCaches[l];p.resume(),p.reload()}}_updatePlacement(l,p,x,E,A=!1){let D=!1,L=!1;const V={};for(const G of this._order){const q=this._layers[G];if(q.type!=="symbol")continue;if(!V[q.source]){const ye=this._getLayerSourceCache(q);if(!ye)continue;V[q.source]=ye.getRenderableIds(!0).map((we=>ye.getTileByID(we))).sort(((we,Se)=>Se.tileID.overscaledZ-we.tileID.overscaledZ||(we.tileID.isLessThan(Se.tileID)?-1:1)))}const te=this.crossTileSymbolIndex.addLayer(q,V[q.source],l.center.lng,l.projection);D=D||te}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),A=A||this._layerOrderChanged||x===0,this._layerOrderChanged&&this.fire(new o.Event("neworder")),(A||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),l.zoom))&&(this.pauseablePlacement=new Kl(l,this._order,A,p,x,E,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,V),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),L=!0),D&&this.pauseablePlacement.placement.setStale()),L||D)for(const G of this._order){const q=this._layers[G];q.type==="symbol"&&this.placement.updateLayerOpacities(q,V[q.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const l in this._sourceCaches)this._sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,p,x){this.imageManager.getImages(p.icons,x),this._updateTilesForChangedImages();const E=A=>{A&&A.setDependencies(p.tileID.key,p.type,p.icons)};E(this._otherSourceCaches[p.source]),E(this._symbolSourceCaches[p.source])}getGlyphs(l,p,x){this.glyphManager.getGlyphs(p.stacks,x)}getResource(l,p,x){return o.makeRequest(p,x)}_getSourceCache(l){return this._otherSourceCaches[l]}_getLayerSourceCache(l){return l.type==="symbol"?this._symbolSourceCaches[l.source]:this._otherSourceCaches[l.source]}_getSourceCaches(l){const p=[];return this._otherSourceCaches[l]&&p.push(this._otherSourceCaches[l]),this._symbolSourceCaches[l]&&p.push(this._symbolSourceCaches[l]),p}_isSourceCacheLoaded(l){const p=this._getSourceCaches(l);return p.length===0?(this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${l}'`))),!1):p.every((x=>x.loaded()))}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Ao.getSourceType=function(_){return Hn[_]},Ao.setSourceType=function(_,l){Hn[_]=l},Ao.registerForPluginStateChange=o.registerForPluginStateChange;var Ca=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Aa="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",aa=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,il=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Ia=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Cu={},Ra={};const Yl=[];Io(Ca,Yl),Io(aa,Yl),Io(il,Yl),Io(Ia,Yl),Cu=Lr("",aa),Ra=Lr(Ia,il);const Vd=Lr(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Ql=Ca,xh=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var bh={background:Lr(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Lr(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Lr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Lr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Lr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Lr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Lr("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Lr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Lr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Lr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Lr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Lr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Lr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Lr(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Lr(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Lr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Lr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Lr(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Lr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Lr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Lr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Lr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Lr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Lr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Lr(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Lr(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Aa),skyboxGradient:Lr(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Aa),skyboxCapture:Lr(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Lr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Lr(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Io(_,l){const p=_.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let x of p)if(x=x.trim(),x[0]==="#"&&x.includes("if")&&!x.includes("endif")){x=x.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const E=x.split(" ");for(const A of E)l.includes(A)||l.push(A)}}function Lr(_,l){const p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,x=l.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),E={},A=[...Yl];return Io(_,A),Io(l,A),{fragmentSource:_=_.replace(p,((D,L,V,G,q)=>(E[q]=!0,L==="define"?`
#ifndef HAS_UNIFORM_u_${q}
varying ${V} ${G} ${q};
#else
uniform ${V} ${G} u_${q};
#endif
`:`
#ifdef HAS_UNIFORM_u_${q}
    ${V} ${G} ${q} = u_${q};
#endif
`))),vertexSource:l=l.replace(p,((D,L,V,G,q)=>{const te=G==="float"?"vec2":"vec4",ye=q.match(/color/)?"color":te;return E[q]?L==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
attribute ${V} ${te} a_${q};
varying ${V} ${G} ${q};
#else
uniform ${V} ${G} u_${q};
#endif
`:ye==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = a_${q};
#else
    ${V} ${G} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = unpack_mix_${ye}(a_${q}, u_${q}_t);
#else
    ${V} ${G} ${q} = u_${q};
#endif
`:L==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
attribute ${V} ${te} a_${q};
#else
uniform ${V} ${G} u_${q};
#endif
`:ye==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${V} ${G} ${q} = a_${q};
#else
    ${V} ${G} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${V} ${G} ${q} = unpack_mix_${ye}(a_${q}, u_${q}_t);
#else
    ${V} ${G} ${q} = u_${q};
#endif
`})),staticAttributes:x,usedDefines:A}}class Zf{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(l,p,x,E,A,D,L){this.context=l;let V=this.boundPaintVertexBuffers.length!==E.length;for(let q=0;!V&&q<E.length;q++)this.boundPaintVertexBuffers[q]!==E[q]&&(V=!0);let G=this.boundDynamicVertexBuffers.length!==L.length;for(let q=0;!G&&q<L.length;q++)this.boundDynamicVertexBuffers[q]!==L[q]&&(G=!0);if(!l.extVertexArrayObject||!this.vao||this.boundProgram!==p||this.boundLayoutVertexBuffer!==x||V||G||this.boundIndexBuffer!==A||this.boundVertexOffset!==D)this.freshBind(p,x,E,A,D,L);else{l.bindVertexArrayOES.set(this.vao);for(const q of L)q&&q.bind();A&&A.dynamicDraw&&A.bind()}}freshBind(l,p,x,E,A,D){let L;const V=l.numAttributes,G=this.context,q=G.gl;if(G.extVertexArrayObject)this.vao&&this.destroy(),this.vao=G.extVertexArrayObject.createVertexArrayOES(),G.bindVertexArrayOES.set(this.vao),L=0,this.boundProgram=l,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=x,this.boundIndexBuffer=E,this.boundVertexOffset=A,this.boundDynamicVertexBuffers=D;else{L=G.currentNumAttributes||0;for(let te=V;te<L;te++)q.disableVertexAttribArray(te)}p.enableAttributes(q,l),p.bind(),p.setVertexAttribPointers(q,l,A);for(const te of x)te.enableAttributes(q,l),te.bind(),te.setVertexAttribPointers(q,l,A);for(const te of D)te&&(te.enableAttributes(q,l),te.bind(),te.setVertexAttribPointers(q,l,A));E&&E.bind(),G.currentNumAttributes=V}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function wh(_,l){const p=Math.pow(2,l.canonical.z),x=l.canonical.y;return[new o.MercatorCoordinate(0,x/p).toLngLat().lat,new o.MercatorCoordinate(0,(x+1)/p).toLngLat().lat]}function Fd(_,l,p,x,E,A,D){const L=_.context,V=L.gl,G=p.fbo;if(!G)return;_.prepareDrawTile();const q=_.useProgram("hillshade");L.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,G.colorAttachment.get());const te=((Ee,Ce,ne,be)=>{const ke=ne.paint.get("hillshade-shadow-color"),Le=ne.paint.get("hillshade-highlight-color"),je=ne.paint.get("hillshade-accent-color");let He=ne.paint.get("hillshade-illumination-direction")*(Math.PI/180);ne.paint.get("hillshade-illumination-anchor")==="viewport"&&(He-=Ee.transform.angle);const qe=!Ee.options.moving;return{u_matrix:be||Ee.transform.calculateProjMatrix(Ce.tileID.toUnwrapped(),qe),u_image:0,u_latrange:wh(0,Ce.tileID),u_light:[ne.paint.get("hillshade-exaggeration"),He],u_shadow:ke,u_highlight:Le,u_accent:je}})(_,p,x,_.terrain?l.projMatrix:null);_.prepareDrawProgram(L,q,l.toUnwrapped());const{tileBoundsBuffer:ye,tileBoundsIndexBuffer:we,tileBoundsSegments:Se}=_.getTileBoundsBuffers(p);q.draw(L,V.TRIANGLES,E,A,D,o.CullFaceMode.disabled,te,x.id,ye,we,Se)}function Cl(_,l,p){if(!l.needsDEMTextureUpload)return;const x=_.context,E=x.gl;x.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||_.getTileTexture(p.stride);const A=p.getPixels();l.demTexture?l.demTexture.update(A,{premultiply:!1}):l.demTexture=new o.Texture(x,A,E.RGBA,{premultiply:!1}),l.needsDEMTextureUpload=!1}function no(_,l,p,x,E,A){const D=_.context,L=D.gl;if(!l.dem)return;const V=l.dem;if(D.activeTexture.set(L.TEXTURE1),Cl(_,l,V),!l.demTexture)return;l.demTexture.bind(L.NEAREST,L.CLAMP_TO_EDGE);const G=V.dim;D.activeTexture.set(L.TEXTURE0);let q=l.fbo;if(!q){const Se=new o.Texture(D,{width:G,height:G,data:null},L.RGBA);Se.bind(L.LINEAR,L.CLAMP_TO_EDGE),q=l.fbo=D.createFramebuffer(G,G,!0),q.colorAttachment.set(Se.texture)}D.bindFramebuffer.set(q.framebuffer),D.viewport.set([0,0,G,G]);const{tileBoundsBuffer:te,tileBoundsIndexBuffer:ye,tileBoundsSegments:we}=_.getMercatorTileBoundsBuffers();_.useProgram("hillshadePrepare").draw(D,L.TRIANGLES,x,E,A,o.CullFaceMode.disabled,((Se,Ee)=>{const Ce=Ee.stride,ne=o.create();return o.ortho(ne,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(ne,ne,[0,-o.EXTENT,0]),{u_matrix:ne,u_image:1,u_dimension:[Ce,Ce],u_zoom:Se.overscaledZ,u_unpack:Ee.unpackVector}})(l.tileID,V),p.id,te,ye,we),l.needsHillshadePrepare=!1}const Th=_=>({u_matrix:new o.UniformMatrix4f(_),u_image0:new o.Uniform1i(_),u_skirt_height:new o.Uniform1f(_)}),Jl=(_,l)=>({u_matrix:_,u_image0:0,u_skirt_height:l}),Ma=(_,l,p,x,E,A,D,L,V,G,q,te,ye,we,Se)=>({u_proj_matrix:Float32Array.from(_),u_globe_matrix:l,u_normalize_matrix:Float32Array.from(x),u_merc_matrix:p,u_zoom_transition:E,u_merc_center:A,u_image0:0,u_frustum_tl:D,u_frustum_tr:L,u_frustum_br:V,u_frustum_bl:G,u_globe_pos:q,u_globe_radius:te,u_viewport:ye,u_grid_matrix:Se?Float32Array.from(Se):new Float32Array(9),u_skirt_height:we});function R(_,l){return _!=null&&l!=null&&!(!_.hasData()||!l.hasData())&&_.demTexture!=null&&l.demTexture!=null&&_.tileID.key!==l.tileID.key}const H=new class{constructor(){this.operations={}}newMorphing(_,l,p,x,E){if(_ in this.operations){const A=this.operations[_];A.to.tileID.key!==p.tileID.key&&(A.queued=p)}else this.operations[_]={startTime:x,phase:0,duration:E,from:l,to:p,queued:null}}getMorphValuesForProxy(_){if(!(_ in this.operations))return null;const l=this.operations[_];return{from:l.from,to:l.to,phase:l.phase}}update(_){for(const l in this.operations){const p=this.operations[l];for(p.phase=(_-p.startTime)/p.duration;p.phase>=1||!this._validOp(p);)if(!this._nextOp(p,_)){delete this.operations[l];break}}}_nextOp(_,l){return!!_.queued&&(_.from=_.to,_.to=_.queued,_.queued=null,_.phase=0,_.startTime=l,!0)}_validOp(_){return _.from.hasData()&&_.to.hasData()}},ie={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Ae(_){return 6*Math.pow(1.5,22-_)}function ht(_,l){const p=1<<_.z;return!l&&(_.x===0||_.x===p-1)||_.y===0||_.y===p-1}const yt=_=>({u_matrix:_});function pn(_,l,p,x,E){if(E>0){const A=o.exported.now(),D=(A-_.timeAdded)/E,L=l?(A-l.timeAdded)/E:-1,V=p.getSource(),G=x.coveringZoomLevel({tileSize:V.tileSize,roundZoom:V.roundZoom}),q=!l||Math.abs(l.tileID.overscaledZ-G)>Math.abs(_.tileID.overscaledZ-G),te=q&&_.refreshedUponExpiration?1:o.clamp(q?D:1-L,0,1);return _.refreshedUponExpiration&&D>=1&&(_.refreshedUponExpiration=!1),l?{opacity:1,mix:1-te}:{opacity:te,mix:0}}return{opacity:1,mix:0}}class gr extends o.SourceCache{constructor(l){const p={type:"raster-dem",maxzoom:l.transform.maxZoom},x=new De(Hl(),null),E=ir("mock-dem",p,x,l.style);super("mock-dem",E,!1),E.setEventedParent(this),this._sourceLoaded=!0}_loadTile(l,p){l.state="loaded",p(null)}}class Qi extends o.SourceCache{constructor(l){const p=ir("proxy",{type:"geojson",maxzoom:l.transform.maxZoom},new De(Hl(),null),l.style);super("proxy",p,!1),p.setEventedParent(this),this.map=this.getSource().map=l,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(l,p,x){if(l.freezeTileCoverage)return;this.transform=l;const E=l.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((A,D)=>{if(A[D.key]="",!this._tiles[D.key]){const L=new o.Tile(D,this._source.tileSize*D.overscaleFactor(),l.tileZoom);L.state="loaded",this._tiles[D.key]=L}return A}),{});for(const A in this._tiles)A in E||(this.freeFBO(A),this._tiles[A].unloadVectorData(),delete this._tiles[A])}freeFBO(l){const p=this.proxyCachedFBO[l];if(p!==void 0){const x=Object.values(p);this.renderCachePool.push(...x),delete this.proxyCachedFBO[l]}}deallocRenderCache(){this.renderCache.forEach((l=>l.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class $r extends o.OverscaledTileID{constructor(l,p,x){super(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y),this.proxyTileKey=p,this.projMatrix=x}}class Vi extends o.Elevation{constructor(l,p){super(),this.painter=l,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[x,E,A]=(function(V){const G=new o.StructArrayLayout2i4,q=new o.StructArrayLayout3ui6,te=131;G.reserve(17161),q.reserve(33800);const ye=o.EXTENT/128,we=o.EXTENT+ye/2,Se=we+ye;for(let Ce=-ye;Ce<Se;Ce+=ye)for(let ne=-ye;ne<Se;ne+=ye){const be=ne<0||ne>we||Ce<0||Ce>we?24575:0,ke=o.clamp(Math.round(ne),0,o.EXTENT),Le=o.clamp(Math.round(Ce),0,o.EXTENT);G.emplaceBack(ke+be,Le)}const Ee=(Ce,ne)=>{const be=ne*te+Ce;q.emplaceBack(be+1,be,be+te),q.emplaceBack(be+te,be+te+1,be+1)};for(let Ce=1;Ce<129;Ce++)for(let ne=1;ne<129;ne++)Ee(ne,Ce);return[0,129].forEach((Ce=>{for(let ne=0;ne<130;ne++)Ee(ne,Ce),Ee(Ce,ne)})),[G,q,32768]})(),D=l.context;this.gridBuffer=D.createVertexBuffer(x,o.posAttributes.members),this.gridIndexBuffer=D.createIndexBuffer(E),this.gridSegments=o.SegmentVector.simpleSegment(0,0,x.length,E.length),this.gridNoSkirtSegments=o.SegmentVector.simpleSegment(0,0,x.length,A),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Qi(p.map),this.orthoMatrix=o.create(),o.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,o.EXTENT,0,o.EXTENT,0,1);const L=D.gl;this._overlapStencilMode=new o.StencilMode({func:L.GEQUAL,mask:255},0,255,L.KEEP,L.KEEP,L.REPLACE),this._previousZoom=l.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=p,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new gr(p.map)}set style(l){l.on("data",this._onStyleDataEvent.bind(this)),l.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=l,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",(()=>{this._clearLineLayersFromRenderCache()}))}update(l,p,x){if(l&&l.terrain){this._style!==l&&(this.style=l),this.enabled=!0;const E=l.terrain.properties;this.sourceCache=l.terrain.drapeRenderMode===0?this._mockSourceCache:l._getSourceCache(E.get("source")),this._exaggeration=E.get("exaggeration");const A=()=>{this.sourceCache.used&&o.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const D=this.getScaledDemTileSize();this.sourceCache.update(p,D,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,A(),this._initializing=!0),A(),p.updateElevation(!0,x),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(p),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(l){this._findCoveringTileCache[l]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const l=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||l.efficiency!==100&&o.warnOnce(`Terrain render cache efficiency is not optimal (${l.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${l.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(l){l.coord&&l.dataType==="source"?this._clearRenderCacheForTile(l.sourceCacheId,l.coord):l.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const l in this._style._sourceCaches)this._style._sourceCaches[l].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach((l=>l.fb.destroy())),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const l=2*this.proxySourceCache.getSource().tileSize;return[l,l]}set useVertexMorphing(l){this._useVertexMorphing=l}updateTileBinding(l){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const p=this.proxySourceCache,x=this.painter.transform;this._initializing&&(this._initializing=x._centerAltitude===0&&this.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(x.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const E=this.proxyCoords=p.getIds().map((V=>{const G=p.getTileByID(V).tileID;return G.projMatrix=x.calculateProjMatrix(G.toUnwrapped()),G}));(function(V,G){const q=G.transform.pointCoordinate(G.transform.getCameraPoint()),te=new o.Point(q.x,q.y);V.sort(((ye,we)=>{if(we.overscaledZ-ye.overscaledZ)return we.overscaledZ-ye.overscaledZ;const Se=new o.Point(ye.canonical.x+(1<<ye.canonical.z)*ye.wrap,ye.canonical.y),Ee=new o.Point(we.canonical.x+(1<<we.canonical.z)*we.wrap,we.canonical.y),Ce=te.mult(1<<ye.canonical.z);return Ce.x-=.5,Ce.y-=.5,Ce.distSqr(Se)-Ce.distSqr(Ee)}))})(E,this.painter),this._previousZoom=x.zoom;const A=this.proxyToSource||{};this.proxyToSource={},E.forEach((V=>{this.proxyToSource[V.key]={}})),this.terrainTileForTile={};const D=this._style._sourceCaches;for(const V in D){const G=D[V];if(!G.used||(G!==this.sourceCache&&this.resetTileLookupCache(G.id),this._setupProxiedCoordsForOrtho(G,l[V],A),G.usedForTerrain))continue;const q=l[V];G.getSource().reparseOverscaled&&this._assignTerrainTiles(q)}this.proxiedCoords[p.id]=E.map((V=>new $r(V,V.key,this.orthoMatrix))),this._assignTerrainTiles(E),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(A),this.renderingToTexture=!1,this._updateTimestamp=o.exported.now();const L={};this._visibleDemTiles=[];for(const V of this.proxyCoords){const G=this.terrainTileForTile[V.key];if(!G)continue;const q=G.tileID.key;q in L||(this._visibleDemTiles.push(G),L[q]=q)}}_assignTerrainTiles(l){this._initializing||l.forEach((p=>{if(this.terrainTileForTile[p.key])return;const x=this._findTileCoveringTileID(p,this.sourceCache);x&&(this.terrainTileForTile[p.key]=x)}))}_prepareDEMTextures(){const l=this.painter.context,p=l.gl;for(const x in this.terrainTileForTile){const E=this.terrainTileForTile[x],A=E.dem;!A||E.demTexture&&!E.needsDEMTextureUpload||(l.activeTexture.set(p.TEXTURE1),Cl(this.painter,E,A))}}_prepareDemTileUniforms(l,p,x,E){if(!p||p.demTexture==null)return!1;const A=l.tileID.canonical,D=Math.pow(2,p.tileID.canonical.z-A.z),L=E||"";return x[`u_dem_tl${L}`]=[A.x*D%1,A.y*D%1],x[`u_dem_scale${L}`]=D,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const l=this.painter.context,p=l.gl;if(!this._emptyDepthBufferTexture){const x=new o.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new o.Texture(l,x,p.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let l=0;const p=this._visibleDemTiles.reduce(((x,E)=>{if(!E.dem)return x;const A=E.dem.tree.minimums[0];return A>0&&l++,x+A}),0);return l?p/l:0}_updateEmptyDEMTexture(){const l=this.painter.context,p=l.gl;l.activeTexture.set(p.TEXTURE2);const x=this._getLoadedAreaMinimum(),E=new o.RGBAImage({width:1,height:1},new Uint8Array(o.DEMData.pack(x,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let A=this._emptyDEMTexture;return A?A.update(E,{premultiply:!1}):A=this._emptyDEMTexture=new o.Texture(l,E,p.RGBA,{premultiply:!1}),A}setupElevationDraw(l,p,x){const E=this.painter.context,A=E.gl,D=(L=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:o.DEMData.getUnpackVector(L),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var L;D.u_dem_size=this.sourceCache.getSource().tileSize,D.u_exaggeration=this.exaggeration();let V=null,G=null,q=1;if(x&&x.morphing&&this._useVertexMorphing){const te=x.morphing.srcDemTile,ye=x.morphing.dstDemTile;q=x.morphing.phase,te&&ye&&(this._prepareDemTileUniforms(l,te,D,"_prev")&&(G=te),this._prepareDemTileUniforms(l,ye,D)&&(V=ye))}if(G&&V?(E.activeTexture.set(A.TEXTURE2),V.demTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE,A.NEAREST),E.activeTexture.set(A.TEXTURE4),G.demTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE,A.NEAREST),D.u_dem_lerp=q):(V=this.terrainTileForTile[l.tileID.key],E.activeTexture.set(A.TEXTURE2),(this._prepareDemTileUniforms(l,V,D)?V.demTexture:this.emptyDEMTexture).bind(A.NEAREST,A.CLAMP_TO_EDGE)),E.activeTexture.set(A.TEXTURE3),x&&x.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),this._depthFBO&&(D.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),D.u_depth_size_inv=[1,1]),x&&x.useMeterToDem&&V){const te=(1<<V.tileID.canonical.z)*o.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;D.u_meter_to_dem=te}if(x&&x.labelPlaneMatrixInv&&(D.u_label_plane_matrix_inv=x.labelPlaneMatrixInv),p.setTerrainUniformValues(E,D),this.painter.transform.projection.name==="globe"){const te=this.globeUniformValues(this.painter.transform,l.tileID.canonical,x&&x.useDenormalizedUpVectorScale);p.setGlobeUniformValues(E,te)}}globeUniformValues(l,p,x){const E=l.projection;return{u_tile_tl_up:E.upVector(p,0,0),u_tile_tr_up:E.upVector(p,o.EXTENT,0),u_tile_br_up:E.upVector(p,o.EXTENT,o.EXTENT),u_tile_bl_up:E.upVector(p,0,o.EXTENT),u_tile_up_scale:x?o.globeMetersToEcef(1):E.upVectorScale(p,l.center.lat,l.worldSize).metersToTile}}renderToBackBuffer(l){const p=this.painter,x=this.painter.context;l.length!==0&&(x.bindFramebuffer.set(null),x.viewport.set([0,0,p.width,p.height]),p.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,(function(E,A,D,L,V){if(E.transform.projection.name==="globe")(function(G,q,te,ye,we){const Se=G.context,Ee=Se.gl;let Ce,ne;const be=G.options.showTerrainWireframe?2:0,ke=G.transform,Le=o.globeUseCustomAntiAliasing(G,Se,ke),je=(Ot,st)=>{if(ne===Ot)return;const St=[ie[Ot],"PROJECTION_GLOBE_VIEW"];Le&&St.push("CUSTOM_ANTIALIASING"),st&&St.push(ie[be]),Ce=G.useProgram("globeRaster",null,St),ne=Ot},He=G.colorModeForRenderPass(),qe=new o.DepthMode(Ee.LEQUAL,o.DepthMode.ReadWrite,G.depthRangeFor3D);H.update(we);const Qe=o.calculateGlobeMercatorMatrix(ke),Ye=[o.mercatorXfromLng(ke.center.lng),o.mercatorYfromLat(ke.center.lat)],lt=be?[!1,!0]:[!1],Vt=G.globeSharedBuffers,rt=[ke.width*o.exported.devicePixelRatio,ke.height*o.exported.devicePixelRatio],_t=Float32Array.from(ke.globeMatrix),at={useDenormalizedUpVectorScale:!0};if(lt.forEach((Ot=>{const st=G.transform,St=Ae(st.zoom)*q.exaggeration();ne=-1;const zt=Ot?Ee.LINES:Ee.TRIANGLES;for(const Ct of ye){const It=te.getTile(Ct),Sn=o.StencilMode.disabled,Un=q.prevTerrainTileForTile[Ct.key],Bt=q.terrainTileForTile[Ct.key];R(Un,Bt)&&H.newMorphing(Ct.key,Un,Bt,we,250),Se.activeTexture.set(Ee.TEXTURE0),It.texture.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE);const hn=H.getMorphValuesForProxy(Ct.key),Fn=hn?1:0;hn&&o.extend$1(at,{morphing:{srcDemTile:hn.from,dstDemTile:hn.to,phase:o.easeCubicInOut(hn.phase)}});const ar=o.tileCornersToBounds(Ct.canonical),Tn=o.getLatitudinalLod(ar.getCenter().lat),Pr=o.getGridMatrix(Ct.canonical,ar,Tn,st.worldSize/st._pixelsPerMercatorPixel),Kr=o.globeNormalizeECEF(o.globeTileBounds(Ct.canonical)),qr=Ma(st.projMatrix,_t,Qe,Kr,o.globeToMercatorTransition(st.zoom),Ye,st.frustumCorners.TL,st.frustumCorners.TR,st.frustumCorners.BR,st.frustumCorners.BL,st.globeCenterInViewSpace,st.globeRadius,rt,St,Pr);if(je(Fn,Ot),q.setupElevationDraw(It,Ce,at),G.prepareDrawProgram(Se,Ce,Ct.toUnwrapped()),Vt){const[Vr,so,kr]=Ot?Vt.getWirefameBuffers(G.context,Tn):Vt.getGridBuffers(Tn,St!==0);Ce.draw(Se,zt,qe,Sn,He,o.CullFaceMode.backCCW,qr,"globe_raster",Vr,so,kr)}}})),Vt){const Ot=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Le&&Ot.push("CUSTOM_ANTIALIASING"),Ce=G.useProgram("globeRaster",null,Ot);for(const st of ye){const{x:St,y:zt,z:Ct}=st.canonical,It=zt===0,Sn=zt===(1<<Ct)-1,[Un,Bt,hn,Fn]=Vt.getPoleBuffers(Ct);if(Fn&&(It||Sn)){const ar=te.getTile(st);Se.activeTexture.set(Ee.TEXTURE0),ar.texture.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE);let Tn=o.globePoleMatrixForTile(Ct,St,ke);const Pr=o.globeNormalizeECEF(o.globeTileBounds(st.canonical)),Kr=(qr,Vr)=>qr.draw(Se,Ee.TRIANGLES,qe,o.StencilMode.disabled,He,o.CullFaceMode.disabled,Ma(ke.projMatrix,Tn,Tn,Pr,0,Ye,ke.frustumCorners.TL,ke.frustumCorners.TR,ke.frustumCorners.BR,ke.frustumCorners.BL,ke.globeCenterInViewSpace,ke.globeRadius,rt,0),"globe_pole_raster",Vr,hn,Fn);q.setupElevationDraw(ar,Ce,at),G.prepareDrawProgram(Se,Ce,st.toUnwrapped()),It&&Kr(Ce,Un),Sn&&(Tn=o.scale(o.create(),Tn,[1,-1,1]),Kr(Ce,Bt))}}}})(E,A,D,L,V);else{const G=E.context,q=G.gl;let te,ye;const we=E.options.showTerrainWireframe?2:0,Se=(ke,Le)=>{if(ye===ke)return;const je=[ie[ke]];Le&&je.push(ie[we]),te=E.useProgram("terrainRaster",null,je),ye=ke},Ee=E.colorModeForRenderPass(),Ce=new o.DepthMode(q.LEQUAL,o.DepthMode.ReadWrite,E.depthRangeFor3D);H.update(V);const ne=E.transform,be=Ae(ne.zoom)*A.exaggeration();(we?[!1,!0]:[!1]).forEach((ke=>{ye=-1;const Le=ke?q.LINES:q.TRIANGLES,[je,He]=ke?A.getWirefameBuffer():[A.gridIndexBuffer,A.gridSegments];for(const qe of L){const Qe=D.getTile(qe),Ye=o.StencilMode.disabled,lt=A.prevTerrainTileForTile[qe.key],Vt=A.terrainTileForTile[qe.key];R(lt,Vt)&&H.newMorphing(qe.key,lt,Vt,V,250),G.activeTexture.set(q.TEXTURE0),Qe.texture.bind(q.LINEAR,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST);const rt=H.getMorphValuesForProxy(qe.key),_t=rt?1:0;let at;rt&&(at={morphing:{srcDemTile:rt.from,dstDemTile:rt.to,phase:o.easeCubicInOut(rt.phase)}});const Ot=Jl(qe.projMatrix,ht(qe.canonical,ne.renderWorldCopies)?be/10:be);Se(_t,ke),A.setupElevationDraw(Qe,te,at),E.prepareDrawProgram(G,te,qe.toUnwrapped()),te.draw(G,Le,Ce,Ye,Ee,o.CullFaceMode.backCCW,Ot,"terrain_raster",A.gridBuffer,je,He)}}))}})(p,this,this.proxySourceCache,l,this._updateTimestamp),this.renderingToTexture=!0,p.gpuTimingDeferredRenderEnd(),l.splice(0,l.length))}renderBatch(l){if(this._drapedRenderBatches.length===0)return l+1;this.renderingToTexture=!0;const p=this.painter,x=this.painter.context,E=this.proxySourceCache,A=this.proxiedCoords[E.id],D=this._drapedRenderBatches.shift(),L=[],V=p.style.order;let G=0;for(const q of A){const te=E.getTileByID(q.proxyTileKey),ye=E.proxyCachedFBO[q.key]?E.proxyCachedFBO[q.key][l]:void 0,we=ye!==void 0?E.renderCache[ye]:this.pool[G++],Se=ye!==void 0;if(te.texture=we.tex,Se&&!we.dirty){L.push(te.tileID);continue}let Ee;x.bindFramebuffer.set(we.fb.framebuffer),this.renderedToTile=!1,we.dirty&&(x.clear({color:o.Color.transparent,stencil:0}),we.dirty=!1);for(let Ce=D.start;Ce<=D.end;++Ce){const ne=p.style._layers[V[Ce]];if(ne.isHidden(p.transform.zoom))continue;const be=p.style._getLayerSourceCache(ne),ke=be?this.proxyToSource[q.key][be.id]:[q];if(!ke)continue;const Le=ke;x.viewport.set([0,0,we.fb.width,we.fb.height]),Ee!==(be?be.id:null)&&(this._setupStencil(we,ke,ne,be),Ee=be?be.id:null),p.renderLayer(p,be,ne,Le)}this.renderedToTile?(we.dirty=!0,L.push(te.tileID)):Se||--G,G===5&&(G=0,this.renderToBackBuffer(L))}return this.renderToBackBuffer(L),this.renderingToTexture=!1,x.bindFramebuffer.set(null),x.viewport.set([0,0,p.width,p.height]),D.end+1}postRender(){}renderCacheEfficiency(l){const p=l.order.length;if(p===0)return{efficiency:100};let x,E=0,A=0,D=!1;for(let L=0;L<p;++L){const V=l._layers[l.order[L]];this._style.isLayerDraped(V)?(D&&++E,++A):D||(D=!0,x=V.id)}return A===0?{efficiency:100}:{efficiency:100*(1-E/A),firstUndrapedLayer:x}}getMinElevationBelowMSL(){let l=0;return this._visibleDemTiles.filter((p=>p.dem)).forEach((p=>{l=Math.min(l,p.dem.tree.minimums[0])})),l===0?l:(l-30)*this._exaggeration}raycast(l,p,x){if(!this._visibleDemTiles)return null;const E=this._visibleDemTiles.filter((A=>A.dem)).map((A=>{const D=A.tileID,L=1<<D.overscaledZ,{x:V,y:G}=D.canonical,q=V/L,te=(V+1)/L,ye=G/L,we=(G+1)/L;return{minx:q,miny:ye,maxx:te,maxy:we,t:A.dem.tree.raycastRoot(q,ye,te,we,l,p,x),tile:A}}));E.sort(((A,D)=>(A.t!==null?A.t:Number.MAX_VALUE)-(D.t!==null?D.t:Number.MAX_VALUE)));for(const A of E){if(A.t==null)return null;const D=A.tile.dem.tree.raycast(A.minx,A.miny,A.maxx,A.maxy,l,p,x);if(D!=null)return D}return null}_createFBO(){const l=this.painter.context,p=l.gl,x=this.drapeBufferSize;l.activeTexture.set(p.TEXTURE0);const E=new o.Texture(l,{width:x[0],height:x[1],data:null},p.RGBA);E.bind(p.LINEAR,p.CLAMP_TO_EDGE);const A=l.createFramebuffer(x[0],x[1],!1);return A.colorAttachment.set(E.texture),A.depthAttachment=new $e(l,A.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=l.createRenderbuffer(l.gl.DEPTH_STENCIL,x[0],x[1]),this._stencilRef=0,A.depthAttachment.set(this._sharedDepthStencil),l.clear({stencil:0})):A.depthAttachment.set(this._sharedDepthStencil),l.extTextureFilterAnisotropic&&!l.extTextureFilterAnisotropicForceOff&&p.texParameterf(p.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax),{fb:A,tex:E,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const l in this._style._sourceCaches)if(this._style._sourceCaches[l].hasTransition())return!0;return this._style.order.some((l=>{const p=this._style._layers[l],x=p.isHidden(this.painter.transform.zoom);return p.type==="custom"?!x&&p.shouldRedrape():!x&&p.hasTransition()}))}_clearLineLayersFromRenderCache(){let l=!1;for(const x of this._style._getSources())if(x instanceof en){l=!0;break}if(!l)return;const p={};for(let x=0;x<this._style.order.length;++x){const E=this._style._layers[this._style.order[x]],A=this._style._getLayerSourceCache(E);if(A&&!p[A.id]&&!E.isHidden(this.painter.transform.zoom)&&E.type==="line"&&E.widthExpression()instanceof o.ZoomDependentExpression){p[A.id]=!0;for(const D of this.proxyCoords){const L=this.proxyToSource[D.key][A.id];if(L)for(const V of L)this._clearRenderCacheForTile(A.id,V)}}}}_clearRasterLayersFromRenderCache(){let l=!1;for(const x in this._style._sourceCaches)if(this._style._sourceCaches[x]._source instanceof jt){l=!0;break}if(!l)return;const p={};for(let x=0;x<this._style.order.length;++x){const E=this._style._layers[this._style.order[x]],A=this._style._getLayerSourceCache(E);if(!A||p[A.id]||E.isHidden(this.painter.transform.zoom)||E.type!=="raster")continue;const D=E.paint.get("raster-fade-duration");for(const L of this.proxyCoords){const V=this.proxyToSource[L.key][A.id];if(V)for(const G of V){const q=pn(A.getTile(G),A.findLoadedParent(G,0),A,this.painter.transform,D);(q.opacity!==1||q.mix!==0)&&this._clearRenderCacheForTile(A.id,G)}}}}_setupDrapedRenderBatches(){const l=this._style.order,p=l.length;if(p===0)return;const x=[];let E,A=0,D=this._style._layers[l[A]];for(;!this._style.isLayerDraped(D)&&D.isHidden(this.painter.transform.zoom)&&++A<p;)D=this._style._layers[l[A]];for(;A<p;++A){const L=this._style._layers[l[A]];L.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(L)?E===void 0&&(E=A):E!==void 0&&(x.push({start:E,end:A-1}),E=void 0))}E!==void 0&&x.push({start:E,end:A-1}),this._drapedRenderBatches=x}_setupRenderCache(l){const p=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,p.renderCache.length>p.renderCachePool.length){const D=Object.values(p.proxyCachedFBO);p.proxyCachedFBO={};for(let L=0;L<D.length;++L){const V=Object.values(D[L]);p.renderCachePool.push(...V)}}return}this._clearRasterLayersFromRenderCache();const x=this.proxyCoords,E=this._tilesDirty;for(let D=x.length-1;D>=0;D--){const L=x[D];if(p.getTileByID(L.key),p.proxyCachedFBO[L.key]!==void 0){const V=l[L.key],G=this.proxyToSource[L.key];let q=0;for(const te in G){const ye=G[te],we=V[te];if(!we||we.length!==ye.length||ye.some(((Se,Ee)=>Se!==we[Ee]||E[te]&&E[te].hasOwnProperty(Se.key)))){q=-1;break}++q}for(const te in p.proxyCachedFBO[L.key])p.renderCache[p.proxyCachedFBO[L.key][te]].dirty=q<0||q!==Object.values(V).length}}const A=[...this._drapedRenderBatches];A.sort(((D,L)=>L.end-L.start-(D.end-D.start)));for(const D of A)for(const L of x){if(p.proxyCachedFBO[L.key])continue;let V=p.renderCachePool.pop();V===void 0&&p.renderCache.length<50&&(V=p.renderCache.length,p.renderCache.push(this._createFBO())),V!==void 0&&(p.proxyCachedFBO[L.key]={},p.proxyCachedFBO[L.key][D.start]=V,p.renderCache[V].dirty=!0)}this._tilesDirty={}}_setupStencil(l,p,x,E){if(!E||!this._sourceTilesOverlap[E.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const A=this.painter.context,D=A.gl;if(p.length<=1)return void(this._overlapStencilType=!1);let L;if(x.isTileClipped())L=p.length,this._overlapStencilMode.test={func:D.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(p[0].overscaledZ>p[p.length-1].overscaledZ))return void(this._overlapStencilType=!1);L=1,this._overlapStencilMode.test={func:D.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+L>255&&(A.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=L,this._overlapStencilMode.ref=this._stencilRef,x.isTileClipped()&&this._renderTileClippingMasks(p,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(l){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[l.key]),this._overlapStencilMode):o.StencilMode.disabled}_renderTileClippingMasks(l,p){const x=this.painter,E=this.painter.context,A=E.gl;x._tileClippingMaskIDs={},E.setColorMode(o.ColorMode.disabled),E.setDepthMode(o.DepthMode.disabled);const D=x.useProgram("clippingMask");for(const L of l){const V=x._tileClippingMaskIDs[L.key]=--p;D.draw(E,A.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:A.ALWAYS,mask:0},V,255,A.KEEP,A.KEEP,A.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,yt(L.projMatrix),"$clipping",x.tileExtentBuffer,x.quadTriangleIndexBuffer,x.tileExtentSegments)}}pointCoordinate(l){const p=this.painter.transform;if(l.x<0||l.x>p.width||l.y<0||l.y>p.height)return null;const x=[l.x,l.y,1,1];o.transformMat4$1(x,x,p.pixelMatrixInverse),o.scale$1(x,x,1/x[3]),x[0]/=p.worldSize,x[1]/=p.worldSize;const E=p._camera.position,A=o.mercatorZfromAltitude(1,p.center.lat),D=[E[0],E[1],E[2]/A,0],L=o.subtract([],x.slice(0,3),D);o.normalize(L,L);const V=this.raycast(D,L,this._exaggeration);return V!==null&&V?(o.scaleAndAdd(D,D,L,V),D[3]=D[2],D[2]*=A,D):null}drawDepth(){const l=this.painter,p=l.context,x=this.proxySourceCache,E=Math.ceil(l.width),A=Math.ceil(l.height);if(!this._depthFBO||this._depthFBO.width===E&&this._depthFBO.height===A||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const D=p.gl,L=p.createFramebuffer(E,A,!0);p.activeTexture.set(D.TEXTURE0);const V=new o.Texture(p,{width:E,height:A,data:null},D.RGBA);V.bind(D.NEAREST,D.CLAMP_TO_EDGE),L.colorAttachment.set(V.texture);const G=p.createRenderbuffer(p.gl.DEPTH_COMPONENT16,E,A);L.depthAttachment.set(G),this._depthFBO=L,this._depthTexture=V}p.bindFramebuffer.set(this._depthFBO.framebuffer),p.viewport.set([0,0,E,A]),(function(D,L,V,G){if(D.transform.projection.name==="globe")return;const q=D.context,te=q.gl;q.clear({depth:1});const ye=D.useProgram("terrainDepth"),we=new o.DepthMode(te.LESS,o.DepthMode.ReadWrite,D.depthRangeFor3D);for(const Se of G){const Ee=V.getTile(Se),Ce=Jl(Se.projMatrix,0);L.setupElevationDraw(Ee,ye),ye.draw(q,te.TRIANGLES,we,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.backCCW,Ce,"terrain_depth",L.gridBuffer,L.gridIndexBuffer,L.gridNoSkirtSegments)}})(l,this,x,this.proxyCoords)}_setupProxiedCoordsForOrtho(l,p,x){if(l.getSource()instanceof Jn)return this._setupProxiedCoordsForImageSource(l,p,x);this._findCoveringTileCache[l.id]=this._findCoveringTileCache[l.id]||{};const E=this.proxiedCoords[l.id]=[],A=this.proxyCoords;for(let L=0;L<A.length;L++){const V=A[L],G=this._findTileCoveringTileID(V,l);if(G){const q=this._createProxiedId(V,G,x[V.key]&&x[V.key][l.id]);E.push(q),this.proxyToSource[V.key][l.id]=[q]}}let D=!1;for(let L=0;L<p.length;L++){const V=l.getTile(p[L]);if(!V||!V.hasData())continue;const G=this._findTileCoveringTileID(V.tileID,this.proxySourceCache);if(G&&G.tileID.canonical.z!==V.tileID.canonical.z){const q=this.proxyToSource[G.tileID.key][l.id],te=this._createProxiedId(G.tileID,V,x[G.tileID.key]&&x[G.tileID.key][l.id]);q?q.splice(q.length-1,0,te):this.proxyToSource[G.tileID.key][l.id]=[te],E.push(te),D=!0}}this._sourceTilesOverlap[l.id]=D}_setupProxiedCoordsForImageSource(l,p,x){if(!l.getSource().loaded())return;const E=this.proxiedCoords[l.id]=[],A=this.proxyCoords,D=l.getSource(),L=new o.Point(D.tileID.x,D.tileID.y)._div(1<<D.tileID.z),V=D.coordinates.map(o.MercatorCoordinate.fromLngLat).reduce(((q,te)=>(q.min.x=Math.min(q.min.x,te.x-L.x),q.min.y=Math.min(q.min.y,te.y-L.y),q.max.x=Math.max(q.max.x,te.x-L.x),q.max.y=Math.max(q.max.y,te.y-L.y),q)),{min:new o.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),G=(q,te)=>{const ye=q.wrap+q.canonical.x/(1<<q.canonical.z),we=q.canonical.y/(1<<q.canonical.z),Se=o.EXTENT/(1<<q.canonical.z),Ee=te.wrap+te.canonical.x/(1<<te.canonical.z),Ce=te.canonical.y/(1<<te.canonical.z);return ye+Se<Ee+V.min.x||ye>Ee+V.max.x||we+Se<Ce+V.min.y||we>Ce+V.max.y};for(let q=0;q<A.length;q++){const te=A[q];for(let ye=0;ye<p.length;ye++){const we=l.getTile(p[ye]);if(!we||!we.hasData()||G(te,we.tileID))continue;const Se=this._createProxiedId(te,we,x[te.key]&&x[te.key][l.id]),Ee=this.proxyToSource[te.key][l.id];Ee?Ee.push(Se):this.proxyToSource[te.key][l.id]=[Se],E.push(Se)}}}_createProxiedId(l,p,x){let E=this.orthoMatrix;if(x){const A=x.find((D=>D.key===p.tileID.key));if(A)return A}if(p.tileID.key!==l.key){const A=l.canonical.z-p.tileID.canonical.z;let D,L,V;E=o.create();const G=p.tileID.wrap-l.wrap<<l.overscaledZ;A>0?(D=o.EXTENT>>A,L=D*((p.tileID.canonical.x<<A)-l.canonical.x+G),V=D*((p.tileID.canonical.y<<A)-l.canonical.y)):(D=o.EXTENT<<-A,L=o.EXTENT*(p.tileID.canonical.x-(l.canonical.x+G<<-A)),V=o.EXTENT*(p.tileID.canonical.y-(l.canonical.y<<-A))),o.ortho(E,0,D,0,D,0,1),o.translate(E,E,[L,V,0])}return new $r(p.tileID,l.key,E)}_findTileCoveringTileID(l,p){let x=p.getTile(l);if(x&&x.hasData())return x;const E=this._findCoveringTileCache[p.id],A=E[l.key];if(x=A?p.getTileByID(A):null,x&&x.hasData()||A===null)return x;let D=x?x.tileID:l,L=D.overscaledZ;const V=p.getSource().minzoom,G=[];if(!A){const te=p.getSource().maxzoom;if(l.canonical.z>=te){const ye=l.canonical.z-te;p.getSource().reparseOverscaled?(L=Math.max(l.canonical.z+2,p.transform.tileZoom),D=new o.OverscaledTileID(L,l.wrap,te,l.canonical.x>>ye,l.canonical.y>>ye)):ye!==0&&(L=te,D=new o.OverscaledTileID(L,l.wrap,te,l.canonical.x>>ye,l.canonical.y>>ye))}D.key!==l.key&&(G.push(D.key),x=p.getTile(D))}const q=te=>{G.forEach((ye=>{E[ye]=te})),G.length=0};for(L-=1;L>=V&&(!x||!x.hasData());L--){x&&q(x.tileID.key);const te=D.calculateScaledKey(L);if(x=p.getTileByID(te),x&&x.hasData())break;const ye=E[te];if(ye===null)break;ye===void 0?G.push(te):x=p.getTileByID(ye)}return q(x?x.tileID.key:null),x&&x.hasData()?x:null}findDEMTileFor(l){return this.enabled?this._findTileCoveringTileID(l,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(l,p){let x=this._tilesDirty[l];x||(x=this._tilesDirty[l]={}),x[p.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const l=(function(p){let x=0;const E=new o.StructArrayLayout2ui4,A=131;for(let D=1;D<129;D++){for(let L=1;L<129;L++)x=D*A+L,E.emplaceBack(x,x+1),E.emplaceBack(x,x+A),E.emplaceBack(x+1,x+A),D===128&&E.emplaceBack(x+A,x+A+1);E.emplaceBack(x+1,x+1+A)}return E})();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(l),this.wireframeSegments=o.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,l.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class nr{static cacheKey(l,p,x,E){let A=`${p}${E?E.cacheKey:""}`;for(const D of x)l.usedDefines.includes(D)&&(A+=`/${D}`);return A}constructor(l,p,x,E,A,D){const L=l.gl;this.program=L.createProgram();const V=(function(ne){const be=[];for(let ke=0;ke<ne.length;ke++){if(ne[ke]===null)continue;const Le=ne[ke].split(" ");be.push(Le.pop())}return be})(x.staticAttributes),G=E?E.getBinderAttributes():[],q=V.concat(G);let te=E?E.defines():[];te=te.concat(D.map((ne=>`#define ${ne}`)));const ye=l.isWebGL2?`#version 300 es
`:"",we=ye+te.concat(l.extStandardDerivatives&&ye.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(xh):xh,xh,Ql,Vd.fragmentSource,Ra.fragmentSource,x.fragmentSource).join(`
`),Se=ye+te.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Ql,Vd.vertexSource,Ra.vertexSource,Cu.vertexSource,x.vertexSource).join(`
`),Ee=L.createShader(L.FRAGMENT_SHADER);if(L.isContextLost())return void(this.failedToCreate=!0);L.shaderSource(Ee,we),L.compileShader(Ee),L.attachShader(this.program,Ee);const Ce=L.createShader(L.VERTEX_SHADER);if(L.isContextLost())this.failedToCreate=!0;else{L.shaderSource(Ce,Se),L.compileShader(Ce),L.attachShader(this.program,Ce),this.attributes={},this.numAttributes=q.length;for(let ne=0;ne<this.numAttributes;ne++)q[ne]&&(L.bindAttribLocation(this.program,ne,q[ne]),this.attributes[q[ne]]=ne);L.linkProgram(this.program),L.deleteShader(Ce),L.deleteShader(Ee),this.fixedUniforms=A(l),this.binderUniforms=E?E.getUniforms(l):[],D.includes("TERRAIN")&&(this.terrainUniforms=(ne=>({u_dem:new o.Uniform1i(ne),u_dem_prev:new o.Uniform1i(ne),u_dem_unpack:new o.Uniform4f(ne),u_dem_tl:new o.Uniform2f(ne),u_dem_scale:new o.Uniform1f(ne),u_dem_tl_prev:new o.Uniform2f(ne),u_dem_scale_prev:new o.Uniform1f(ne),u_dem_size:new o.Uniform1f(ne),u_dem_lerp:new o.Uniform1f(ne),u_exaggeration:new o.Uniform1f(ne),u_depth:new o.Uniform1i(ne),u_depth_size_inv:new o.Uniform2f(ne),u_meter_to_dem:new o.Uniform1f(ne),u_label_plane_matrix_inv:new o.UniformMatrix4f(ne)}))(l)),D.includes("GLOBE")&&(this.globeUniforms=(ne=>({u_tile_tl_up:new o.Uniform3f(ne),u_tile_tr_up:new o.Uniform3f(ne),u_tile_br_up:new o.Uniform3f(ne),u_tile_bl_up:new o.Uniform3f(ne),u_tile_up_scale:new o.Uniform1f(ne)}))(l)),D.includes("FOG")&&(this.fogUniforms=(ne=>({u_fog_matrix:new o.UniformMatrix4f(ne),u_fog_range:new o.Uniform2f(ne),u_fog_color:new o.Uniform4f(ne),u_fog_horizon_blend:new o.Uniform1f(ne),u_fog_temporal_offset:new o.Uniform1f(ne),u_frustum_tl:new o.Uniform3f(ne),u_frustum_tr:new o.Uniform3f(ne),u_frustum_br:new o.Uniform3f(ne),u_frustum_bl:new o.Uniform3f(ne),u_globe_pos:new o.Uniform3f(ne),u_globe_radius:new o.Uniform1f(ne),u_globe_transition:new o.Uniform1f(ne),u_is_globe:new o.Uniform1i(ne),u_viewport:new o.Uniform2f(ne)}))(l))}}setTerrainUniformValues(l,p){if(!this.terrainUniforms)return;const x=this.terrainUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const E in p)x[E]&&x[E].set(this.program,E,p[E])}}setGlobeUniformValues(l,p){if(!this.globeUniforms)return;const x=this.globeUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const E in p)x[E]&&x[E].set(this.program,E,p[E])}}setFogUniformValues(l,p){if(!this.fogUniforms)return;const x=this.fogUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const E in p)x[E].set(this.program,E,p[E])}}draw(l,p,x,E,A,D,L,V,G,q,te,ye,we,Se,Ee){const Ce=l.gl;if(this.failedToCreate)return;l.program.set(this.program),l.setDepthMode(x),l.setStencilMode(E),l.setColorMode(A),l.setCullFace(D);for(const be of Object.keys(this.fixedUniforms))this.fixedUniforms[be].set(this.program,be,L[be]);Se&&Se.setUniforms(this.program,l,this.binderUniforms,ye,{zoom:we});const ne={[Ce.LINES]:2,[Ce.TRIANGLES]:3,[Ce.LINE_STRIP]:1}[p];for(const be of te.get()){const ke=be.vaos||(be.vaos={});(ke[V]||(ke[V]=new Zf)).bind(l,this,G,Se?Se.getPaintVertexBuffers():[],q,be.vertexOffset,Ee||[]),Ce.drawElements(p,be.primitiveLength*ne,Ce.UNSIGNED_SHORT,be.primitiveOffset*ne*2)}}}function Ho(_,l){const p=Math.pow(2,l.tileID.overscaledZ),x=l.tileSize*Math.pow(2,_.transform.tileZoom)/p,E=x*(l.tileID.canonical.x+l.tileID.wrap*p),A=x*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_tile_units_to_pixels:1/tt(l,1,_.transform.tileZoom),u_pixel_coord_upper:[E>>16,A>>16],u_pixel_coord_lower:[65535&E,65535&A]}}const Pa=o.create(),la=(_,l,p,x,E,A,D,L,V,G,q)=>{const te=l.style.light,ye=te.properties.get("position"),we=[ye.x,ye.y,ye.z],Se=o.create$1();te.properties.get("anchor")==="viewport"&&(o.fromRotation(Se,-l.transform.angle),o.transformMat3(we,we,Se));const Ee=te.properties.get("color"),Ce=l.transform,ne={u_matrix:_,u_lightpos:we,u_lightintensity:te.properties.get("intensity"),u_lightcolor:[Ee.r,Ee.g,Ee.b],u_vertical_gradient:+p,u_opacity:x,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Pa,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:E,u_edge_radius:A};return Ce.projection.name==="globe"&&(ne.u_tile_id=[D.canonical.x,D.canonical.y,1<<D.canonical.z],ne.u_zoom_transition=V,ne.u_inv_rot_matrix=q,ne.u_merc_center=G,ne.u_up_dir=Ce.projection.upVector(new o.CanonicalTileID(0,0,0),G[0]*o.EXTENT,G[1]*o.EXTENT),ne.u_height_lift=L),ne},kc=(_,l,p,x,E,A,D,L,V,G,q,te)=>{const ye=la(_,l,p,x,E,A,D,V,G,q,te),we={u_height_factor:-Math.pow(2,D.overscaledZ)/L.tileSize/8};return o.extend(ye,Ho(l,L),we)},ka=_=>({u_matrix:_}),Dc=(_,l,p)=>o.extend(ka(_),Ho(l,p)),uv=(_,l)=>({u_matrix:_,u_world:l}),hv=(_,l,p,x)=>o.extend(Dc(_,l,p),{u_world:x}),dv=o.create(),Kf=(_,l,p,x,E,A)=>{const D=_.transform,L=D.projection.name==="globe";let V;if(A.paint.get("circle-pitch-alignment")==="map")if(L){const q=o.globePixelsToTileUnits(D.zoom,l.canonical)*D._pixelsPerMercatorPixel;V=Float32Array.from([q,0,0,q])}else V=D.calculatePixelsToTileUnitsMatrix(p);else V=new Float32Array([D.pixelsToGLUnits[0],0,0,D.pixelsToGLUnits[1]]);const G={u_camera_to_center_distance:D.cameraToCenterDistance,u_matrix:_.translatePosMatrix(l.projMatrix,p,A.paint.get("circle-translate"),A.paint.get("circle-translate-anchor")),u_device_pixel_ratio:o.exported.devicePixelRatio,u_extrude_scale:V,u_inv_rot_matrix:dv,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(L){G.u_inv_rot_matrix=x,G.u_merc_center=E,G.u_tile_id=[l.canonical.x,l.canonical.y,1<<l.canonical.z],G.u_zoom_transition=o.globeToMercatorTransition(D.zoom);const q=E[0]*o.EXTENT,te=E[1]*o.EXTENT;G.u_up_dir=D.projection.upVector(new o.CanonicalTileID(0,0,0),q,te)}return G},Yf=_=>{const l=[];return _.paint.get("circle-pitch-alignment")==="map"&&l.push("PITCH_WITH_MAP"),_.paint.get("circle-pitch-scale")==="map"&&l.push("SCALE_WITH_MAP"),l},Au=(_,l,p,x)=>{const E=o.EXTENT/p.tileSize;return{u_matrix:_,u_camera_to_center_distance:l.getCameraToCenterDistance(x),u_extrude_scale:[l.pixelsToGLUnits[0]/E,l.pixelsToGLUnits[1]/E]}},Lc=(_,l,p=1)=>({u_matrix:_,u_color:l,u_overlay:0,u_overlay_scale:p}),Kg=o.create(),Ud=(_,l,p,x,E,A,D)=>{const L=_.transform,V=L.projection.name==="globe",G=V?o.globePixelsToTileUnits(L.zoom,l.canonical)*L._pixelsPerMercatorPixel:tt(p,1,A),q={u_matrix:l.projMatrix,u_extrude_scale:G,u_intensity:D,u_inv_rot_matrix:Kg,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(V){q.u_inv_rot_matrix=x,q.u_merc_center=E,q.u_tile_id=[l.canonical.x,l.canonical.y,1<<l.canonical.z],q.u_zoom_transition=o.globeToMercatorTransition(L.zoom);const te=E[0]*o.EXTENT,ye=E[1]*o.EXTENT;q.u_up_dir=L.projection.upVector(new o.CanonicalTileID(0,0,0),te,ye)}return q},Yg=(_,l,p,x,E,A,D)=>{const L=_.transform,V=L.calculatePixelsToTileUnitsMatrix(l);return{u_matrix:jd(_,l,p,x),u_pixels_to_tile_units:V,u_device_pixel_ratio:A,u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:E,u_texsize:Sh(p)?l.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Oc(l,_.transform),u_alpha_discard_threshold:0,u_trim_offset:D}},Eh=(_,l,p,x,E)=>{const A=_.transform;return{u_matrix:jd(_,l,p,x),u_texsize:l.imageAtlasTexture.size,u_pixels_to_tile_units:A.calculatePixelsToTileUnitsMatrix(l),u_device_pixel_ratio:E,u_image:0,u_tile_units_to_pixels:Oc(l,A),u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Oc(_,l){return 1/tt(_,1,l.tileZoom)}function jd(_,l,p,x){return _.translatePosMatrix(x||l.tileID.projMatrix,l,p.paint.get("line-translate"),p.paint.get("line-translate-anchor"))}function Sh(_){const l=_.paint.get("line-dasharray").value;return l.value||l.kind!=="constant"}const Qf=(_,l,p,x,E,A)=>{return{u_matrix:_,u_tl_parent:l,u_scale_parent:p,u_fade_t:x.mix,u_opacity:x.opacity*E.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:E.paint.get("raster-brightness-min"),u_brightness_high:E.paint.get("raster-brightness-max"),u_saturation_factor:(L=E.paint.get("raster-saturation"),L>0?1-1/(1.001-L):-L),u_contrast_factor:(D=E.paint.get("raster-contrast"),D>0?1/(1-D):1+D),u_spin_weights:sl(E.paint.get("raster-hue-rotate")),u_perspective_transform:A};var D,L};function sl(_){_*=Math.PI/180;const l=Math.sin(_),p=Math.cos(_);return[(2*p+1)/3,(-Math.sqrt(3)*l-p+1)/3,(Math.sqrt(3)*l-p+1)/3]}const Jf=o.create(),Am=(_,l,p,x,E,A,D,L,V,G,q,te,ye,we,Se,Ee)=>{const Ce=E.transform,ne={u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:Ce.cameraToCenterDistance,u_rotate_symbol:+p,u_aspect_ratio:Ce.width/Ce.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_matrix:A,u_label_plane_matrix:D,u_coord_matrix:L,u_is_text:+V,u_pitch_with_map:+x,u_texsize:G,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Jf,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Jf,u_up_vector:[0,-1,0]};return Ee.name==="globe"&&(ne.u_tile_id=[q.canonical.x,q.canonical.y,1<<q.canonical.z],ne.u_zoom_transition=te,ne.u_inv_rot_matrix=we,ne.u_merc_center=ye,ne.u_camera_forward=Ce._camera.forward(),ne.u_ecef_origin=o.globeECEFOrigin(Ce.globeMatrix,q.toUnwrapped()),ne.u_tile_matrix=Float32Array.from(Ce.globeMatrix),ne.u_up_vector=Se),ne},ep=(_,l,p,x,E,A,D,L,V,G,q,te,ye,we,Se,Ee,Ce)=>o.extend(Am(_,l,p,x,E,A,D,L,V,G,te,ye,we,Se,Ee,Ce),{u_gamma_scale:x?E.transform.cameraToCenterDistance*Math.cos(E.terrain?0:E.transform._pitch):1,u_device_pixel_ratio:o.exported.devicePixelRatio,u_is_halo:1}),Qg=(_,l,p,x,E,A,D,L,V,G,q,te,ye,we,Se,Ee)=>o.extend(ep(_,l,p,x,E,A,D,L,!0,V,!0,q,te,ye,we,Se,Ee),{u_texsize_icon:G,u_texture_icon:1}),Im=(_,l,p)=>({u_matrix:_,u_opacity:l,u_color:p}),ca=(_,l,p,x,E)=>o.extend((function(A,D,L){const V=D.imageManager.getPattern(A.toString()),{width:G,height:q}=D.imageManager.getPixelSize(),te=Math.pow(2,L.tileID.overscaledZ),ye=L.tileSize*Math.pow(2,D.transform.tileZoom)/te,we=ye*(L.tileID.canonical.x+L.tileID.wrap*te),Se=ye*L.tileID.canonical.y;return{u_image:0,u_pattern_tl:V.tl,u_pattern_br:V.br,u_texsize:[G,q],u_pattern_size:V.displaySize,u_tile_units_to_pixels:1/tt(L,1,D.transform.tileZoom),u_pixel_coord_upper:[we>>16,Se>>16],u_pixel_coord_lower:[65535&we,65535&Se]}})(x,p,E),{u_matrix:_,u_opacity:l}),Iu={fillExtrusion:_=>({u_matrix:new o.UniformMatrix4f(_),u_lightpos:new o.Uniform3f(_),u_lightintensity:new o.Uniform1f(_),u_lightcolor:new o.Uniform3f(_),u_vertical_gradient:new o.Uniform1f(_),u_opacity:new o.Uniform1f(_),u_edge_radius:new o.Uniform1f(_),u_ao:new o.Uniform2f(_),u_tile_id:new o.Uniform3f(_),u_zoom_transition:new o.Uniform1f(_),u_inv_rot_matrix:new o.UniformMatrix4f(_),u_merc_center:new o.Uniform2f(_),u_up_dir:new o.Uniform3f(_),u_height_lift:new o.Uniform1f(_)}),fillExtrusionPattern:_=>({u_matrix:new o.UniformMatrix4f(_),u_lightpos:new o.Uniform3f(_),u_lightintensity:new o.Uniform1f(_),u_lightcolor:new o.Uniform3f(_),u_vertical_gradient:new o.Uniform1f(_),u_height_factor:new o.Uniform1f(_),u_edge_radius:new o.Uniform1f(_),u_ao:new o.Uniform2f(_),u_tile_id:new o.Uniform3f(_),u_zoom_transition:new o.Uniform1f(_),u_inv_rot_matrix:new o.UniformMatrix4f(_),u_merc_center:new o.Uniform2f(_),u_up_dir:new o.Uniform3f(_),u_height_lift:new o.Uniform1f(_),u_image:new o.Uniform1i(_),u_texsize:new o.Uniform2f(_),u_pixel_coord_upper:new o.Uniform2f(_),u_pixel_coord_lower:new o.Uniform2f(_),u_tile_units_to_pixels:new o.Uniform1f(_),u_opacity:new o.Uniform1f(_)}),fill:_=>({u_matrix:new o.UniformMatrix4f(_)}),fillPattern:_=>({u_matrix:new o.UniformMatrix4f(_),u_image:new o.Uniform1i(_),u_texsize:new o.Uniform2f(_),u_pixel_coord_upper:new o.Uniform2f(_),u_pixel_coord_lower:new o.Uniform2f(_),u_tile_units_to_pixels:new o.Uniform1f(_)}),fillOutline:_=>({u_matrix:new o.UniformMatrix4f(_),u_world:new o.Uniform2f(_)}),fillOutlinePattern:_=>({u_matrix:new o.UniformMatrix4f(_),u_world:new o.Uniform2f(_),u_image:new o.Uniform1i(_),u_texsize:new o.Uniform2f(_),u_pixel_coord_upper:new o.Uniform2f(_),u_pixel_coord_lower:new o.Uniform2f(_),u_tile_units_to_pixels:new o.Uniform1f(_)}),circle:_=>({u_camera_to_center_distance:new o.Uniform1f(_),u_extrude_scale:new o.UniformMatrix2f(_),u_device_pixel_ratio:new o.Uniform1f(_),u_matrix:new o.UniformMatrix4f(_),u_inv_rot_matrix:new o.UniformMatrix4f(_),u_merc_center:new o.Uniform2f(_),u_tile_id:new o.Uniform3f(_),u_zoom_transition:new o.Uniform1f(_),u_up_dir:new o.Uniform3f(_)}),collisionBox:_=>({u_matrix:new o.UniformMatrix4f(_),u_camera_to_center_distance:new o.Uniform1f(_),u_extrude_scale:new o.Uniform2f(_)}),collisionCircle:_=>({u_matrix:new o.UniformMatrix4f(_),u_inv_matrix:new o.UniformMatrix4f(_),u_camera_to_center_distance:new o.Uniform1f(_),u_viewport_size:new o.Uniform2f(_)}),debug:_=>({u_color:new o.UniformColor(_),u_matrix:new o.UniformMatrix4f(_),u_overlay:new o.Uniform1i(_),u_overlay_scale:new o.Uniform1f(_)}),clippingMask:_=>({u_matrix:new o.UniformMatrix4f(_)}),heatmap:_=>({u_extrude_scale:new o.Uniform1f(_),u_intensity:new o.Uniform1f(_),u_matrix:new o.UniformMatrix4f(_),u_inv_rot_matrix:new o.UniformMatrix4f(_),u_merc_center:new o.Uniform2f(_),u_tile_id:new o.Uniform3f(_),u_zoom_transition:new o.Uniform1f(_),u_up_dir:new o.Uniform3f(_)}),heatmapTexture:_=>({u_image:new o.Uniform1i(_),u_color_ramp:new o.Uniform1i(_),u_opacity:new o.Uniform1f(_)}),hillshade:_=>({u_matrix:new o.UniformMatrix4f(_),u_image:new o.Uniform1i(_),u_latrange:new o.Uniform2f(_),u_light:new o.Uniform2f(_),u_shadow:new o.UniformColor(_),u_highlight:new o.UniformColor(_),u_accent:new o.UniformColor(_)}),hillshadePrepare:_=>({u_matrix:new o.UniformMatrix4f(_),u_image:new o.Uniform1i(_),u_dimension:new o.Uniform2f(_),u_zoom:new o.Uniform1f(_),u_unpack:new o.Uniform4f(_)}),line:_=>({u_matrix:new o.UniformMatrix4f(_),u_pixels_to_tile_units:new o.UniformMatrix2f(_),u_device_pixel_ratio:new o.Uniform1f(_),u_units_to_pixels:new o.Uniform2f(_),u_dash_image:new o.Uniform1i(_),u_gradient_image:new o.Uniform1i(_),u_image_height:new o.Uniform1f(_),u_texsize:new o.Uniform2f(_),u_tile_units_to_pixels:new o.Uniform1f(_),u_alpha_discard_threshold:new o.Uniform1f(_),u_trim_offset:new o.Uniform2f(_)}),linePattern:_=>({u_matrix:new o.UniformMatrix4f(_),u_texsize:new o.Uniform2f(_),u_pixels_to_tile_units:new o.UniformMatrix2f(_),u_device_pixel_ratio:new o.Uniform1f(_),u_image:new o.Uniform1i(_),u_units_to_pixels:new o.Uniform2f(_),u_tile_units_to_pixels:new o.Uniform1f(_),u_alpha_discard_threshold:new o.Uniform1f(_)}),raster:_=>({u_matrix:new o.UniformMatrix4f(_),u_tl_parent:new o.Uniform2f(_),u_scale_parent:new o.Uniform1f(_),u_fade_t:new o.Uniform1f(_),u_opacity:new o.Uniform1f(_),u_image0:new o.Uniform1i(_),u_image1:new o.Uniform1i(_),u_brightness_low:new o.Uniform1f(_),u_brightness_high:new o.Uniform1f(_),u_saturation_factor:new o.Uniform1f(_),u_contrast_factor:new o.Uniform1f(_),u_spin_weights:new o.Uniform3f(_),u_perspective_transform:new o.Uniform2f(_)}),symbolIcon:_=>({u_is_size_zoom_constant:new o.Uniform1i(_),u_is_size_feature_constant:new o.Uniform1i(_),u_size_t:new o.Uniform1f(_),u_size:new o.Uniform1f(_),u_camera_to_center_distance:new o.Uniform1f(_),u_rotate_symbol:new o.Uniform1i(_),u_aspect_ratio:new o.Uniform1f(_),u_fade_change:new o.Uniform1f(_),u_matrix:new o.UniformMatrix4f(_),u_label_plane_matrix:new o.UniformMatrix4f(_),u_coord_matrix:new o.UniformMatrix4f(_),u_is_text:new o.Uniform1i(_),u_pitch_with_map:new o.Uniform1i(_),u_texsize:new o.Uniform2f(_),u_tile_id:new o.Uniform3f(_),u_zoom_transition:new o.Uniform1f(_),u_inv_rot_matrix:new o.UniformMatrix4f(_),u_merc_center:new o.Uniform2f(_),u_camera_forward:new o.Uniform3f(_),u_tile_matrix:new o.UniformMatrix4f(_),u_up_vector:new o.Uniform3f(_),u_ecef_origin:new o.Uniform3f(_),u_texture:new o.Uniform1i(_)}),symbolSDF:_=>({u_is_size_zoom_constant:new o.Uniform1i(_),u_is_size_feature_constant:new o.Uniform1i(_),u_size_t:new o.Uniform1f(_),u_size:new o.Uniform1f(_),u_camera_to_center_distance:new o.Uniform1f(_),u_rotate_symbol:new o.Uniform1i(_),u_aspect_ratio:new o.Uniform1f(_),u_fade_change:new o.Uniform1f(_),u_matrix:new o.UniformMatrix4f(_),u_label_plane_matrix:new o.UniformMatrix4f(_),u_coord_matrix:new o.UniformMatrix4f(_),u_is_text:new o.Uniform1i(_),u_pitch_with_map:new o.Uniform1i(_),u_texsize:new o.Uniform2f(_),u_texture:new o.Uniform1i(_),u_gamma_scale:new o.Uniform1f(_),u_device_pixel_ratio:new o.Uniform1f(_),u_tile_id:new o.Uniform3f(_),u_zoom_transition:new o.Uniform1f(_),u_inv_rot_matrix:new o.UniformMatrix4f(_),u_merc_center:new o.Uniform2f(_),u_camera_forward:new o.Uniform3f(_),u_tile_matrix:new o.UniformMatrix4f(_),u_up_vector:new o.Uniform3f(_),u_ecef_origin:new o.Uniform3f(_),u_is_halo:new o.Uniform1i(_)}),symbolTextAndIcon:_=>({u_is_size_zoom_constant:new o.Uniform1i(_),u_is_size_feature_constant:new o.Uniform1i(_),u_size_t:new o.Uniform1f(_),u_size:new o.Uniform1f(_),u_camera_to_center_distance:new o.Uniform1f(_),u_rotate_symbol:new o.Uniform1i(_),u_aspect_ratio:new o.Uniform1f(_),u_fade_change:new o.Uniform1f(_),u_matrix:new o.UniformMatrix4f(_),u_label_plane_matrix:new o.UniformMatrix4f(_),u_coord_matrix:new o.UniformMatrix4f(_),u_is_text:new o.Uniform1i(_),u_pitch_with_map:new o.Uniform1i(_),u_texsize:new o.Uniform2f(_),u_texsize_icon:new o.Uniform2f(_),u_texture:new o.Uniform1i(_),u_texture_icon:new o.Uniform1i(_),u_gamma_scale:new o.Uniform1f(_),u_device_pixel_ratio:new o.Uniform1f(_),u_is_halo:new o.Uniform1i(_)}),background:_=>({u_matrix:new o.UniformMatrix4f(_),u_opacity:new o.Uniform1f(_),u_color:new o.UniformColor(_)}),backgroundPattern:_=>({u_matrix:new o.UniformMatrix4f(_),u_opacity:new o.Uniform1f(_),u_image:new o.Uniform1i(_),u_pattern_tl:new o.Uniform2f(_),u_pattern_br:new o.Uniform2f(_),u_texsize:new o.Uniform2f(_),u_pattern_size:new o.Uniform2f(_),u_pixel_coord_upper:new o.Uniform2f(_),u_pixel_coord_lower:new o.Uniform2f(_),u_tile_units_to_pixels:new o.Uniform1f(_)}),terrainRaster:Th,terrainDepth:Th,skybox:_=>({u_matrix:new o.UniformMatrix4f(_),u_sun_direction:new o.Uniform3f(_),u_cubemap:new o.Uniform1i(_),u_opacity:new o.Uniform1f(_),u_temporal_offset:new o.Uniform1f(_)}),skyboxGradient:_=>({u_matrix:new o.UniformMatrix4f(_),u_color_ramp:new o.Uniform1i(_),u_center_direction:new o.Uniform3f(_),u_radius:new o.Uniform1f(_),u_opacity:new o.Uniform1f(_),u_temporal_offset:new o.Uniform1f(_)}),skyboxCapture:_=>({u_matrix_3f:new o.UniformMatrix3f(_),u_sun_direction:new o.Uniform3f(_),u_sun_intensity:new o.Uniform1f(_),u_color_tint_r:new o.Uniform4f(_),u_color_tint_m:new o.Uniform4f(_),u_luminance:new o.Uniform1f(_)}),globeRaster:_=>({u_proj_matrix:new o.UniformMatrix4f(_),u_globe_matrix:new o.UniformMatrix4f(_),u_normalize_matrix:new o.UniformMatrix4f(_),u_merc_matrix:new o.UniformMatrix4f(_),u_zoom_transition:new o.Uniform1f(_),u_merc_center:new o.Uniform2f(_),u_image0:new o.Uniform1i(_),u_grid_matrix:new o.UniformMatrix3f(_),u_skirt_height:new o.Uniform1f(_),u_frustum_tl:new o.Uniform3f(_),u_frustum_tr:new o.Uniform3f(_),u_frustum_br:new o.Uniform3f(_),u_frustum_bl:new o.Uniform3f(_),u_globe_pos:new o.Uniform3f(_),u_globe_radius:new o.Uniform1f(_),u_viewport:new o.Uniform2f(_)}),globeAtmosphere:_=>({u_frustum_tl:new o.Uniform3f(_),u_frustum_tr:new o.Uniform3f(_),u_frustum_br:new o.Uniform3f(_),u_frustum_bl:new o.Uniform3f(_),u_horizon:new o.Uniform1f(_),u_transition:new o.Uniform1f(_),u_fadeout_range:new o.Uniform1f(_),u_color:new o.Uniform4f(_),u_high_color:new o.Uniform4f(_),u_space_color:new o.Uniform4f(_),u_star_intensity:new o.Uniform1f(_),u_star_density:new o.Uniform1f(_),u_star_size:new o.Uniform1f(_),u_temporal_offset:new o.Uniform1f(_),u_horizon_angle:new o.Uniform1f(_),u_rotation_matrix:new o.UniformMatrix4f(_)})};let $d;function Ch(_,l,p,x,E,A,D){const L=_.context,V=L.gl,G=_.transform,q=_.useProgram("collisionBox"),te=[];let ye=0,we=0;for(let Le=0;Le<x.length;Le++){const je=x[Le],He=l.getTile(je),qe=He.getBucket(p);if(!qe)continue;const Qe=Hi(je,qe,G);let Ye=Qe;E[0]===0&&E[1]===0||(Ye=_.translatePosMatrix(Qe,He,E,A));const lt=D?qe.textCollisionBox:qe.iconCollisionBox,Vt=qe.collisionCircleArray;if(Vt.length>0){const rt=o.create(),_t=Ye;o.mul(rt,qe.placementInvProjMatrix,G.glCoordMatrix),o.mul(rt,rt,qe.placementViewportMatrix),te.push({circleArray:Vt,circleOffset:we,transform:_t,invTransform:rt,projection:qe.getProjection()}),ye+=Vt.length/4,we=ye}lt&&(_.terrain&&_.terrain.setupElevationDraw(He,q),q.draw(L,V.LINES,o.DepthMode.disabled,o.StencilMode.disabled,_.colorModeForRenderPass(),o.CullFaceMode.disabled,Au(Ye,G,He,qe.getProjection()),p.id,lt.layoutVertexBuffer,lt.indexBuffer,lt.segments,null,G.zoom,null,[lt.collisionVertexBuffer,lt.collisionVertexBufferExt]))}if(!D||!te.length)return;const Se=_.useProgram("collisionCircle"),Ee=new o.StructArrayLayout2f1f2i16;Ee.resize(4*ye),Ee._trim();let Ce=0;for(const Le of te)for(let je=0;je<Le.circleArray.length/4;je++){const He=4*je,qe=Le.circleArray[He+0],Qe=Le.circleArray[He+1],Ye=Le.circleArray[He+2],lt=Le.circleArray[He+3];Ee.emplace(Ce++,qe,Qe,Ye,lt,0),Ee.emplace(Ce++,qe,Qe,Ye,lt,1),Ee.emplace(Ce++,qe,Qe,Ye,lt,2),Ee.emplace(Ce++,qe,Qe,Ye,lt,3)}(!$d||$d.length<2*ye)&&($d=(function(Le){const je=2*Le,He=new o.StructArrayLayout3ui6;He.resize(je),He._trim();for(let qe=0;qe<je;qe++){const Qe=6*qe;He.uint16[Qe+0]=4*qe+0,He.uint16[Qe+1]=4*qe+1,He.uint16[Qe+2]=4*qe+2,He.uint16[Qe+3]=4*qe+2,He.uint16[Qe+4]=4*qe+3,He.uint16[Qe+5]=4*qe+0}return He})(ye));const ne=L.createIndexBuffer($d,!0),be=L.createVertexBuffer(Ee,o.collisionCircleLayout.members,!0);for(const Le of te){const je={u_matrix:Le.transform,u_inv_matrix:Le.invTransform,u_camera_to_center_distance:(ke=G).getCameraToCenterDistance(Le.projection),u_viewport_size:[ke.width,ke.height]};Se.draw(L,V.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,_.colorModeForRenderPass(),o.CullFaceMode.disabled,je,p.id,be,ne,o.SegmentVector.simpleSegment(0,2*Le.circleOffset,Le.circleArray.length,Le.circleArray.length/2),null,G.zoom)}var ke;be.destroy(),ne.destroy()}const Rm=o.create();function tp({width:_,height:l,anchor:p,textOffset:x,textScale:E},A){const{horizontalAlign:D,verticalAlign:L}=o.getAnchorAlignment(p),V=-(D-.5)*_,G=-(L-.5)*l,q=o.evaluateVariableOffset(p,x);return new o.Point((V/E+q[0])*A,(G/E+q[1])*A)}function Mm(_,l,p,x,E,A,D,L,V,G,q){const te=_.text.placedSymbolArray,ye=_.text.dynamicLayoutVertexArray,we=_.icon.dynamicLayoutVertexArray,Se={},Ee=_.getProjection(),Ce=gi(L,Ee,A),ne=A.elevation,be=Ee.upVectorScale(L.canonical,A.center.lat,A.worldSize).metersToTile;ye.clear();for(let ke=0;ke<te.length;ke++){const Le=te.get(ke),{tileAnchorX:je,tileAnchorY:He,numGlyphs:qe}=Le,Qe=Le.hidden||!Le.crossTileID||_.allowVerticalPlacement&&!Le.placedOrientation?null:x[Le.crossTileID];if(Qe){let Ye=0,lt=0,Vt=0;if(ne){const It=ne?ne.getAtTileOffset(L,je,He):0,[Sn,Un,Bt]=Ee.upVector(L.canonical,je,He);Ye=It*Sn*be,lt=It*Un*be,Vt=It*Bt*be}let[rt,_t,at,Ot]=Dr(Le.projectedAnchorX+Ye,Le.projectedAnchorY+lt,Le.projectedAnchorZ+Vt,p?Ce:D);const st=Es(A.getCameraToCenterDistance(Ee),Ot);let St=E.evaluateSizeForFeature(_.textSizeData,G,Le)*st/o.ONE_EM;p&&(St*=_.tilePixelRatio/V);const zt=tp(Qe,St);p?({x:rt,y:_t,z:at}=Ee.projectTilePoint(je+zt.x,He+zt.y,L.canonical),[rt,_t,at]=Dr(rt+Ye,_t+lt,at+Vt,D)):(l&&zt._rotate(-A.angle),rt+=zt.x,_t+=zt.y,at=0);const Ct=_.allowVerticalPlacement&&Le.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let It=0;It<qe;It++)o.addDynamicAttributes(ye,rt,_t,at,Ct);q&&Le.associatedIconIndex>=0&&(Se[Le.associatedIconIndex]={x:rt,y:_t,z:at,angle:Ct})}else qo(qe,ye)}if(q){we.clear();const ke=_.icon.placedSymbolArray;for(let Le=0;Le<ke.length;Le++){const je=ke.get(Le),{numGlyphs:He}=je,qe=Se[Le];if(je.hidden||!qe)qo(He,we);else{const{x:Qe,y:Ye,z:lt,angle:Vt}=qe;for(let rt=0;rt<He;rt++)o.addDynamicAttributes(we,Qe,Ye,lt,Vt)}}_.icon.dynamicLayoutVertexBuffer.updateData(we)}_.text.dynamicLayoutVertexBuffer.updateData(ye)}function Pm(_,l,p){return p.iconsInText&&l?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function Ru(_,l,p,x,E,A,D,L,V,G,q,te){const ye=_.context,we=ye.gl,Se=_.transform,Ee=L==="map",Ce=V==="map",ne=Ee&&p.layout.get("symbol-placement")!=="point",be=Ee&&!Ce&&!ne,ke=p.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Le=!1;const je=_.depthModeForSublayer(0,o.DepthMode.ReadOnly),He=[o.mercatorXfromLng(Se.center.lng),o.mercatorYfromLat(Se.center.lat)],qe=p.layout.get("text-variable-anchor"),Qe=Se.projection.name==="globe",Ye=[],lt=[0,-1,0];let Vt=lt;!Qe&&!Se.mercatorFromTransition||Ee||(Vt=(function(rt){const _t=rt._camera.getWorldToCamera(rt.worldSize,1),at=o.multiply([],_t,rt.globeMatrix);o.invert(at,at);const Ot=[0,0,0],st=[0,1,0,0];return o.transformMat4$1(st,st,at),Ot[0]=st[0],Ot[1]=st[1],Ot[2]=st[2],o.normalize(Ot,Ot),Ot})(Se));for(const rt of x){const _t=l.getTile(rt),at=_t.getBucket(p);if(!at||at.projection.name==="mercator"&&Qe)continue;const Ot=E?at.text:at.icon;if(!Ot||at.fullyClipped||!Ot.segments.get().length)continue;const st=Ot.programConfigurations.get(p.id),St=E||at.sdfIcons,zt=E?at.textSizeData:at.iconSizeData,Ct=Ce||Se.pitch!==0,It=o.evaluateSizeForZoom(zt,Se.zoom);let Sn,Un,Bt,hn,Fn=[0,0],ar=null;if(E)Un=_t.glyphAtlasTexture,Bt=we.LINEAR,Sn=_t.glyphAtlasTexture.size,at.iconsInText&&(Fn=_t.imageAtlasTexture.size,ar=_t.imageAtlasTexture,hn=Ct||_.options.rotating||_.options.zooming||zt.kind==="composite"||zt.kind==="camera"?we.LINEAR:we.NEAREST);else{const Va=p.layout.get("icon-size").constantOr(0)!==1||at.iconsNeedLinear;Un=_t.imageAtlasTexture,Bt=St||_.options.rotating||_.options.zooming||Va||Ct?we.LINEAR:we.NEAREST,Sn=_t.imageAtlasTexture.size}const Tn=at.projection.name==="globe",Pr=Tn?Vt:lt,Kr=Tn?o.globeToMercatorTransition(Se.zoom):0,qr=gi(rt,at.getProjection(),Se),Vr=Se.calculatePixelsToTileUnitsMatrix(_t),so=vt(qr,_t.tileID.canonical,Ce,Ee,Se,at.getProjection(),Vr),kr=_.terrain&&Ce&&ne?o.invert(o.create(),so):Rm,Zo=Zr(qr,_t.tileID.canonical,Ce,Ee,Se,at.getProjection(),Vr),Na=qe&&at.hasTextData(),Mi=p.layout.get("icon-text-fit")!=="none"&&Na&&at.hasIconData();if(ne){const Va=Se.elevation,Pl=Va?Va.getAtTileOffsetFunc(rt,Se.center.lat,Se.worldSize,at.getProjection()):null,Mo=$o(qr,_t.tileID.canonical,Ce,Ee,Se,at.getProjection(),Vr);Tu(at,qr,_,E,Mo,Zo,Ce,G,Pl,rt)}const li=ne||E&&qe||Mi,Fr=_.translatePosMatrix(qr,_t,A,D),ss=li?Rm:so,Hs=_.translatePosMatrix(Zo,_t,A,D,!0),vi=at.getProjection().createInversionMatrix(Se,rt.canonical),Ei=[];_.terrainRenderModeElevated()&&Ce&&Ei.push("PITCH_WITH_MAP_TERRAIN"),Tn&&Ei.push("PROJECTION_GLOBE_VIEW"),li&&Ei.push("PROJECTED_POS_ON_VIEWPORT");const Ji=St&&p.paint.get(E?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ml;Ml=St?at.iconsInText?Qg(zt.kind,It,be,Ce,_,Fr,ss,Hs,Sn,Fn,rt,Kr,He,vi,Pr,at.getProjection()):ep(zt.kind,It,be,Ce,_,Fr,ss,Hs,E,Sn,!0,rt,Kr,He,vi,Pr,at.getProjection()):Am(zt.kind,It,be,Ce,_,Fr,ss,Hs,E,Sn,rt,Kr,He,vi,Pr,at.getProjection());const lc={program:_.useProgram(Pm(St,E,at),st,Ei),buffers:Ot,uniformValues:Ml,atlasTexture:Un,atlasTextureIcon:ar,atlasInterpolation:Bt,atlasInterpolationIcon:hn,isSDF:St,hasHalo:Ji,tile:_t,labelPlaneMatrixInv:kr};if(ke&&at.canOverlap){Le=!0;const Va=Ot.segments.get();for(const Pl of Va)Ye.push({segments:new o.SegmentVector([Pl]),sortKey:Pl.sortKey,state:lc})}else Ye.push({segments:Ot.segments,sortKey:0,state:lc})}Le&&Ye.sort(((rt,_t)=>rt.sortKey-_t.sortKey));for(const rt of Ye){const _t=rt.state;if(_.terrain&&_.terrain.setupElevationDraw(_t.tile,_t.program,{useDepthForOcclusion:!Qe,labelPlaneMatrixInv:_t.labelPlaneMatrixInv}),ye.activeTexture.set(we.TEXTURE0),_t.atlasTexture.bind(_t.atlasInterpolation,we.CLAMP_TO_EDGE),_t.atlasTextureIcon&&(ye.activeTexture.set(we.TEXTURE1),_t.atlasTextureIcon&&_t.atlasTextureIcon.bind(_t.atlasInterpolationIcon,we.CLAMP_TO_EDGE)),_t.isSDF){const at=_t.uniformValues;_t.hasHalo&&(at.u_is_halo=1,Mu(_t.buffers,rt.segments,p,_,_t.program,je,q,te,at)),at.u_is_halo=0}Mu(_t.buffers,rt.segments,p,_,_t.program,je,q,te,_t.uniformValues)}}function Mu(_,l,p,x,E,A,D,L,V){const G=x.context,q=[_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer,_.globeExtVertexBuffer];E.draw(G,G.gl.TRIANGLES,A,D,L,o.CullFaceMode.disabled,V,p.id,_.layoutVertexBuffer,_.indexBuffer,l,p.paint,x.transform.zoom,_.programConfigurations.get(p.id),q)}function Ah(_,l,p,x,E,A,D){const L=_.context.gl,V=p.paint.get("fill-pattern"),G=V&&V.constantOr(1);let q,te,ye,we,Se;D?(te=G&&!p.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",q=L.LINES):(te=G?"fillPattern":"fill",q=L.TRIANGLES);for(const Ee of x){const Ce=l.getTile(Ee);if(G&&!Ce.patternsLoaded())continue;const ne=Ce.getBucket(p);if(!ne)continue;_.prepareDrawTile();const be=ne.programConfigurations.get(p.id),ke=_.useProgram(te,be);G&&(_.context.activeTexture.set(L.TEXTURE0),Ce.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),be.updatePaintBuffers());const Le=V.constantOr(null);if(Le&&Ce.imageAtlas){const He=Ce.imageAtlas.patternPositions[Le.toString()];He&&be.setConstantPatternPositions(He)}const je=_.translatePosMatrix(Ee.projMatrix,Ce,p.paint.get("fill-translate"),p.paint.get("fill-translate-anchor"));if(D){we=ne.indexBuffer2,Se=ne.segments2;const He=_.terrain&&_.terrain.renderingToTexture?_.terrain.drapeBufferSize:[L.drawingBufferWidth,L.drawingBufferHeight];ye=te==="fillOutlinePattern"&&G?hv(je,_,Ce,He):uv(je,He)}else we=ne.indexBuffer,Se=ne.segments,ye=G?Dc(je,_,Ce):ka(je);_.prepareDrawProgram(_.context,ke,Ee.toUnwrapped()),ke.draw(_.context,q,E,_.stencilModeForClipping(Ee),A,o.CullFaceMode.disabled,ye,p.id,ne.layoutVertexBuffer,we,Se,p.paint,_.transform.zoom,be)}}function Ih(_,l,p,x,E,A,D){const L=_.context,V=L.gl,G=_.transform,q=p.paint.get("fill-extrusion-pattern"),te=q.constantOr(1),ye=p.paint.get("fill-extrusion-opacity"),we=[p.paint.get("fill-extrusion-ambient-occlusion-intensity"),p.paint.get("fill-extrusion-ambient-occlusion-radius")],Se=p.layout.get("fill-extrusion-edge-radius"),Ee=Se>0&&!p.paint.get("fill-extrusion-rounded-roof"),Ce=Ee?0:Se,ne=G.projection.name==="globe"?o.fillExtrusionHeightLift():0,be=G.projection.name==="globe",ke=be?o.globeToMercatorTransition(G.zoom):0,Le=[o.mercatorXfromLng(G.center.lng),o.mercatorYfromLat(G.center.lat)],je=[];be&&je.push("PROJECTION_GLOBE_VIEW"),we[0]>0&&je.push("FAUX_AO"),Ee&&je.push("ZERO_ROOF_RADIUS");for(const He of x){const qe=l.getTile(He),Qe=qe.getBucket(p);if(!Qe||Qe.projection.name!==G.projection.name)continue;const Ye=Qe.programConfigurations.get(p.id),lt=_.useProgram(te?"fillExtrusionPattern":"fillExtrusion",Ye,je);if(_.terrain){const St=_.terrain;if(_.style.terrainSetForDrapingOnly())St.setupElevationDraw(qe,lt,{useMeterToDem:!0});else{if(!Qe.enableTerrain)continue;if(St.setupElevationDraw(qe,lt,{useMeterToDem:!0}),km(L,l,He,Qe,p,St),!Qe.centroidVertexBuffer){const zt=lt.attributes.a_centroid_pos;zt!==void 0&&V.vertexAttrib2f(zt,0,0)}}}te&&(_.context.activeTexture.set(V.TEXTURE0),qe.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),Ye.updatePaintBuffers());const Vt=q.constantOr(null);if(Vt&&qe.imageAtlas){const St=qe.imageAtlas.patternPositions[Vt.toString()];St&&Ye.setConstantPatternPositions(St)}const rt=_.translatePosMatrix(He.projMatrix,qe,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),_t=G.projection.createInversionMatrix(G,He.canonical),at=p.paint.get("fill-extrusion-vertical-gradient"),Ot=te?kc(rt,_,at,ye,we,Ce,He,qe,ne,ke,Le,_t):la(rt,_,at,ye,we,Ce,He,ne,ke,Le,_t);_.prepareDrawProgram(L,lt,He.toUnwrapped());const st=[];_.terrain&&st.push(Qe.centroidVertexBuffer),be&&st.push(Qe.layoutVertexExtBuffer),lt.draw(L,L.gl.TRIANGLES,E,A,D,o.CullFaceMode.backCCW,Ot,p.id,Qe.layoutVertexBuffer,Qe.indexBuffer,Qe.segments,p.paint,_.transform.zoom,Ye,st)}}function km(_,l,p,x,E,A){const D=[ne=>{let be=ne.canonical.x-1,ke=ne.wrap;return be<0&&(be=(1<<ne.canonical.z)-1,ke--),new o.OverscaledTileID(ne.overscaledZ,ke,ne.canonical.z,be,ne.canonical.y)},ne=>{let be=ne.canonical.x+1,ke=ne.wrap;return be===1<<ne.canonical.z&&(be=0,ke++),new o.OverscaledTileID(ne.overscaledZ,ke,ne.canonical.z,be,ne.canonical.y)},ne=>new o.OverscaledTileID(ne.overscaledZ,ne.wrap,ne.canonical.z,ne.canonical.x,(ne.canonical.y===0?1<<ne.canonical.z:ne.canonical.y)-1),ne=>new o.OverscaledTileID(ne.overscaledZ,ne.wrap,ne.canonical.z,ne.canonical.x,ne.canonical.y===(1<<ne.canonical.z)-1?0:ne.canonical.y+1)],L=ne=>{const be=l.getSource().minzoom,ke=je=>{const He=l.getTileByID(je);if(He&&He.hasData())return He.getBucket(E)},Le=[0,-1,1];for(const je of Le){if(ne.overscaledZ+je<be)continue;const He=ke(ne.calculateScaledKey(ne.overscaledZ+je));if(He)return He}},V=[0,0,0],G=(ne,be)=>(V[0]=Math.min(ne.min.y,be.min.y),V[1]=Math.max(ne.max.y,be.max.y),V[2]=o.EXTENT-be.min.x>ne.max.x?be.min.x-o.EXTENT:ne.max.x,V),q=(ne,be)=>(V[0]=Math.min(ne.min.x,be.min.x),V[1]=Math.max(ne.max.x,be.max.x),V[2]=o.EXTENT-be.min.y>ne.max.y?be.min.y-o.EXTENT:ne.max.y,V),te=[(ne,be)=>G(ne,be),(ne,be)=>G(be,ne),(ne,be)=>q(ne,be),(ne,be)=>q(be,ne)],ye=new o.Point(0,0);let we,Se,Ee;const Ce=(ne,be,ke,Le,je)=>{const He=[[Le?ke:ne,Le?ne:ke,0],[Le?ke:be,Le?be:ke,0]],qe=je<0?o.EXTENT+je:je,Qe=[Le?qe:(ne+be)/2,Le?(ne+be)/2:qe,0];return ke===0&&je<0||ke!==0&&je>0?A.getForTilePoints(Ee,[Qe],!0,Se):He.push(Qe),A.getForTilePoints(p,He,!0,we),Math.max(He[0][2],He[1][2],Qe[2])/A.exaggeration()};for(let ne=0;ne<4;ne++){const be=(ne<2?1:5)-ne,ke=x.borders[ne];if(ke.length===0)continue;const Le=Ee=D[ne](p),je=L(Le);if(!(je&&je instanceof o.FillExtrusionBucket&&je.enableTerrain)||x.borderDoneWithNeighborZ[ne]===je.canonical.z&&je.borderDoneWithNeighborZ[be]===x.canonical.z||(Se=A.findDEMTileFor(Le),!Se||!Se.dem))continue;if(!we){const Ye=A.findDEMTileFor(p);if(!Ye||!Ye.dem)return;we=Ye}const He=je.borders[be];let qe=0;const Qe=je.borderDoneWithNeighborZ[be]!==x.canonical.z;if(x.canonical.z===je.canonical.z){for(let Ye=0;Ye<ke.length;Ye++){const lt=x.featuresOnBorder[ke[Ye]],Vt=lt.borders[ne];let rt;for(;qe<He.length&&(rt=je.featuresOnBorder[He[qe]],!(rt.borders[be][1]>Vt[0]+3));)Qe&&je.encodeCentroid(void 0,rt,!1),qe++;if(rt&&qe<He.length){const _t=qe;let at=0;for(;!(rt.borders[be][0]>Vt[1]-3)&&(at++,++qe!==He.length);)rt=je.featuresOnBorder[He[qe]];if(rt=je.featuresOnBorder[He[_t]],lt.intersectsCount()>1||rt.intersectsCount()>1||at!==1){at!==1&&(qe=_t),x.encodeCentroid(void 0,lt,!1),Qe&&je.encodeCentroid(void 0,rt,!1);continue}const Ot=te[ne](lt,rt),st=ne%2?o.EXTENT-1:0;ye.x=Ce(Ot[0],Math.min(o.EXTENT-1,Ot[1]),st,ne<2,Ot[2]),ye.y=0,x.encodeCentroid(ye,lt,!1),Qe&&je.encodeCentroid(ye,rt,!1)}else x.encodeCentroid(void 0,lt,!1)}x.borderDoneWithNeighborZ[ne]=je.canonical.z,x.needsCentroidUpdate=!0,Qe&&(je.borderDoneWithNeighborZ[be]=x.canonical.z,je.needsCentroidUpdate=!0)}else{for(const Ye of ke)x.encodeCentroid(void 0,x.featuresOnBorder[Ye],!1);if(Qe){for(const Ye of He)je.encodeCentroid(void 0,je.featuresOnBorder[Ye],!1);je.borderDoneWithNeighborZ[be]=x.canonical.z,je.needsCentroidUpdate=!0}x.borderDoneWithNeighborZ[ne]=je.canonical.z,x.needsCentroidUpdate=!0}}(x.needsCentroidUpdate||!x.centroidVertexBuffer&&x.centroidVertexArray.length!==0)&&x.uploadCentroid(_)}const Da=new o.Color(1,0,0,1),Rh=new o.Color(0,1,0,1),Dm=new o.Color(0,0,1,1),Jg=new o.Color(1,0,1,1),Pu=new o.Color(0,1,1,1);function ey(_,l,p){const x=_.context,E=_.transform,A=x.gl,D=E.projection.name==="globe",L=D?["PROJECTION_GLOBE_VIEW"]:null;let V=p.projMatrix;if(D&&o.globeToMercatorTransition(E.zoom)>0){const lt=o.transitionTileAABBinECEF(p.canonical,E),Vt=o.globeDenormalizeECEF(lt);V=o.multiply(new Float32Array(16),E.globeMatrix,Vt),o.multiply(V,E.projMatrix,V)}const G=_.useProgram("debug",null,L),q=l.getTileByID(p.key);_.terrain&&_.terrain.setupElevationDraw(q,G);const te=o.DepthMode.disabled,ye=o.StencilMode.disabled,we=_.colorModeForRenderPass(),Se="$debug";x.activeTexture.set(A.TEXTURE0),_.emptyTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),D?q._makeGlobeTileDebugBuffers(_.context,E):q._makeDebugTileBoundsBuffers(_.context,E.projection);const Ee=q._tileDebugBuffer||_.debugBuffer,Ce=q._tileDebugIndexBuffer||_.debugIndexBuffer,ne=q._tileDebugSegments||_.debugSegments;G.draw(x,A.LINE_STRIP,te,ye,we,o.CullFaceMode.disabled,Lc(V,o.Color.red),Se,Ee,Ce,ne,null,null,null,[q._globeTileDebugBorderBuffer]);const be=q.latestRawTileData,ke=Math.floor((be&&be.byteLength||0)/1024),Le=l.getTile(p).tileSize,je=512/Math.min(Le,512)*(p.overscaledZ/E.zoom)*.5;let He=p.canonical.toString();p.overscaledZ!==p.canonical.z&&(He+=` => ${p.overscaledZ}`),He+=` ${ke}kb`,(function(lt,Vt){lt.initDebugOverlayCanvas();const rt=lt.debugOverlayCanvas,_t=lt.context.gl,at=lt.debugOverlayCanvas.getContext("2d");at.clearRect(0,0,rt.width,rt.height),at.shadowColor="white",at.shadowBlur=2,at.lineWidth=1.5,at.strokeStyle="white",at.textBaseline="top",at.font="bold 36px Open Sans, sans-serif",at.fillText(Vt,5,5),at.strokeText(Vt,5,5),lt.debugOverlayTexture.update(rt),lt.debugOverlayTexture.bind(_t.LINEAR,_t.CLAMP_TO_EDGE)})(_,He);const qe=q._tileDebugTextBuffer||_.debugBuffer,Qe=q._tileDebugTextIndexBuffer||_.quadTriangleIndexBuffer,Ye=q._tileDebugTextSegments||_.debugSegments;G.draw(x,A.TRIANGLES,te,ye,o.ColorMode.alphaBlended,o.CullFaceMode.disabled,Lc(V,o.Color.transparent,je),Se,qe,Qe,Ye,null,null,null,[q._globeTileDebugTextBuffer])}function Lm(_,l,p,x){Mh(_,0,l+p/2,_.transform.width,p,x)}function qd(_,l,p,x){Mh(_,l-p/2,0,p,_.transform.height,x)}function Mh(_,l,p,x,E,A){const D=_.context,L=D.gl;L.enable(L.SCISSOR_TEST),L.scissor(l*o.exported.devicePixelRatio,p*o.exported.devicePixelRatio,x*o.exported.devicePixelRatio,E*o.exported.devicePixelRatio),D.clear({color:A}),L.disable(L.SCISSOR_TEST)}const ty=o.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:ny}=ty;function Al(_,l,p,x){_.emplaceBack(l,p,x)}class Gd{constructor(l){this.vertexArray=new o.StructArrayLayout3f12,this.indices=new o.StructArrayLayout3ui6,Al(this.vertexArray,-1,-1,1),Al(this.vertexArray,1,-1,1),Al(this.vertexArray,-1,1,1),Al(this.vertexArray,1,1,1),Al(this.vertexArray,-1,-1,-1),Al(this.vertexArray,1,-1,-1),Al(this.vertexArray,-1,1,-1),Al(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=l.createVertexBuffer(this.vertexArray,ny),this.indexBuffer=l.createIndexBuffer(this.indices),this.segment=o.SegmentVector.simpleSegment(0,0,36,12)}}function Wo(_,l,p,x,E,A){const D=_.gl,L=l.paint.get("sky-atmosphere-color"),V=l.paint.get("sky-atmosphere-halo-color"),G=l.paint.get("sky-atmosphere-sun-intensity"),q=((te,ye,we,Se,Ee)=>({u_matrix_3f:te,u_sun_direction:ye,u_sun_intensity:we,u_color_tint_r:[Se.r,Se.g,Se.b,Se.a],u_color_tint_m:[Ee.r,Ee.g,Ee.b,Ee.a],u_luminance:5e-5}))(o.fromMat4(o.create$1(),x),E,G,L,V);D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,D.TEXTURE_CUBE_MAP_POSITIVE_X+A,l.skyboxTexture,0),p.draw(_,D.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.frontCW,q,"skyboxCapture",l.skyboxGeometry.vertexBuffer,l.skyboxGeometry.indexBuffer,l.skyboxGeometry.segment)}const Ro=o.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Hd{constructor(l){const p=new o.StructArrayLayout5f20;p.emplaceBack(-1,1,1,0,0),p.emplaceBack(1,1,1,1,0),p.emplaceBack(1,-1,1,1,1),p.emplaceBack(-1,-1,1,0,1);const x=new o.StructArrayLayout3ui6;x.emplaceBack(0,1,2),x.emplaceBack(2,3,0),this.vertexBuffer=l.createVertexBuffer(p,Ro.members),this.indexBuffer=l.createIndexBuffer(x),this.segments=o.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ls={symbol:function(_,l,p,x,E){if(_.renderPass!=="translucent")return;const A=o.StencilMode.disabled,D=_.colorModeForRenderPass();p.layout.get("text-variable-anchor")&&(function(L,V,G,q,te,ye,we){const Se=V.transform,Ee=te==="map",Ce=ye==="map";for(const ne of L){const be=q.getTile(ne),ke=be.getBucket(G);if(!ke||!ke.text||!ke.text.segments.get().length)continue;const Le=o.evaluateSizeForZoom(ke.textSizeData,Se.zoom),je=gi(ne,ke.getProjection(),Se),He=Se.calculatePixelsToTileUnitsMatrix(be),qe=vt(je,be.tileID.canonical,Ce,Ee,Se,ke.getProjection(),He),Qe=G.layout.get("icon-text-fit")!=="none"&&ke.hasIconData();if(Le){const Ye=Math.pow(2,Se.zoom-be.tileID.overscaledZ);Mm(ke,Ee,Ce,we,o.symbolSize,Se,qe,ne,Ye,Le,Qe)}}})(x,_,p,l,p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),E),p.paint.get("icon-opacity").constantOr(1)!==0&&Ru(_,l,p,x,!1,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),p.layout.get("icon-rotation-alignment"),p.layout.get("icon-pitch-alignment"),p.layout.get("icon-keep-upright"),A,D),p.paint.get("text-opacity").constantOr(1)!==0&&Ru(_,l,p,x,!0,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),p.layout.get("text-keep-upright"),A,D),l.map.showCollisionBoxes&&(Ch(_,l,p,x,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),!0),Ch(_,l,p,x,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),!1))},circle:function(_,l,p,x){if(_.renderPass!=="translucent")return;const E=p.paint.get("circle-opacity"),A=p.paint.get("circle-stroke-width"),D=p.paint.get("circle-stroke-opacity"),L=p.layout.get("circle-sort-key").constantOr(1)!==void 0;if(E.constantOr(1)===0&&(A.constantOr(1)===0||D.constantOr(1)===0))return;const V=_.context,G=V.gl,q=_.transform,te=_.depthModeForSublayer(0,o.DepthMode.ReadOnly),ye=o.StencilMode.disabled,we=_.colorModeForRenderPass(),Se=q.projection.name==="globe",Ee=[o.mercatorXfromLng(q.center.lng),o.mercatorYfromLat(q.center.lat)],Ce=[];for(let be=0;be<x.length;be++){const ke=x[be],Le=l.getTile(ke),je=Le.getBucket(p);if(!je||je.projection.name!==q.projection.name)continue;const He=je.programConfigurations.get(p.id),qe=Yf(p);Se&&qe.push("PROJECTION_GLOBE_VIEW");const Qe=_.useProgram("circle",He,qe),Ye=je.layoutVertexBuffer,lt=je.globeExtVertexBuffer,Vt=je.indexBuffer,rt=q.projection.createInversionMatrix(q,ke.canonical),_t={programConfiguration:He,program:Qe,layoutVertexBuffer:Ye,globeExtVertexBuffer:lt,indexBuffer:Vt,uniformValues:Kf(_,ke,Le,rt,Ee,p),tile:Le};if(L){const at=je.segments.get();for(const Ot of at)Ce.push({segments:new o.SegmentVector([Ot]),sortKey:Ot.sortKey,state:_t})}else Ce.push({segments:je.segments,sortKey:0,state:_t})}L&&Ce.sort(((be,ke)=>be.sortKey-ke.sortKey));const ne={useDepthForOcclusion:!Se};for(const be of Ce){const{programConfiguration:ke,program:Le,layoutVertexBuffer:je,globeExtVertexBuffer:He,indexBuffer:qe,uniformValues:Qe,tile:Ye}=be.state,lt=be.segments;_.terrain&&_.terrain.setupElevationDraw(Ye,Le,ne),_.prepareDrawProgram(V,Le,Ye.tileID.toUnwrapped()),Le.draw(V,G.TRIANGLES,te,ye,we,o.CullFaceMode.disabled,Qe,p.id,je,qe,lt,p.paint,q.zoom,ke,[He])}},heatmap:function(_,l,p,x){if(p.paint.get("heatmap-opacity")!==0)if(_.renderPass==="offscreen"){const E=_.context,A=E.gl,D=o.StencilMode.disabled,L=new o.ColorMode([A.ONE,A.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(we,Se,Ee,Ce){const ne=we.gl,be=Se.width*Ce,ke=Se.height*Ce;we.activeTexture.set(ne.TEXTURE1),we.viewport.set([0,0,be,ke]);let Le=Ee.heatmapFbo;if(!Le||Le&&(Le.width!==be||Le.height!==ke)){Le&&Le.destroy();const je=ne.createTexture();ne.bindTexture(ne.TEXTURE_2D,je),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_WRAP_S,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_WRAP_T,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MIN_FILTER,ne.LINEAR),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MAG_FILTER,ne.LINEAR),Le=Ee.heatmapFbo=we.createFramebuffer(be,ke,!1),(function(He,qe,Qe,Ye,lt,Vt){const rt=He.gl;rt.texImage2D(rt.TEXTURE_2D,0,He.isWebGL2&&He.extRenderToTextureHalfFloat?rt.RGBA16F:rt.RGBA,lt,Vt,0,rt.RGBA,He.extRenderToTextureHalfFloat?He.isWebGL2?rt.HALF_FLOAT:He.extTextureHalfFloat.HALF_FLOAT_OES:rt.UNSIGNED_BYTE,null),Ye.colorAttachment.set(Qe)})(we,0,je,Le,be,ke)}else ne.bindTexture(ne.TEXTURE_2D,Le.colorAttachment.get()),we.bindFramebuffer.set(Le.framebuffer)})(E,_,p,_.transform.projection.name==="globe"?.5:.25),E.clear({color:o.Color.transparent});const V=_.transform,G=V.projection.name==="globe",q=G?["PROJECTION_GLOBE_VIEW"]:null,te=G?o.CullFaceMode.frontCCW:o.CullFaceMode.disabled,ye=[o.mercatorXfromLng(V.center.lng),o.mercatorYfromLat(V.center.lat)];for(let we=0;we<x.length;we++){const Se=x[we];if(l.hasRenderableParent(Se))continue;const Ee=l.getTile(Se),Ce=Ee.getBucket(p);if(!Ce||Ce.projection.name!==V.projection.name)continue;const ne=Ce.programConfigurations.get(p.id),be=_.useProgram("heatmap",ne,q),{zoom:ke}=_.transform;_.terrain&&_.terrain.setupElevationDraw(Ee,be),_.prepareDrawProgram(E,be,Se.toUnwrapped());const Le=V.projection.createInversionMatrix(V,Se.canonical);be.draw(E,A.TRIANGLES,o.DepthMode.disabled,D,L,te,Ud(_,Se,Ee,Le,ye,ke,p.paint.get("heatmap-intensity")),p.id,Ce.layoutVertexBuffer,Ce.indexBuffer,Ce.segments,p.paint,_.transform.zoom,ne,G?[Ce.globeExtVertexBuffer]:null)}E.viewport.set([0,0,_.width,_.height])}else _.renderPass==="translucent"&&(_.context.setColorMode(_.colorModeForRenderPass()),(function(E,A){const D=E.context,L=D.gl,V=A.heatmapFbo;if(!V)return;D.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,V.colorAttachment.get()),D.activeTexture.set(L.TEXTURE1);let G=A.colorRampTexture;G||(G=A.colorRampTexture=new o.Texture(D,A.colorRamp,L.RGBA)),G.bind(L.LINEAR,L.CLAMP_TO_EDGE),E.useProgram("heatmapTexture").draw(D,L.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,E.colorModeForRenderPass(),o.CullFaceMode.disabled,((q,te,ye,we)=>({u_image:0,u_color_ramp:1,u_opacity:te.paint.get("heatmap-opacity")}))(0,A),A.id,E.viewportBuffer,E.quadTriangleIndexBuffer,E.viewportSegments,A.paint,E.transform.zoom)})(_,p))},line:function(_,l,p,x){if(_.renderPass!=="translucent")return;const E=p.paint.get("line-opacity"),A=p.paint.get("line-width");if(E.constantOr(1)===0||A.constantOr(1)===0)return;const D=_.depthModeForSublayer(0,o.DepthMode.ReadOnly),L=_.colorModeForRenderPass(),V=_.terrain&&_.terrain.renderingToTexture?1:o.exported.devicePixelRatio,G=p.paint.get("line-dasharray"),q=G.constantOr(1),te=p.layout.get("line-cap"),ye=p.paint.get("line-pattern"),we=ye.constantOr(1),Se=p.paint.get("line-gradient"),Ee=we?"linePattern":"line",Ce=_.context,ne=Ce.gl,be=(Le=>{const je=[];Sh(Le)&&je.push("RENDER_LINE_DASH"),Le.paint.get("line-gradient")&&je.push("RENDER_LINE_GRADIENT");const He=Le.paint.get("line-trim-offset");He[0]===0&&He[1]===0||je.push("RENDER_LINE_TRIM_OFFSET");const qe=Le.paint.get("line-pattern").constantOr(1),Qe=Le.paint.get("line-opacity").constantOr(1)!==1;return!qe&&Qe&&je.push("RENDER_LINE_ALPHA_DISCARD"),je})(p);let ke=be.includes("RENDER_LINE_ALPHA_DISCARD");_.terrain&&_.terrain.clipOrMaskOverlapStencilType()&&(ke=!1);for(const Le of x){const je=l.getTile(Le);if(we&&!je.patternsLoaded())continue;const He=je.getBucket(p);if(!He)continue;_.prepareDrawTile();const qe=He.programConfigurations.get(p.id),Qe=_.useProgram(Ee,qe,be),Ye=ye.constantOr(null);if(Ye&&je.imageAtlas){const St=je.imageAtlas.patternPositions[Ye.toString()];St&&qe.setConstantPatternPositions(St)}const lt=G.constantOr(null),Vt=te.constantOr(null);if(!we&&lt&&Vt&&je.lineAtlas){const St=je.lineAtlas.getDash(lt,Vt);St&&qe.setConstantPatternPositions(St)}let[rt,_t]=p.paint.get("line-trim-offset");(Vt==="round"||Vt==="square")&&rt!==_t&&(rt===0&&(rt-=1),_t===1&&(_t+=1));const at=_.terrain?Le.projMatrix:null,Ot=we?Eh(_,je,p,at,V):Yg(_,je,p,at,He.lineClipsArray.length,V,[rt,_t]);if(Se){const St=He.gradients[p.id];let zt=St.texture;if(p.gradientVersion!==St.version){let Ct=256;if(p.stepInterpolant){const It=l.getSource().maxzoom,Sn=Le.canonical.z===It?Math.ceil(1<<_.transform.maxZoom-Le.canonical.z):1;Ct=o.clamp(o.nextPowerOfTwo(He.maxLineLength/o.EXTENT*1024*Sn),256,Ce.maxTextureSize)}St.gradient=o.renderColorRamp({expression:p.gradientExpression(),evaluationKey:"lineProgress",resolution:Ct,image:St.gradient||void 0,clips:He.lineClipsArray}),St.texture?St.texture.update(St.gradient):St.texture=new o.Texture(Ce,St.gradient,ne.RGBA),St.version=p.gradientVersion,zt=St.texture}Ce.activeTexture.set(ne.TEXTURE1),zt.bind(p.stepInterpolant?ne.NEAREST:ne.LINEAR,ne.CLAMP_TO_EDGE)}q&&(Ce.activeTexture.set(ne.TEXTURE0),je.lineAtlasTexture.bind(ne.LINEAR,ne.REPEAT),qe.updatePaintBuffers()),we&&(Ce.activeTexture.set(ne.TEXTURE0),je.imageAtlasTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),qe.updatePaintBuffers()),_.prepareDrawProgram(Ce,Qe,Le.toUnwrapped());const st=St=>{Qe.draw(Ce,ne.TRIANGLES,D,St,L,o.CullFaceMode.disabled,Ot,p.id,He.layoutVertexBuffer,He.indexBuffer,He.segments,p.paint,_.transform.zoom,qe,[He.layoutVertexBuffer2])};if(ke){const St=_.stencilModeForClipping(Le).ref;St===0&&_.terrain&&Ce.clear({stencil:0});const zt={func:ne.EQUAL,mask:255};Ot.u_alpha_discard_threshold=.8,st(new o.StencilMode(zt,St,255,ne.KEEP,ne.KEEP,ne.INVERT)),Ot.u_alpha_discard_threshold=0,st(new o.StencilMode(zt,St,255,ne.KEEP,ne.KEEP,ne.KEEP))}else st(_.stencilModeForClipping(Le))}ke&&(_.resetStencilClippingMasks(),_.terrain&&Ce.clear({stencil:0}))},fill:function(_,l,p,x){const E=p.paint.get("fill-color"),A=p.paint.get("fill-opacity");if(A.constantOr(1)===0)return;const D=_.colorModeForRenderPass(),L=p.paint.get("fill-pattern"),V=_.opaquePassEnabledForLayer()&&!L.constantOr(1)&&E.constantOr(o.Color.transparent).a===1&&A.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===V){const G=_.depthModeForSublayer(1,_.renderPass==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly);Ah(_,l,p,x,G,D,!1)}if(_.renderPass==="translucent"&&p.paint.get("fill-antialias")){const G=_.depthModeForSublayer(p.getPaintProperty("fill-outline-color")?2:0,o.DepthMode.ReadOnly);Ah(_,l,p,x,G,D,!0)}},"fill-extrusion":function(_,l,p,x){const E=p.paint.get("fill-extrusion-opacity");if(E!==0&&_.renderPass==="translucent"){const A=new o.DepthMode(_.context.gl.LEQUAL,o.DepthMode.ReadWrite,_.depthRangeFor3D);if(E!==1||p.paint.get("fill-extrusion-pattern").constantOr(1))Ih(_,l,p,x,A,o.StencilMode.disabled,o.ColorMode.disabled),Ih(_,l,p,x,A,_.stencilModeFor3D(),_.colorModeForRenderPass()),_.resetStencilClippingMasks();else{const D=_.colorModeForRenderPass();Ih(_,l,p,x,A,o.StencilMode.disabled,D)}}},hillshade:function(_,l,p,x){if(_.renderPass!=="offscreen"&&_.renderPass!=="translucent")return;const E=_.context,A=_.depthModeForSublayer(0,o.DepthMode.ReadOnly),D=_.colorModeForRenderPass(),L=_.terrain&&_.terrain.renderingToTexture,[V,G]=_.renderPass!=="translucent"||L?[{},x]:_.stencilConfigForOverlap(x);for(const q of G){const te=l.getTile(q);if(te.needsHillshadePrepare&&_.renderPass==="offscreen")no(_,te,p,A,o.StencilMode.disabled,D);else if(_.renderPass==="translucent"){const ye=L&&_.terrain?_.terrain.stencilModeForRTTOverlap(q):V[q.overscaledZ];Fd(_,q,te,p,A,ye,D)}}E.viewport.set([0,0,_.width,_.height]),_.resetStencilClippingMasks()},raster:function(_,l,p,x,E,A){if(_.renderPass!=="translucent"||p.paint.get("raster-opacity")===0||!x.length)return;const D=_.context,L=D.gl,V=l.getSource(),G=_.useProgram("raster"),q=_.colorModeForRenderPass(),te=_.terrain&&_.terrain.renderingToTexture,[ye,we]=V instanceof Jn||te?[{},x]:_.stencilConfigForOverlap(x),Se=we[we.length-1].overscaledZ,Ee=!_.options.moving;for(const Ce of we){const ne=te?o.DepthMode.disabled:_.depthModeForSublayer(Ce.overscaledZ-Se,p.paint.get("raster-opacity")===1?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly,L.LESS),be=Ce.toUnwrapped(),ke=l.getTile(Ce);if(te&&(!ke||!ke.hasData()))continue;const Le=te?Ce.projMatrix:_.transform.calculateProjMatrix(be,Ee),je=_.terrain&&te?_.terrain.stencilModeForRTTOverlap(Ce):ye[Ce.overscaledZ],He=A?0:p.paint.get("raster-fade-duration");ke.registerFadeDuration(He);const qe=l.findLoadedParent(Ce,0),Qe=pn(ke,qe,l,_.transform,He);let Ye,lt;_.terrain&&_.terrain.prepareDrawTile();const Vt=p.paint.get("raster-resampling")==="nearest"?L.NEAREST:L.LINEAR;D.activeTexture.set(L.TEXTURE0),ke.texture.bind(Vt,L.CLAMP_TO_EDGE),D.activeTexture.set(L.TEXTURE1),qe?(qe.texture.bind(Vt,L.CLAMP_TO_EDGE),Ye=Math.pow(2,qe.tileID.overscaledZ-ke.tileID.overscaledZ),lt=[ke.tileID.canonical.x*Ye%1,ke.tileID.canonical.y*Ye%1]):ke.texture.bind(Vt,L.CLAMP_TO_EDGE),ke.texture.useMipmap&&D.extTextureFilterAnisotropic&&_.transform.pitch>20&&L.texParameterf(L.TEXTURE_2D,D.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,D.extTextureFilterAnisotropicMax);const rt=Qf(Le,lt||[0,0],Ye||1,Qe,p,V instanceof Jn?V.perspectiveTransform:[0,0]);if(_.prepareDrawProgram(D,G,be),V instanceof Jn)V.boundsBuffer&&V.boundsSegments&&G.draw(D,L.TRIANGLES,ne,o.StencilMode.disabled,q,o.CullFaceMode.disabled,rt,p.id,V.boundsBuffer,_.quadTriangleIndexBuffer,V.boundsSegments);else{const{tileBoundsBuffer:_t,tileBoundsIndexBuffer:at,tileBoundsSegments:Ot}=_.getTileBoundsBuffers(ke);G.draw(D,L.TRIANGLES,ne,je,q,o.CullFaceMode.disabled,rt,p.id,_t,at,Ot)}}_.resetStencilClippingMasks()},background:function(_,l,p,x){const E=p.paint.get("background-color"),A=p.paint.get("background-opacity");if(A===0)return;const D=_.context,L=D.gl,V=_.transform,G=V.tileSize,q=p.paint.get("background-pattern");if(_.isPatternMissing(q))return;const te=!q&&E.a===1&&A===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==te)return;const ye=o.StencilMode.disabled,we=_.depthModeForSublayer(0,te==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly),Se=_.colorModeForRenderPass(),Ee=_.useProgram(q?"backgroundPattern":"background");let Ce,ne=x;ne||(Ce=_.getBackgroundTiles(),ne=Object.values(Ce).map((be=>be.tileID))),q&&(D.activeTexture.set(L.TEXTURE0),_.imageManager.bind(_.context));for(const be of ne){const ke=be.toUnwrapped(),Le=x?be.projMatrix:_.transform.calculateProjMatrix(ke);_.prepareDrawTile();const je=l?l.getTile(be):Ce?Ce[be.key]:new o.Tile(be,G,V.zoom,_),He=q?ca(Le,A,_,q,{tileID:be,tileSize:G}):Im(Le,A,E);_.prepareDrawProgram(D,Ee,ke);const{tileBoundsBuffer:qe,tileBoundsIndexBuffer:Qe,tileBoundsSegments:Ye}=_.getTileBoundsBuffers(je);Ee.draw(D,L.TRIANGLES,we,ye,Se,o.CullFaceMode.disabled,He,p.id,qe,Qe,Ye)}},sky:function(_,l,p){const x=_.transform,E=x.projection.name==="mercator"||x.projection.name==="globe"?1:o.smoothstep(7,8,x.zoom),A=p.paint.get("sky-opacity")*E;if(A===0)return;const D=_.context,L=p.paint.get("sky-type"),V=new o.DepthMode(D.gl.LEQUAL,o.DepthMode.ReadOnly,[0,1]),G=_.frameCounter/1e3%1;L==="atmosphere"?_.renderPass==="offscreen"?p.needsSkyboxCapture(_)&&((function(q,te,ye,we){const Se=q.context,Ee=Se.gl;let Ce=te.skyboxFbo;if(!Ce){Ce=te.skyboxFbo=Se.createFramebuffer(32,32,!1),te.skyboxGeometry=new Gd(Se),te.skyboxTexture=Se.gl.createTexture(),Ee.bindTexture(Ee.TEXTURE_CUBE_MAP,te.skyboxTexture),Ee.texParameteri(Ee.TEXTURE_CUBE_MAP,Ee.TEXTURE_WRAP_S,Ee.CLAMP_TO_EDGE),Ee.texParameteri(Ee.TEXTURE_CUBE_MAP,Ee.TEXTURE_WRAP_T,Ee.CLAMP_TO_EDGE),Ee.texParameteri(Ee.TEXTURE_CUBE_MAP,Ee.TEXTURE_MIN_FILTER,Ee.LINEAR),Ee.texParameteri(Ee.TEXTURE_CUBE_MAP,Ee.TEXTURE_MAG_FILTER,Ee.LINEAR);for(let Le=0;Le<6;++Le)Ee.texImage2D(Ee.TEXTURE_CUBE_MAP_POSITIVE_X+Le,0,Ee.RGBA,32,32,0,Ee.RGBA,Ee.UNSIGNED_BYTE,null)}Se.bindFramebuffer.set(Ce.framebuffer),Se.viewport.set([0,0,32,32]);const ne=te.getCenter(q,!0),be=q.useProgram("skyboxCapture"),ke=new Float64Array(16);o.identity(ke),o.rotateY(ke,ke,.5*-Math.PI),Wo(Se,te,be,ke,ne,0),o.identity(ke),o.rotateY(ke,ke,.5*Math.PI),Wo(Se,te,be,ke,ne,1),o.identity(ke),o.rotateX(ke,ke,.5*-Math.PI),Wo(Se,te,be,ke,ne,2),o.identity(ke),o.rotateX(ke,ke,.5*Math.PI),Wo(Se,te,be,ke,ne,3),o.identity(ke),Wo(Se,te,be,ke,ne,4),o.identity(ke),o.rotateY(ke,ke,Math.PI),Wo(Se,te,be,ke,ne,5),Se.viewport.set([0,0,q.width,q.height])})(_,p),p.markSkyboxValid(_)):_.renderPass==="sky"&&(function(q,te,ye,we,Se){const Ee=q.context,Ce=Ee.gl,ne=q.transform,be=q.useProgram("skybox");Ee.activeTexture.set(Ce.TEXTURE0),Ce.bindTexture(Ce.TEXTURE_CUBE_MAP,te.skyboxTexture);const ke=((Le,je,He,qe,Qe)=>({u_matrix:Le,u_sun_direction:je,u_cubemap:0,u_opacity:qe,u_temporal_offset:Qe}))(ne.skyboxMatrix,te.getCenter(q,!1),0,we,Se);q.prepareDrawProgram(Ee,be),be.draw(Ee,Ce.TRIANGLES,ye,o.StencilMode.disabled,q.colorModeForRenderPass(),o.CullFaceMode.backCW,ke,"skybox",te.skyboxGeometry.vertexBuffer,te.skyboxGeometry.indexBuffer,te.skyboxGeometry.segment)})(_,p,V,A,G):L==="gradient"&&_.renderPass==="sky"&&(function(q,te,ye,we,Se){const Ee=q.context,Ce=Ee.gl,ne=q.transform,be=q.useProgram("skyboxGradient");te.skyboxGeometry||(te.skyboxGeometry=new Gd(Ee)),Ee.activeTexture.set(Ce.TEXTURE0);let ke=te.colorRampTexture;ke||(ke=te.colorRampTexture=new o.Texture(Ee,te.colorRamp,Ce.RGBA)),ke.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE);const Le=((je,He,qe,Qe,Ye)=>({u_matrix:je,u_color_ramp:0,u_center_direction:He,u_radius:o.degToRad(qe),u_opacity:Qe,u_temporal_offset:Ye}))(ne.skyboxMatrix,te.getCenter(q,!1),te.paint.get("sky-gradient-radius"),we,Se);q.prepareDrawProgram(Ee,be),be.draw(Ee,Ce.TRIANGLES,ye,o.StencilMode.disabled,q.colorModeForRenderPass(),o.CullFaceMode.backCW,Le,"skyboxGradient",te.skyboxGeometry.vertexBuffer,te.skyboxGeometry.indexBuffer,te.skyboxGeometry.segment)})(_,p,V,A,G)},debug:function(_,l,p){for(let x=0;x<p.length;x++)ey(_,l,p[x])},custom:function(_,l,p,x){const E=_.context,A=p.implementation;if(!_.transform.projection.unsupportedLayers||!_.transform.projection.unsupportedLayers.includes("custom")||_.terrain&&(_.terrain.renderingToTexture||_.renderPass==="offscreen")&&p.isLayerDraped()){if(_.renderPass==="offscreen"){const D=A.prerender;if(D){if(_.setCustomLayerDefaults(),E.setColorMode(_.colorModeForRenderPass()),_.transform.projection.name==="globe"){const L=_.transform.pointMerc;D.call(A,E.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),o.globeToMercatorTransition(_.transform.zoom),[L.x,L.y],_.transform.pixelsPerMeterRatio)}else D.call(A,E.gl,_.transform.customLayerMatrix());E.setDirty(),_.setBaseState()}}else if(_.renderPass==="translucent"){if(_.terrain&&_.terrain.renderingToTexture){const L=A.renderToTile;if(L){const V=x[0].canonical,G=new o.MercatorCoordinate(V.x+x[0].wrap*(1<<V.z),V.y,V.z);E.setDepthMode(o.DepthMode.disabled),E.setStencilMode(o.StencilMode.disabled),E.setColorMode(_.colorModeForRenderPass()),_.setCustomLayerDefaults(),L.call(A,E.gl,G),E.setDirty(),_.setBaseState()}return}_.setCustomLayerDefaults(),E.setColorMode(_.colorModeForRenderPass()),E.setStencilMode(o.StencilMode.disabled);const D=A.renderingMode==="3d"?new o.DepthMode(_.context.gl.LEQUAL,o.DepthMode.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,o.DepthMode.ReadOnly);if(E.setDepthMode(D),_.transform.projection.name==="globe"){const L=_.transform.pointMerc;A.render(E.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),o.globeToMercatorTransition(_.transform.zoom),[L.x,L.y],_.transform.pixelsPerMeterRatio)}else A.render(E.gl,_.transform.customLayerMatrix());E.setDirty(),_.setBaseState(),E.bindFramebuffer.set(null)}}else o.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class ol{constructor(l,p,x=!1){this.context=new Xt(l,x),this.transform=p,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=o.SourceCache.maxUnderzooming+o.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(l,p){const x=!!l&&!!l.terrain&&this.transform.projection.supportsTerrain;if(!(x||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Vi(this,l));const E=this._terrain;this.transform.elevation=x?E:null,E.update(l,this.transform,p)}_updateFog(l){const p=l.fog;if(!p||this.transform.projection.name==="globe"||p.getOpacity(this.transform.pitch)<1||p.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[x,E]=p.getFovAdjustedRange(this.transform._fov);if(x>E)return void(this.transform.fogCullDistSq=null);const A=x+.78*(E-x);this.transform.fogCullDistSq=A*A}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(l,p){if(this.width=l*o.exported.devicePixelRatio,this.height=p*o.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const x of this.style.order)this.style._layers[x].resize()}setup(){const l=this.context,p=new o.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(o.EXTENT,0),p.emplaceBack(0,o.EXTENT),p.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=l.createVertexBuffer(p,o.posAttributes.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const x=new o.StructArrayLayout2i4;x.emplaceBack(0,0),x.emplaceBack(o.EXTENT,0),x.emplaceBack(0,o.EXTENT),x.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=l.createVertexBuffer(x,o.posAttributes.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const E=new o.StructArrayLayout2i4;E.emplaceBack(-1,-1),E.emplaceBack(1,-1),E.emplaceBack(-1,1),E.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(E,o.posAttributes.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const A=new o.StructArrayLayout4i8;A.emplaceBack(0,0,0,0),A.emplaceBack(o.EXTENT,0,o.EXTENT,0),A.emplaceBack(0,o.EXTENT,0,o.EXTENT),A.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.mercatorBoundsBuffer=l.createVertexBuffer(A,o.boundsAttributes.members),this.mercatorBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const D=new o.StructArrayLayout3ui6;D.emplaceBack(0,1,2),D.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(D);const L=new o.StructArrayLayout1ui2;for(const G of[0,1,3,2,0])L.emplaceBack(G);this.debugIndexBuffer=l.createIndexBuffer(L),this.emptyTexture=new o.Texture(l,new o.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),l.gl.RGBA),this.identityMat=o.create();const V=this.context.gl;this.stencilClearMode=new o.StencilMode({func:V.ALWAYS,mask:0},0,255,V.ZERO,V.ZERO,V.ZERO),this.loadTimeStamps.push(o.window.performance.now()),this.atmosphereBuffer=new Hd(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(l){return l._makeTileBoundsBuffers(this.context,this.transform.projection),l._tileBoundsBuffer?{tileBoundsBuffer:l._tileBoundsBuffer,tileBoundsIndexBuffer:l._tileBoundsIndexBuffer,tileBoundsSegments:l._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const l=this.context,p=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(l,p.TRIANGLES,o.DepthMode.disabled,this.stencilClearMode,o.ColorMode.disabled,o.CullFaceMode.disabled,yt(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(l,p,x){if(!p||this.currentStencilSource===p.id||!l.isTileClipped()||!x||x.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let L=!1;for(const V of x)if(this._tileClippingMaskIDs[V.key]===void 0){L=!0;break}if(!L)return}this.currentStencilSource=p.id;const E=this.context,A=E.gl;this.nextStencilID+x.length>256&&this.clearStencil(),E.setColorMode(o.ColorMode.disabled),E.setDepthMode(o.DepthMode.disabled);const D=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const L of x){const V=p.getTile(L),G=this._tileClippingMaskIDs[L.key]=this.nextStencilID++,{tileBoundsBuffer:q,tileBoundsIndexBuffer:te,tileBoundsSegments:ye}=this.getTileBoundsBuffers(V);D.draw(E,A.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:A.ALWAYS,mask:0},G,255,A.KEEP,A.KEEP,A.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,yt(L.projMatrix),"$clipping",q,te,ye)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,p=this.context.gl;return new o.StencilMode({func:p.NOTEQUAL,mask:255},l,255,p.KEEP,p.KEEP,p.REPLACE)}stencilModeForClipping(l){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(l);const p=this.context.gl;return new o.StencilMode({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,p.KEEP,p.KEEP,p.REPLACE)}stencilConfigForOverlap(l){const p=this.context.gl,x=l.sort(((D,L)=>L.overscaledZ-D.overscaledZ)),E=x[x.length-1].overscaledZ,A=x[0].overscaledZ-E+1;if(A>1){this.currentStencilSource=void 0,this.nextStencilID+A>256&&this.clearStencil();const D={};for(let L=0;L<A;L++)D[L+E]=new o.StencilMode({func:p.GEQUAL,mask:255},L+this.nextStencilID,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID+=A,[D,x]}return[{[E]:o.StencilMode.disabled},x]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new o.ColorMode([l.CONSTANT_COLOR,l.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?o.ColorMode.unblended:o.ColorMode.alphaBlended}depthModeForSublayer(l,p,x){if(!this.opaquePassEnabledForLayer())return o.DepthMode.disabled;const E=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new o.DepthMode(x||this.context.gl.LEQUAL,p,[E,E])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,p){this.style=l,this.options=p,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const x=this.style.order,E=this.style._sourceCaches;for(const G in E){const q=E[G];q.used&&q.prepare(this.context)}const A={},D={},L={};for(const G in E){const q=E[G];A[G]=q.getVisibleCoordinates(),D[G]=A[G].slice().reverse(),L[G]=q.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let G=0;G<x.length;G++)if(this.style._layers[x[G]].is3D()){this.opaquePassCutoff=G;break}if(this.terrain&&(this.terrain.updateTileBinding(L),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.GlobeSharedBuffers(this.context)),!o.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const G of x){const q=this.style._layers[G],te=l._getLayerSourceCache(q);if(!q.hasOffscreenPass()||q.isHidden(this.transform.zoom))continue;const ye=te?D[te.id]:void 0;(q.type==="custom"||q.isSky()||ye&&ye.length)&&this.renderLayer(this,te,q,ye)}this.depthRangeFor3D=[0,1-(l.order.length+2)*this.numSublayers*this.depthEpsilon];const V=this.terrain;if(V&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&V.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:p.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=p.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const G=this.style._layers[x[this.currentLayer]],q=l._getLayerSourceCache(G);if(G.isSky())continue;const te=q?D[q.id]:void 0;this._renderTileClippingMasks(G,q,te),this.renderLayer(this,q,G,te)}if(this.style.fog&&this.transform.projection.supportsFog&&(function(G,q){const te=G.context,ye=te.gl,we=G.transform,Se=new o.DepthMode(ye.LEQUAL,o.DepthMode.ReadOnly,[0,1]),Ee=G.useProgram("globeAtmosphere",null,we.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Ce=o.globeToMercatorTransition(we.zoom),ne=q.properties.get("color").toArray01(),be=q.properties.get("high-color").toArray01(),ke=q.properties.get("space-color").toArray01PremultipliedAlpha(),Le=o.identity$1([]);o.rotateY$1(Le,Le,-o.degToRad(we._center.lng)),o.rotateX$1(Le,Le,o.degToRad(we._center.lat)),o.rotateZ$1(Le,Le,we.angle),o.rotateX$1(Le,Le,-we._pitch);const je=o.fromQuat(new Float32Array(16),Le),He=o.mapValue(q.properties.get("star-intensity"),0,1,0,.25),qe=5e-4,Qe=o.mapValue(q.properties.get("horizon-blend"),0,1,qe,.25),Ye=o.globeUseCustomAntiAliasing(G,te,we)&&Qe===qe?we.worldSize/(2*Math.PI*1.025)-1:we.globeRadius,lt=G.frameCounter/1e3%1,Vt=o.length(we.globeCenterInViewSpace),rt=Math.sqrt(Math.pow(Vt,2)-Math.pow(Ye,2)),_t=Math.acos(rt/Vt),at=((st,St,zt,Ct,It,Sn,Un,Bt,hn,Fn,ar,Tn,Pr,Kr)=>({u_frustum_tl:st,u_frustum_tr:St,u_frustum_br:zt,u_frustum_bl:Ct,u_horizon:It,u_transition:Sn,u_fadeout_range:Un,u_color:Bt,u_high_color:hn,u_space_color:Fn,u_star_intensity:ar,u_star_size:5*o.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Tn,u_horizon_angle:Pr,u_rotation_matrix:Kr}))(we.frustumCorners.TL,we.frustumCorners.TR,we.frustumCorners.BR,we.frustumCorners.BL,we.frustumCorners.horizon,Ce,Qe,ne,be,ke,He,lt,_t,je);G.prepareDrawProgram(te,Ee);const Ot=G.atmosphereBuffer;Ot&&Ee.draw(te,ye.TRIANGLES,Se,o.StencilMode.disabled,o.ColorMode.alphaBlended,o.CullFaceMode.backCW,at,"skybox",Ot.vertexBuffer,Ot.indexBuffer,Ot.segments)})(this,this.style.fog),this.renderPass="sky",(o.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const G=this.style._layers[x[this.currentLayer]],q=l._getLayerSourceCache(G);G.isSky()&&this.renderLayer(this,q,G,q?D[q.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<x.length;){const G=this.style._layers[x[this.currentLayer]],q=l._getLayerSourceCache(G);if(G.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(G)){if(G.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const te=q?(G.type==="symbol"?L:D)[q.id]:void 0;this._renderTileClippingMasks(G,q,q?A[q.id]:void 0),this.renderLayer(this,q,G,te),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let G=null;o.values(this.style._layers).forEach((q=>{const te=l._getLayerSourceCache(q);te&&!q.isHidden(this.transform.zoom)&&(!G||G.getSource().maxzoom<te.getSource().maxzoom)&&(G=te)})),G&&this.options.showTileBoundaries&&Ls.debug(this,G,G.getVisibleCoordinates())}this.options.showPadding&&(function(G){const q=G.transform.padding;Lm(G,G.transform.height-(q.top||0),3,Da),Lm(G,q.bottom||0,3,Rh),qd(G,q.left||0,3,Dm),qd(G,G.transform.width-(q.right||0),3,Jg);const te=G.transform.centerPoint;(function(ye,we,Se,Ee){Mh(ye,we-1,Se-10,2,20,Ee),Mh(ye,we-10,Se-1,20,2,Ee)})(G,te.x,G.transform.height-te.y,Pu)})(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(o.window.performance.now()),this.saveCanvasCopy())}renderLayer(l,p,x,E){x.isHidden(this.transform.zoom)||(x.type==="background"||x.type==="sky"||x.type==="custom"||E&&E.length)&&(this.id=x.id,this.gpuTimingStart(x),(!l.transform.projection.unsupportedLayers||!l.transform.projection.unsupportedLayers.includes(x.type)||l.terrain&&x.type==="custom")&&Ls[x.type](l,p,x,E,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(l){if(!this.options.gpuTiming)return;const p=this.context.extTimerQuery;let x=this.gpuTimers[l.id];x||(x=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:p.createQueryEXT()}),x.calls++,p.beginQueryEXT(p.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const l=this.context.extTimerQuery,p=l.createQueryEXT();this.deferredRenderGpuTimeQueries.push(p),l.beginQueryEXT(l.TIME_ELAPSED_EXT,p)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}collectGpuTimers(){const l=this.gpuTimers;return this.gpuTimers={},l}collectDeferredRenderGpuQueries(){const l=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],l}queryGpuTimers(l){const p={};for(const x in l){const E=l[x],A=this.context.extTimerQuery,D=A.getQueryObjectEXT(E.query,A.QUERY_RESULT_EXT)/1e6;A.deleteQueryEXT(E.query),p[x]=D}return p}queryGpuTimeDeferredRender(l){if(!this.options.gpuTimingDeferredRender)return 0;const p=this.context.extTimerQuery;let x=0;for(const E of l)x+=p.getQueryObjectEXT(E,p.QUERY_RESULT_EXT)/1e6,p.deleteQueryEXT(E);return x}translatePosMatrix(l,p,x,E,A){if(!x[0]&&!x[1])return l;const D=A?E==="map"?this.transform.angle:0:E==="viewport"?-this.transform.angle:0;if(D){const G=Math.sin(D),q=Math.cos(D);x=[x[0]*q-x[1]*G,x[0]*G+x[1]*q]}const L=[A?x[0]:tt(p,x[0],this.transform.zoom),A?x[1]:tt(p,x[1],this.transform.zoom),0],V=new Float32Array(16);return o.translate(V,l,L),V}saveTileTexture(l){const p=this._tileTextures[l.size[0]];p?p.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const p=this._tileTextures[l];return p&&p.length>0?p.pop():null}isPatternMissing(l){return l===null||l!==void 0&&!this.imageManager.getPattern(l.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const l=this.terrain&&this.terrain.renderingToTexture,p=this.terrain&&this.terrain.exaggeration()===0,x=this.style&&this.style.fog,E=[];return this.terrainRenderModeElevated()&&E.push("TERRAIN"),this.transform.projection.name==="globe"&&E.push("GLOBE"),p&&E.push("ZERO_EXAGGERATION"),x&&!l&&x.getOpacity(this.transform.pitch)!==0&&E.push("FOG"),l&&E.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&E.push("OVERDRAW_INSPECTOR"),E}useProgram(l,p,x){this.cache=this.cache||{};const E=x||[],A=this.currentGlobalDefines().concat(E),D=nr.cacheKey(bh[l],l,A,p);return this.cache[D]||(this.cache[D]=new nr(this.context,l,bh[l],p,Iu[l],A)),this.cache[D]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(l,p,x){if(this.terrain&&this.terrain.renderingToTexture)return;const E=this.style.fog;if(E){const A=E.getOpacity(this.transform.pitch),D=((L,V,G,q,te,ye,we,Se,Ee,Ce,ne)=>{const be=L.transform,ke=V.properties.get("color").toArray01();ke[3]=q;const Le=L.frameCounter/1e3%1;return{u_fog_matrix:G?be.calculateFogTileMatrix(G):L.identityMat,u_fog_range:V.getFovAdjustedRange(be._fov),u_fog_color:ke,u_fog_horizon_blend:V.properties.get("horizon-blend"),u_fog_temporal_offset:Le,u_frustum_tl:te,u_frustum_tr:ye,u_frustum_br:we,u_frustum_bl:Se,u_globe_pos:Ee,u_globe_radius:Ce,u_viewport:ne,u_globe_transition:o.globeToMercatorTransition(be.zoom),u_is_globe:+(be.projection.name==="globe")}})(this,E,x,A,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.exported.devicePixelRatio,this.transform.height*o.exported.devicePixelRatio]);p.setFogUniformValues(l,D)}}setTileLoadedFlag(l){this.tileLoaded=l}saveCanvasCopy(){const l=this.canvasCopy();l&&(this.frameCopies.push(l),this.tileLoaded=!1)}canvasCopy(){const l=this.context.gl,p=l.createTexture();return l.bindTexture(l.TEXTURE_2D,p),l.copyTexImage2D(l.TEXTURE_2D,0,l.RGBA,0,0,l.drawingBufferWidth,l.drawingBufferHeight,0),p}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const l=this.style&&this.style.fog;return!!l&&l.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const l=this._backgroundTiles,p=this._backgroundTiles={},x=this.transform.coveringTiles({tileSize:512});for(const E of x)p[E.key]=l[E.key]||new o.Tile(E,512,this.transform.tileZoom,this);return p}clearBackgroundTiles(){this._backgroundTiles={}}}class Ph{constructor(l=0,p=0,x=0,E=0){if(isNaN(l)||l<0||isNaN(p)||p<0||isNaN(x)||x<0||isNaN(E)||E<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=p,this.left=x,this.right=E}interpolate(l,p,x){return p.top!=null&&l.top!=null&&(this.top=o.number(l.top,p.top,x)),p.bottom!=null&&l.bottom!=null&&(this.bottom=o.number(l.bottom,p.bottom,x)),p.left!=null&&l.left!=null&&(this.left=o.number(l.left,p.left,x)),p.right!=null&&l.right!=null&&(this.right=o.number(l.right,p.right,x)),this}getCenter(l,p){const x=o.clamp((this.left+l-this.right)/2,0,l),E=o.clamp((this.top+p-this.bottom)/2,0,p);return new o.Point(x,E)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new Ph(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ku(_,l){const p=o.getColumn(_,3);o.fromQuat(_,l),o.setColumn(_,3,p)}function Mr(_,l){const p=o.identity$1([]);return o.rotateZ$1(p,p,-l),o.rotateX$1(p,p,-_),p}function Du(_,l){const p=[_[0],_[1],0],x=[l[0],l[1],0];if(o.length(p)>=1e-15){const D=o.normalize([],p);o.scale$2(x,D,o.dot(x,D)),l[0]=x[0],l[1]=x[1]}const E=o.cross([],l,_);if(o.len(E)<1e-15)return null;const A=Math.atan2(-E[1],E[0]);return Mr(Math.atan2(Math.sqrt(_[0]*_[0]+_[1]*_[1]),-_[2]),A)}class zc{constructor(l,p){this.position=l,this.orientation=p}get position(){return this._position}set position(l){if(l){const p=l instanceof o.MercatorCoordinate?l:new o.MercatorCoordinate(l[0],l[1],l[2]);this._renderWorldCopies&&(p.x=o.wrap(p.x,0,1)),this._position=p}else this._position=null}lookAtPoint(l,p){if(this.orientation=null,!this.position)return;const x=this.position,E=this._elevation?this._elevation.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(l)):0,A=o.MercatorCoordinate.fromLngLat(l,E),D=[A.x-x.x,A.y-x.y,A.z-x.z];p||(p=[0,0,1]),p[2]=Math.abs(p[2]),this.orientation=Du(D,p)}setPitchBearing(l,p){this.orientation=Mr(o.degToRad(l),o.degToRad(-p))}}class Wd{constructor(l,p){this._transform=o.identity([]),this.orientation=p,this.position=l}get mercatorPosition(){const l=this.position;return new o.MercatorCoordinate(l[0],l[1],l[2])}get position(){const l=o.getColumn(this._transform,3);return[l[0],l[1],l[2]]}set position(l){var p;l&&o.setColumn(this._transform,3,[(p=l)[0],p[1],p[2],1])}get orientation(){return this._orientation}set orientation(l){this._orientation=l||o.identity$1([]),l&&ku(this._transform,this._orientation)}getPitchBearing(){const l=this.forward(),p=this.right();return{bearing:Math.atan2(-p[1],p[0]),pitch:Math.atan2(Math.sqrt(l[0]*l[0]+l[1]*l[1]),-l[2])}}setPitchBearing(l,p){this._orientation=Mr(l,p),ku(this._transform,this._orientation)}forward(){const l=o.getColumn(this._transform,2);return[-l[0],-l[1],-l[2]]}up(){const l=o.getColumn(this._transform,1);return[-l[0],-l[1],-l[2]]}right(){const l=o.getColumn(this._transform,0);return[l[0],l[1],l[2]]}getCameraToWorld(l,p){const x=new Float64Array(16);return o.invert(x,this.getWorldToCamera(l,p)),x}getWorldToCameraPosition(l,p,x){const E=this.position;o.scale$2(E,E,-l);const A=new Float64Array(16);return o.fromScaling(A,[x,x,x]),o.translate(A,A,E),A[10]*=p,A}getWorldToCamera(l,p){const x=new Float64Array(16),E=new Float64Array(4),A=this.position;return o.conjugate(E,this._orientation),o.scale$2(A,A,-l),o.fromQuat(x,E),o.translate(x,x,A),x[1]*=-1,x[5]*=-1,x[9]*=-1,x[13]*=-1,x[8]*=p,x[9]*=p,x[10]*=p,x[11]*=p,x}getCameraToClipPerspective(l,p,x,E){const A=new Float64Array(16);return o.perspective(A,l,p,x,E),A}getDistanceToElevation(l,p=!1){const x=l===0?0:o.mercatorZfromAltitude(l,p?o.latFromMercatorY(this.position[1]):this.position[1]),E=this.forward();return(x-this.position[2])/E[2]}clone(){return new Wd([...this.position],[...this.orientation])}}function ec(_,l){const p=np(_.projection,_.zoom,_.width,_.height),x=(function(A,D,L,V,G){const q=new o.LngLat(L.lng-180*ds,L.lat),te=new o.LngLat(L.lng+180*ds,L.lat),ye=A.project(q.lng,q.lat),we=A.project(te.lng,te.lat),Se=-Math.atan2(we.y-ye.y,we.x-ye.x),Ee=o.MercatorCoordinate.fromLngLat(L);Ee.y=o.clamp(Ee.y,-1+ds,1-ds);const Ce=Ee.toLngLat(),ne=A.project(Ce.lng,Ce.lat),be=o.MercatorCoordinate.fromLngLat(Ce);be.x+=ds;const ke=be.toLngLat(),Le=A.project(ke.lng,ke.lat),je=La(Le.x-ne.x,Le.y-ne.y,Se),He=o.MercatorCoordinate.fromLngLat(Ce);He.y+=ds;const qe=He.toLngLat(),Qe=A.project(qe.lng,qe.lat),Ye=La(Qe.x-ne.x,Qe.y-ne.y,Se),lt=Math.abs(je.x)/Math.abs(Ye.y),Vt=o.identity([]);o.rotateZ(Vt,Vt,-Se*(1-(G?0:V)));const rt=o.identity([]);return o.scale(rt,rt,[1,1-(1-lt)*V,1]),rt[4]=-Ye.x/Ye.y*V,o.rotateZ(rt,rt,Se),o.multiply(rt,Vt,rt),rt})(_.projection,0,_.center,p,l),E=Lu(_);return o.scale(x,x,[E,E,1]),x}function Lu(_){const l=_.projection,p=np(_.projection,_.zoom,_.width,_.height),x=rp(l,_.center),E=rp(l,o.LngLat.convert(l.center));return Math.pow(2,x*p+(1-p)*E)}function np(_,l,p,x,E=1/0){const A=_.range;if(!A)return 0;const D=Math.min(E,Math.max(p,x)),L=Math.log(D/1024)/Math.LN2;return o.smoothstep(A[0]+L,A[1]+L,l)}const ds=1/4e4;function rp(_,l){const p=o.clamp(l.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),x=new o.LngLat(l.lng-180*ds,p),E=new o.LngLat(l.lng+180*ds,p),A=_.project(x.lng,p),D=_.project(E.lng,p),L=o.MercatorCoordinate.fromLngLat(x),V=o.MercatorCoordinate.fromLngLat(E),G=D.x-A.x,q=D.y-A.y,te=V.x-L.x,ye=V.y-L.y,we=Math.sqrt((te*te+ye*ye)/(G*G+q*q));return Math.log(we)/Math.LN2}function La(_,l,p){const x=Math.cos(p),E=Math.sin(p);return{x:_*x-l*E,y:_*E+l*x}}class Ou{constructor(l,p,x,E,A,D,L){this.tileSize=512,this._renderWorldCopies=A===void 0||A,this._minZoom=l||0,this._maxZoom=p||22,this._minPitch=x??0,this._maxPitch=E??60,this.setProjection(D),this.setMaxBounds(L),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Ph,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Wd,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const l=new Ou(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return l._elevation=this._elevation,l._centerAltitude=this._centerAltitude,l._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,l.tileSize=this.tileSize,l.mercatorFromTransition=this.mercatorFromTransition,l.width=this.width,l.height=this.height,l.cameraElevationReference=this.cameraElevationReference,l._center=this._center,l._setZoom(this.zoom),l._seaLevelZoom=this._seaLevelZoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._nearZ=this._nearZ,l._farZ=this._farZ,l._averageElevation=this._averageElevation,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._camera=this._camera.clone(),l._calcMatrices(),l.freezeTileCoverage=this.freezeTileCoverage,l.frustumCorners=this.frustumCorners,l}get elevation(){return this._elevation}set elevation(l){this._elevation!==l&&(this._elevation=l,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(l,p=!1){const x=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||x)&&this._updateCameraOnTerrain(),(l||x)&&this._constrainCamera(p),this._calcMatrices()}getProjection(){return o.pick(this.projection,["name","center","parallels"])}setProjection(l){this.projectionOptions=l||{name:"mercator"};const p=this.projection?this.getProjection():void 0;this.projection=o.getProjection(this.projectionOptions);const x=!S(p,this.getProjection());return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setMercatorFromTransition(){const l=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=o.getProjection({name:"mercator"});const p=l!==this.projection.name;return p&&this._calcMatrices(),p}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get cameraWorldSize(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.Point(this.width,this.height)}get bearing(){return o.wrap(this.rotation,-180,180)}set bearing(l){this.rotation=l}get rotation(){return-this.angle/Math.PI*180}set rotation(l){const p=-l*Math.PI/180;var x;this.angle!==p&&(this._unmodified=!1,this.angle=p,this._calcMatrices(),this.rotationMatrix=(x=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0),x[0]=1,x[3]=1,x),(function(E,A,D){var L=A[0],V=A[1],G=A[2],q=A[3],te=Math.sin(D),ye=Math.cos(D);E[0]=L*ye+G*te,E[1]=V*ye+q*te,E[2]=L*-te+G*ye,E[3]=V*-te+q*ye})(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const p=o.clamp(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==p&&(this._unmodified=!1,this._pitch=p,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const l=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/l)}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=o.degToRad(l),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(l){this._averageElevation=l,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(l){const p=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==p&&(this._unmodified=!1,this._setZoom(p),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(l){this._zoom=l,this.scale=this.zoomScale(l),this.tileZoom=Math.floor(l),this.zoomFraction=l-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const l=this._elevation;this._centerAltitude=l.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=l.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const l=this._elevation,p=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],x=this.horizonLineFromTop();let E=0,A=0;for(let D=0;D<p.length;D++){const L=new o.Point(p[D][0]*this.width,x+p[D][1]*(this.height-x)),V=l.pointCoordinate(L);if(!V)continue;const G=1/Math.hypot(V[0]-this._camera.position[0],V[1]-this._camera.position[1]);E+=V[3]*G,A+=G}return A===0?NaN:E/A}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const l=this._seaLevelZoom,p=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),x=this.pixelsPerMeter/this.worldSize*p,E=this._mercatorZfromZoom(l),A=this._mercatorZfromZoom(this._maxZoom),D=Math.max(E-x,A);this._setZoom(this._zoomFromMercatorZ(D))}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}computeZoomRelativeTo(l){const p=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,l.toAltitude()));let x;x=l.z<this._camera.position[2]?[p.x,p.y,p.z]:[l.x,l.y,l.z];const E=o.length(o.sub([],this._camera.position,x));return o.clamp(this._zoomFromMercatorZ(E),this._minZoom,this._maxZoom)}setFreeCameraOptions(l){if(!this.height||!l.position&&!l.orientation)return;this._updateCameraState();let p=!1;if(l.orientation&&!o.exactEquals(l.orientation,this._camera.orientation)&&(p=this._setCameraOrientation(l.orientation)),l.position){const x=[l.position.x,l.position.y,l.position.z];o.exactEquals$1(x,this._camera.position)||(this._setCameraPosition(x),p=!0)}p&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const l=this._camera.position,p=new zc;return p.position=new o.MercatorCoordinate(l[0],l[1],l[2]),p.orientation=this._camera.orientation,p._elevation=this.elevation,p._renderWorldCopies=this.renderWorldCopies,p}_setCameraOrientation(l){if(!o.length$1(l))return!1;o.normalize$1(l,l);const p=o.transformQuat([],[0,0,-1],l),x=o.transformQuat([],[0,-1,0],l);if(x[2]<0)return!1;const E=Du(p,x);return!!E&&(this._camera.orientation=E,!0)}_setCameraPosition(l){const p=this.zoomScale(this.minZoom)*this.tileSize,x=this.zoomScale(this.maxZoom)*this.tileSize,E=this.cameraToCenterDistance;l[2]=o.clamp(l[2],E/x,E/p),this._camera.position=l}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,p,x){this._unmodified=!1,this._edgeInsets.interpolate(l,p,x),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const p=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,p)}getVisibleUnwrappedCoordinates(l){const p=[new o.UnwrappedTileID(0,l)];if(this.renderWorldCopies){const x=this.pointCoordinate(new o.Point(0,0)),E=this.pointCoordinate(new o.Point(this.width,0)),A=this.pointCoordinate(new o.Point(this.width,this.height)),D=this.pointCoordinate(new o.Point(0,this.height)),L=Math.floor(Math.min(x.x,E.x,A.x,D.x)),V=Math.floor(Math.max(x.x,E.x,A.x,D.x)),G=1;for(let q=L-G;q<=V+G;q++)q!==0&&p.push(new o.UnwrappedTileID(q,l))}return p}coveringTiles(l){let p=this.coveringZoomLevel(l);const x=p,E=this.elevation&&!l.isTerrainDEM,A=this.projection.name==="mercator";if(l.minzoom!==void 0&&p<l.minzoom)return[];l.maxzoom!==void 0&&p>l.maxzoom&&(p=l.maxzoom);const D=this.locationCoordinate(this.center),L=this.center.lat,V=1<<p,G=[V*D.x,V*D.y,0],q=this.projection.name==="globe",te=!q,ye=o.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p,te),we=q?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Se=V*o.mercatorZfromAltitude(1,this.center.lat),Ee=this._camera.position[2]/o.mercatorZfromAltitude(1,this.center.lat),Ce=[V*we.x,V*we.y,Ee*(te?1:Se)],ne=this.cameraToCenterDistance/l.tileSize*(l.roundZoom?1:.502),be=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?p:0,ke=l.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Le=l.isTerrainDEM?-ke:this._elevation?this._elevation.getMinElevationBelowMSL():0,je=this.projection.isReprojectedInTileSpace?Lu(this):1,He=st=>{const zt=new o.MercatorCoordinate(st.x+25e-6,st.y,st.z),Ct=new o.MercatorCoordinate(st.x,st.y+25e-6,st.z),It=st.toLngLat(),Sn=zt.toLngLat(),Un=Ct.toLngLat(),Bt=this.locationCoordinate(It),hn=this.locationCoordinate(Sn),Fn=this.locationCoordinate(Un),ar=Math.hypot(hn.x-Bt.x,hn.y-Bt.y),Tn=Math.hypot(Fn.x-Bt.x,Fn.y-Bt.y);return Math.sqrt(ar*Tn)*je/25e-6},qe=st=>{const St=ke,zt=Le;return{aabb:o.tileAABB(this,V,0,0,0,st,zt,St,this.projection),zoom:0,x:0,y:0,minZ:zt,maxZ:St,wrap:st,fullyVisible:!1}},Qe=[];let Ye=[];const lt=p,Vt=l.reparseOverscaled?x:p,rt=st=>st*st,_t=rt((Ee-this._centerAltitude)*Se),at=st=>{if(!this._elevation||!st.tileID||!A)return;const St=this._elevation.getMinMaxForTile(st.tileID),zt=st.aabb;St?(zt.min[2]=St.min,zt.max[2]=St.max,zt.center[2]=(zt.min[2]+zt.max[2])/2):(st.shouldSplit=Ot(st),st.shouldSplit||(zt.min[2]=zt.max[2]=zt.center[2]=this._centerAltitude))},Ot=st=>{if(st.zoom<be)return!0;if(st.zoom===lt)return!1;if(st.shouldSplit!=null)return st.shouldSplit;const St=st.aabb.distanceX(Ce),zt=st.aabb.distanceY(Ce);let Ct=_t,It=1;if(q){Ct=rt(st.aabb.distanceZ(Ce));const Bt=Math.pow(2,st.zoom),hn=o.latFromMercatorY((st.y+1)/Bt),Fn=o.latFromMercatorY(st.y/Bt),ar=Math.min(Math.max(L,hn),Fn),Tn=o.circumferenceAtLatitude(ar)/o.circumferenceAtLatitude(L);if(It=ar===L?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Tn/this._mercatorScaleRatio),this.zoom<=o.GLOBE_ZOOM_THRESHOLD_MIN&&st.zoom===lt-1&&Tn>=.9)return!0}else if(E&&(Ct=rt(st.aabb.distanceZ(Ce)*Se)),this.projection.isReprojectedInTileSpace&&x<=5){const Bt=Math.pow(2,st.zoom),hn=He(new o.MercatorCoordinate((st.x+.5)/Bt,(st.y+.5)/Bt));It=hn>.85?1:hn}const Sn=St*St+zt*zt+Ct,Un=rt((1<<lt-st.zoom)*ne*It*((Bt,hn)=>{if(hn*rt(.707)<Bt)return 1;const Fn=Math.sqrt(hn/Bt);return Fn/(1.4144271570014144+(Math.pow(1.1,Fn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Ct,_t),Sn));return Sn<Un};if(this.renderWorldCopies)for(let st=1;st<=3;st++)Qe.push(qe(-st)),Qe.push(qe(st));for(Qe.push(qe(0));Qe.length>0;){const st=Qe.pop(),St=st.x,zt=st.y;let Ct=st.fullyVisible;if(!Ct){const It=st.aabb.intersects(ye);if(It===0)continue;Ct=It===2}if(st.zoom!==lt&&Ot(st))for(let It=0;It<4;It++){const Sn=(St<<1)+It%2,Un=(zt<<1)+(It>>1),Bt={aabb:A?st.aabb.quadrant(It):o.tileAABB(this,V,st.zoom+1,Sn,Un,st.wrap,st.minZ,st.maxZ,this.projection),zoom:st.zoom+1,x:Sn,y:Un,wrap:st.wrap,fullyVisible:Ct,tileID:void 0,shouldSplit:void 0,minZ:st.minZ,maxZ:st.maxZ};E&&!q&&(Bt.tileID=new o.OverscaledTileID(st.zoom+1===lt?Vt:st.zoom+1,st.wrap,st.zoom+1,Sn,Un),at(Bt)),Qe.push(Bt)}else{const It=st.zoom===lt?Vt:st.zoom;if(l.minzoom&&l.minzoom>It)continue;const Sn=G[0]-(.5+St+(st.wrap<<st.zoom))*(1<<p-st.zoom),Un=G[1]-.5-zt,Bt=st.tileID?st.tileID:new o.OverscaledTileID(It,st.wrap,st.zoom,St,zt);Ye.push({tileID:Bt,distanceSq:Sn*Sn+Un*Un})}}if(this.fogCullDistSq){const st=this.fogCullDistSq,St=this.horizonLineFromTop();Ye=Ye.filter((zt=>{const Ct=[0,0,0,1],It=[o.EXTENT,o.EXTENT,0,1],Sn=this.calculateFogTileMatrix(zt.tileID.toUnwrapped());o.transformMat4$1(Ct,Ct,Sn),o.transformMat4$1(It,It,Sn);const Un=o.getAABBPointSquareDist(Ct,It);if(Un===0)return!0;let Bt=!1;const hn=this._elevation;if(hn&&Un>st&&St!==0){const Fn=this.calculateProjMatrix(zt.tileID.toUnwrapped());let ar;l.isTerrainDEM||(ar=hn.getMinMaxForTile(zt.tileID)),ar||(ar={min:Le,max:ke});const Tn=o.furthestTileCorner(this.rotation),Pr=[Tn[0]*o.EXTENT,Tn[1]*o.EXTENT,ar.max];o.transformMat4(Pr,Pr,Fn),Bt=(1-Pr[1])*this.height*.5<St}return Un<st||Bt}))}return Ye.sort(((st,St)=>st.distanceSq-St.distanceSq)).map((st=>st.tileID))}resize(l,p){this.width=l,this.height=p,this.pixelsToGLUnits=[2/l,-2/p],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const p=o.clamp(l.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),x=this.projection.project(l.lng,p);return new o.Point(x.x*this.worldSize,x.y*this.worldSize)}unproject(l){return this.projection.unproject(l.x/this.worldSize,l.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/o.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(l,p){let x,E;const A=this.centerPoint;if(this.projection.name==="globe"){const L=this.worldSize;x=(p.x-A.x)/L,E=(p.y-A.y)/L}else{const L=this.pointCoordinate(p),V=this.pointCoordinate(A);x=L.x-V.x,E=L.y-V.y}const D=this.locationCoordinate(l);this.setLocation(new o.MercatorCoordinate(D.x-x,D.y-E))}setLocation(l){this.center=this.coordinateLocation(l),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(l){return this.projection.locationPoint(this,l)}locationPoint3D(l){return this.projection.locationPoint(this,l,!0)}pointLocation(l){return this.coordinateLocation(this.pointCoordinate(l))}pointLocation3D(l){return this.coordinateLocation(this.pointCoordinate3D(l))}locationCoordinate(l,p){const x=p?o.mercatorZfromAltitude(p,l.lat):void 0,E=this.projection.project(l.lng,l.lat);return new o.MercatorCoordinate(E.x,E.y,x)}coordinateLocation(l){return this.projection.unproject(l.x,l.y)}pointRayIntersection(l,p){const x=p??this._centerAltitude,E=[l.x,l.y,0,1],A=[l.x,l.y,1,1];o.transformMat4$1(E,E,this.pixelMatrixInverse),o.transformMat4$1(A,A,this.pixelMatrixInverse);const D=A[3];o.scale$1(E,E,1/E[3]),o.scale$1(A,A,1/D);const L=E[2],V=A[2];return{p0:E,p1:A,t:L===V?0:(x-L)/(V-L)}}screenPointToMercatorRay(l){const p=[l.x,l.y,0,1],x=[l.x,l.y,1,1];return o.transformMat4$1(p,p,this.pixelMatrixInverse),o.transformMat4$1(x,x,this.pixelMatrixInverse),o.scale$1(p,p,1/p[3]),o.scale$1(x,x,1/x[3]),p[2]=o.mercatorZfromAltitude(p[2],this._center.lat)*this.worldSize,x[2]=o.mercatorZfromAltitude(x[2],this._center.lat)*this.worldSize,o.scale$1(p,p,1/this.worldSize),o.scale$1(x,x,1/this.worldSize),new o.Ray([p[0],p[1],p[2]],o.normalize([],o.sub([],x,p)))}rayIntersectionCoordinate(l){const{p0:p,p1:x,t:E}=l,A=o.mercatorZfromAltitude(p[2],this._center.lat),D=o.mercatorZfromAltitude(x[2],this._center.lat);return new o.MercatorCoordinate(o.number(p[0],x[0],E)/this.worldSize,o.number(p[1],x[1],E)/this.worldSize,o.number(A,D,E))}pointCoordinate(l,p=this._centerAltitude){return this.projection.pointCoordinate(this,l.x,l.y,p)}pointCoordinate3D(l){if(!this.elevation)return this.pointCoordinate(l);let p=this.projection.pointCoordinate3D(this,l.x,l.y);if(p)return new o.MercatorCoordinate(p[0],p[1],p[2]);let x=0,E=this.horizonLineFromTop();if(l.y>E)return this.pointCoordinate(l);const A=.02*E,D=l.clone();for(let L=0;L<10&&E-x>A;L++){D.y=o.number(x,E,.66);const V=this.projection.pointCoordinate3D(this,D.x,D.y);V?(E=D.y,p=V):x=D.y}return p?new o.MercatorCoordinate(p[0],p[1],p[2]):this.pointCoordinate(l)}isPointAboveHorizon(l){return this.projection.isPointAboveHorizon(this,l)}isPointOnSurface(l){if(l.y<0||l.y>this.height||l.x<0||l.x>this.width)return!1;if(this.elevation||this.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(l);const p=this.pointCoordinate(l);return p.y>=0&&p.y<=1}_coordinatePoint(l,p){const x=p&&this.elevation?this.elevation.getAtPointOrZero(l,this._centerAltitude):this._centerAltitude,E=[l.x*this.worldSize,l.y*this.worldSize,x+l.toAltitude(),1];return o.transformMat4$1(E,E,this.pixelMatrix),E[3]>0?new o.Point(E[0]/E[3],E[1]/E[3]):new o.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:l,left:p}=this._edgeInsets,x=this.height-this._edgeInsets.bottom,E=this.width-this._edgeInsets.right,A=this.pointLocation3D(new o.Point(p,l)),D=this.pointLocation3D(new o.Point(E,l)),L=this.pointLocation3D(new o.Point(E,x)),V=this.pointLocation3D(new o.Point(p,x));let G=Math.min(A.lng,D.lng,L.lng,V.lng),q=Math.max(A.lng,D.lng,L.lng,V.lng),te=Math.min(A.lat,D.lat,L.lat,V.lat),ye=Math.max(A.lat,D.lat,L.lat,V.lat);const we=Math.pow(2,-this.zoom)/16*270,Se=this.projection.name==="globe"?1:4,Ee=(Ce,ne,be,ke,Le)=>{const je=(Ce+be)/2,He=(ne+ke)/2,qe=new o.Point(je,He),{lng:Qe,lat:Ye}=this.pointLocation3D(qe),lt=Math.max(0,G-Qe,te-Ye,Qe-q,Ye-ye);G=Math.min(G,Qe),q=Math.max(q,Qe),te=Math.min(te,Ye),ye=Math.max(ye,Ye),(Le<Se||lt>we)&&(Ee(Ce,ne,je,He,Le+1),Ee(je,He,be,ke,Le+1))};if(Ee(p,l,E,l,1),Ee(E,l,E,x,1),Ee(E,x,p,x,1),Ee(p,x,p,l,1),this.projection.name==="globe"){const[Ce,ne]=o.polesInViewport(this);Ce?(ye=90,q=180,G=-180):ne&&(te=-90,q=180,G=-180)}return new o.LngLatBounds(new o.LngLat(G,te),new o.LngLat(q,ye))}_getBoundsRectangular(l,p){const{top:x,left:E}=this._edgeInsets,A=this.height-this._edgeInsets.bottom,D=this.width-this._edgeInsets.right,L=new o.Point(E,x),V=new o.Point(D,x),G=new o.Point(D,A),q=new o.Point(E,A);let te=this.pointCoordinate(L,l),ye=this.pointCoordinate(V,l);const we=this.pointCoordinate(G,p),Se=this.pointCoordinate(q,p),Ee=(Ce,ne)=>(ne.y-Ce.y)/(ne.x-Ce.x);return te.y>1&&ye.y>=0?te=new o.MercatorCoordinate((1-Se.y)/Ee(Se,te)+Se.x,1):te.y<0&&ye.y<=1&&(te=new o.MercatorCoordinate(-Se.y/Ee(Se,te)+Se.x,0)),ye.y>1&&te.y>=0?ye=new o.MercatorCoordinate((1-we.y)/Ee(we,ye)+we.x,1):ye.y<0&&te.y<=1&&(ye=new o.MercatorCoordinate(-we.y/Ee(we,ye)+we.x,0)),new o.LngLatBounds().extend(this.coordinateLocation(te)).extend(this.coordinateLocation(ye)).extend(this.coordinateLocation(Se)).extend(this.coordinateLocation(we))}_getBoundsRectangularTerrain(){const l=this.elevation;if(!l.visibleDemTiles.length||l.isUsingMockSource())return this._getBoundsRectangular(0,0);const p=l.visibleDemTiles.reduce(((x,E)=>{if(E.dem){const A=E.dem.tree;x.min=Math.min(x.min,A.minimums[0]),x.max=Math.max(x.max,A.maximums[0])}return x}),{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(p.min*l.exaggeration(),p.max*l.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(l=!0){const p=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,x=this.height/2-p*(1-this._horizonShift);return l?Math.max(0,x):x}getMaxBounds(){return this.maxBounds}setMaxBounds(l){this.maxBounds=l,this.minLat=-o.MAX_MERCATOR_LATITUDE,this.maxLat=o.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,l&&(this.minLat=l.getSouth(),this.maxLat=l.getNorth(),this.minLng=l.getWest(),this.maxLng=l.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=o.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=o.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=o.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(l,p){return this.projection.createTileMatrix(this,p,l)}calculateDistanceTileData(l){const p=l.key,x=this._distanceTileDataCache;if(x[p])return x[p];const E=l.canonical,A=1/this.height,D=this.cameraWorldSize,L=D/this.zoomScale(E.z),V=(E.x+Math.pow(2,E.z)*l.wrap)*L,G=E.y*L,q=this.point;q.x*=D/this.worldSize,q.y*=D/this.worldSize;const te=this.angle,ye=Math.sin(-te),we=-Math.cos(-te);return x[p]={bearing:[ye,we],center:[(q.x-V)*A,(q.y-G)*A],scale:L/o.EXTENT*A},x[p]}calculateFogTileMatrix(l){const p=l.key,x=this._fogTileMatrixCache;if(x[p])return x[p];const E=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,l);return o.multiply(E,this.worldToFogMatrix,E),x[p]=new Float32Array(E),x[p]}calculateProjMatrix(l,p=!1){const x=l.key,E=p?this._alignedProjMatrixCache:this._projMatrixCache;if(E[x])return E[x];const A=this.calculatePosMatrix(l,this.worldSize);return o.multiply(A,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:p?this.alignedProjMatrix:this.projMatrix,A),E[x]=new Float32Array(A),E[x]}calculatePixelsToTileUnitsMatrix(l){const p=l.tileID.key,x=this._pixelsToTileUnitsCache;if(x[p])return x[p];const E=(function(A,D){const{scale:L}=A.tileTransform,V=L*o.EXTENT/(A.tileSize*Math.pow(2,D.zoom-A.tileID.overscaledZ+A.tileID.canonical.z));return G=new Float32Array(4),ye=(q=D.inverseAdjustmentMatrix)[1],we=q[2],Se=q[3],Ce=(te=[V,V])[1],G[0]=q[0]*(Ee=te[0]),G[1]=ye*Ee,G[2]=we*Ce,G[3]=Se*Ce,G;var G,q,te,ye,we,Se,Ee,Ce})(l,this);return x[p]=E,x[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const l=1/this.worldSize,p=o.fromScaling([],[l,l,l]);return o.multiply(p,p,this.globeMatrix),p}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const l=this._elevation;this._updateCameraState();const p=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(p),E=this._camera.forward(),A=o.mercatorZfromAltitude(1,this._center.lat);x[2]/=A,E[2]/=A,o.normalize(E,E);const D=l.raycast(x,E,l.exaggeration());if(D){const L=o.scaleAndAdd([],x,E,D),V=new o.MercatorCoordinate(L[0],L[1],o.mercatorZfromAltitude(L[2],o.latFromMercatorY(L[1]))),G=(V.z+o.length([V.x-x[0],V.y-x[1],V.z-x[2]*A]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(G),this._centerAltitude=V.toAltitude(),this._center=this.coordinateLocation(V),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(l=!1){if(!this._elevation)return;const p=this._elevation,x=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,E=this._computeCameraPosition(x),A=p.getAtPointOrZero(new o.MercatorCoordinate(...E)),D=this.pixelsPerMeter/this.worldSize*A,L=this._minimumHeightOverTerrain(),V=E[2]-D;if(V<=L)if(V<0||l){const G=this.locationCoordinate(this._center,this._centerAltitude),q=[E[0],E[1],G.z-E[2]],te=o.length(q);q[2]-=(L-V)/this._pixelsPerMercatorPixel;const ye=o.length(q);if(ye===0)return;o.scale$2(q,q,te/ye*this._pixelsPerMercatorPixel),this._camera.position=[E[0],E[1],G.z*this._pixelsPerMercatorPixel-q[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const l=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||l){const ye=this.center;return ye.lat=o.clamp(ye.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!l)&&(ye.lng=o.clamp(ye.lng,this.minLng,this.maxLng)),this.center=ye,void(this._constraining=!1)}const p=this._unmodified,{x,y:E}=this.point;let A=0,D=x,L=E;const V=this.width/2,G=this.height/2,q=this.worldMinY*this.scale,te=this.worldMaxY*this.scale;if(E-G<q&&(L=q+G),E+G>te&&(L=te-G),te-q<this.height&&(A=Math.max(A,this.height/(te-q)),L=(te+q)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ye=this.worldMinX*this.scale,we=this.worldMaxX*this.scale,Se=this.worldSize/2-(ye+we)/2;D=(x+Se+this.worldSize)%this.worldSize-Se,D-V<ye&&(D=ye+V),D+V>we&&(D=we-V),we-ye<this.width&&(A=Math.max(A,this.width/(we-ye)),D=(we+ye)/2)}D===x&&L===E||(this.center=this.unproject(new o.Point(D,L))),A&&(this.zoom+=this.scaleZoom(A)),this._constrainCamera(),this._unmodified=p,this._constraining=!1}_minZoomForBounds(){let l=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(l=Math.max(l,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),l}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const l=this.centerOffset,p=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=o.mercatorZfromAltitude(1,this.center.lat)/o.mercatorZfromAltitude(1,o.GLOBE_SCALE_MATCH_LATITUDE));const x=np(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const E=this.projection.zAxisUnit==="meters"?p:1,A=this._camera.getWorldToCamera(this.worldSize,E),D=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);D[8]=2*-l.x/this.width,D[9]=2*l.y/this.height;let L=o.mul([],D,A);if(this.projection.isReprojectedInTileSpace){const He=this.locationCoordinate(this.center),qe=o.identity([]);o.translate(qe,qe,[He.x*this.worldSize,He.y*this.worldSize,0]),o.multiply(qe,qe,ec(this)),o.translate(qe,qe,[-He.x*this.worldSize,-He.y*this.worldSize,0]),o.multiply(L,L,qe),this.inverseAdjustmentMatrix=(function(Qe){const Ye=ec(Qe,!0);return se([],[Ye[0],Ye[1],Ye[4],Ye[5]])})(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=o.scale([],L,[this.worldSize,this.worldSize,this.worldSize/E,1]),this.projMatrix=L,this.invProjMatrix=o.invert(new Float64Array(16),this.projMatrix);const V=o.invert([],D);this.frustumCorners=o.FrustumCorners.fromInvProjectionMatrix(V,this.horizonLineFromTop(),this.height);const G=new Float32Array(16);o.identity(G),o.scale(G,G,[1,-1,1]),o.rotateX(G,G,this._pitch),o.rotateZ(G,G,this.angle);const q=o.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),te=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;q[8]=2*-l.x/this.width,q[9]=2*(l.y+te)/this.height,this.skyboxMatrix=o.multiply(G,q,G);const ye=this.point,we=ye.x,Se=ye.y,Ee=this.width%2/2,Ce=this.height%2/2,ne=Math.cos(this.angle),be=Math.sin(this.angle),ke=we-Math.round(we)+ne*Ee+be*Ce,Le=Se-Math.round(Se)+ne*Ce+be*Ee,je=new Float64Array(L);if(o.translate(je,je,[ke>.5?ke-1:ke,Le>.5?Le-1:Le,0]),this.alignedProjMatrix=je,L=o.create(),o.scale(L,L,[this.width/2,-this.height/2,1]),o.translate(L,L,[1,-1,0]),this.labelPlaneMatrix=L,L=o.create(),o.scale(L,L,[1,-1,1]),o.translate(L,L,[-1,-1,0]),o.scale(L,L,[2/this.width,2/this.height,1]),this.glCoordMatrix=L,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},L=o.invert(new Float64Array(16),this.pixelMatrix),!L)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=L,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.calculateGlobeMatrix(this);const He=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.transformMat4(He,He,A),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=L;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const l=this.cameraWorldSizeForFog,p=this.cameraPixelsPerMeter,x=this._camera.position,E=1/this.height/this._pixelsPerMercatorPixel,A=[l,l,p];o.scale$2(A,A,E),o.scale$2(x,x,-1),o.multiply$2(x,x,A);const D=o.create();o.translate(D,D,x),o.scale(D,D,A),this.mercatorFogMatrix=D,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(l,p,E)}_computeCameraPosition(l){const p=(l=l||this.pixelsPerMeter)/this.pixelsPerMeter,x=this._camera.forward(),E=this.point,A=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*p-l/this.worldSize*this._centerAltitude;return[E.x/this.worldSize-x[0]*A,E.y/this.worldSize-x[1]*A,l/this.worldSize*this._centerAltitude-x[2]*A]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(l){const p=this._maxCameraBoundsDistance()*Math.cos(this._pitch),x=this._camera.position[2],E=l[2];let A=1;this.projection.wrap&&(this.center=this.center.wrap()),E>0&&(A=Math.min((p-x)/E,1)),this._camera.position=o.scaleAndAdd([],this._camera.position,l,A),this._updateStateFromCamera()}_updateStateFromCamera(){const l=this._camera.position,p=this._camera.forward(),{pitch:x,bearing:E}=this._camera.getPitchBearing(),A=o.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,D=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.degToRad(this._maxPitch)),L=Math.max((l[2]-A)/Math.cos(x),D),V=this._zoomFromMercatorZ(L);o.scaleAndAdd(l,l,p,L),this._pitch=o.clamp(x,o.degToRad(this.minPitch),o.degToRad(this.maxPitch)),this.angle=o.wrap(E,-Math.PI,Math.PI),this._setZoom(o.clamp(V,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.MercatorCoordinate(l[0],l[1],l[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(l){return Math.pow(2,l)*this.tileSize}_mercatorZfromZoom(l){return this.cameraToCenterDistance/this._worldSizeFromZoom(l)}_minimumHeightOverTerrain(){const l=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(l)}_zoomFromMercatorZ(l){return this.scaleZoom(this.cameraToCenterDistance/(l*this.tileSize))}zoomFromMercatorZAdjusted(l){let p=0,x=o.GLOBE_ZOOM_THRESHOLD_MAX,E=0,A=1/0;for(;x-p>1e-6&&x>p;){const D=p+.5*(x-p),L=this.tileSize*Math.pow(2,D),V=this.getCameraToCenterDistance(this.projection,D,L),G=this.scaleZoom(V/(l*this.tileSize)),q=Math.abs(D-G);q<A&&(A=q,E=D),D<G?p=D:x=D}return E}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(l,p){const x=Math.min(l.x,p.x),E=Math.max(l.x,p.x),A=Math.min(l.y,p.y),D=Math.max(l.y,p.y);if(A<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const L=[new o.Point(x,A),new o.Point(E,D),new o.Point(x,D),new o.Point(E,A)],V=this.renderWorldCopies?-3:0,G=this.renderWorldCopies?4:1;for(const q of L){const te=this.pointRayIntersection(q);if(te.t<0)return!0;const ye=this.rayIntersectionCoordinate(te);if(ye.x<V||ye.y<0||ye.x>G||ye.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.Point(0,0),new o.Point(this.width,this.height))}zoomDeltaToMovement(l,p){const x=o.length(o.sub([],this._camera.position,l)),E=this._zoomFromMercatorZ(x)+p;return x-this._mercatorZfromZoom(E)}getCameraPoint(){if(this.projection.name==="globe"){const l=(function([p,x,E],A){const D=[p,x,E,1];o.transformMat4$1(D,D,A);const L=D[3]=Math.max(D[3],1e-6);return D[0]/=L,D[1]/=L,D[2]/=L,D})([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.Point(l[0],l[1])}{const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.Point(0,l))}}getCameraToCenterDistance(l,p=this.zoom,x=this.worldSize){const E=np(l,p,this.width,this.height,1024),A=l.pixelSpaceConversion(this.center.lat,x,E);return .5/Math.tan(.5*this._fov)*this.height*A}getWorldToCameraMatrix(){const l=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&o.multiply(l,l,this.globeMatrix),l}}function tc(_,l){let p=!1,x=null;const E=()=>{x=null,p&&(_(),x=setTimeout(E,l),p=!1)};return()=>(p=!0,x||E(),x)}class nc{constructor(l){this._hashName=l&&encodeURIComponent(l),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=tc(this._updateHashUnthrottled.bind(this),300)}addTo(l){return this._map=l,o.window.addEventListener("hashchange",this._onHashChange,!1),l.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),o.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const l=this._map;if(!l)return"";const p=zu(l);if(this._hashName){const x=this._hashName;let E=!1;const A=o.window.location.hash.slice(1).split("&").map((D=>{const L=D.split("=")[0];return L===x?(E=!0,`${L}=${p}`):D})).filter((D=>D));return E||A.push(`${x}=${p}`),`#${A.join("&")}`}return`#${p}`}_getCurrentHash(){const l=o.window.location.hash.replace("#","");if(this._hashName){let p;return l.split("&").map((x=>x.split("="))).forEach((x=>{x[0]===this._hashName&&(p=x)})),(p&&p[1]||"").split("/")}return l.split("/")}_onHashChange(){const l=this._map;if(!l)return!1;const p=this._getCurrentHash();if(p.length>=3&&!p.some((x=>isNaN(x)))){const x=l.dragRotate.isEnabled()&&l.touchZoomRotate.isEnabled()?+(p[3]||0):l.getBearing();return l.jumpTo({center:[+p[2],+p[1]],zoom:+p[0],bearing:x,pitch:+(p[4]||0)}),!0}return!1}_updateHashUnthrottled(){const l=o.window.location.href.replace(/(#.+)?$/,this.getHashString());o.window.history.replaceState(o.window.history.state,null,l)}}function zu(_,l){const p=_.getCenter(),x=Math.round(100*_.getZoom())/100,E=Math.ceil((x*Math.LN2+Math.log(512/360/.5))/Math.LN10),A=Math.pow(10,E),D=Math.round(p.lng*A)/A,L=Math.round(p.lat*A)/A,V=_.getBearing(),G=_.getPitch();let q=l?`/${D}/${L}/${x}`:`${x}/${L}/${D}`;return(V||G)&&(q+="/"+Math.round(10*V)/10),G&&(q+=`/${Math.round(G)}`),q}const kh={linearity:.3,easing:o.bezier(0,0,.3,1)},Dh=o.extend({deceleration:2500,maxSpeed:1400},kh),Xd=o.extend({deceleration:20,maxSpeed:1400},kh),rn=o.extend({deceleration:1e3,maxSpeed:360},kh),ro=o.extend({deceleration:1e3,maxSpeed:90},kh);class Bu{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,p=o.exported.now();for(;l.length>0&&p-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const p={zoom:0,bearing:0,pitch:0,pan:new o.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:A}of this._inertiaBuffer)p.zoom+=A.zoomDelta||0,p.bearing+=A.bearingDelta||0,p.pitch+=A.pitchDelta||0,A.panDelta&&p.pan._add(A.panDelta),A.around&&(p.around=A.around),A.pinchAround&&(p.pinchAround=A.pinchAround);const x=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,E={};if(p.pan.mag()){const A=rc(p.pan.mag(),x,o.extend({},Dh,l||{}));E.offset=p.pan.mult(A.amount/p.pan.mag()),E.center=this._map.transform.center,Bc(E,A)}if(p.zoom){const A=rc(p.zoom,x,Xd);E.zoom=this._map.transform.zoom+A.amount,Bc(E,A)}if(p.bearing){const A=rc(p.bearing,x,rn);E.bearing=this._map.transform.bearing+o.clamp(A.amount,-179,179),Bc(E,A)}if(p.pitch){const A=rc(p.pitch,x,ro);E.pitch=this._map.transform.pitch+A.amount,Bc(E,A)}if(E.zoom||E.bearing){const A=p.pinchAround===void 0?p.around:p.pinchAround;E.around=A?this._map.unproject(A):this._map.getCenter()}return this.clear(),E.noMoveStart=!0,E}}function Bc(_,l){(!_.duration||_.duration<l.duration)&&(_.duration=l.duration,_.easing=l.easing)}function rc(_,l,p){const{maxSpeed:x,linearity:E,deceleration:A}=p,D=o.clamp(_*E/(l/1e3),-x,x),L=Math.abs(D)/(A*E);return{easing:p.easing,duration:1e3*L,amount:D*(L/2)}}class yi extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,p,x,E={}){const A=Te(p.getCanvasContainer(),x),D=p.unproject(A);super(l,o.extend({point:A,lngLat:D,originalEvent:x},E)),this._defaultPrevented=!1,this.target=p}}class io extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,p,x){const E=l==="touchend"?x.changedTouches:x.touches,A=ae(p.getCanvasContainer(),E),D=A.map((V=>p.unproject(V))),L=A.reduce(((V,G,q,te)=>V.add(G.div(te.length))),new o.Point(0,0));super(l,{points:A,point:L,lngLats:D,lngLat:p.unproject(L),originalEvent:x}),this._defaultPrevented=!1}}class al extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,p,x){super(l,{originalEvent:x}),this._defaultPrevented=!1}}class Oa{constructor(l,p){this._map=l,this._clickTolerance=p.clickTolerance}reset(){this._mousedownPos=void 0}wheel(l){return this._firePreventable(new al(l.type,this._map,l))}mousedown(l,p){return this._mousedownPos=p,this._firePreventable(new yi(l.type,this._map,l))}mouseup(l){this._map.fire(new yi(l.type,this._map,l))}preclick(l){const p=o.extend({},l);p.type="preclick",this._map.fire(new yi(p.type,this._map,p))}click(l,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||(this.preclick(l),this._map.fire(new yi(l.type,this._map,l)))}dblclick(l){return this._firePreventable(new yi(l.type,this._map,l))}mouseover(l){this._map.fire(new yi(l.type,this._map,l))}mouseout(l){this._map.fire(new yi(l.type,this._map,l))}touchstart(l){return this._firePreventable(new io(l.type,this._map,l))}touchmove(l){this._map.fire(new io(l.type,this._map,l))}touchend(l){this._map.fire(new io(l.type,this._map,l))}touchcancel(l){this._map.fire(new io(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ua{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(l){this._map.fire(new yi(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new yi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._map.fire(new yi(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Il{constructor(l,p){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=p.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,p){this.isEnabled()&&l.shiftKey&&l.button===0&&(ge(),this._startPos=this._lastPos=p,this._active=!0)}mousemoveWindow(l,p){if(!this._active)return;const x=p,E=this._startPos,A=this._lastPos;if(!E||!A||A.equals(x)||!this._box&&x.dist(E)<this._clickTolerance)return;this._lastPos=x,this._box||(this._box=j("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));const D=Math.min(E.x,x.x),L=Math.max(E.x,x.x),V=Math.min(E.y,x.y),G=Math.max(E.y,x.y);this._map._requestDomTask((()=>{this._box&&(this._box.style.transform=`translate(${D}px,${V}px)`,this._box.style.width=L-D+"px",this._box.style.height=G-V+"px")}))}mouseupWindow(l,p){if(!this._active)return;const x=this._startPos,E=p;if(x&&l.button===0){if(this.reset(),me(),x.x!==E.x||x.y!==E.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:l})),{cameraAnimation:A=>A.fitScreenCoordinates(x,E,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",l)}}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ue(),delete this._startPos,delete this._lastPos}_fireEvent(l,p){return this._map.fire(new o.Event(l,{originalEvent:p}))}}function Zd(_,l){const p={};for(let x=0;x<_.length;x++)p[_[x].identifier]=l[x];return p}class Nc{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(l,p,x){(this.centroid||x.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=l.timeStamp),x.length===this.numTouches&&(this.centroid=(function(E){const A=new o.Point(0,0);for(const D of E)A._add(D);return A.div(E.length)})(p),this.touches=Zd(x,p)))}touchmove(l,p,x){if(this.aborted||!this.centroid)return;const E=Zd(x,p);for(const A in this.touches){const D=E[A];(!D||D.dist(this.touches[A])>30)&&(this.aborted=!0)}}touchend(l,p,x){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),x.length===0){const E=!this.aborted&&this.centroid;if(this.reset(),E)return E}}}class Kd{constructor(l){this.singleTap=new Nc(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(l,p,x){this.singleTap.touchstart(l,p,x)}touchmove(l,p,x){this.singleTap.touchmove(l,p,x)}touchend(l,p,x){const E=this.singleTap.touchend(l,p,x);if(E){const A=l.timeStamp-this.lastTime<500,D=!this.lastTap||this.lastTap.dist(E)<30;if(A&&D||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=E,this.count===this.numTaps)return this.reset(),E}}}class ry{constructor(){this._zoomIn=new Kd({numTouches:1,numTaps:2}),this._zoomOut=new Kd({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,p,x){this._zoomIn.touchstart(l,p,x),this._zoomOut.touchstart(l,p,x)}touchmove(l,p,x){this._zoomIn.touchmove(l,p,x),this._zoomOut.touchmove(l,p,x)}touchend(l,p,x){const E=this._zoomIn.touchend(l,p,x),A=this._zoomOut.touchend(l,p,x);return E?(this._active=!0,l.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:D.getZoom()+1,around:D.unproject(E)},{originalEvent:l})}):A?(this._active=!0,l.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:D.getZoom()-1,around:D.unproject(A)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Os={0:1,2:2};class hi{constructor(l){this.reset(),this._clickTolerance=l.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(l,p){return!1}_move(l,p){return{}}mousedown(l,p){if(this._lastPoint)return;const x=re(l);this._correctButton(l,x)&&(this._lastPoint=p,this._eventButton=x)}mousemoveWindow(l,p){const x=this._lastPoint;if(x){if(l.preventDefault(),this._eventButton!=null&&(function(E,A){const D=Os[A];return E.buttons===void 0||(E.buttons&D)!==D})(l,this._eventButton))this.reset();else if(this._moved||!(p.dist(x)<this._clickTolerance))return this._moved=!0,this._lastPoint=p,this._move(x,p)}}mouseupWindow(l){this._lastPoint&&re(l)===this._eventButton&&(this._moved&&me(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Or extends hi{mousedown(l,p){super.mousedown(l,p),this._lastPoint&&(this._active=!0)}_correctButton(l,p){return p===0&&!l.ctrlKey}_move(l,p){return{around:p,panDelta:p.sub(l)}}}class Rl extends hi{_correctButton(l,p){return p===0&&l.ctrlKey||p===2}_move(l,p){const x=.8*(p.x-l.x);if(x)return this._active=!0,{bearingDelta:x}}contextmenu(l){l.preventDefault()}}class Xo extends hi{_correctButton(l,p){return p===0&&l.ctrlKey||p===2}_move(l,p){const x=-.5*(p.y-l.y);if(x)return this._active=!0,{pitchDelta:x}}contextmenu(l){l.preventDefault()}}class Lh{constructor(l,p){this._map=l,this._el=l.getCanvasContainer(),this._minTouches=1,this._clickTolerance=p.clickTolerance||1,this.reset(),o.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.Point(0,0)}touchstart(l,p,x){return this._calculateTransform(l,p,x)}touchmove(l,p,x){if(this._active&&!(x.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(x.length===1&&!o.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return l.cancelable&&l.preventDefault(),this._calculateTransform(l,p,x)}}touchend(l,p,x){this._calculateTransform(l,p,x),this._active&&x.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,p,x){x.length>0&&(this._active=!0);const E=Zd(x,p),A=new o.Point(0,0),D=new o.Point(0,0);let L=0;for(const G in E){const q=E[G],te=this._touches[G];te&&(A._add(q),D._add(q.sub(te)),L++,E[G]=q)}if(this._touches=E,L<this._minTouches||!D.mag())return;const V=D.div(L);return this._sum._add(V),this._sum.mag()<this._clickTolerance?void 0:{around:A.div(L),panDelta:V}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=j("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")}),500)}}class za{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(l){}_move(l,p,x){return{}}touchstart(l,p,x){this._firstTwoTouches||x.length<2||(this._firstTwoTouches=[x[0].identifier,x[1].identifier],this._start([p[0],p[1]]))}touchmove(l,p,x){const E=this._firstTwoTouches;if(!E)return;l.preventDefault();const[A,D]=E,L=Oh(x,p,A),V=Oh(x,p,D);if(!L||!V)return;const G=this._aroundCenter?null:L.add(V).div(2);return this._move([L,V],G,l)}touchend(l,p,x){if(!this._firstTwoTouches)return;const[E,A]=this._firstTwoTouches,D=Oh(x,p,E),L=Oh(x,p,A);D&&L||(this._active&&me(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Oh(_,l,p){for(let x=0;x<_.length;x++)if(_[x].identifier===p)return l[x]}function ip(_,l){return Math.log(_/l)/Math.LN2}class Nu extends za{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,p){const x=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(ip(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ip(this._distance,x),pinchAround:p}}}function ic(_,l){return 180*_.angleWith(l)/Math.PI}class sp extends za{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,p){const x=this._vector;if(this._vector=l[0].sub(l[1]),x&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:ic(this._vector,x),pinchAround:p}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const p=25/(Math.PI*this._minDiameter)*360,x=this._startVector;if(!x)return!1;const E=ic(l,x);return Math.abs(E)<p}}function Ba(_){return Math.abs(_.y)>Math.abs(_.x)}class op extends za{constructor(l){super(),this._map=l}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(l){this._lastPoints=l,Ba(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,p,x){const E=this._lastPoints;if(!E)return;const A=l[0].sub(E[0]),D=l[1].sub(E[1]);return this._map._cooperativeGestures&&!o.isFullscreen()&&x.touches.length<3||(this._valid=this.gestureBeginsVertically(A,D,x.timeStamp),!this._valid)?void 0:(this._lastPoints=l,this._active=!0,{pitchDelta:(A.y+D.y)/2*-.5})}gestureBeginsVertically(l,p,x){if(this._valid!==void 0)return this._valid;const E=l.mag()>=2,A=p.mag()>=2;if(!E&&!A)return;if(!E||!A)return this._firstMove==null&&(this._firstMove=x),x-this._firstMove<100&&void 0;const D=l.y>0==p.y>0;return Ba(l)&&Ba(p)&&D}}const Vc={panStep:100,bearingStep:15,pitchStep:10};class sc{constructor(){const l=Vc;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let p=0,x=0,E=0,A=0,D=0;switch(l.keyCode){case 61:case 107:case 171:case 187:p=1;break;case 189:case 109:case 173:p=-1;break;case 37:l.shiftKey?x=-1:(l.preventDefault(),A=-1);break;case 39:l.shiftKey?x=1:(l.preventDefault(),A=1);break;case 38:l.shiftKey?E=1:(l.preventDefault(),D=-1);break;case 40:l.shiftKey?E=-1:(l.preventDefault(),D=1);break;default:return}return this._rotationDisabled&&(x=0,E=0),{cameraAnimation:L=>{const V=L.getZoom();L.easeTo({duration:300,easeId:"keyboardHandler",easing:oc,zoom:p?Math.round(V)+p*(l.shiftKey?2:1):V,bearing:L.getBearing()+x*this._bearingStep,pitch:L.getPitch()+E*this._pitchStep,offset:[-A*this._panStep,-D*this._panStep],center:L.getCenter()},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function oc(_){return _*(2-_)}const ll=4.000244140625;class ap{constructor(l,p){this._map=l,this._el=l.getCanvasContainer(),this._handler=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(l){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(l.ctrlKey||l.metaKey||this.isZooming()||o.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let p=l.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const x=o.exported.now(),E=x-(this._lastWheelEventTime||0);this._lastWheelEventTime=x,p!==0&&p%ll==0?this._type="wheel":p!==0&&Math.abs(p)<4?this._type="trackpad":E>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(E*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),l.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=l,this._delta-=p,this._active||this._start(l)),l.preventDefault()}_onTimeout(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const p=Te(this._el,l);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:p,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._map.transform;this._type==="wheel"&&l.projection.wrap&&(l._center.lng>=180||l._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const p=()=>l._terrainEnabled()&&this._aroundCoord?l.computeZoomRelativeTo(this._aroundCoord):l.zoom;if(this._delta!==0){const V=this._type==="wheel"&&Math.abs(this._delta)>ll?this._wheelZoomRate:this._defaultZoomRate;let G=2/(1+Math.exp(-Math.abs(this._delta*V)));this._delta<0&&G!==0&&(G=1/G);const q=p(),te=Math.pow(2,q),ye=typeof this._targetZoom=="number"?l.zoomScale(this._targetZoom):te;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(ye*G))),this._type==="wheel"&&(this._startZoom=q,this._easing=this._smoothOutEasing(200)),this._delta=0}const x=typeof this._targetZoom=="number"?this._targetZoom:p(),E=this._startZoom,A=this._easing;let D,L=!1;if(this._type==="wheel"&&E&&A){const V=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),G=A(V);D=o.number(E,x,G),V<1?this._frameId||(this._frameId=!0):L=!0}else D=x,L=!0;return this._active=!0,L&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!L,zoomDelta:D-p(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let p=o.ease;if(this._prevEase){const x=this._prevEase,E=(o.exported.now()-x.start)/x.duration,A=x.easing(E+.01)-x.easing(E),D=.27/Math.sqrt(A*A+1e-4)*.01,L=Math.sqrt(.0729-D*D);p=o.bezier(D,L,.25,1)}return this._prevEase={start:o.exported.now(),duration:l,easing:p},p}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=j("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(o.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")}),200)}}class lp{constructor(l,p){this._clickZoom=l,this._tapZoom=p}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class fs{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(l,p){return l.preventDefault(),{cameraAnimation:x=>{x.easeTo({duration:300,zoom:x.getZoom()+(l.shiftKey?-1:1),around:x.unproject(p)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cp{constructor(){this._tap=new Kd({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(l,p,x){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?x.length>0&&(this._swipePoint=p[0],this._swipeTouch=x[0].identifier):this._tap.touchstart(l,p,x))}touchmove(l,p,x){if(this._tapTime){if(this._swipePoint){if(x[0].identifier!==this._swipeTouch)return;const E=p[0],A=E.y-this._swipePoint.y;return this._swipePoint=E,l.preventDefault(),this._active=!0,{zoomDelta:A/128}}}else this._tap.touchmove(l,p,x)}touchend(l,p,x){this._tapTime?this._swipePoint&&x.length===0&&this.reset():this._tap.touchend(l,p,x)&&(this._tapTime=l.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fc{constructor(l,p,x){this._el=l,this._mousePan=p,this._touchPan=x}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Gs{constructor(l,p,x){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=p,this._mousePitch=x}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class up{constructor(l,p,x,E){this._el=l,this._touchZoom=p,this._touchRotate=x,this._tapDragZoom=E,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ha=_=>_.zoom||_.drag||_.pitch||_.rotate;class iy extends o.Event{}class fv{constructor(){this.constants=[1,1,.01],this.radius=0}setup(l,p){const x=o.sub([],p,l);this.radius=o.length(x[2]<0?o.div([],x,this.constants):[x[0],x[1],0])}projectRay(l){o.div(l,l,this.constants),o.normalize(l,l),o.mul$1(l,l,this.constants);const p=o.scale$2([],l,this.radius);if(p[2]>0){const x=o.scale$2([],[0,0,1],o.dot(p,[0,0,1])),E=o.scale$2([],o.normalize([],[p[0],p[1],0]),this.radius),A=o.add([],p,o.scale$2([],o.sub([],o.add([],E,x),p),2));p[0]=A[0],p[1]=A[1]}return p}}function cl(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class _i{constructor(l,p){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Bu(l),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new fv,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(p),o.bindAll(["handleEvent","handleWindowEvent"],this);const x=this._el;this._listeners=[[x,"touchstart",{passive:!0}],[x,"touchmove",{passive:!1}],[x,"touchend",void 0],[x,"touchcancel",void 0],[x,"mousedown",void 0],[x,"mousemove",void 0],[x,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[x,"mouseover",void 0],[x,"mouseout",void 0],[x,"dblclick",void 0],[x,"click",void 0],[x,"keydown",{capture:!1}],[x,"keyup",void 0],[x,"wheel",{passive:!1}],[x,"contextmenu",void 0],[o.window,"blur",void 0]];for(const[E,A,D]of this._listeners)E.addEventListener(A,E===o.window.document?this.handleWindowEvent:this.handleEvent,D)}destroy(){for(const[l,p,x]of this._listeners)l.removeEventListener(p,l===o.window.document?this.handleWindowEvent:this.handleEvent,x)}_addDefaultHandlers(l){const p=this._map,x=p.getCanvasContainer();this._add("mapEvent",new Oa(p,l));const E=p.boxZoom=new Il(p,l);this._add("boxZoom",E);const A=new ry,D=new fs;p.doubleClickZoom=new lp(D,A),this._add("tapZoom",A),this._add("clickZoom",D);const L=new cp;this._add("tapDragZoom",L);const V=p.touchPitch=new op(p);this._add("touchPitch",V);const G=new Rl(l),q=new Xo(l);p.dragRotate=new Gs(l,G,q),this._add("mouseRotate",G,["mousePitch"]),this._add("mousePitch",q,["mouseRotate"]);const te=new Or(l),ye=new Lh(p,l);p.dragPan=new Fc(x,te,ye),this._add("mousePan",te),this._add("touchPan",ye,["touchZoom","touchRotate"]);const we=new sp,Se=new Nu;p.touchZoomRotate=new up(x,Se,we,L),this._add("touchRotate",we,["touchPan","touchZoom"]),this._add("touchZoom",Se,["touchPan","touchRotate"]),this._add("blockableMapEvent",new ua(p));const Ee=p.scrollZoom=new ap(p,this);this._add("scrollZoom",Ee,["mousePan"]);const Ce=p.keyboard=new sc;this._add("keyboard",Ce);for(const ne of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])l.interactive&&l[ne]&&p[ne].enable(l[ne])}_add(l,p,x){this._handlers.push({handlerName:l,handler:p,allowed:x}),this._handlersById[l]=p}stop(l){if(!this._updatingCamera){for(const{handler:p}of this._handlers)p.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ha(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(l,p,x){for(const E in l)if(E!==x&&(!p||p.indexOf(E)<0))return!0;return!1}handleWindowEvent(l){this.handleEvent(l,`${l.type}Window`)}_getMapTouches(l){const p=[];for(const x of l)this._el.contains(x.target)&&p.push(x);return p}handleEvent(l,p){this._updatingCamera=!0;const x=l.type==="renderFrame",E=x?void 0:l,A={needsRenderFrame:!1},D={},L={},V=l.touches?this._getMapTouches(l.touches):void 0,G=V?ae(this._el,V):x?void 0:Te(this._el,l);for(const{handlerName:ye,handler:we,allowed:Se}of this._handlers){if(!we.isEnabled())continue;let Ee;this._blockedByActive(L,Se,ye)?we.reset():we[p||l.type]&&(Ee=we[p||l.type](l,G,V),this.mergeHandlerResult(A,D,Ee,ye,E),Ee&&Ee.needsRenderFrame&&this._triggerRenderFrame()),(Ee||we.isActive())&&(L[ye]=we)}const q={};for(const ye in this._previousActiveHandlers)L[ye]||(q[ye]=E);this._previousActiveHandlers=L,(Object.keys(q).length||cl(A))&&(this._changes.push([A,D,q]),this._triggerRenderFrame()),(Object.keys(L).length||cl(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:te}=A;te&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],te(this._map))}mergeHandlerResult(l,p,x,E,A){if(!x)return;o.extend(l,x);const D={handlerName:E,originalEvent:x.originalEvent||A};x.zoomDelta!==void 0&&(p.zoom=D),x.panDelta!==void 0&&(p.drag=D),x.pitchDelta!==void 0&&(p.pitch=D),x.bearingDelta!==void 0&&(p.rotate=D)}_applyChanges(){const l={},p={},x={};for(const[E,A,D]of this._changes)E.panDelta&&(l.panDelta=(l.panDelta||new o.Point(0,0))._add(E.panDelta)),E.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+E.zoomDelta),E.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+E.bearingDelta),E.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+E.pitchDelta),E.around!==void 0&&(l.around=E.around),E.aroundCoord!==void 0&&(l.aroundCoord=E.aroundCoord),E.pinchAround!==void 0&&(l.pinchAround=E.pinchAround),E.noInertia&&(l.noInertia=E.noInertia),o.extend(p,A),o.extend(x,D);this._updateMapTransform(l,p,x),this._changes=[]}_updateMapTransform(l,p,x){const E=this._map,A=E.transform,D=be=>[be.x,be.y,be.z];if((be=>{const ke=this._eventsInProgress.drag;return ke&&!this._handlersById[ke.handlerName].isActive()})()&&!cl(l)){const be=A.zoom;A.cameraElevationReference="sea",A.recenterOnTerrain(),A.cameraElevationReference="ground",be!==A.zoom&&this._map._update(!0)}if(A._isCameraConstrained&&E._stop(!0),!cl(l))return void this._fireEvents(p,x,!0);let{panDelta:L,zoomDelta:V,bearingDelta:G,pitchDelta:q,around:te,aroundCoord:ye,pinchAround:we}=l;A._isCameraConstrained&&(V>0&&(V=0),A._isCameraConstrained=!1),we!==void 0&&(te=we),(V||(be=>p[be]&&!this._eventsInProgress[be])("drag"))&&te&&(this._dragOrigin=D(A.pointCoordinate3D(te)),this._trackingEllipsoid.setup(A._camera.position,this._dragOrigin)),A.cameraElevationReference="sea",E._stop(!0),te=te||E.transform.centerPoint,G&&(A.bearing+=G),q&&(A.pitch+=q),A._updateCameraState();const Se=[0,0,0];if(L)if(A.projection.name==="mercator"){const be=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(te).dir),ke=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(te.sub(L)).dir);Se[0]=ke[0]-be[0],Se[1]=ke[1]-be[1]}else{const be=A.pointCoordinate(te);if(A.projection.name==="globe"){L=L.rotate(-A.angle);const ke=A._pixelsPerMercatorPixel/A.worldSize;Se[0]=-L.x*o.mercatorScale(o.latFromMercatorY(be.y))*ke,Se[1]=-L.y*o.mercatorScale(A.center.lat)*ke}else{const ke=A.pointCoordinate(te.sub(L));be&&ke&&(Se[0]=ke.x-be.x,Se[1]=ke.y-be.y)}}const Ee=A.zoom,Ce=[0,0,0];if(V){const be=D(ye||A.pointCoordinate3D(te)),ke={dir:o.normalize([],o.sub([],be,A._camera.position))};if(ke.dir[2]<0){const Le=A.zoomDeltaToMovement(be,V);o.scale$2(Ce,ke.dir,Le)}}const ne=o.add(Se,Se,Ce);A._translateCameraConstrained(ne),V&&Math.abs(A.zoom-Ee)>1e-4&&A.recenterOnTerrain(),A.cameraElevationReference="ground",this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(p,x,!0)}_fireEvents(l,p,x){const E=ha(this._eventsInProgress),A=ha(l),D={};for(const q in l){const{originalEvent:te}=l[q];this._eventsInProgress[q]||(D[`${q}start`]=te),this._eventsInProgress[q]=l[q]}!E&&A&&this._fireEvent("movestart",A.originalEvent);for(const q in D)this._fireEvent(q,D[q]);A&&this._fireEvent("move",A.originalEvent);for(const q in l){const{originalEvent:te}=l[q];this._fireEvent(q,te)}const L={};let V;for(const q in this._eventsInProgress){const{handlerName:te,originalEvent:ye}=this._eventsInProgress[q];this._handlersById[te].isActive()||(delete this._eventsInProgress[q],V=p[te]||ye,L[`${q}end`]=V)}for(const q in L)this._fireEvent(q,L[q]);const G=ha(this._eventsInProgress);if(x&&(E||A)&&!G){this._updatingCamera=!0;const q=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),te=ye=>ye!==0&&-this._bearingSnap<ye&&ye<this._bearingSnap;q?(te(q.bearing||this._map.getBearing())&&(q.bearing=0),this._map.easeTo(q,{originalEvent:V})):(this._map.fire(new o.Event("moveend",{originalEvent:V})),te(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(l,p){this._map.fire(new o.Event(l,p?{originalEvent:p}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((l=>{this._frameId=void 0,this.handleEvent(new iy("renderFrame",{timeStamp:l})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const ac="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Uc extends o.Evented{constructor(l,p){super(),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=p.bearingSnap,this._respectPrefersReducedMotion=p.respectPrefersReducedMotion!==!1,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(l,p){return this.jumpTo({center:l},p)}panBy(l,p,x){return l=o.Point.convert(l).mult(-1),this.panTo(this.transform.center,o.extend({offset:l},p),x)}panTo(l,p,x){return this.easeTo(o.extend({center:l},p),x)}getZoom(){return this.transform.zoom}setZoom(l,p){return this.jumpTo({zoom:l},p),this}zoomTo(l,p,x){return this.easeTo(o.extend({zoom:l},p),x)}zoomIn(l,p){return this.zoomTo(this.getZoom()+1,l,p),this}zoomOut(l,p){return this.zoomTo(this.getZoom()-1,l,p),this}getBearing(){return this.transform.bearing}setBearing(l,p){return this.jumpTo({bearing:l},p),this}getPadding(){return this.transform.padding}setPadding(l,p){return this.jumpTo({padding:l},p),this}rotateTo(l,p,x){return this.easeTo(o.extend({bearing:l},p),x)}resetNorth(l,p){return this.rotateTo(0,o.extend({duration:1e3},l),p),this}resetNorthPitch(l,p){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},l),p),this}snapToNorth(l,p){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,p):this}getPitch(){return this.transform.pitch}setPitch(l,p){return this.jumpTo({pitch:l},p),this}cameraForBounds(l,p){l=o.LngLatBounds.convert(l);const x=p&&p.bearing||0,E=p&&p.pitch||0,A=l.getNorthWest(),D=l.getSouthEast();return this._cameraForBounds(this.transform,A,D,x,E,p)}_extendCameraOptions(l){const p={top:0,bottom:0,right:0,left:0};if(typeof(l=o.extend({padding:p,offset:[0,0],maxZoom:this.transform.maxZoom},l)).padding=="number"){const x=l.padding;l.padding={top:x,bottom:x,right:x,left:x}}return l.padding=o.extend(p,l.padding),l}_minimumAABBFrustumDistance(l,p){const x=p.max[0]-p.min[0],E=p.max[1]-p.min[1];return x/E>l.aspect?x/(2*Math.tan(.5*l.fovX)*l.aspect):E/(2*Math.tan(.5*l.fovY)*l.aspect)}_cameraForBoundsOnGlobe(l,p,x,E,A,D){const L=l.clone(),V=this._extendCameraOptions(D);L.bearing=E,L.pitch=A;const G=o.LngLat.convert(p),q=o.LngLat.convert(x),te=.5*(G.lat+q.lat),ye=.5*(G.lng+q.lng),we=o.latLngToECEF(te,ye),Se=o.normalize([],we),Ee=o.normalize([],o.cross([],Se,[0,1,0])),Ce=o.cross([],Ee,Se),ne=[Ee[0],Ee[1],Ee[2],0,Ce[0],Ce[1],Ce[2],0,Se[0],Se[1],Se[2],0,0,0,0,1],be=[we,o.latLngToECEF(G.lat,G.lng),o.latLngToECEF(q.lat,G.lng),o.latLngToECEF(q.lat,q.lng),o.latLngToECEF(G.lat,q.lng),o.latLngToECEF(te,G.lng),o.latLngToECEF(te,q.lng),o.latLngToECEF(G.lat,ye),o.latLngToECEF(q.lat,ye)];let ke=o.Aabb.fromPoints(be.map((Ct=>[o.dot(Ee,Ct),o.dot(Ce,Ct),o.dot(Se,Ct)])));const Le=o.transformMat4([],ke.center,ne);o.squaredLength(Le)===0&&o.set(Le,0,0,1),o.normalize(Le,Le),o.scale$2(Le,Le,o.GLOBE_RADIUS),L.center=o.ecefToLatLng(Le);const je=L.getWorldToCameraMatrix(),He=o.invert(new Float64Array(16),je);ke=o.Aabb.applyTransform(ke,o.multiply([],je,ne)),o.transformMat4(Le,Le,je);const qe=.5*(ke.max[2]-ke.min[2]),Qe=this._minimumAABBFrustumDistance(L,ke),Ye=o.scale$2([],[0,0,1],qe),lt=o.add(Ye,Le,Ye),Vt=Qe+(L.pitch===0?0:o.distance(Le,lt)),rt=L.globeCenterInViewSpace,_t=o.sub([],Le,[rt[0],rt[1],rt[2]]);o.normalize(_t,_t),o.scale$2(_t,_t,Vt);const at=o.add([],Le,_t);o.transformMat4(at,at,He);const Ot=o.earthRadius/o.GLOBE_RADIUS,st=o.length(at),St=o.mercatorZfromAltitude(Math.max(st*Ot-o.earthRadius,Number.EPSILON),0),zt=Math.min(L.zoomFromMercatorZAdjusted(St),V.maxZoom);return zt>.5*(o.GLOBE_ZOOM_THRESHOLD_MIN+o.GLOBE_ZOOM_THRESHOLD_MAX)?(L.setProjection({name:"mercator"}),L.zoom=zt,this._cameraForBounds(L,p,x,E,A,D)):{center:L.center,zoom:zt,bearing:E,pitch:A}}queryTerrainElevation(l,p){const x=this.transform.elevation;return x?(p=o.extend({},{exaggerated:!0},p),x.getAtPoint(o.MercatorCoordinate.fromLngLat(l),null,p.exaggerated)):null}_cameraForBounds(l,p,x,E,A,D){if(l.projection.name==="globe")return this._cameraForBoundsOnGlobe(l,p,x,E,A,D);const L=l.clone(),V=this._extendCameraOptions(D),G=L.padding;L.bearing=E,L.pitch=A;const q=o.LngLat.convert(p),te=o.LngLat.convert(x),ye=new o.LngLat(q.lng,te.lat),we=new o.LngLat(te.lng,q.lat),Se=L.project(q),Ee=L.project(te),Ce=this.queryTerrainElevation(q),ne=this.queryTerrainElevation(te),be=this.queryTerrainElevation(ye),ke=this.queryTerrainElevation(we),Le=[[Se.x,Se.y,Math.min(Ce||0,ne||0,be||0,ke||0)],[Ee.x,Ee.y,Math.max(Ce||0,ne||0,be||0,ke||0)]];let je=o.Aabb.fromPoints(Le);const He=L.getWorldToCameraMatrix(),qe=o.invert(new Float64Array(16),He);je=o.Aabb.applyTransform(je,He);const Qe=o.sub([],je.max,je.min),Ye=G.left||0,lt=G.right||0,Vt=G.bottom||0,rt=G.top||0,{left:_t,right:at,top:Ot,bottom:st}=V.padding,St=.5*(Ye+lt),zt=.5*(rt+Vt),Ct=Math.min(L.scaleZoom(L.scale*Math.min((L.width-(Ye+lt+_t+at))/Qe[0],(L.height-(Vt+rt+st+Ot))/Qe[1])),V.maxZoom),It=L.scale/L.zoomScale(Ct);je=new o.Aabb([je.min[0]-(_t+St)*It,je.min[1]-(st+zt)*It,je.min[2]],[je.max[0]+(at+St)*It,je.max[1]+(Ot+zt)*It,je.max[2]]);const Sn=.5*Qe[2],Un=this._minimumAABBFrustumDistance(L,je),Bt=[0,0,1,0];o.transformMat4$1(Bt,Bt,He),o.normalize$2(Bt,Bt);const hn=o.scale$2([],Bt,Un+Sn),Fn=o.add([],je.center,hn),ar=(typeof V.offset.x=="number"&&typeof V.offset.y=="number"?new o.Point(V.offset.x,V.offset.y):o.Point.convert(V.offset)).rotate(-o.degToRad(E));je.center[0]-=ar.x*It,je.center[1]+=ar.y*It,o.transformMat4(je.center,je.center,qe),o.transformMat4(Fn,Fn,qe);const Tn=[je.center[0],je.center[1],Fn[2]*L.pixelsPerMeter];o.scale$2(Tn,Tn,1/L.worldSize);const Pr=o.lngFromMercatorX(Tn[0]),Kr=o.latFromMercatorY(Tn[1]),qr=Math.min(L._zoomFromMercatorZ(Tn[2]),V.maxZoom),Vr=new o.LngLat(Pr,Kr);return L.mercatorFromTransition&&qr<.5*(o.GLOBE_ZOOM_THRESHOLD_MIN+o.GLOBE_ZOOM_THRESHOLD_MAX)?(L.setProjection({name:"globe"}),L.zoom=qr,this._cameraForBounds(L,p,x,E,A,D)):{center:Vr,zoom:qr,bearing:E,pitch:A}}fitBounds(l,p,x){const E=this.cameraForBounds(l,p);return this._fitInternal(E,p,x)}fitScreenCoordinates(l,p,x,E,A){const D=o.Point.convert(l),L=o.Point.convert(p),V=new o.Point(Math.min(D.x,L.x),Math.min(D.y,L.y)),G=new o.Point(Math.max(D.x,L.x),Math.max(D.y,L.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(D,L))return this;const q=this.transform.pointLocation3D(V),te=this.transform.pointLocation3D(G),ye=this.transform.pointLocation3D(new o.Point(V.x,G.y)),we=this.transform.pointLocation3D(new o.Point(G.x,V.y)),Se=[Math.min(q.lng,te.lng,ye.lng,we.lng),Math.min(q.lat,te.lat,ye.lat,we.lat)],Ee=[Math.max(q.lng,te.lng,ye.lng,we.lng),Math.max(q.lat,te.lat,ye.lat,we.lat)],Ce=E&&E.pitch?E.pitch:this.getPitch(),ne=this._cameraForBounds(this.transform,Se,Ee,x,Ce,E);return this._fitInternal(ne,E,A)}_fitInternal(l,p,x){return l?(delete(p=o.extend(l,p)).padding,p.linear?this.easeTo(p,x):this.flyTo(p,x)):this}jumpTo(l,p){this.stop();const x=l.preloadOnly?this.transform.clone():this.transform;let E=!1,A=!1,D=!1;return"zoom"in l&&x.zoom!==+l.zoom&&(E=!0,x.zoom=+l.zoom),l.center!==void 0&&(x.center=o.LngLat.convert(l.center)),"bearing"in l&&x.bearing!==+l.bearing&&(A=!0,x.bearing=+l.bearing),"pitch"in l&&x.pitch!==+l.pitch&&(D=!0,x.pitch=+l.pitch),l.padding==null||x.isPaddingEqual(l.padding)||(x.padding=l.padding),l.preloadOnly?(this._preloadTiles(x),this):(this.fire(new o.Event("movestart",p)).fire(new o.Event("move",p)),E&&this.fire(new o.Event("zoomstart",p)).fire(new o.Event("zoom",p)).fire(new o.Event("zoomend",p)),A&&this.fire(new o.Event("rotatestart",p)).fire(new o.Event("rotate",p)).fire(new o.Event("rotateend",p)),D&&this.fire(new o.Event("pitchstart",p)).fire(new o.Event("pitch",p)).fire(new o.Event("pitchend",p)),this.fire(new o.Event("moveend",p)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.warnOnce(ac),this.transform.getFreeCameraOptions()}setFreeCameraOptions(l,p){const x=this.transform;if(!x.projection.supportsFreeCamera)return o.warnOnce(ac),this;this.stop();const E=x.zoom,A=x.pitch,D=x.bearing;x.setFreeCameraOptions(l);const L=E!==x.zoom,V=A!==x.pitch,G=D!==x.bearing;return this.fire(new o.Event("movestart",p)).fire(new o.Event("move",p)),L&&this.fire(new o.Event("zoomstart",p)).fire(new o.Event("zoom",p)).fire(new o.Event("zoomend",p)),G&&this.fire(new o.Event("rotatestart",p)).fire(new o.Event("rotate",p)).fire(new o.Event("rotateend",p)),V&&this.fire(new o.Event("pitchstart",p)).fire(new o.Event("pitch",p)).fire(new o.Event("pitchend",p)),this.fire(new o.Event("moveend",p)),this}easeTo(l,p){this._stop(!1,l.easeId),((l=o.extend({offset:[0,0],duration:500,easing:o.ease},l)).animate===!1||this._prefersReducedMotion(l))&&(l.duration=0);const x=this.transform,E=this.getZoom(),A=this.getBearing(),D=this.getPitch(),L=this.getPadding(),V="zoom"in l?+l.zoom:E,G="bearing"in l?this._normalizeBearing(l.bearing,A):A,q="pitch"in l?+l.pitch:D,te="padding"in l?l.padding:x.padding,ye=o.Point.convert(l.offset);let we,Se,Ee;if(x.projection.name==="globe"){const Ye=o.MercatorCoordinate.fromLngLat(x.center),lt=ye.rotate(-x.angle);Ye.x+=lt.x/x.worldSize,Ye.y+=lt.y/x.worldSize;const Vt=Ye.toLngLat(),rt=o.LngLat.convert(l.center||Vt);this._normalizeCenter(rt),we=x.centerPoint.add(lt),Se=new o.Point(Ye.x,Ye.y).mult(x.worldSize),Ee=new o.Point(o.mercatorXfromLng(rt.lng),o.mercatorYfromLat(rt.lat)).mult(x.worldSize).sub(Se)}else{we=x.centerPoint.add(ye);const Ye=x.pointLocation(we),lt=o.LngLat.convert(l.center||Ye);this._normalizeCenter(lt),Se=x.project(Ye),Ee=x.project(lt).sub(Se)}const Ce=x.zoomScale(V-E);let ne,be;l.around&&(ne=o.LngLat.convert(l.around),be=x.locationPoint(ne));const ke=this._zooming||V!==E,Le=this._rotating||A!==G,je=this._pitching||q!==D,He=!x.isPaddingEqual(te),qe=Ye=>lt=>{if(ke&&(Ye.zoom=o.number(E,V,lt)),Le&&(Ye.bearing=o.number(A,G,lt)),je&&(Ye.pitch=o.number(D,q,lt)),He&&(Ye.interpolatePadding(L,te,lt),we=Ye.centerPoint.add(ye)),ne)Ye.setLocationAtPoint(ne,be);else{const Vt=Ye.zoomScale(Ye.zoom-E),rt=V>E?Math.min(2,Ce):Math.max(.5,Ce),_t=Math.pow(rt,1-lt),at=Ye.unproject(Se.add(Ee.mult(lt*_t)).mult(Vt));Ye.setLocationAtPoint(Ye.renderWorldCopies?at.wrap():at,we)}return l.preloadOnly||this._fireMoveEvents(p),Ye};if(l.preloadOnly){const Ye=this._emulate(qe,l.duration,x);return this._preloadTiles(Ye),this}const Qe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ke,this._rotating=Le,this._pitching=je,this._padding=He,this._easeId=l.easeId,this._prepareEase(p,l.noMoveStart,Qe),this._ease(qe(x),(Ye=>{x.recenterOnTerrain(),this._afterEase(p,Ye)}),l),this}_prepareEase(l,p,x={}){this._moving=!0,this.transform.cameraElevationReference="sea",p||x.moving||this.fire(new o.Event("movestart",l)),this._zooming&&!x.zooming&&this.fire(new o.Event("zoomstart",l)),this._rotating&&!x.rotating&&this.fire(new o.Event("rotatestart",l)),this._pitching&&!x.pitching&&this.fire(new o.Event("pitchstart",l))}_fireMoveEvents(l){this.fire(new o.Event("move",l)),this._zooming&&this.fire(new o.Event("zoom",l)),this._rotating&&this.fire(new o.Event("rotate",l)),this._pitching&&this.fire(new o.Event("pitch",l))}_afterEase(l,p){if(this._easeId&&p&&this._easeId===p)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const x=this._zooming,E=this._rotating,A=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,x&&this.fire(new o.Event("zoomend",l)),E&&this.fire(new o.Event("rotateend",l)),A&&this.fire(new o.Event("pitchend",l)),this.fire(new o.Event("moveend",l))}flyTo(l,p){if(this._prefersReducedMotion(l)){const Ct=o.pick(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ct,p)}this.stop(),l=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},l);const x=this.transform,E=this.getZoom(),A=this.getBearing(),D=this.getPitch(),L=this.getPadding(),V="zoom"in l?o.clamp(+l.zoom,x.minZoom,x.maxZoom):E,G="bearing"in l?this._normalizeBearing(l.bearing,A):A,q="pitch"in l?+l.pitch:D,te="padding"in l?l.padding:x.padding,ye=x.zoomScale(V-E),we=o.Point.convert(l.offset);let Se=x.centerPoint.add(we);const Ee=x.pointLocation(Se),Ce=o.LngLat.convert(l.center||Ee);this._normalizeCenter(Ce);const ne=x.project(Ee),be=x.project(Ce).sub(ne);let ke=l.curve;const Le=Math.max(x.width,x.height),je=Le/ye,He=be.mag();if("minZoom"in l){const Ct=o.clamp(Math.min(l.minZoom,E,V),x.minZoom,x.maxZoom),It=Le/x.zoomScale(Ct-E);ke=Math.sqrt(It/He*2)}const qe=ke*ke;function Qe(Ct){const It=(je*je-Le*Le+(Ct?-1:1)*qe*qe*He*He)/(2*(Ct?je:Le)*qe*He);return Math.log(Math.sqrt(It*It+1)-It)}function Ye(Ct){return(Math.exp(Ct)-Math.exp(-Ct))/2}function lt(Ct){return(Math.exp(Ct)+Math.exp(-Ct))/2}const Vt=Qe(0);let rt=function(Ct){return lt(Vt)/lt(Vt+ke*Ct)},_t=function(Ct){return Le*((lt(Vt)*(Ye(It=Vt+ke*Ct)/lt(It))-Ye(Vt))/qe)/He;var It},at=(Qe(1)-Vt)/ke;if(Math.abs(He)<1e-6||!isFinite(at)){if(Math.abs(Le-je)<1e-6)return this.easeTo(l,p);const Ct=je<Le?-1:1;at=Math.abs(Math.log(je/Le))/ke,_t=function(){return 0},rt=function(It){return Math.exp(Ct*ke*It)}}l.duration="duration"in l?+l.duration:1e3*at/("screenSpeed"in l?+l.screenSpeed/ke:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0);const Ot=A!==G,st=q!==D,St=!x.isPaddingEqual(te),zt=Ct=>It=>{const Sn=It*at,Un=1/rt(Sn);Ct.zoom=It===1?V:E+Ct.scaleZoom(Un),Ot&&(Ct.bearing=o.number(A,G,It)),st&&(Ct.pitch=o.number(D,q,It)),St&&(Ct.interpolatePadding(L,te,It),Se=Ct.centerPoint.add(we));const Bt=It===1?Ce:Ct.unproject(ne.add(be.mult(_t(Sn))).mult(Un));return Ct.setLocationAtPoint(Ct.renderWorldCopies?Bt.wrap():Bt,Se),Ct._updateCameraOnTerrain(),l.preloadOnly||this._fireMoveEvents(p),Ct};if(l.preloadOnly){const Ct=this._emulate(zt,l.duration,x);return this._preloadTiles(Ct),this}return this._zooming=!0,this._rotating=Ot,this._pitching=st,this._padding=St,this._prepareEase(p,!1),this._ease(zt(x),(()=>this._afterEase(p)),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,p){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const x=this._onEaseEnd;this._onEaseEnd=void 0,x.call(this,p)}if(!l){const x=this.handlers;x&&x.stop(!1)}return this}_ease(l,p,x){x.animate===!1||x.duration===0?(l(1),p()):(this._easeStart=o.exported.now(),this._easeOptions=x,this._onEaseFrame=l,this._onEaseEnd=p,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const l=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1),p=this._onEaseFrame;p&&p(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(l,p){l=o.wrap(l,-180,180);const x=Math.abs(l-p);return Math.abs(l-360-p)<x&&(l-=360),Math.abs(l+360-p)<x&&(l+=360),l}_normalizeCenter(l){const p=this.transform;if(!p.renderWorldCopies||p.maxBounds)return;const x=l.lng-p.center.lng;l.lng+=x>180?-360:x<-180?360:0}_prefersReducedMotion(l){return this._respectPrefersReducedMotion&&o.exported.prefersReducedMotion&&!(l&&l.essential)}_emulate(l,p,x){const E=Math.ceil(15*p/1e3),A=[],D=l(x.clone());for(let L=0;L<=E;L++){const V=D(L/E);A.push(V.clone())}return A}}class gn{constructor(l={}){this.options=l,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(l){const p=this.options&&this.options.compact;return this._map=l,this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=j("button","mapboxgl-ctrl-attrib-button",this._container),j("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=j("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),p&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),p===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(l,p){const x=this._map._getUIString(`AttributionControl.${p}`);l.setAttribute("aria-label",x),l.removeAttribute("title"),l.firstElementChild&&l.firstElementChild.setAttribute("title",x)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let l=this._editLink;l||(l=this._editLink=this._container.querySelector(".mapbox-improve-map"));const p=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(l){const x=p.reduce(((E,A,D)=>(A.value&&(E+=`${A.key}=${A.value}${D<p.length-1?"&":""}`),E)),"?");l.href=`${o.config.FEEDBACK_URL}/${x}#${zu(this._map,!0)}`,l.rel="noopener nofollow",this._setElementTitle(l,"MapFeedback")}}_updateData(l){!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let l=[];if(this._map.style.stylesheet){const E=this._map.style.stylesheet;this.styleOwner=E.owner,this.styleId=E.id}const p=this._map.style._sourceCaches;for(const E in p){const A=p[E];if(A.used){const D=A.getSource();D.attribution&&l.indexOf(D.attribution)<0&&l.push(D.attribution)}}l.sort(((E,A)=>E.length-A.length)),l=l.filter(((E,A)=>{for(let D=A+1;D<l.length;D++)if(l[D].indexOf(E)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=[...this.options.customAttribution,...l]:l.unshift(this.options.customAttribution));const x=l.join(" | ");x!==this._attribHTML&&(this._attribHTML=x,l.length?(this._innerContainer.innerHTML=x,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Yd{constructor(){o.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(l){this._map=l,this._container=j("div","mapboxgl-ctrl");const p=j("a","mapboxgl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://www.mapbox.com/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(l){l&&l.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const l=this._map.style._sourceCaches;if(Object.entries(l).length===0)return!0;for(const p in l){const x=l[p].getSource();if(x.hasOwnProperty("mapbox_logo")&&!x.mapbox_logo)return!1}return!0}_updateCompact(){const l=this._container.children;if(l.length){const p=l[0];this._map.getCanvasContainer().offsetWidth<250?p.classList.add("mapboxgl-compact"):p.classList.remove("mapboxgl-compact")}}}class jc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const p=++this._id;return this._queue.push({callback:l,id:p,cancelled:!1}),p}remove(l){const p=this._currentlyRunning,x=p?this._queue.concat(p):this._queue;for(const E of x)if(E.id===l)return void(E.cancelled=!0)}run(l=0){const p=this._currentlyRunning=this._queue;this._queue=[];for(const x of p)if(!x.cancelled&&(x.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function ul(_,l,p){if(_=new o.LngLat(_.lng,_.lat),l){const x=new o.LngLat(_.lng-360,_.lat),E=new o.LngLat(_.lng+360,_.lat),A=360*Math.ceil(Math.abs(_.lng-p.center.lng)/360),D=p.locationPoint(_).distSqr(l),L=l.x<0||l.y<0||l.x>p.width||l.y>p.height;p.locationPoint(x).distSqr(l)<D&&(L||Math.abs(x.lng-p.center.lng)<A)?_=x:p.locationPoint(E).distSqr(l)<D&&(L||Math.abs(E.lng-p.center.lng)<A)&&(_=E)}for(;Math.abs(_.lng-p.center.lng)>180;){const x=p.locationPoint(_);if(x.x>=0&&x.y>=0&&x.x<=p.width&&x.y<=p.height)break;_.lng>p.center.lng?_.lng-=360:_.lng+=360}return _}const Vu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class un extends o.Evented{constructor(l,p){if(super(),(l instanceof o.window.HTMLElement||p)&&(l=o.extend({element:l},p)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=l&&l.occludedOpacity||.2,l&&l.element)this._element=l.element,this._offset=o.Point.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=j("div");const E=41,A=27,D=Z("svg",{display:"block",height:E*this._scale+"px",width:A*this._scale+"px",viewBox:`0 0 ${A} ${E}`},this._element),L=Z("radialGradient",{id:"shadowGradient"},Z("defs",{},D));Z("stop",{offset:"10%","stop-opacity":.4},L),Z("stop",{offset:"100%","stop-opacity":.05},L),Z("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},D),Z("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},D),Z("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},D),Z("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},D),this._offset=o.Point.convert(l&&l.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(E=>{E.preventDefault()})),this._element.addEventListener("mousedown",(E=>{E.preventDefault()}));const x=this._element.classList;for(const E in Vu)x.remove(`mapboxgl-marker-anchor-${E}`);x.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(l){return l===this._map||(this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._updateMoving),l.on("moveend",this._update),l.on("remove",this._clearFadeTimer),l._addMarker(this),this.setDraggable(this._draggable),this._update(),l.on("click",this._onMapClick)),this}remove(){const l=this._map;return l&&(l.off("click",this._onMapClick),l.off("move",this._updateMoving),l.off("moveend",this._update),l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler),l.off("mouseup",this._onUp),l.off("touchend",this._onUp),l.off("mousemove",this._onMove),l.off("touchmove",this._onMove),l.off("remove",this._clearFadeTimer),l._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=o.LngLat.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const E=Math.sqrt(Math.pow(13.5,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[E,-1*(38.1-13.5+E)],"bottom-right":[-E,-1*(38.1-13.5+E)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,l._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(l){const p=l.code,x=l.charCode||l.keyCode;p!=="Space"&&p!=="Enter"&&x!==32&&x!==13||this.togglePopup()}_onMapClick(l){const p=l.originalEvent.target,x=this._element;this._popup&&(p===x||x.contains(p))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const l=this._popup;return l?(l.isOpen()?(l.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(l.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const l=this._map,p=this._pos;if(!l||!p)return!1;const x=l.unproject(p),E=l.getFreeCameraOptions();if(!E.position)return!1;const A=E.position.toLngLat();return A.distanceTo(x)<.9*A.distanceTo(this._lngLat)}_evaluateOpacity(){const l=this._map;if(!l)return;const p=this._pos;if(!p||p.x<0||p.x>l.transform.width||p.y<0||p.y>l.transform.height)return void this._clearFadeTimer();const x=l.unproject(p);let E;l._showingGlobe()&&o.isLngLatBehindGlobe(l.transform,this._lngLat)?E=0:(E=1-l._queryFogOpacity(x),l.transform._terrainEnabled()&&l.getTerrain()&&this._behindTerrain()&&(E*=this._occludedOpacity)),this._element.style.opacity=`${E}`,this._element.style.pointerEvents=E>0?"auto":"none",this._popup&&this._popup._setOpacity(E),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const l=this._pos;if(!l||!this._map)return;const p=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${l.x}px,${l.y}px)
            ${Vu[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${p.x}px,${p.y}px)
        `}_calculateXYTransform(){const l=this._pos,p=this._map,x=this.getPitchAlignment();if(!p||!l||x!=="map")return"";if(!p._showingGlobe()){const V=p.getPitch();return V?`rotateX(${V}deg)`:""}const E=o.radToDeg(o.globeTiltAtLngLat(p.transform,this._lngLat)),A=l.sub(o.globeCenterToScreenPoint(p.transform)),D=Math.abs(A.x)+Math.abs(A.y);if(D===0)return"";const L=E/D;return`rotateX(${-A.y*L}deg) rotateY(${A.x*L}deg)`}_calculateZTransform(){const l=this._pos,p=this._map;if(!p||!l)return"";let x=0;const E=this.getRotationAlignment();if(E==="map")if(p._showingGlobe()){const A=p.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),D=p.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(A);x=o.radToDeg(Math.atan2(D.y,D.x))-90}else x=-p.getBearing();else if(E==="horizon"){const A=o.smoothstep(4,6,p.getZoom()),D=o.globeCenterToScreenPoint(p.transform);D.y+=A*p.transform.height;const L=l.sub(D),V=o.radToDeg(Math.atan2(L.y,L.x));x=(V>90?V-270:V+90)*(1-A)}return x+=this._rotation,x?`rotateZ(${x}deg)`:""}_update(l){o.window.cancelAnimationFrame(this._updateFrameId);const p=this._map;p&&(p.transform.renderWorldCopies&&(this._lngLat=ul(this._lngLat,this._pos,p.transform)),this._pos=p.project(this._lngLat),l===!0?this._updateFrameId=o.window.requestAnimationFrame((()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())})):this._pos=this._pos.round(),p._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(p._showingGlobe()||p.getTerrain()||p.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})))}getOffset(){return this._offset}setOffset(l){return this._offset=o.Point.convert(l),this._update(),this}_onMove(l){const p=this._map;if(!p)return;const x=this._pointerdownPos,E=this._positionDelta;if(x&&E){if(!this._isDragging){const A=this._clickTolerance||p._clickTolerance;if(l.point.dist(x)<A)return;this._isDragging=!0}this._pos=l.point.sub(E),this._lngLat=p.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const l=this._map;l&&(l.off("mousemove",this._onMove),l.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(l){const p=this._map,x=this._pos;p&&x&&this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(x),this._pointerdownPos=l.point,this._state="pending",p.on("mousemove",this._onMove),p.on("touchmove",this._onMove),p.once("mouseup",this._onUp),p.once("touchend",this._onUp))}setDraggable(l){this._draggable=!!l;const p=this._map;return p&&(l?(p.on("mousedown",this._addDragHandler),p.on("touchstart",this._addDragHandler)):(p.off("mousedown",this._addDragHandler),p.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(l){return this._occludedOpacity=l||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Om={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},sy=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function $c(_=new o.Point(0,0),l="bottom"){if(typeof _=="number"){const p=Math.round(Math.sqrt(.5*Math.pow(_,2)));switch(l){case"top":return new o.Point(0,_);case"top-left":return new o.Point(p,p);case"top-right":return new o.Point(-p,p);case"bottom":return new o.Point(0,-_);case"bottom-left":return new o.Point(p,-p);case"bottom-right":return new o.Point(-p,-p);case"left":return new o.Point(_,0);case"right":return new o.Point(-_,0)}return new o.Point(0,0)}return _ instanceof o.Point||Array.isArray(_)?o.Point.convert(_):o.Point.convert(_[l]||[0,0])}class Qd{constructor(l){this.jumpTo(l)}getValue(l){if(l<=this._startTime)return this._start;if(l>=this._endTime)return this._end;const p=o.easeCubicInOut((l-this._startTime)/(this._endTime-this._startTime));return this._start*(1-p)+this._end*p}isEasing(l){return l>=this._startTime&&l<=this._endTime}jumpTo(l){this._startTime=-1/0,this._endTime=-1/0,this._start=l,this._end=l}easeTo(l,p,x){this._start=this.getValue(p),this._end=l,this._startTime=p,this._endTime=p+x}}const Jd={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},zm={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},zh={showCompass:!0,showZoom:!0,visualizePitch:!1};class Bm{constructor(l,p,x=!1){this._clickTolerance=10,this.element=p,this.mouseRotate=new Rl({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,x&&(this.mousePitch=new Xo({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),p.addEventListener("mousedown",this.mousedown),p.addEventListener("touchstart",this.touchstart,{passive:!1}),p.addEventListener("touchmove",this.touchmove),p.addEventListener("touchend",this.touchend),p.addEventListener("touchcancel",this.reset)}down(l,p){this.mouseRotate.mousedown(l,p),this.mousePitch&&this.mousePitch.mousedown(l,p),ge()}move(l,p){const x=this.map,E=this.mouseRotate.mousemoveWindow(l,p),A=E&&E.bearingDelta;if(A&&x.setBearing(x.getBearing()+A),this.mousePitch){const D=this.mousePitch.mousemoveWindow(l,p),L=D&&D.pitchDelta;L&&x.setPitch(x.getPitch()+L)}}off(){const l=this.element;l.removeEventListener("mousedown",this.mousedown),l.removeEventListener("touchstart",this.touchstart,{passive:!1}),l.removeEventListener("touchmove",this.touchmove),l.removeEventListener("touchend",this.touchend),l.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ue(),o.window.removeEventListener("mousemove",this.mousemove),o.window.removeEventListener("mouseup",this.mouseup)}mousedown(l){this.down(o.extend({},l,{ctrlKey:!0,preventDefault:()=>l.preventDefault()}),Te(this.element,l)),o.window.addEventListener("mousemove",this.mousemove),o.window.addEventListener("mouseup",this.mouseup)}mousemove(l){this.move(l,Te(this.element,l))}mouseup(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()}touchstart(l){l.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ae(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>l.preventDefault()},this._startPos))}touchmove(l){l.targetTouches.length!==1?this.reset():(this._lastPos=ae(this.element,l.targetTouches)[0],this.move({preventDefault:()=>l.preventDefault()},this._lastPos))}touchend(l){l.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Bh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Nh={maxWidth:100,unit:"metric"},hp={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Fu={version:o.version,supported:M,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends Uc{constructor(_){if(o.LivePerformanceUtils.mark(o.PerformanceMarkers.create),(_=o.extend({},zm,_)).minZoom!=null&&_.maxZoom!=null&&_.minZoom>_.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(_.minPitch!=null&&_.maxPitch!=null&&_.minPitch>_.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(_.minPitch!=null&&_.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(_.maxPitch!=null&&_.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(_.antialias&&o.isSafariWithAntialiasingBug(o.window)&&(_.antialias=!1,o.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ou(_.minZoom,_.maxZoom,_.minPitch,_.maxPitch,_.renderWorldCopies),_),this._interactive=_.interactive,this._minTileCacheSize=_.minTileCacheSize,this._maxTileCacheSize=_.maxTileCacheSize,this._failIfMajorPerformanceCaveat=_.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=_.preserveDrawingBuffer,this._antialias=_.antialias,this._useWebGL2=_.useWebGL2,this._trackResize=_.trackResize,this._bearingSnap=_.bearingSnap,this._refreshExpiredTiles=_.refreshExpiredTiles,this._fadeDuration=_.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=_.crossSourceCollisions,this._collectResourceTiming=_.collectResourceTiming,this._optimizeForTerrain=_.optimizeForTerrain,this._language=this._parseLanguage(_.language),this._worldview=_.worldview,this._renderTaskQueue=new jc,this._domRenderTaskQueue=new jc,this._controls=[],this._markers=[],this._popups=[],this._mapId=o.uniqueId(),this._locale=o.extend({},Jd,_.locale),this._clickTolerance=_.clickTolerance,this._cooperativeGestures=_.cooperativeGestures,this._performanceMetricsCollection=_.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Qd(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new o.RequestManager(_.transformRequest,_.accessToken,_.testMode),this._silenceAuthErrors=!!_.testMode,typeof _.container=="string"){if(this._container=o.window.document.getElementById(_.container),!this._container)throw new Error(`Container '${_.container}' not found.`)}else{if(!(_.container instanceof o.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=_.container}if(this._container.childNodes.length>0&&o.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),_.maxBounds&&this.setMaxBounds(_.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1),o.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new _i(this,_),this._localFontFamily=_.localFontFamily,this._localIdeographFontFamily=_.localIdeographFontFamily,_.style&&this.setStyle(_.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),_.projection&&this.setProjection(_.projection),this._hash=_.hash&&new nc(typeof _.hash=="string"&&_.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch}),_.bounds&&(this.resize(),this.fitBounds(_.bounds,o.extend({},_.fitBoundsOptions,{duration:0})))),this.resize(),_.attributionControl&&this.addControl(new gn({customAttribution:_.customAttribution})),this._logoControl=new Yd,this.addControl(this._logoControl,_.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(l=>{this._update(l.dataType==="style"),this.fire(new o.Event(`${l.dataType}data`,l))})),this.on("dataloading",(l=>{this.fire(new o.Event(`${l.dataType}dataloading`,l))}))}_getMapId(){return this._mapId}addControl(_,l){if(l===void 0&&(l=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const p=_.onAdd(this);this._controls.push(_);const x=this._controlPositions[l];return l.indexOf("bottom")!==-1?x.insertBefore(p,x.firstChild):x.appendChild(p),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(_);return l>-1&&this._controls.splice(l,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(_){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const l=!this._moving;return l&&this.fire(new o.Event("movestart",_)).fire(new o.Event("move",_)),this.fire(new o.Event("resize",_)),l&&this.fire(new o.Event("moveend",_)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(_){return this.transform.setMaxBounds(o.LngLatBounds.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_?this.setZoom(_):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_?this.setZoom(_):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_?this.setPitch(_):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_?this.setPitch(_):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(_){return _==="auto"?o.window.navigator.language:Array.isArray(_)?_.length===0?void 0:_.map((l=>l==="auto"?o.window.navigator.language:l)):_}setLanguage(_){const l=this._parseLanguage(_);if(!this.style||l===this._language)return this;this._language=l,this.style._reloadSources();for(const p of this._controls)p._setLanguage&&p._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(_){return this.style&&_!==this._worldview?(this._worldview=_,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(_){return this._lazyInitEmptyStyle(),_?typeof _=="string"&&(_={name:_}):_=null,this._useExplicitProjection=!!_,this._prioritizeAndUpdateProjection(_,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const _=this.transform,l=_.projection.name;let p;l==="globe"&&_.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?(_.setMercatorFromTransition(),p=!0):l==="mercator"&&_.zoom<o.GLOBE_ZOOM_THRESHOLD_MAX&&(_.setProjection({name:"globe"}),p=!0),p&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(_,l){return this._updateProjection(_||l||{name:"mercator"})}_updateProjection(_){let l;if(l=_.name==="globe"&&this.transform.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(_),this.style.applyProjectionUpdate(),l){this.painter.clearBackgroundTiles();for(const p in this.style._sourceCaches)this.style._sourceCaches[p].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(_){return this.transform.locationPoint3D(o.LngLat.convert(_))}unproject(_){return this.transform.pointLocation3D(o.Point.convert(_))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(_,l,p){if(_==="mouseenter"||_==="mouseover"){let x=!1;const E=D=>{const L=l.filter((G=>this.getLayer(G))),V=L.length?this.queryRenderedFeatures(D.point,{layers:L}):[];V.length?x||(x=!0,p.call(this,new yi(_,this,D.originalEvent,{features:V}))):x=!1},A=()=>{x=!1};return{layers:new Set(l),listener:p,delegates:{mousemove:E,mouseout:A}}}if(_==="mouseleave"||_==="mouseout"){let x=!1;const E=D=>{const L=l.filter((V=>this.getLayer(V)));(L.length?this.queryRenderedFeatures(D.point,{layers:L}):[]).length?x=!0:x&&(x=!1,p.call(this,new yi(_,this,D.originalEvent)))},A=D=>{x&&(x=!1,p.call(this,new yi(_,this,D.originalEvent)))};return{layers:new Set(l),listener:p,delegates:{mousemove:E,mouseout:A}}}{const x=E=>{const A=l.filter((L=>this.getLayer(L))),D=A.length?this.queryRenderedFeatures(E.point,{layers:A}):[];D.length&&(E.features=D,p.call(this,E),delete E.features)};return{layers:new Set(l),listener:p,delegates:{[_]:x}}}}on(_,l,p){if(p===void 0)return super.on(_,l);Array.isArray(l)||(l=[l]);const x=this._createDelegatedListener(_,l,p);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(x);for(const E in x.delegates)this.on(E,x.delegates[E]);return this}once(_,l,p){if(p===void 0)return super.once(_,l);Array.isArray(l)||(l=[l]);const x=this._createDelegatedListener(_,l,p);for(const E in x.delegates)this.once(E,x.delegates[E]);return this}off(_,l,p){if(p===void 0)return super.off(_,l);l=new Set(Array.isArray(l)?l:[l]);const x=(A,D)=>{if(A.size!==D.size)return!1;for(const L of A)if(!D.has(L))return!1;return!0},E=this._delegatedListeners?this._delegatedListeners[_]:void 0;return E&&(A=>{for(let D=0;D<A.length;D++){const L=A[D];if(L.listener===p&&x(L.layers,l)){for(const V in L.delegates)this.off(V,L.delegates[V]);return A.splice(D,1),this}}})(E),this}queryRenderedFeatures(_,l){return this.style?(l!==void 0||_===void 0||_ instanceof o.Point||Array.isArray(_)||(l=_,_=void 0),this.style.queryRenderedFeatures(_=_||[[0,0],[this.transform.width,this.transform.height]],l=l||{},this.transform)):[]}querySourceFeatures(_,l){return this.style.querySourceFeatures(_,l)}isPointOnSurface(_){const{name:l}=this.transform.projection;return l!=="globe"&&l!=="mercator"&&o.warnOnce(`${l} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(o.Point.convert(_))}setStyle(_,l){return(l=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&l.localFontFamily===this._localFontFamily&&this.style&&_?(this._diffStyle(_,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._localFontFamily=l.localFontFamily,this._updateStyle(_,l))}_getUIString(_){const l=this._locale[_];if(l==null)throw new Error(`Missing UI string '${_}'`);return l}_updateStyle(_,l){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),_&&(this.style=new Ao(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_):this.style.loadJSON(_)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ao(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,l){if(typeof _=="string"){const p=this._requestManager.normalizeStyleURL(_),x=this._requestManager.transformRequest(p,o.ResourceType.Style);o.getJSON(x,((E,A)=>{E?this.fire(new o.ErrorEvent(E)):A&&this._updateDiff(A,l)}))}else typeof _=="object"&&this._updateDiff(_,l)}_updateDiff(_,l){try{this.style.setState(_)&&this._update(!0)}catch(p){o.warnOnce(`Unable to perform style diff: ${p.message||p.error||p}.  Rebuilding the style from scratch.`),this._updateStyle(_,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.warnOnce("There is no style added to the map."),!1)}addSource(_,l){return this._lazyInitEmptyStyle(),this.style.addSource(_,l),this._update(!0)}isSourceLoaded(_){return!!this.style&&this.style._isSourceCacheLoaded(_)}areTilesLoaded(){const _=this.style&&this.style._sourceCaches;for(const l in _){const p=_[l]._tiles;for(const x in p){const E=p[x];if(E.state!=="loaded"&&E.state!=="errored")return!1}}return!0}addSourceType(_,l,p){this._lazyInitEmptyStyle(),this.style.addSourceType(_,l,p)}removeSource(_){return this.style.removeSource(_),this._updateTerrain(),this._update(!0)}getSource(_){return this.style.getSource(_)}addImage(_,l,{pixelRatio:p=1,sdf:x=!1,stretchX:E,stretchY:A,content:D}={}){if(this._lazyInitEmptyStyle(),l instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&l instanceof o.window.ImageBitmap){const{width:L,height:V,data:G}=o.exported.getImageData(l);this.style.addImage(_,{data:new o.RGBAImage({width:L,height:V},G),pixelRatio:p,stretchX:E,stretchY:A,content:D,sdf:x,version:0})}else if(l.width===void 0||l.height===void 0)this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:L,height:V}=l,G=l;this.style.addImage(_,{data:new o.RGBAImage({width:L,height:V},new Uint8Array(G.data)),pixelRatio:p,stretchX:E,stretchY:A,content:D,sdf:x,version:0,userImage:G}),G.onAdd&&G.onAdd(this,_)}}updateImage(_,l){const p=this.style.getImage(_);if(!p)return void this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=l instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&l instanceof o.window.ImageBitmap?o.exported.getImageData(l):l,{width:E,height:A}=x;E!==void 0&&A!==void 0?E===p.data.width&&A===p.data.height?(p.data.replace(x.data,!(l instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&l instanceof o.window.ImageBitmap)),this.style.updateImage(_,p)):this.fire(new o.ErrorEvent(new Error(`The width and height of the updated image (${E}, ${A})
                must be that same as the previous version of the image
                (${p.data.width}, ${p.data.height})`))):this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_,l){o.getImage(this._requestManager.transformRequest(_,o.ResourceType.Image),((p,x)=>{l(p,x instanceof o.window.HTMLImageElement?o.exported.getImageData(x):x)}))}listImages(){return this.style.listImages()}addLayer(_,l){return this._lazyInitEmptyStyle(),this.style.addLayer(_,l),this._update(!0)}moveLayer(_,l){return this.style.moveLayer(_,l),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}setLayerZoomRange(_,l,p){return this.style.setLayerZoomRange(_,l,p),this._update(!0)}setFilter(_,l,p={}){return this.style.setFilter(_,l,p),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,l,p,x={}){return this.style.setPaintProperty(_,l,p,x),this._update(!0)}getPaintProperty(_,l){return this.style.getPaintProperty(_,l)}setLayoutProperty(_,l,p,x={}){return this.style.setLayoutProperty(_,l,p,x),this._update(!0)}getLayoutProperty(_,l){return this.style.getLayoutProperty(_,l)}setLight(_,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,l),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(_){return this._lazyInitEmptyStyle(),!_&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(_),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(_){return this._lazyInitEmptyStyle(),this.style.setFog(_),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(_){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.LngLat.convert(_),this.transform):0}setFeatureState(_,l){return this.style.setFeatureState(_,l),this._update()}removeFeatureState(_,l){return this.style.removeFeatureState(_,l),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}_updateContainerDimensions(){if(!this._container)return;const _=this._container.getBoundingClientRect().width||400,l=this._container.getBoundingClientRect().height||300;let p,x,E,A=this._container;for(;A&&(!x||!E);){const D=o.window.getComputedStyle(A).transform;D&&D!=="none"&&(p=D.match(/matrix.*\((.+)\)/)[1].split(", "),p[0]&&p[0]!=="0"&&p[0]!=="1"&&(x=p[0]),p[3]&&p[3]!=="0"&&p[3]!=="1"&&(E=p[3])),A=A.parentElement}this._containerWidth=x?Math.abs(_/x):_,this._containerHeight=E?Math.abs(l/E):l}_detectMissingCSS(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const _=this._container;_.classList.add("mapboxgl-map"),(this._missingCSSCanary=j("div","mapboxgl-canary",_)).style.visibility="hidden",this._detectMissingCSS();const l=this._canvasContainer=j("div","mapboxgl-canvas-container",_);this._interactive&&l.classList.add("mapboxgl-interactive"),this._canvas=j("canvas","mapboxgl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const p=this._controlContainer=j("div","mapboxgl-control-container",_),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((E=>{x[E]=j("div",`mapboxgl-ctrl-${E}`,p)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,l){const p=o.exported.devicePixelRatio||1;this._canvas.width=p*Math.ceil(_),this._canvas.height=p*Math.ceil(l),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${l}px`}_addMarker(_){this._markers.push(_)}_removeMarker(_){const l=this._markers.indexOf(_);l!==-1&&this._markers.splice(l,1)}_addPopup(_){this._popups.push(_)}_removePopup(_){const l=this._popups.indexOf(_);l!==-1&&this._popups.splice(l,1)}_setupPainter(){const _=o.extend({},M.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),l=this._useWebGL2&&this._canvas.getContext("webgl2",_),p=l||this._canvas.getContext("webgl",_)||this._canvas.getContext("experimental-webgl",_);p?(this._useWebGL2&&!l&&o.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),o.storeAuthState(p,!0),this.painter=new ol(p,this.transform,!!l),this.on("data",(x=>{x.dataType==="source"&&this.painter.setTileLoadedFlag(!0)})),o.exported$1.testSupport(p)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(_){_.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:_}))}_contextRestored(_){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:_}))}_onMapScroll(_){if(_.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_requestDomTask(_){!this.loaded()||this.loaded()&&!this.isMoving()?_():this._domRenderTaskQueue.add(_)}_render(_){let l;const p=this.painter.context.extTimerQuery,x=o.exported.now();if(this.listens("gpu-timing-frame")&&(l=p.createQueryEXT(),p.beginQueryEXT(p.TIME_ELAPSED_EXT,l)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],o.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],o.window.performance.now())),this._renderTaskQueue.run(_),this._domRenderTaskQueue.run(_),this._removed)return;this._updateProjectionTransition();const E=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const L=this.transform.zoom,V=this.transform.pitch,G=o.exported.now(),q=new o.EvaluationParameters(L,{now:G,fadeDuration:E,pitch:V,transition:this.style.getTransition()});this.style.update(q)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let A=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),A=this._updateAverageElevation(x),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):A=this._updateAverageElevation(x),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,E,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),l){const L=o.exported.now()-x;p.endQueryEXT(p.TIME_ELAPSED_EXT,l),setTimeout((()=>{const V=p.getQueryObjectEXT(l,p.QUERY_RESULT_EXT)/1e6;p.deleteQueryEXT(l),this.fire(new o.Event("gpu-timing-frame",{cpuTime:L,gpuTime:V})),o.window.performance.mark("frame-gpu",{startTime:x,detail:{gpuTime:V}})}),50)}if(this.listens("gpu-timing-layer")){const L=this.painter.collectGpuTimers();setTimeout((()=>{const V=this.painter.queryGpuTimers(L);this.fire(new o.Event("gpu-timing-layer",{layerTimes:V}))}),50)}if(this.listens("gpu-timing-deferred-render")){const L=this.painter.collectDeferredRenderGpuQueries();setTimeout((()=>{const V=this.painter.queryGpuTimeDeferredRender(L);this.fire(new o.Event("gpu-timing-deferred-render",{gpuTime:V}))}),50)}const D=this._sourcesDirty||this._styleDirty||this._placementDirty||A;if(D||this._repaint)this.triggerRepaint();else{const L=!this.isMoving()&&this.loaded();if(L&&(A=this._updateAverageElevation(x,!0)),A)this.triggerRepaint();else if(this._triggerFrame(!1),L&&(this.fire(new o.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const V=this._calculateSpeedIndex();this.fire(new o.Event("speedindexcompleted",{speedIndex:V})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||D||(this._fullyLoaded=!0,o.LivePerformanceUtils.mark(o.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&o.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(_){for(const l of this._markers)_&&!this.getRenderWorldCopies()&&(l._lngLat=l._lngLat.wrap()),l._update();for(const l of this._popups)!_||this.getRenderWorldCopies()||l._trackPointer||(l._lngLat=l._lngLat.wrap()),l._update()}_updateAverageElevation(_,l=!1){const p=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&p(0);if((l||_-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(_)){const x=this.transform.averageElevation;let E=this.transform.sampleAverageElevation(),A=!1;this.transform.elevation&&(A=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(E)?E=0:this._averageElevationLastSampledAt=_;const D=Math.abs(x-E);if(D>1){if(this._isInitialLoad||A)return this._averageElevation.jumpTo(E),p(E);this._averageElevation.easeTo(E,_,300)}else if(D>1e-4)return this._averageElevation.jumpTo(E),p(E)}return!!this._averageElevation.isEasing(_)&&p(this._averageElevation.getValue(_))}_authenticate(){o.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(_=>{if(_&&(_.message===o.AUTH_ERR_MSG||_.status===401)){const l=this.painter.context.gl;o.storeAuthState(l,!1),this._logoControl instanceof Yd&&this._logoControl._updateLogo(),l&&l.clear(l.DEPTH_BUFFER_BIT|l.COLOR_BUFFER_BIT|l.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),o.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_updateTerrain(){const _=this._isDragging();this.painter.updateTerrain(this.style,_)}_calculateSpeedIndex(){const _=this.painter.canvasCopy(),l=this.painter.getCanvasCopiesAndTimestamps();l.timeStamps.push(performance.now());const p=this.painter.context.gl,x=p.createFramebuffer();function E(A){p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,A,0);const D=new Uint8Array(p.drawingBufferWidth*p.drawingBufferHeight*4);return p.readPixels(0,0,p.drawingBufferWidth,p.drawingBufferHeight,p.RGBA,p.UNSIGNED_BYTE,D),D}return p.bindFramebuffer(p.FRAMEBUFFER,x),this._canvasPixelComparison(E(_),l.canvasCopies.map(E),l.timeStamps)}_canvasPixelComparison(_,l,p){let x=p[1]-p[0];const E=_.length/4;for(let A=0;A<l.length;A++){const D=l[A];let L=0;for(let V=0;V<D.length;V+=4)D[V]===_[V]&&D[V+1]===_[V+1]&&D[V+2]===_[V+2]&&D[V+3]===_[V+3]&&(L+=1);x+=(p[A+2]-p[A+1])*(1-L/E)}return x}remove(){this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1),o.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const _=this.painter.context.gl.getExtension("WEBGL_lose_context");_&&_.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),o.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(_){this._renderNextFrame=this._renderNextFrame||_,this.style&&!this._frame&&(this._frame=o.exported.frame((l=>{const p=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,p&&this._render(l)})))}_preloadTiles(_){const l=this.style?Object.values(this.style._sourceCaches):[];return o.asyncAll(l,((p,x)=>p._preloadTiles(_,x)),(()=>{this.triggerRepaint()})),this}_onWindowOnline(){this._update()}_onWindowResize(_){this._trackResize&&this.resize({originalEvent:_})._update()}_onVisibilityChange(){o.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(_){this._showTerrainWireframe!==_&&(this._showTerrainWireframe=_,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(_){this._speedIndexTiming!==_&&(this._speedIndexTiming=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(_){this._showTileAABBs!==_&&(this._showTileAABBs=_,_&&this._update())}_setCacheLimits(_,l){o.setCacheLimits(_,l)}get version(){return o.version}},NavigationControl:class{constructor(_){this.options=o.extend({},zh,_),this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(l=>l.preventDefault())),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(l=>{this._map&&this._map.zoomIn({},{originalEvent:l})})),j("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(l=>{this._map&&this._map.zoomOut({},{originalEvent:l})})),j("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(l=>{const p=this._map;p&&(this.options.visualizePitch?p.resetNorthPitch({},{originalEvent:l}):p.resetNorth({},{originalEvent:l}))})),this._compassIcon=j("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const _=this._map;if(!_)return;const l=_.getZoom(),p=l===_.getMaxZoom(),x=l===_.getMinZoom();this._zoomInButton.disabled=p,this._zoomOutButton.disabled=x,this._zoomInButton.setAttribute("aria-disabled",p.toString()),this._zoomOutButton.setAttribute("aria-disabled",x.toString())}_rotateCompassArrow(){const _=this._map;if(!_)return;const l=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(_.transform.pitch*(Math.PI/180)),.5)}) rotateX(${_.transform.pitch}deg) rotateZ(${_.transform.angle*(180/Math.PI)}deg)`:`rotate(${_.transform.angle*(180/Math.PI)}deg)`;_._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=l)}))}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),_.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&_.on("pitch",this._rotateCompassArrow),_.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Bm(_,this._compass,this.options.visualizePitch)),this._container}onRemove(){const _=this._map;_&&(this._container.remove(),this.options.showZoom&&_.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&_.off("pitch",this._rotateCompassArrow),_.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(_,l){const p=j("button",_,this._container);return p.type="button",p.addEventListener("click",l),p}_setButtonTitle(_,l){if(!this._map)return;const p=this._map._getUIString(`NavigationControl.${l}`);_.setAttribute("aria-label",p),_.firstElementChild&&_.firstElementChild.setAttribute("title",p)}},GeolocateControl:class extends o.Evented{constructor(_){super(),this.options=o.extend({geolocation:o.window.navigator.geolocation},Bh,_),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=tc(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(_){return this._map=_,this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(_){const l=(p=!!this.options.geolocation)=>{this._supportsGeolocation=p,_(p)};this._supportsGeolocation!==void 0?_(this._supportsGeolocation):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then((p=>l(p.state!=="denied"))).catch((()=>l())):l()}_isOutOfMapMaxBounds(_){const l=this._map.getMaxBounds(),p=_.coords;return!!l&&(p.longitude<l.getWest()||p.longitude>l.getEast()||p.latitude<l.getSouth()||p.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(_){if(this._map){if(this._isOutOfMapMaxBounds(_))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",_)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=_,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(_),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(_),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",_)),this._finish()}}_updateCamera(_){const l=new o.LngLat(_.coords.longitude,_.coords.latitude),p=_.coords.accuracy,x=this._map.getBearing(),E=o.extend({bearing:x},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(p),E,{geolocateSource:!0})}_updateMarker(_){if(_){const l=new o.LngLat(_.coords.longitude,_.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=_.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const _=this._map.transform,l=o.mercatorZfromAltitude(1,_._center.lat)*_.worldSize,p=Math.ceil(2*this._accuracy*l);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(_){if(this._map){if(this.options.trackUserLocation)if(_.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(_.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",_)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(_){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",(l=>l.preventDefault())),this._geolocateButton=j("button","mapboxgl-ctrl-geolocate",this._container),j("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",_===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=j("div","mapboxgl-user-location"),this._dotElement.appendChild(j("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(j("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new un({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=j("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new un({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(l=>{l.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l.originalEvent&&l.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))}))}}_onDeviceOrientation(_){this._userLocationDotMarker&&(_.webkitCompassHeading?this._heading=_.webkitCompassHeading:_.absolute===!0&&(this._heading=-1*_.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(_={maximumAge:6e5,timeout:0},this._noTimeout=!0):(_=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,_),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const _=()=>{o.window.addEventListener("ondeviceorientationabsolute"in o.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};o.window.DeviceMotionEvent!==void 0&&typeof o.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then((l=>{l==="granted"&&_()})).catch(console.error):_()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),o.window.removeEventListener("deviceorientation",this._onDeviceOrientation),o.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:gn,ScaleControl:class{constructor(_){this.options=o.extend({},Nh,_),this._isNumberFormatSupported=(function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}})(),o.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const _=this.options.maxWidth||100,l=this._map,p=l._containerHeight/2,x=l._containerWidth/2-_/2,E=l.unproject([x,p]),A=l.unproject([x+_,p]),D=E.distanceTo(A);if(this.options.unit==="imperial"){const L=3.2808*D;L>5280?this._setScale(_,L/5280,"mile"):this._setScale(_,L,"foot")}else this.options.unit==="nautical"?this._setScale(_,D/1852,"nautical-mile"):D>=1e3?this._setScale(_,D/1e3,"kilometer"):this._setScale(_,D,"meter")}_setScale(_,l,p){this._map._requestDomTask((()=>{const x=(function(A){const D=Math.pow(10,`${Math.floor(A)}`.length-1);let L=A/D;return L=L>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:(function(V){const G=Math.pow(10,Math.ceil(-Math.log(V)/Math.LN10));return Math.round(V*G)/G})(L),D*L})(l),E=x/l;this._container.innerHTML=this._isNumberFormatSupported&&p!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:p}).format(x):`${x}&nbsp;${hp[p]}`,this._container.style.width=_*E+"px"}))}onAdd(_){return this._map=_,this._language=_.getLanguage(),this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-scale",_.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(_){this._language=_,this._update()}setUnit(_){this.options.unit=_,this._update()}},FullscreenControl:class{constructor(_){this._fullscreen=!1,_&&_.container&&(_.container instanceof o.window.HTMLElement?this._container=_.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in o.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=j("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!o.window.document.fullscreenEnabled&&!o.window.document.webkitFullscreenEnabled)}_setupUI(){const _=this._fullscreenButton=j("button","mapboxgl-ctrl-fullscreen",this._controlContainer);j("span","mapboxgl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",_)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(o.window.document.fullscreenElement||o.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.Evented{constructor(_){super(),this.options=o.extend(Object.create(Om),_),o.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(_&&_.className?_.className.trim().split(/\s+/):[])}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&_.on("preclick",this._onClose),this.options.closeOnMove&&_.on("move",this._onClose),_.on("remove",this.remove),this._update(),_._addPopup(this),this._focusFirstElement(),this._trackPointer?(_.on("mousemove",this._onMouseEvent),_.on("mouseup",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")):_.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const _=this._map;return _&&(_.off("move",this._update),_.off("move",this._onClose),_.off("preclick",this._onClose),_.off("click",this._onClose),_.off("remove",this.remove),_.off("mousemove",this._onMouseEvent),_.off("mouseup",this._onMouseEvent),_.off("drag",this._onMouseEvent),_._canvasContainer&&_._canvasContainer.classList.remove("mapboxgl-track-pointer"),_._removePopup(this),this._map=void 0),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(_){this._lngLat=o.LngLat.convert(_),this._pos=null,this._trackPointer=!1,this._update();const l=this._map;return l&&(l.on("move",this._update),l.off("mousemove",this._onMouseEvent),l._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const _=this._map;return _&&(_.off("move",this._update),_.on("mousemove",this._onMouseEvent),_.on("drag",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(o.window.document.createTextNode(_))}setHTML(_){const l=o.window.document.createDocumentFragment(),p=o.window.document.createElement("body");let x;for(p.innerHTML=_;x=p.firstChild,x;)l.appendChild(x);return this.setDOMContent(l)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){let l=this._content;if(l)for(;l.hasChildNodes();)l.firstChild&&l.removeChild(l.firstChild);else l=this._content=j("div","mapboxgl-popup-content",this._container||void 0);if(l.appendChild(_),this.options.closeButton){const p=this._closeButton=j("button","mapboxgl-popup-close-button",l);p.type="button",p.setAttribute("aria-label","Close popup"),p.setAttribute("aria-hidden","true"),p.innerHTML="&#215;",p.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(_){return this._classList.add(_),this._updateClassList(),this}removeClassName(_){return this._classList.delete(_),this._updateClassList(),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){let l;return this._classList.delete(_)?l=!1:(this._classList.add(_),l=!0),this._updateClassList(),l}_onMouseEvent(_){this._update(_.point)}_getAnchor(_){if(this.options.anchor)return this.options.anchor;const l=this._map,p=this._container,x=this._pos;if(!l||!p||!x)return"bottom";const E=p.offsetWidth,A=p.offsetHeight,D=x.x<E/2,L=x.x>l.transform.width-E/2;if(x.y+_<A)return D?"top-left":L?"top-right":"top";if(x.y>l.transform.height-A){if(D)return"bottom-left";if(L)return"bottom-right"}return D?"left":L?"right":"bottom"}_updateClassList(){const _=this._container;if(!_)return;const l=[...this._classList];l.push("mapboxgl-popup"),this._anchor&&l.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&l.push("mapboxgl-popup-track-pointer"),_.className=l.join(" ")}_update(_){const l=this._map,p=this._content;if(!l||!this._lngLat&&!this._trackPointer||!p)return;let x=this._container;if(x||(x=this._container=j("div","mapboxgl-popup",l.getContainer()),this._tip=j("div","mapboxgl-popup-tip",x),x.appendChild(p)),this.options.maxWidth&&x.style.maxWidth!==this.options.maxWidth&&(x.style.maxWidth=this.options.maxWidth),l.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ul(this._lngLat,this._pos,l.transform)),!this._trackPointer||_){const E=this._pos=this._trackPointer&&_?_:l.project(this._lngLat),A=$c(this.options.offset),D=this._anchor=this._getAnchor(A.y),L=$c(this.options.offset,D),V=E.add(L).round();l._requestDomTask((()=>{this._container&&D&&(this._container.style.transform=`${Vu[D]} translate(${V.x}px,${V.y}px)`)}))}if(!this._marker&&l._showingGlobe()){const E=o.isLngLatBehindGlobe(l.transform,this._lngLat)?0:1;this._setOpacity(E)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(sy);_&&_.focus()}_onClose(){this.remove()}_setOpacity(_){this._container&&(this._container.style.opacity=`${_}`),this._content&&(this._content.style.pointerEvents=_?"auto":"none")}},Marker:un,Style:Ao,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.Point,MercatorCoordinate:o.MercatorCoordinate,FreeCameraOptions:zc,Evented:o.Evented,config:o.config,prewarm:function(){Hl().acquire(Eo)},clearPrewarmedResources:function(){const _=ks;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(Eo),ks=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(_){o.config.ACCESS_TOKEN=_},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(_){o.config.API_URL=_},get workerCount(){return gs.workerCount},set workerCount(_){gs.workerCount=_},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(_){o.config.MAX_PARALLEL_IMAGE_REQUESTS=_},clearStorage(_){o.clearTileCache(_)},workerUrl:"",workerClass:null,setNow:o.exported.setNow,restoreNow:o.exported.restoreNow};return Fu}));var b=f;return b}))})(Hw)),Hw.exports}var oae=sae();const i_=RT(oae);function aae(t,e,n,i){const u=M=>M*Math.PI/180,g=u(n-t),b=u(i-e),o=Math.sin(g/2)*Math.sin(g/2)+Math.cos(u(t))*Math.cos(u(n))*Math.sin(b/2)*Math.sin(b/2);return 6371e3*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}function lae(){const t=W.useRef(null),e=W.useRef(null),[n,i]=W.useState(null),[u,f]=W.useState(2e3),[g,b]=W.useState([]),{user:o}=W.useContext(zd);i_.accessToken="pk.eyJ1Ijoid2lsbGlhbWxpODgiLCJhIjoiY21pYmM5eG92MTZpNzJscTFoYzV2cHFuYyJ9",W.useEffect(()=>{if(e.current||!t.current)return;const N=new i_.Map({container:t.current,style:"mapbox://styles/mapbox/streets-v11",center:[0,0],zoom:12});e.current=N,N.addControl(new i_.NavigationControl,"top-right"),N.on("error",j=>{console.error("Mapbox error:",j.error)}),N.on("load",()=>{console.debug("Mapbox loaded, style loaded:",N.isStyleLoaded&&N.isStyleLoaded());try{N.resize()}catch(j){console.warn("map.resize() failed on load:",j)}});try{window.__MAD_MAP=N}catch{}return()=>{try{N.remove()}catch{}e.current=null;try{delete window.__MAD_MAP}catch{}}},[]),W.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(N=>{const j=N.coords.latitude,Z=N.coords.longitude;i({lat:j,lng:Z}),e.current&&e.current.setCenter([Z,j])},()=>{},{enableHighAccuracy:!0})},[]),W.useEffect(()=>{if(!n||!e.current)return;const N=e.current,j=()=>{try{N.getLayer("search-radius")&&N.removeLayer("search-radius"),N.getSource("search-radius-src")&&N.removeSource("search-radius-src")}catch{}const Z=[],K=64,{lat:Q,lng:ce}=n;for(let ue=0;ue<K;ue++){const pe=ue/K*2*Math.PI,me=u/111320*Math.cos(pe),Te=u/110540*Math.sin(pe);Z.push([ce+me,Q+Te])}try{if(!N.getSource("search-radius-src"))N.addSource("search-radius-src",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[Z]}}});else{const ue=N.getSource("search-radius-src");try{ue.setData({type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[Z]}})}catch{}}N.getLayer("search-radius")||N.addLayer({id:"search-radius",type:"fill",source:"search-radius-src",paint:{"fill-color":"#5b9bd5","fill-opacity":.12}})}catch{}let ge;try{ge=new i_.Marker({color:"#1976d2"}).setLngLat([ce,Q]).addTo(N)}catch{}return(async()=>{const pe=(await jse()).filter(me=>me.lat==null||me.lng==null?!1:aae(Q,ce,me.lat,me.lng)<=u);b(pe),pe.forEach(me=>{try{const Te=me._marker;Te&&(Te.remove(),me._marker=void 0)}catch{}me._marker=new i_.Marker({color:S(me)}).setLngLat([me.lng,me.lat]).setPopup(new i_.Popup({offset:12}).setHTML(`<strong>${me.name}</strong><br/>${me.date} ${M(me.time)}`)).addTo(N)})})(),()=>{try{N.getLayer("search-radius")&&N.removeLayer("search-radius"),N.getSource("search-radius-src")&&N.removeSource("search-radius-src")}catch{}try{ge&&ge.remove()}catch{}}};if(N.isStyleLoaded&&N.isStyleLoaded())j();else{const Z=()=>j();N.once("load",Z)}return()=>{try{N.getLayer("search-radius")&&N.removeLayer("search-radius"),N.getSource("search-radius-src")&&N.removeSource("search-radius-src")}catch{}}},[n,u]);function S(N){let j=N.startTimestamp;if(j&&typeof j=="object"&&typeof j.toMillis=="function"&&(j=j.toMillis()),!j&&N.date&&N.time&&N.time!=="TBD"){const ce=new Date(`${N.date}T${N.time}`);isNaN(ce.getTime())||(j=ce.getTime())}if(!j)return"#1976d2";const Z=Date.now(),K=j-Z;if(K<=0)return"#9e9e9e";const Q=K/(1e3*60*60);return Q<=1?"#2e7d32":Q<=6?"#f57f17":"#c62828"}function M(N){if(!N||N==="TBD")return"TBD";const j=String(N).match(/^(\d{1,2}):(\d{2})$/);if(!j)return N;let Z=Number(j[1]);const K=j[2],Q=Z>=12?"PM":"AM";return Z=Z%12,Z===0&&(Z=12),`${Z}:${K} ${Q}`}async function O(N){if(o)try{await iV(N.code,o.uid,"attendee");const j=await BO(N.code);window.alert(`Joined ${N.name}. ${j.length} people now attending.`)}catch(j){window.alert(j?.message||"Error joining event")}}return U.jsxs(On,{sx:{minHeight:"100vh",pt:10,pb:4,bgcolor:"background.default"},children:[U.jsx(xM,{}),U.jsxs(_h,{maxWidth:"lg",children:[U.jsxs(hr,{direction:"row",spacing:3,alignItems:"center",sx:{mb:3},children:[U.jsx(sn,{variant:"h3",sx:{fontWeight:700},children:"Search nearby events"}),U.jsx(Tb,{label:`${Math.round(u)}m radius`,size:"medium",sx:{fontSize:"1rem",px:1,py:2.5}})]}),U.jsxs(Ec,{sx:{height:600,position:"relative",overflow:"hidden",borderRadius:3},children:[U.jsxs(On,{sx:{position:"absolute",top:16,right:16,zIndex:2,bgcolor:"background.paper",boxShadow:4,borderRadius:2,p:2,minWidth:220,pointerEvents:"auto"},children:[U.jsx(sn,{variant:"body1",sx:{fontWeight:700,display:"block",mb:1.5},children:"Legend"}),U.jsxs(hr,{spacing:1,children:[U.jsxs(hr,{direction:"row",spacing:1.5,alignItems:"center",children:[U.jsx(On,{sx:{width:18,height:18,bgcolor:"#9e9e9e",borderRadius:1}}),U.jsx(sn,{variant:"body2",children:"Started"})]}),U.jsxs(hr,{direction:"row",spacing:1.5,alignItems:"center",children:[U.jsx(On,{sx:{width:18,height:18,bgcolor:"#2e7d32",borderRadius:1}}),U.jsx(sn,{variant:"body2",children:"Starts within 1 hour"})]}),U.jsxs(hr,{direction:"row",spacing:1.5,alignItems:"center",children:[U.jsx(On,{sx:{width:18,height:18,bgcolor:"#f57f17",borderRadius:1}}),U.jsx(sn,{variant:"body2",children:"Starts within 6 hours"})]}),U.jsxs(hr,{direction:"row",spacing:1.5,alignItems:"center",children:[U.jsx(On,{sx:{width:18,height:18,bgcolor:"#c62828",borderRadius:1}}),U.jsx(sn,{variant:"body2",children:"Starts in > 6 hours"})]}),U.jsxs(hr,{direction:"row",spacing:1.5,alignItems:"center",children:[U.jsx(On,{sx:{width:18,height:18,bgcolor:"#1976d2",borderRadius:1}}),U.jsx(sn,{variant:"body2",children:"No start time listed"})]})]})]}),U.jsx("div",{ref:t,style:{height:"100%"}})]}),U.jsxs(hr,{direction:{xs:"column",sm:"row"},spacing:3,sx:{mt:3},alignItems:"center",children:[U.jsx(sn,{variant:"h6",sx:{minWidth:180},children:"Radius (meters)"}),U.jsx(hse,{value:u,min:200,max:2e4,step:100,onChange:(N,j)=>f(j),sx:{width:400},size:"medium"})]}),U.jsx(sn,{variant:"h4",sx:{mt:4,mb:2,fontWeight:700},children:"Events found"}),U.jsx(hr,{spacing:2,sx:{mt:2},children:g.map(N=>U.jsxs(Ec,{sx:{p:3,display:"flex",justifyContent:"space-between",alignItems:"center",borderRadius:2},children:[U.jsxs(hr,{spacing:.5,children:[U.jsx(sn,{variant:"h6",sx:{fontWeight:600},children:N.name}),U.jsxs(sn,{variant:"body1",color:"text.secondary",children:[N.date," ",N.time,"  ",N.location]})]}),U.jsxs(hr,{direction:"row",spacing:2,alignItems:"center",children:[U.jsx(cs,{size:"large",variant:"contained",onClick:()=>O(N),sx:{minWidth:120},children:"Attend"}),U.jsx(cs,{size:"large",onClick:async()=>{const j=await BO(N.code);window.alert(`${j.filter(Z=>Z.role==="recruiter").length} recruiters attending.`)},sx:{minWidth:160},children:"See recruiters"})]})]},N.code))})]})]})}function iu({children:t}){return U.jsx(Xf.div,{initial:{opacity:0,y:20,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.98},transition:{duration:.4,ease:"easeOut"},children:t})}function s_({children:t}){const{user:e,loading:n}=W.useContext(zd),i=yh();return n?U.jsx(iu,{children:U.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"system-ui, sans-serif"},children:"Loading session"})}):e?t:U.jsx(r3,{to:"/login",replace:!0,state:{from:i}})}function cae(){const t=yh();return U.jsx(xj,{mode:"wait",children:U.jsxs(NF,{location:t,children:[U.jsx(yc,{path:"/",element:U.jsx(iu,{children:U.jsx(Ase,{})})}),U.jsx(yc,{path:"/login",element:U.jsx(iu,{children:U.jsx(Rse,{})})}),U.jsx(yc,{path:"/signup",element:U.jsx(iu,{children:U.jsx(Pse,{})})}),U.jsx(yc,{path:"/dashboard",element:U.jsx(s_,{children:U.jsx(iu,{children:U.jsx(Xse,{})})})}),U.jsx(yc,{path:"/profile/edit",element:U.jsx(s_,{children:U.jsx(iu,{children:U.jsx(toe,{})})})}),U.jsx(yc,{path:"/profile/me",element:U.jsx(s_,{children:U.jsx(iu,{children:U.jsx(roe,{})})})}),U.jsx(yc,{path:"/p/:slug",element:U.jsx(iu,{children:U.jsx(soe,{})})}),U.jsx(yc,{path:"/profile/view/:slug",element:U.jsx(s_,{children:U.jsx(iu,{children:U.jsx(aoe,{})})})}),U.jsx(yc,{path:"/nearby/:eventCode",element:U.jsx(s_,{children:U.jsx(iu,{children:U.jsx(nae,{})})})}),U.jsx(yc,{path:"/events/:eventCode",element:U.jsx(s_,{children:U.jsx(iu,{children:U.jsx(rae,{})})})}),U.jsx(yc,{path:"/map",element:U.jsx(iu,{children:U.jsx(lae,{})})}),U.jsx(yc,{path:"*",element:U.jsx(r3,{to:"/",replace:!0})})]},t.pathname)})}class uae extends hu.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){this.setState({error:e,errorInfo:n}),console.error("Caught by ErrorBoundary:",e,n)}render(){return this.state.hasError?U.jsxs("div",{style:{padding:24},children:[U.jsx("h1",{children:"Something went wrong"}),U.jsx("p",{children:"The application encountered an error during rendering. The full error and stack trace are shown below."}),U.jsxs("div",{style:{whiteSpace:"pre-wrap",background:"#111",color:"#fff",padding:12,borderRadius:8,overflow:"auto"},children:[U.jsx("strong",{children:"Error:"}),U.jsx("div",{style:{marginTop:8},children:this.state.error?.message}),U.jsx("hr",{style:{borderColor:"#333"}}),U.jsx("strong",{children:"Stack:"}),U.jsx("div",{style:{marginTop:8},children:this.state.error?.stack}),this.state.errorInfo?.componentStack&&U.jsxs(U.Fragment,{children:[U.jsx("hr",{style:{borderColor:"#333"}}),U.jsx("strong",{children:"Component stack:"}),U.jsx("div",{style:{marginTop:8},children:this.state.errorInfo.componentStack})]})]})]}):this.props.children}}WV.createRoot(document.getElementById("root")).render(U.jsx(hu.StrictMode,{children:U.jsx(l6,{children:U.jsx(qse,{children:U.jsx(PZ,{children:U.jsx(uae,{children:U.jsx(cae,{})})})})})}));
